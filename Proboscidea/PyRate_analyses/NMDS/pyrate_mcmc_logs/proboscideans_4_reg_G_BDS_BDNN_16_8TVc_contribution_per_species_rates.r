pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_4_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 5.0,2.0,6.0,3.0,4.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.02811948461337571, 0.1052716806958473,0.10378713225163316,0.11886895452051295,0.13176765255601966,0.05355704449065122,0.09264687251049139,0.046025808581737784,0.07149943010662256,0.206270452715362,0.04072028463542576,0.0766151452792884,0.0386948826584384,0.06994400828252684,-0.0940158803315847,-0.051134157412649754,-0.42401950985890186,-0.28544603436774535,-0.04453256358265071,0.1957185054972816,-0.154593303262628,0.04048931882795653,0.029662174274794024,-0.03053786949421268,0.18498345421825593,-0.1940748678351913,-0.2244180698729363,-0.24913505604350208,-0.20010507615544607,-0.17412769584624355,0.4436810599457049,0.34138904087658717,0.5089221076368169,0.4389647959535107,0.46623568014953065,0.2601648105134745,-0.11181049320802654,-0.06380532855806711,0.09560567973545275,0.3135150612414057,0.2345866715097053,-0.03173632732117214,0.026753813689977257,-0.04529614078205395,-0.006149134236461881,-0.05294669080800013,-0.004684872296535742,0.03579391734920971,-0.08283627149258523,-0.007891147659027218,0.040148324397235056,-0.052751156026113626,-0.03585089666596386,-0.012695603226266356,-0.062243968979368985,-0.05410174222218521,0.2028269799687098,0.07796403797253093,0.12067330795771557,0.11928914361085598,0.10501568905755689,-0.31839843966803666,0.33200094972205185,0.31979459120767684,0.4113491222787756,0.3279711836531752,0.3127625485612993,0.3123016114699996,-0.03581184041750922,-0.06629562136050365,-0.10334906473046579,0.3620431267363644,0.504740900658883,0.707560820145417,0.7239726765103852,0.4518124228379115,0.7457977077465073,0.28945178873456867,0.37092513781810965,0.40547607422816184,0.41829442668820727,0.332583987701513,0.47349305179294243,0.13622623953647042,0.06087146415643936,0.07950993373632477,-0.09046164164735485,-0.02490507852775793,-0.05661315353275333,-0.3395654802520318,-0.36045279118781426,-0.3611660680693421,-0.3492473677693436,-0.41507995125714325,-0.4158631433607062,0.5267129242088833,0.712594778752122,0.6543921767090203,0.7340917760984801,0.4440939418546425,0.7141424418138697,0.7512213444459079,0.5306689017076245,0.4952181254010568,0.45837041419646557,0.6754569830859972,-0.18604771480709512,-0.03721871368154493,-0.04465828046453352,0.0785515620210809,-0.17562948031805312,-0.18477584318004614,0.32848669469711295,0.030519828283841855,0.031204741828136245,0.015040927426009109,-0.011696896351913075,0.31245260619470533,-0.28645301216359753,-0.3104165328077792,-0.3615584608603385,0.022181637746678674,-0.01575200062362401,0.05362550108550077,-0.017999238638563248,0.016727938777323394,0.026194036157445914,0.06004133049754274,0.15931934942926032,0.13072825482148145,0.08462239801331185,0.03198029902096442,0.09851558978313947,0.1453182593725557,0.06803150985009805,0.11113229674177982,0.13344237614673077,0.28529969661166293,0.24667431500130796,0.25847090017028856,0.27934832314857155,0.35235694182548916,0.2541335994891961,0.23063805787697686,0.2866907280060275,0.25274819535994236,0.3556170434132758,0.26221245976336344,0.2237639498840992,0.34117727637921325,0.33666426132880367,0.3371610796862485,0.3551878583430162,0.35381888004607326,0.28540660593818823,0.1809937159527269,0.1972673231088901,0.20869823646310626,0.2825877703988858,0.2136367798010156,0.4437011050588198,0.20580513967533398,0.17688393472162162,0.23484027211210778,0.21042105398303,0.13133077601218893,0.09711011294198843,0.06489972794550737,-0.03846766868425462,-0.028714754022411342,0.12862654779187846,0.07867924162572552,-0.043734514734745586,-0.10505603107303509,-0.1043660932445438)
shap_list[[2]]=c(-0.05610212400636158, -0.00850472898328524,-0.07155528435089271,-0.06405140446288961,-0.020573281265587922,-0.026947376946999953,-0.007254660603387597,-0.03101290301284177,-0.011098968117767678,0.052332342762207065,-0.014949983085207497,-0.029595166463701986,-0.027410845766176674,-0.015407433982836442,-0.020377458403099853,-0.04141196665917397,0.0351604144843497,0.04721312049364878,-0.002295604823268422,0.014989251227708129,-0.01906788999191062,0.03182609460458057,-0.05005321456129717,0.012514515976614264,-0.016664489696830022,0.06414004435262564,0.09038653794431786,0.12187664735161007,0.060782056672654676,0.061235479940096045,0.04014445400787109,0.030138992182044372,0.05600072297369637,0.04243476617211407,0.05908362809682282,0.029477275043794736,0.06998832334772134,-0.009038255310346105,-0.03142774823851264,0.011469717429205996,-0.031091693618855366,-0.02793810598435154,0.009059570406661043,-0.04383811608885445,-0.02500551288552603,-0.02315842659245931,-0.017718173809863645,0.0038886292929996586,-0.01297510380473552,-0.007550142783385668,-0.0734920499831405,-0.021419525514630215,-0.015131223817225899,-0.0089048805166191,-0.02296273838882261,-0.021808649637958973,0.03156427754822505,-0.08454131659720236,-0.06438319112979562,-0.025058782136467516,-0.06213779684497467,-0.0018824619439621498,0.046129080369143975,0.03482347839550349,0.03608191632747771,0.04076942044275667,0.03464512308952382,0.03440375301528225,0.06212444266934265,0.08791776427767081,0.06020577004367951,0.029187393648585164,0.16047348197932737,0.15130759496713775,0.18789152663135683,0.07942072136092627,0.1698833797214802,0.04341355456343686,0.09929915961877801,0.07125089269493952,0.057623946304940936,0.033833862730490834,0.09716914406090298,-0.001189581493457924,-0.043181933310567,-0.004056509684520103,0.06005951092044934,0.036515480582440155,0.0349902578619069,-0.025930491002992922,-0.023252286472360637,-0.023242690831595445,-0.025670897383807602,0.09516954307886183,0.06377022377736563,0.09744981826838987,0.15083576433715115,0.19138317037637298,0.1330837970975719,0.04765411288329079,0.15815225658176288,0.16936854249840372,0.08114455485194956,0.07928238257532917,0.050875091846506716,0.15882781546544805,0.016229749848235782,-0.015606443306182802,-0.018760210941348512,-0.056921103111299234,-0.002183321649636595,0.015979852677217805,-0.01396262305830822,-0.0980052558130908,-0.09525875888848236,-0.0963472605535153,-0.0959034284175711,0.02985917615035532,0.024210146084996415,0.038582102775329724,0.049359264109475144,-0.017961364979646566,-0.08189255711520682,-0.09678915640272347,-0.04597089910861546,-0.08689759337722282,-0.025528858913842847,-0.04135344935607464,-0.043442886890085006,0.07276125953819515,0.012669180092259699,0.10333179076839369,0.09180781852790511,0.06401442789554589,0.14856064004015368,0.09564089898761682,0.05685381536675936,-0.0066212629668876526,0.03812221975948025,0.025958028969162043,0.020508841241731635,0.059903712667931104,0.02297050202183609,0.027017194048108272,0.026230083445032294,0.030075618261304553,0.03512431298391905,0.030784347428492786,0.01953420816289789,0.06130940881816065,0.06754325667731906,0.06670414752249842,0.05037710512495137,0.05253430359396622,0.00407134073240785,0.012473793369509698,0.03260793658852271,0.04615698917919144,0.03448233015702861,-0.008384317338873307,0.027804709720385557,-0.012178765327166137,-0.002233014665012614,-0.004719549473007663,-0.0046295008713496165,-0.02043179412759552,-0.015881426650107628,0.010461083577138987,-0.022998323492045003,-0.01220064428901246,-0.031493595317663374,-0.05744106169903839,0.12362009989781338,0.042145290727661516,0.04511981560335851)
shap_list[[3]]=c(-0.06119820458908507, 0.0024077924877383408,0.15269303714498716,0.16144910702928855,0.029413062505195396,0.004142306817137062,-0.03470522041420359,0.011404537864845016,-0.03323926545180506,1.0089487617502444,-0.0353343613927183,0.013084479372663682,0.000711416988890867,-0.04221769395223167,0.04038789472630421,-0.18985478457348318,-0.014250865067806921,-0.023553109443930045,0.02412627768343444,0.17040251872538068,0.0529626384291758,0.10724905884976971,-0.062019634434999284,0.048349902261788036,0.08108016865029422,-0.019047158580123506,0.030304998054858992,0.047728221409318004,0.017800290960215442,0.012859006148623266,-0.026021040866232817,-0.04149182138487415,0.040607268283549665,0.07542051777242977,0.03023601099827596,-0.2243273789393437,-0.038269315206911125,-0.01372650679179762,0.152475843445448,0.2586052108626926,0.11034677158809199,-0.1708607386472046,0.10434168678559894,-0.049040713427241756,0.045724682285032715,0.034581251557437805,0.07287003051482842,0.10943307994443117,0.046081838208770265,0.07082763383754212,0.10994135938594671,0.031920942659189565,0.06094363350619858,0.07035342462505413,0.03378218116640901,0.03337500678737451,0.17525275393871817,0.02990584217024214,0.15951247748942657,0.024482069506134057,0.058056814560700144,-0.018739039071117524,-0.03895408416351605,-0.035236838549309764,-0.02731269104385695,-0.014859543160771206,-0.033464589319967604,-0.046851618737295084,0.11289436427487243,-0.09873712007306797,-0.0906505068407363,-0.03740285903500624,0.25079202389892724,0.9666163020248845,0.9555296015570183,0.03511560186318193,0.9868007916753728,-0.2639768547969383,-0.04350669973939632,0.032843312748834994,0.029505774339719956,-0.01817700573456785,0.04080655882784506,0.23111018388548632,0.10537461360872633,0.1923294598199274,0.06429189058387458,0.08161902682193374,-0.08890157519978788,-0.010640847808738989,-0.008987273355456488,-0.008982592735037289,-0.009977649518176947,-0.001400165015436154,-0.014072091750504917,0.04945326481486586,1.0225062217263916,0.8932727223436797,0.8955179989992073,-0.020728061422989198,0.9961356670099613,0.9937546020594015,0.04082854060594695,0.039620456454018,-0.014434901269380336,1.0179772212499767,0.02478985790238496,0.03198476380908325,0.024304993421907502,0.13237170134785753,0.004719749482364112,0.02498667747385924,0.027739628148758477,0.08923991036583567,0.09031155918384749,0.0742976773087451,0.05173775832944861,-0.028597066583092065,0.021038259698053882,-0.022973650141283334,0.0487145796518929,-0.03377802647055205,0.0425271978611902,0.08626790508800251,-0.02262722613649928,0.056484228926916784,0.0655610604503458,0.06792011663489995,0.23677994053016752,0.08540186994725035,0.10882452431615876,0.18221440861429306,0.21735010248780068,0.2099348223969802,0.1821989888785632,0.22237779100690933,0.21134910704424545,-0.028691384155201775,0.007613826933656104,0.014140095628160418,0.029689637250211818,0.6428408189270732,0.007627124564195544,0.0019097914288356834,0.017496021436636824,-0.048178302976377735,0.741754754302086,0.005128530030679689,0.001121017726775038,0.621737885353284,0.6418432469479043,0.65199412816277,0.619701864240448,0.03129132858581017,0.05992071621386936,0.04764684979107157,0.096927987113076,0.10299533511068945,0.6390202718333021,0.02143069523443565,0.6354090507197188,0.004383317222746777,0.0035616978994040937,0.09250450795723213,0.028021280455961098,-0.022033729994158043,-0.17615699355322065,0.06252357412136451,-0.14233006351570948,0.04246847735064897,0.22547381647828146,0.15501271387806184,-0.028628449606591125,0.016594661663882102,0.051206073207910784)
shap_list[[4]]=c(-0.022317319093595935, 0.07331555488676511,0.048881410348325965,0.02755118789274874,0.008117742370917006,-0.04301988076680005,0.028942595144635683,-0.006393061510229272,0.030422898086692438,0.1026500308678452,0.027501005184908243,-0.008780093334890797,-0.022288799963433543,0.023460656576990122,0.03357405524366723,0.017359261565670324,0.02824999349072428,0.03764499100132739,-0.012191992777283927,0.1188112441005095,0.034450588918286,0.07541023380680785,-0.022977898393477122,0.021479878640671295,0.1189895268145527,0.02253776693904501,0.006113589293825838,0.04737787200211089,-0.014305187798482152,-0.023868630655588557,-0.0006716138329315781,-0.01049439256594797,0.029561414852812842,0.04608249284287887,0.014750123255430079,0.02908484178312818,0.04796775910148327,0.0073996867008783804,0.012660013012688575,0.15361846240229152,-0.01936040117957736,0.02383423978599042,0.07512799754573508,-0.03130357195935457,0.03224391508148391,0.023707048671214575,0.04958938898163896,0.07971086701948527,0.024933649546512313,0.05306822389400692,-0.049866244309989774,0.009624242381176734,0.05008237674033148,0.054468358843597124,0.02315832308560643,0.02423378058499349,0.08985979713843152,0.012619941855778555,0.054034008733290624,0.0416096073612265,0.039755599931352074,0.024374366904172558,-0.013941340021329192,0.018564295735716833,0.009673019884323023,0.02367858241946284,0.022823381579945536,-0.012193958690823641,-0.05335773350053555,0.02066677570377369,0.015901114333666713,0.0014989799180329581,-0.009203008967268882,0.1722225519468684,0.15352664898089047,0.01556728750546518,0.18539757585192554,0.020366964725406573,0.018540498216945193,0.001865670676744341,0.014871435943410996,0.02181906313509517,0.016725551785735805,0.12961673880106953,-0.026973512977713363,0.13556151970863942,0.06552091647281956,0.05846850444425598,-0.006391888666623577,0.011989062911673362,0.016639852263044937,0.01652282981707185,0.018461223158010878,0.04925233848519061,0.028567798888695876,0.028945702900387553,0.18042569218930396,0.09139128502455614,0.15998420964192334,0.014635500418547134,0.17920876840847116,0.18749176591417271,0.024065925740745165,0.016820762066821607,0.01808539652926257,0.17750639438541496,0.04268689983812229,0.01163475501223495,-0.005231116955173916,0.06858283731930627,0.028515399358379285,0.04312282304695123,0.024544763824198155,0.07184487521543852,0.07353226335063048,0.06285283610045364,0.04524387682810766,-0.010576165804130786,0.005927818704919526,0.022320101398461457,0.035605967296690695,0.00929626598157597,0.03811614386745938,0.05244693931134916,-0.0037827196327803662,0.05024480040117818,0.08969318284695212,0.07453217085196905,0.047765273598707685,0.007491357912204176,0.04350773464762735,0.045369753979599456,0.055394492172555765,0.031123974132910195,0.05251356414135863,0.042364443647637404,0.034653543597863413,0.026930875115322894,-0.03266169716721321,0.015129805685208471,0.030876603899632933,-0.0681174675886016,0.0023311655917171575,-0.027855001701645444,0.017359312100061575,0.001933604368649711,-0.032823612377099985,-0.017228152439413755,-0.016446941826440277,-0.07560665820163098,-0.06173670043556476,-0.05844226129180283,-0.08232343899084409,0.008065783436007447,0.036533830587056663,0.03482988580971429,0.16462366193555253,0.10022458602652193,0.056271245539907144,0.015276628756054011,-0.10078242370031713,-0.03741514726928427,-0.02888316445463136,0.12458879344619393,0.03501146866588691,0.04294886878705445,0.03520922492228433,0.018112811270947493,0.0163151639712974,0.04045750134984869,0.04445973505167555,0.044100707361719414,0.06704439893820166,-0.00018449729427232655,0.03541011140767146)
shap_list[[5]]=c(-0.018050001751845755, 0.04471380045791899,0.06317854162152481,0.0729978361343119,-0.05675840028051083,-0.038200954338876145,0.020295019945042188,-0.044900102459022255,0.014030250188148756,0.016506077173602095,0.007656180632345775,-0.04841251738785473,-0.028132700415462383,0.0017093896930965664,0.023683032235366004,0.009806785469984557,0.010707536594911275,0.009788258865755963,0.026711708490872413,0.11050513251057897,0.023895308517966816,0.07595445764592541,-0.01626640115118888,0.04074141416051229,0.0481311263075211,0.003913158151275818,0.016803295540286423,0.027792542975811345,0.009109819879732974,0.00710331993918459,0.0056956237761398906,0.0017553943356984633,-0.006450305002814077,-0.01589078031240166,-0.004215810543324491,-0.0030417586437949213,0.018533583658310267,0.019785259385848093,0.07796467188826361,0.11372957407667868,0.06507614571968026,-0.01780407571100258,-0.0017303249478626483,-0.011916324854888072,-0.04386218451633299,-0.04028046384448218,-0.023265013056166618,0.014478069177910441,-0.030826228365358418,-0.040747508486321915,-0.041176842907471464,-0.03017248419912521,-0.03844509348390342,-0.040241869439006,-0.03208999206122166,-0.03915769339902412,0.153750722123591,0.022681568717049443,0.06783579611246628,0.039162090490756744,0.0414399346600746,0.0028259541756016633,-0.0014556366850756472,0.009669572240427436,0.009918732854187179,0.014883464720191057,0.009828204129265616,0.00141977620886551,0.004121944709634456,0.022525059933880973,0.014873388639510626,0.006275468408876605,0.09773880342014106,0.09695484835202002,0.1286140958624841,0.004962068737036618,0.11355214411886817,0.01830676101375914,0.05128347265155574,0.01172055373740716,-0.005518135370433337,0.01600367430688497,0.02099551065795386,0.10575614767362869,0.05975172022360826,0.08904845063522102,0.05307458980426789,0.06693958399175831,0.021593059247663287,0.005871012278644958,0.010028058002959608,0.01007174922308584,0.010568254983388183,0.022801010376014272,0.008724921657263933,0.025317667322211194,0.0985171011893236,0.12785551227964817,0.0875573800005828,0.010103856222705236,0.10073946499703192,0.1145532832187349,0.00973914767578676,0.014152258158558485,0.012977240689743045,0.09739351551667288,0.03428928230866885,-0.009087582383162807,-0.0057342709290983,-0.030727295351518018,0.01729496463339275,0.03377578915824961,-0.02799702755639416,0.04213074273996522,0.04290481453745216,0.034556087838723465,0.02021995728961122,0.005686314206810067,0.006653576476587019,0.005040401109433393,0.019473693375081504,0.014144471989910392,0.018296948490705556,0.044298306659864915,0.0035887242856565936,0.026579351518224065,0.04369340364268415,0.048601109665358536,0.10214082385253419,0.09716574706720985,0.07591250861695344,0.1341414478559303,0.15230096044349895,0.139335073345893,0.14997823762601395,0.15311838472322845,0.13878637213127956,0.02308508596142374,-0.037204563719802713,-0.04375505033305333,-0.04037414269668183,-0.006958891616398868,-0.043295476326434795,-0.04491190394760446,-0.04268256917133826,-0.018751660472704983,-0.003491834777920151,-0.04425815761686485,-0.04293050140427332,-0.006570174005169253,-0.006212015922969316,-0.007017520267541546,-0.0055777814900671895,-0.03802062461098643,-0.05509681380766466,-0.03879539187965643,0.01337978272798473,0.0026586215763756177,-0.024164853725357708,-0.05926796922117366,0.00698835402408179,0.028268892865564953,0.029924785891764207,0.052086613225257386,0.03625850151223526,0.031680887496083936,0.016416699150059336,0.004628511016608826,-0.008185880667973888,-0.01669127067392302,0.10069914880064529,0.06214274443232649,0.03186633009577853,0.01581975676974012,0.04096536876312259)
shap_list[[6]]=c(-0.01784585920545271, 0.016414975654338197,-0.05034911343545457,-0.029903938304371647,0.010413899752412886,-0.0037479977767610017,0.012384539684768665,-0.002008163444126985,0.01082280681196089,0.09333833294202838,0.0064701500447451,0.0001573378624948017,-0.006556091810641369,0.004963778065590021,-0.022813281322839163,-0.013248691435140875,-0.04483611573005902,-0.027192952776811125,-0.022659306382795726,-0.009286679362515106,-0.019977107320011386,-0.012479927690576051,-0.021038947601557608,-0.019970318966555493,0.16677913555898008,-0.027820275075100757,-0.027241520605713988,-0.02163094745397508,-0.02983034626813136,-0.030526641933325938,0.0378208380417014,0.028866287781184812,0.04405821474910044,0.0364628785766313,0.04182465545478355,0.015070142050115757,-0.017623240280413077,0.009595172388059068,0.13378791876939522,0.21706628433816444,0.12264023287295411,-0.0024964857619807737,0.016142255364866912,-0.008300287474623726,0.0016965123157885364,-0.002574825136786683,0.0033897001411623386,0.012498111980621266,0.004119544899792451,0.009007421297614376,0.029774778940894617,-0.00023111490186773472,0.008633923356559388,0.007954351518947939,-0.001076472478967123,-0.0015707635026963784,-9.99783946472937e-05,-0.04519365870780152,-0.05272446193544824,0.0026609556242193307,-0.04237442366774861,-0.012239988645590796,0.02846497392370535,0.029446574615035026,0.037439177544108665,0.03816496865054764,0.028646762639136868,0.026244898882276026,-0.025076430674906197,-0.024021693267995362,-0.02135615692402931,0.03210906553319623,0.09215529823552666,0.14420831588700983,0.14415204503598972,0.05208280259369593,0.15196448073129382,0.02086254301805195,0.057083192404774545,0.05050585611079935,0.04105254548346261,0.037657452702898574,0.061821166540548846,0.20678127358697174,0.1172705856375872,0.22258354694129293,-0.03179014315959327,-0.033188461977032666,-0.027266078786872636,-0.030651748773725358,-0.0347209175409053,-0.035043137978949215,-0.03518618611343989,-0.03194223896604674,-0.0401393787710088,0.06820803143848679,0.15491126033698524,0.1307654712534666,0.1371942436269034,0.03993035747286129,0.15166678862053123,0.15545261772426108,0.056042376245755685,0.057879841406551294,0.04297682597579878,0.15286590999762106,0.007249505906803109,0.00601200540060871,0.002850554476654082,0.0353793759190799,-0.002263317941959732,0.007463846021531752,0.02443895767288751,-0.031711284554582005,-0.03187979605285546,-0.033448212180596265,-0.03751739873081704,0.03160232590331708,-0.030431013701143022,-0.0321531290469454,-0.03119971724495097,0.00817648903938091,-0.038062238332787865,-0.0328631094143862,-0.0051217091575701005,-0.03921465700774902,0.194246794061889,0.1524925834869965,-0.00015881668353789658,-0.022874553821932122,0.2869994246452314,0.4146596831542725,0.40399034052404037,0.36653755991720766,0.4504248354653331,0.40111114977330814,0.36942479841244313,0.02933309626177697,0.0027233598978812167,0.0023158186908336896,0.0028178228382468268,0.03791177154326381,-0.0003374709738759853,-0.001558585531132601,0.004536791336844863,0.007399587014231519,0.04699345328088385,0.00039717422308090973,-0.003746535659699007,0.03979908469722366,0.03915043330914707,0.0381861702211875,0.038684874860987435,0.015205183494165893,0.019812755541327495,0.0049909944218809515,0.018083122113225745,0.02192236484273516,0.06945933647578674,0.004052721120049012,0.06468657882257144,0.09772747830413646,0.09657628013440231,0.17059832779425968,0.09639134554548373,0.02155716978377271,0.009824384815721954,0.018308203263641423,-0.0005296296481431171,0.007733288471037451,-0.004185542099370359,-0.03363539692433632,-0.017208548019894132,-0.04209334950674638,-0.037996505683126965)
shap_list[[7]]=c(0.18563129835429695, 0.11363222918801458,-0.014967735387485465,-0.01263058156566542,0.08602912337783536,-0.08447392312543728,-0.02998682713695052,-0.027965676630720842,-0.05619740022737419,-0.1965047932257243,-0.08930261330746934,-0.0116112036355207,-0.16219205945293214,-0.11491852062259461,0.06449474356345021,0.14392732176244824,0.413753437990519,0.24842930396768192,-0.026413622020249574,0.34887594350568274,0.19395999176356535,0.15163478403642017,0.09400183395915879,0.05482660874258421,-0.20769078823731915,-0.06839074377807015,0.02322368741790326,0.028792099051862072,-0.019623714346368944,-0.06179935264089308,-0.17525358228722884,-0.1127855971235776,-0.1991670851041517,-0.19020188855300468,-0.23125177406273387,-0.10483639404011721,0.2589905023374508,0.3893085329006255,0.15047706453307821,0.11699719742780346,-9.426650855970374e-05,0.09636690988237742,0.2671596051484275,0.500886857573269,0.1898652479320728,0.0486445843471402,0.24033937674109307,0.27146016476356705,0.11929335744940935,0.21417011220056786,0.19612900283447823,0.03632567938168992,0.20113688834238194,0.23143715493418743,0.041884167630327,0.05007784566267663,0.5994899458667281,-0.0315525514045763,-0.011010530426844675,-0.09647459782832012,0.03765906518168235,0.24256689310343982,-0.11625216331282341,-0.22752228324495796,-0.18221236180898823,-0.093957335936387,-0.2485852450832401,-0.14175307634329815,-0.12302188777765208,-0.046860112242752446,-0.05987083454452462,-0.1437564249355867,-0.23903063571638342,-0.2421266381337887,-0.25439873723265094,-0.16830585391132033,-0.24752072575924838,-0.12141461580315267,-0.19532863211601803,-0.24768383428304397,-0.18064541179253174,-0.09730768399837961,-0.23725819577913515,0.12225789579487296,0.07949777845211607,-0.015867913307199978,0.18072498568570544,0.2229083562318377,0.1308331098699857,0.30859179283299,0.4409641656843575,0.4406156733821937,0.4496040267220531,0.4513282740910667,0.2999599633010718,-0.24445812908782397,-0.26071991325469934,-0.25618937995599916,-0.20461065392383596,-0.2390081102604019,-0.2564544541128931,-0.2487136706746821,-0.22277286080898367,-0.24774726628357896,-0.22148118582681725,-0.26085266586156874,0.45170201125759646,-0.0045489121567172715,-0.04967598542824087,0.08466176490496441,0.27229222652299456,0.45289729165461196,-0.1362161641450972,0.2388293621514282,0.24119851278827512,0.19392067221833698,0.1201219355955147,-0.026130674552252438,0.060506489260623963,0.20669469070462804,0.2279773515055556,0.2809210563766522,0.08407781554857222,0.23005523615775447,0.04976650826712347,0.11763090788909883,-0.18558069525462326,-0.023886446011434193,0.11240916535105014,-0.09134834200400373,-0.17012925870075668,-0.15221179943100716,-0.1576949259990873,-0.23156022646589836,-0.11347558986489852,-0.15643461712985524,-0.21098974267836587,-0.08449224107840808,-0.18538488194384758,-0.14087989688542657,-0.13095971258398437,-0.21735400350039466,-0.18251796880320872,-0.15441027899227014,-0.13847046754974915,-0.056980776462068346,-0.21876373140223684,-0.16787860278448405,-0.21837694616131154,-0.15176774656286462,-0.2061933160163967,-0.22217116402873904,-0.17424948786314104,-0.04263633372789129,0.2746858779674325,0.08171011934273625,-0.17322208595176933,0.11726396402421857,0.14471525147051698,0.0014280841923301443,-0.15917580291608013,-0.19613735885330305,-0.13615126338910782,-0.2448522836884784,-0.1189107951667878,-0.05291222251573869,-0.032636891247779805,-0.01926538123535917,-0.00023284105161556668,0.045509793826068685,0.10700089226617791,-0.01551351959002386,0.15292196982741463,0.006544187308347207,0.17601287907745533)
shap = do.call('cbind', shap_list)
baseline = 0.34195052022325895
rate=c(0.382567695429231, 0.6846442532073853,0.5731436452335544,0.6145165611316645,0.5310169808753031,0.20570044760956,0.4243267066198569,0.2891399869962854,0.3684787581436526,1.6122559827266882,0.2858053763761304,0.33535425059234764,0.13669872520623216,0.2710485118382204,0.36508824557483704,0.21903268858838346,0.3478370980725122,0.34929878862161456,0.28419671278774705,1.2780376272367966,0.45141379128245046,0.8026371987882136,0.2957989646144131,0.4658021292120217,0.7184608662113237,0.12507756932967437,0.25687292271683554,0.34385626533559105,0.166598935832969,0.13403587796726021,0.6685502849920836,0.5811671507455621,0.8152993804373918,0.7749482742092718,0.7191926278233463,0.34465752333424443,0.5692004137264598,0.6786584121403598,0.9307873084167172,1.5167034398440717,0.8236247079827329,0.2128217092197158,0.8315512997534443,0.6546116533044365,0.5366709920973363,0.32977386410107407,0.6596909523711214,0.8616885364545527,0.4083168757247357,0.629741865225483,0.5553538542806742,0.31510731766492905,0.5713429074346683,0.6413927949011405,0.32223629666864706,0.3329320472932311,1.5809341047943095,0.3250841683166062,0.6149977361095641,0.44548119731032715,0.5178202483352117,0.2608955182898168,0.579816231102014,0.493156576424059,0.6381105495462215,0.6785995816875133,0.470268389093111,0.517877722612248,0.28533136191633296,0.2378080781886358,0.15916133850583652,0.5934762125467207,1.1938693377295935,2.32410264243252,2.365900414081918,0.8117019811429964,2.431512935578626,0.3495276520242707,0.6979452965576486,0.6679522387852769,0.7171674104221065,0.6684782751886065,0.8144674458416281,1.2624565082413417,0.6953712332762381,1.0328905372801416,0.6403646665439865,0.7467000953281454,0.35090377040512033,0.26254989740103374,0.38297629038940784,0.38156442724713735,0.4013413974393341,0.510750709401805,0.27403164060410096,0.8918830409193381,2.383829601696188,2.16192101238534,2.2740007395270427,0.6398027410073007,2.3692410034220073,2.448399284902123,0.8610422138094321,0.7966198902537748,0.690045319805293,2.3442692726317285,0.7271119851132464,0.32458448923635375,0.2453686056772641,0.6530364146278043,0.4812556758256381,0.7296167433590017,0.5698338486425495,0.6816892932938803,0.6906089856644669,0.5907647022476212,0.43385351951038637,0.6571584281849052,0.14487230521538016,0.2501649647136147,0.33068916794237657,0.6232875236318175,0.38922039601681013,0.676741783572902,0.300684857983501,0.4825886089624729,0.549837349620183,0.6807583373660087,0.9495232558147945,0.6164332110405385,0.7851240713477841,1.0939375589766664,1.1945370727164448,1.0601335310723274,1.2711096671347077,1.202228963788542,1.0686719924566397,0.5860972642810437,0.3841786019224967,0.4747981006904391,0.5350064731034295,1.1449976800166215,0.405008209866514,0.375377476271155,0.5143987772322578,0.5118125522550572,1.2653560117964033,0.4135434783432032,0.3076816877136141,1.1763739641799345,1.1555422538490996,1.1502252078710298,1.1479689700140225,0.7220021124785199,0.9657908829614601,0.6664740429961207,0.6881981887751905,0.9385989377387821,1.551682477554847,0.5311590991357379,1.2632847739278024,0.43793455443217433,0.4873080759106868,0.767560192540483,0.6295667273854767,0.4737182377177835,0.27713299114185874,0.498305174787784,0.1475058402017794,0.41919598323169943,0.9055286530457243,0.5739943864052086,0.6258821363927687,0.27696968539915456,0.5474289246686953)
rate_lwr=c(0.06445682065350741, 0.056922450974855265,0.15871606959202816,0.15754726016642231,0.13466512757058177,0.029537306910021432,0.1177104978722969,0.08084528501166055,0.06559855791198327,0.12451245518378895,0.07265652577837861,0.08117016810076541,0.012624061046825008,0.052377169544378155,0.02999083266506808,0.005097601501503568,0.08016331257577713,0.05556339575701896,0.021793371110255255,0.32128078803275756,0.029743479953067614,0.15248847638267166,0.046594385347692446,0.07094865848452522,0.1387959018104213,0.007421196591431589,0.02506302183769199,0.0322207836993918,0.01859291596810686,0.025214887330674507,0.2787812818229124,0.23113414716362685,0.2103693798370859,0.14974686910108242,0.24382251242124336,0.03541834595676341,0.07307396283777026,0.1073747602990956,0.19505767678963065,0.2690138212455183,0.09694557261251124,0.02845445242750927,0.22206833414853522,0.0456422946597102,0.09560425052028376,0.09837046259645243,0.18729789057871482,0.22526488077830903,0.03584494610372346,0.22389687541694042,0.03491000267459787,0.09205098625897348,0.15506189395628373,0.22629240790751043,0.09751151746073816,0.08828147411591464,0.2748488707961415,0.039282796960768585,0.09596602567450382,0.016747659711026708,0.07223694011163373,0.026153149416668797,0.2429863726965733,0.12592485714430712,0.3205749543786346,0.27283945026160733,0.1417252106612306,0.22102771178874245,0.018628881075621384,0.023522825556444416,0.011765591295576139,0.3042608844485353,0.07878861886086791,1.056309916714189,0.7883068940129998,0.28260599543635756,1.076478501889369,0.01815493965895154,0.03247479187938784,0.13691997324412047,0.24041282916404158,0.2378012692948967,0.2460558737337943,0.28798341840582853,0.14759092850300395,0.1476788467893585,0.12923147374722532,0.14492289548288387,0.015890809318672205,0.04245168988195969,0.08277967353052451,0.11763318387933391,0.12899811860980864,0.1065502214367069,0.04552066601537408,0.24527946705049603,0.9904085214157481,0.5602007636391473,1.0332028006390508,0.22501120875961664,1.043674603173575,1.0380447977137113,0.3258776751793798,0.2634683118342516,0.25098851870225636,0.9837008586062361,0.10168259346701117,0.038403384613770075,0.03030207321365752,0.04207065831468615,0.055737304924546816,0.1335627340367314,0.11171277088047313,0.22941196408222447,0.2555340580688326,0.16709921481552992,0.10566250113066183,0.22900985015753988,0.026529823596848634,0.06907301327531407,0.032920296852564146,0.09387754809620896,0.12794048094102564,0.17048625410048704,0.034282728886346814,0.1762009102760891,0.05701670051052171,0.16540223205291252,0.20611640826857386,0.03172241950782878,0.04428369330054932,0.23074060072799896,0.2980819493696597,0.20773807128857885,0.22241432472001849,0.2751044412957381,0.2242490240297346,0.08211278701020075,0.07777264273054121,0.14567033103489344,0.10878482203621342,0.3830331714064059,0.159838018144786,0.10965282439390767,0.17961035511932755,0.09415532648334474,0.37534087631190244,0.17523859444775824,0.09596486661203055,0.41435019202867635,0.34959687025918773,0.39901157435739876,0.3773627655836309,0.23404355969716645,0.2098858003727432,0.1569843246108853,0.06337313042878395,0.2099235462144035,0.33093709218411105,0.1332817090606585,0.1623313857495026,0.07486444121777758,0.09326666010841606,0.10104158797279478,0.12195588375126554,0.044116074334305255,0.025463595662104932,0.05966742345615167,0.00831284846605948,0.11763454707510418,0.2215558135068021,0.13680596129005004,0.05412917801880729,0.06630232566432062,0.12512901175193145)
rate_upr=c(0.7674685764341483, 1.7119660766272977,1.1446245767373993,1.2191327840234063,1.0355165859793527,0.4498869913291315,0.9322553266705633,0.5386622137386662,0.7769976244241228,3.1509955482924767,0.5831099859517838,0.6452969152107115,0.30160916844239094,0.5085439635007354,0.8823458088072857,0.5690352862742603,0.6769799176977197,0.7273383722472826,0.7230226288689636,2.473759626327322,1.0295920541546084,1.7481952384713106,0.6196954915771895,1.0042362686004467,1.5062469354747317,0.26796868856254286,0.6141612683652844,0.918692297248912,0.3454944240893816,0.2903695476834033,1.1460314786047705,0.9176086725988118,1.517378839221566,1.5943451980009835,1.2332707171681796,0.7778364575211579,1.1745160273001551,1.4778388408086798,1.9676452413735444,3.1408479121996407,1.787872962197933,0.5343568457726182,1.6600764531879832,1.5106859263074364,0.9943301569975518,0.6313672589767547,1.2414938869732604,1.740619899160083,0.9270433774253217,1.2470309257164531,1.3414435686696913,0.5827312042294451,1.0456810655599658,1.1822840470859843,0.5870663214597122,0.5908981104367788,3.3679063774510154,0.6885106815566766,1.1946645957524331,1.1667337484725833,1.131119525258522,0.5675548182970132,1.047165883448772,0.7903190776292615,1.0937152255597966,1.2184697147286734,0.8349224420051675,0.8501386091649901,0.7471542596001448,0.6172859548142828,0.399409745417962,0.9618921768268018,2.682175032017775,3.836166507194409,4.097879174656528,1.376166101406726,3.9703630862328545,0.8666988430316697,1.722548837120597,1.293646279228526,1.2659560807750163,1.164632460652649,1.6223550946493281,2.533828284715334,1.420794883034007,2.1288427801683385,1.3262914572787114,1.650955634171036,0.9303436107128868,0.5163673786764557,0.6874062917630104,0.7155761009368728,0.7381213060602672,1.1302532417057958,0.6024029092061131,1.6649475724726008,3.883373694762991,4.146022610150378,3.8059213721346525,1.1229087272840141,3.8797015560360686,3.9860993301908167,1.5460218739377787,1.4478179095447927,1.221166895262283,3.805380665153279,1.6485075782301033,0.7364740441742857,0.5101873086369069,1.533195878088547,1.156115797556609,1.7074410766924246,1.1578010610129534,1.2364131364339808,1.249005097190711,1.207985607956146,0.8774746795450912,1.2318210947896322,0.3030408191450399,0.4883614795205492,0.7956224428693043,1.3314412992973075,0.7566528166259785,1.3489192610531884,0.7006477003947971,0.8582154136402589,1.231284106622772,1.3194642572958062,1.930001863015478,1.6245121481078924,1.881652101718071,2.1213009866014487,2.2126375731985757,2.0468296804629085,2.5530421432889394,2.208788948973859,2.046698650077436,1.2504928095376213,0.790828518041213,0.8414155301050783,1.0135370623223214,1.8980076515930262,0.719980194061759,0.6483740083483439,0.9267037562098708,1.0185219865914044,2.308111158174108,0.6985758429378759,0.5485836548425109,1.9502889903525564,1.9067377197904205,1.99838127012356,1.8708986616486591,1.4453874169703709,2.022497521328095,1.247140236224307,1.5689879476437745,2.155602506779756,2.8672413278133417,1.0503333870792377,2.346900033024064,0.8536394196543773,1.0002081928772966,1.6197178828995527,1.2838066539380493,1.109994369226566,0.6436030262370724,1.24800860110146,0.3520521383239126,0.8066242536801851,1.8985542347790467,1.081036274853858,1.495371907510427,0.5328180948378427,1.1150912813598606)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.14999629601708, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.88884247356902,12.685450981781905,18.452723600647822,11.389842614526929,10.70649647352556,18.757996322182372,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.979848282645456,14.521871401808362,13.644381033687072,20.953699984613685,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,11.610334918074667,10.928438777046042,19.116662982107215,19.555450852647265,12.67666310315921,22.62499624949477,10.612329808628933,14.86899639528348,19.605621306249663,20.328662959325403,11.825381067878618,15.251534849631417,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,12.762457973341409,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,12.762457973341409,21.08232961182545,19.810905393300043,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.474087405781923,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.141457947420491,10.74007339597134,15.109881006140222,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,10.180996483403327,18.093996334663508,9.341546499182357,8.275121519227847,9.699996492444631,8.672663178421974,18.08099633490787,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,20.39513914855202,12.685450981781905,14.172329741711991,13.876163080612338,14.172329741711991,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,10.74007339597134,10.647178292822375,23.096662907295563,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,7.943796525455751,12.685450981781905,16.47608727416608,22.26749625621469,12.543329772332134,10.15963284744126,12.685450981781905,19.776150149198095,19.336662977971898,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,23.096662907295563,11.566150303520583,14.172329741711991,17.990150182769337,22.72199624767148,21.1276885853318,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,10.74007339597134,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.060215653706084706, 0.07120382813832113,0.07547321995439363,0.07553303844941986,-0.0655538117244973,-0.06573057611922166,-0.06633580481400116,-0.06480512175509773,-0.06591718893891202,-0.06566107305410074,-0.06635612976227534,-0.06575530260523814,-0.06648522666727343,-0.06648264820611907,0.07160382314916693,0.06991591455568481,0.07896828005153499,0.07164279384062808,0.06241612237200713,0.06181710864179994,0.0620542230992475,0.0619257982089976,0.06205565514682178,0.06244715441567639,0.08536162860888764,0.0781485833424689,0.07800774329487155,0.07772811300512934,0.07791664489091751,0.078430858070029,-0.09655939017353769,-0.09453166367784402,-0.09737056775704644,-0.09756836188293168,-0.09771124102236046,-0.09489448605075196,0.06662273298427293,0.06435602673638904,0.0718496307755567,0.07669770254638532,0.07692469496334695,-0.023811058440237867,0.0018380841934253433,0.0407606456727695,-0.036574292472077,-0.023845383442355428,-0.0017349507967650468,0.014216762802039094,-0.023744632999080615,-0.02373427603273566,-0.037920230330225964,-0.039432285387830904,-0.03558678234927401,-0.02138892519882995,-0.03582607098234195,-0.035828890942609874,0.06072130955268081,0.07585985691369515,0.07584998206790093,0.07613083952438973,0.07570774052612286,0.06104586873054804,-0.0946662360659525,-0.10113752730055107,-0.10059543849877811,-0.09528738906089164,-0.10113752730055107,-0.09926244016805601,0.07296979120199583,0.07265363504589992,0.07266446239131709,-0.09734564055824746,-0.10020881386256153,-0.09980392711708956,-0.10025595042197993,-0.09927276219800274,-0.09986184842365976,-0.09937675679747424,-0.10015276488077163,-0.1000820730366025,-0.09894708948071829,-0.09650100529132201,-0.10011192494549465,0.07204411677737774,0.0720409085823848,0.07216120837451634,0.07040210413484989,0.07034059170263873,0.0704032385023171,0.07654583752209874,0.07581088243605578,0.07604993324287385,0.07575062624005621,0.07633350337467917,0.07936294367314294,-0.1026471592634567,-0.10258589682391282,-0.10234912772853237,-0.10242877572479905,-0.10165134907594976,-0.10265720284985663,-0.1026894064057499,-0.10219141035004033,-0.10218639750686921,-0.10149191211782835,-0.10252880434772459,0.06462529147846456,-0.06738633067926358,-0.06761009026148805,-0.03804202633149428,0.06441870183422228,0.06403360542154875,-0.09587218596652905,0.07134321207721041,0.07162023643627316,0.0717251785857892,0.07185609124303338,-0.09084025950359412,0.07375596733613446,0.07315591380310436,0.07355940509139895,0.06737174068853075,0.07267153216546134,0.07349527333613609,0.07338422109689738,0.07344676701043965,0.08341550187531026,0.08285147216065267,0.06835254934915627,0.07054198971392792,0.08553387242806472,0.08524815010790283,0.08461285383974707,0.08573855466517519,0.08398315804706857,0.08454314169323841,0.08566796878332675,-0.0911824241355365,-0.048262415836383556,-0.05024985142083372,-0.05030363800366674,-0.051911085061191596,-0.051048317987344986,-0.051436728991880225,-0.050255571233606716,-0.04926137264069275,-0.05180483492290015,-0.05144358462083344,-0.051128221573714376,-0.05153287108042268,-0.05041072053979207,-0.05194629699338727,-0.051644091426492,-0.04799014381100187,-0.039791771046979264,-0.040611366755548405,-0.04136382300595065,-0.03980091860007938,-0.040660002401300695,-0.040619834562899845,-0.09306661676176632,0.08536451961562791,0.08515029335992289,0.08555005833959368,0.08533475374974679,-0.0860966991869381,-0.08605855962711326,-0.05652552347909637,-0.056327161796512655,-0.05626178296176147,0.07179264123136686,0.07216393927554056,0.07026455344348272,0.07072804241420669,0.07027260398820519)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.031487973809310954, 0.056045089244965714,0.06523571853511792,0.06536433864146353,-0.0011094764495186403,-0.0011168188960492711,-0.0011430371275704834,-0.001077228436486598,-0.0011248855286571248,-0.0011137529284083788,-0.0011439098058443125,-0.0011179817140537529,-0.00114951110258354,-0.0011493678934149365,0.05676235197091913,0.05340344654932186,0.08269510173950885,0.06251136095074591,0.034526476491236406,0.03369347399364835,0.03402759880386093,0.03384139074294292,0.03402746728310914,0.0345680045535573,-0.21428849064429292,0.07868295706447608,0.0783310114501287,0.07762723168256738,0.07810157622965398,0.07939525945859789,-0.007414690392607977,-0.0070141157470689575,-0.007572534451876783,-0.00761099043763912,-0.007638740726438832,-0.0070837457627604995,0.04528297598805638,0.044616727555077444,-0.1307261488795868,-0.16033176060718551,-0.16151989956009763,0.0044100693014426234,0.005956278106038162,0.008032215785280952,0.003353603597050532,0.00442590962853442,0.0057042066024082586,0.0066779873114222316,0.0043793364927230405,0.004374702895625441,0.0032942726778237698,0.003174692081930204,0.00343353444054799,0.004428102511348008,0.003491561408617302,0.0034607673295661326,0.034231170322423225,0.06609362600833785,0.06607107539503415,0.0666842438485572,0.06576291053964763,0.03482298873069152,-0.007050793193479975,-0.00840147683907096,-0.008289694257841452,-0.007182109141907853,-0.00840147683907096,-0.008011753510916899,0.057407189219284616,0.05678740883646508,0.056808445818924164,-0.007573851662116367,-0.008150800022863188,-0.008067945610696846,-0.008160323771842844,-0.007961318344967898,-0.008079582704278861,-0.007982180127202733,-0.008139393929796675,-0.008125115008795359,-0.007895865747821472,-0.007405402175669493,-0.008131146012157506,-0.13079101891081943,-0.13077586607344505,-0.13132023871835244,0.05239197322190802,0.05227834076142451,0.052394154015620455,0.07606307435114548,0.0742338570128532,0.07483708488378318,0.07408646138213007,0.07565447722337876,0.08373512963515507,-0.008722825880633937,-0.008709861562225587,-0.008659825864249663,-0.00867663217611596,-0.00851225422478999,-0.008724941121608584,-0.008731743484831687,-0.008626662572066051,-0.008625420180948667,-0.008479073104229129,-0.008697696772623002,0.04557933554246334,-0.001604548523668928,-0.00161785608045529,0.0033207676491175697,0.04474996455264182,0.044084762391282915,-0.007277706573412467,0.05624957568820766,0.05679590739029155,0.057003292640960386,0.05726308897559785,-0.006278326651827772,0.06746525231095829,0.066103306447857,0.06701777149961241,0.048170664401342926,0.05918794764632315,0.06097541210223828,0.06071927522484218,0.060848208921999804,-0.2020040363903387,-0.19860827086678615,0.05002422625189043,0.052632824789420704,-0.21536148146799203,-0.21357386846857998,-0.2095695871320363,-0.21664944548719434,-0.20566232443163227,-0.20914012696679674,-0.21620631582768957,-0.006344281323543723,0.005878368841510932,0.0065521069337260126,0.006569726957410954,0.007119867634661843,0.006825824523182357,0.0069582390748420065,0.006553963186440205,0.006225436056580161,0.007083652773250968,0.006960542979082788,0.006852494800865196,0.006991146511649723,0.006604663837464395,0.007131868822396479,0.0070287895461951895,0.005795803649463602,0.0031281809083915867,0.0033618496913559275,0.003547537990150454,0.0031139096737299488,0.003397708089845245,0.003331377393129029,-0.006716784047259043,-0.21430225256155924,-0.21296567959361842,-0.21546704479079568,-0.2141167721778152,-0.005324564608243708,-0.005318704749656681,0.0003839010613670945,0.00038055321763787425,0.0003794442814260127,0.057155664445274916,0.057896123329980016,0.05213564746093228,0.052998181163972556,0.05214989365391874)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(21.735000000000003, 14.895,9.438,9.438,12.725000000000001,6.289499999999999,9.438,9.438,9.438,4.4665,6.289499999999999,9.438,0.4535,4.4665,14.895,21.735000000000003,36.272180500000005,25.565,9.438,18.205000000000002,21.735000000000003,14.895,18.205000000000002,12.725000000000001,3.0900000000000003,9.438,14.895,14.895,12.725000000000001,9.438,3.0900000000000003,6.289499999999999,3.0900000000000003,1.2905,1.2905,4.4665,21.735000000000003,25.565,14.895,12.725000000000001,9.438,18.205000000000002,18.205000000000002,31.0,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,14.895,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,12.725000000000001,25.565,9.438,9.438,6.289499999999999,12.725000000000001,25.565,6.289499999999999,1.2905,3.0900000000000003,6.289499999999999,0.06885,4.4665,4.4665,9.438,9.438,4.4665,0.4535,0.4535,0.4535,4.4665,0.4535,3.0900000000000003,1.2905,1.2905,3.0900000000000003,6.289499999999999,1.2905,12.725000000000001,12.725000000000001,9.438,18.205000000000002,18.205000000000002,18.205000000000002,31.0,36.272180500000005,36.272180500000005,36.272180500000005,36.272180500000005,31.0,1.2905,0.06885,0.4535,2.19,0.4535,0.06885,0.4535,2.19,1.2905,1.2905,0.06885,31.0,9.438,9.438,12.725000000000001,25.565,31.0,4.4665,18.205000000000002,18.205000000000002,18.205000000000002,14.895,9.438,18.205000000000002,25.565,25.565,21.735000000000003,14.895,18.205000000000002,14.895,14.895,3.0900000000000003,9.438,12.725000000000001,6.289499999999999,3.0900000000000003,4.4665,4.4665,1.2905,6.289499999999999,4.4665,2.19,6.289499999999999,2.19,4.4665,4.4665,0.4535,3.0900000000000003,4.4665,4.4665,9.438,1.2905,3.0900000000000003,1.2905,4.4665,1.2905,0.4535,3.0900000000000003,9.438,18.205000000000002,14.895,2.19,14.895,18.205000000000002,9.438,4.4665,2.19,4.4665,1.2905,6.289499999999999,9.438,9.438,9.438,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205000000000002,12.725000000000001,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(5.0, 2.0,1.0,3.0,0.0,4.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.026169159157565233, 0.04241261700596735,-0.015674354319796163,0.019288898337720305,0.33328563675715317,0.36770548399828673,0.31705390112318865,-0.014217868762303958,0.34855467005709523,0.14670428395470594,-0.026801660654126078,0.3464289616864,0.46031887983641884,0.07557306626483967,0.057877068403548976,0.02004982280880776,0.09143046254916108,0.04375847001211802,0.008708063236229911,0.028291593754325717,0.016439048588863414,0.023770160956005475,-0.03597758678633163,0.009818624497972646,0.16970078381965167,0.11495217263964604,0.045644020500563535,0.01482728769147139,0.019260080535085676,0.04669107868458029,-0.2136559739043292,0.004728652791750287,-0.23842857563578893,-0.2470317903211814,-0.2130982451646278,-0.09424167955197352,0.020046638492790123,0.13973355071945212,0.02552763787004162,0.04992788847174356,0.0468450696384265,-0.007077912657441562,0.051413774896638016,0.024755461353423918,-0.0064050179709914615,0.029495978030835614,0.017236488205757797,0.05346510069874861,0.06943597197799539,0.01792300479202774,-0.0012561043040180257,0.015501661106092612,0.032998547592250224,0.006770846354660535,0.005858594680015774,0.03303448909816291,0.06344509991541919,-0.024771828001648576,-0.03130382542067825,-0.038447780216045106,-0.01454067126133125,0.15019056831610147,-0.0004712161013801284,0.022643229201582554,-0.08065509645805985,0.0037324868872973937,0.007375676052214947,0.0017131035589498275,0.17265909385384387,0.0637880464696278,0.015194312244680225,-0.005978694754472243,0.0619531942786193,-0.21067104493248243,-0.09080651198380722,-0.04187048485470053,0.08908153756798858,-0.09263657598199934,-0.08592995963230426,-0.2431063580243389,-0.020096572069153416,0.004595127559771427,-0.2871209534361657,0.044776700763540525,0.017928235407614384,0.057449289880859476,0.006149973683191383,0.010060662056851405,0.009541309817568405,0.25160903451339206,0.20237167485440657,0.2547609836228466,0.20266270117039784,0.08480357042677036,0.10178080110507122,-0.13670229917732515,0.11722116023377856,-0.06686138814238812,-0.28838988096559637,-0.1530047599832985,0.10258247193616532,-0.2214475642413658,-0.2214604062973168,-0.1524441794765891,-0.21820592172088976,0.13905960558508818,0.4138974001508918,0.02488291418073039,0.01752348421150952,-0.011274230780761677,0.47053187793155177,0.41496706028418556,-0.11943307378885928,-0.007951865549972511,0.00931161868676635,0.01757252278077386,-1.4734940738430902e-05,0.0047277471072590845,0.044530007206475,0.057470641482848216,0.017672495969566694,0.03130538883194457,-0.0006560948852763198,-0.01168532495807562,0.019954513620545167,-0.010183486141377969,0.0022489812399538035,-3.435911383673726e-05,0.012066783592959264,0.12444734355525153,0.12853563866798806,0.13490148805842922,0.106855719878449,0.16839139556839705,0.13163867409900604,0.11130251674267923,0.17462650621131356,0.004873704604615439,-0.07141323137913437,-0.006149731581825496,-0.017070655754986626,-0.0003405002416732778,0.16459368052349216,-0.028161172311475,0.16509277850451048,0.006872425680514372,0.10156837515456836,0.16581967553915303,-0.09232826802472933,0.01811129896452198,0.03282171560759402,0.041886362327525704,0.11776263649728472,-0.020765589543492335,0.007937128124132609,0.018259742872084855,0.06817033688913426,0.05074795504608402,0.014079653630337965,0.17929669859986513,0.003723643381974696,0.020959815188751018,0.022896854967265182,0.17175230843909314,-0.011286498489513876,-0.02745493146568224,-9.745351943300021e-05,0.022306271782529197,-0.002445976418931919,-0.008803581437781883,0.07243356981378492,0.011680783677404601,0.03734892718109131,0.0005691632630086588,0.007290001269415569)
shap_list[[2]]=c(0.07624364087723873, 0.14802448396638235,0.23905161914770431,0.36112792916349007,0.4589906444814017,0.5245561081870099,0.39022889163375984,-0.02812822041327591,0.4370599805595278,0.28782083903104144,-0.02101497282519431,0.46905708476229246,0.5755304043634686,0.10154400083915813,0.16225462972533425,0.09293359454327883,-0.09336994645363517,-0.08070990613705697,0.05402835736989589,0.10675666812402257,0.017621528819798372,0.06503352285909816,0.049117920680243954,0.0696605545655139,0.26758818403002455,-0.374649405764642,-0.10315386515779289,-0.026396806885463742,-0.07112366801575803,-0.10496136465359875,-0.08807497758293255,-0.024591745134952783,0.15437972541421618,0.054191202403839706,0.1591259010109173,-0.05817707286040679,-0.07522529313835323,0.1455252920023455,0.2606469874138958,0.2039872052508365,0.232568215101662,0.059015495405315435,0.12023521791669417,0.08356772425550346,0.04023974210267711,0.09331852861807345,0.07171142573900999,0.12395723006590756,0.09293187109335617,0.07615442601173902,0.19944750927715746,0.13729937323900232,0.15075839049122944,0.05651060202030043,0.09948235080478579,0.09189777082471953,0.06654752229818775,0.14116014418326825,0.1855494783096861,0.2311447104314371,0.10298544067539249,-0.0737906145882056,-0.022641977734593508,0.10432862126660328,0.09198511565966878,-0.0192508849760659,0.09600217462533304,-0.021741601019640608,-0.1713232523584673,-0.10864878292875814,-0.06342034239247053,-0.026579258655496332,0.0736477548462629,-0.19332337371279484,-0.07354538834203184,-0.046913872959768295,0.07132244280949968,-0.04896706075581945,0.1152774901270353,-0.06353658376949314,-0.03813286216314221,-0.02090006283696442,-0.13174984763382325,0.28765779021296306,0.24347743190047388,0.33583047722263826,-0.07395571951651607,-0.03773326554770486,-0.05013089604849848,0.1500703961870557,0.09602330136664816,0.15197585860299406,0.10031691515502178,-0.06916092824695734,-0.09449191260625055,0.0820197910605623,0.1685856254708617,-0.10727105713743704,-0.21321657906091174,0.05609589792174011,0.09314116813510942,-0.06866209084502163,0.08973978535142263,0.1524661363290234,-0.11119648079709823,0.10656360236975194,0.3841018917824474,0.15914126133293954,0.19111375287568047,0.17761273773718456,0.43313555569776446,0.38391895335046333,0.37458895929653585,0.11037306162637235,0.1687796016702217,0.1882839525764183,0.1415890600769094,-0.020965547800006118,-0.1030425976107561,-0.13863056289294387,-0.0792807124904853,0.06444512407178596,0.12794493252834602,0.09886053613680629,0.18362320658030704,0.10141879872441949,0.24719237409854342,0.21760991610882022,0.31027553283743253,0.06529248683507767,0.12834504298014937,0.07412339613419032,0.06388573544300881,0.16166243145731599,0.09475819779439323,0.0717434546479888,0.17692068126223748,0.10471850908926818,-0.09877744400035063,-0.05066307808404989,-0.047488577272878175,-0.07293033786898258,0.20291696355403882,-0.09384610143202705,0.2025045539045926,-0.02074488358861872,0.17661587248471863,0.15855264615685885,-0.11292291961239918,-0.06886476642238763,-0.08600039043733439,-0.07553883551699664,0.14231862370009135,-0.06392040833497648,-0.025074692004130473,-0.014558388051566406,0.03124703220864387,0.021183079403853187,-0.050447850840557085,0.20673041976753942,0.06700694944355506,0.043248957682551166,0.03787999231280558,0.25089298207067295,-0.01674297204480092,0.21087941186512138,0.14726230954815694,0.26291376351430285,0.08070299768725513,0.08367686412484834,0.39539567043662166,0.2592699880508774,-0.045612167340644244,-0.053286483506946404,-0.07692388851628958)
shap_list[[3]]=c(0.1490798574027924, 0.40918548863433424,-0.09706429432628537,-0.03173282183226503,0.05196146585955919,0.08349761315392945,0.7824061162845303,-0.03427360867159722,0.8327828960418269,1.2683412701503187,0.06799855919961634,0.03540198711870601,-0.024186700771430772,0.28869412365188013,-0.061048664687534435,-0.11281613834706758,0.08739353175364079,0.07382521850325792,-0.04802794665670753,0.0028927713102487383,-0.06277469239538278,-0.02471534566666804,0.10961824074390734,-0.05773958267055344,0.05014448935942344,0.4607032557772852,-0.02326823027365506,-0.008549936408015296,-0.031354369295303844,-0.02258687422647632,0.27533950755842457,0.10009072521701921,0.007423581217913733,0.04160097621703054,0.002742650663085854,-0.06204350538858912,0.08849927795723643,0.27087271932656876,-0.13871532069919779,-0.07986993097357364,-0.12491839369433248,-0.09369873079147496,0.05907595764255836,0.10978066581874284,-0.00815552397007577,-0.00028092829215858314,0.02645251858802503,0.0685338331090016,0.014582544218505477,-0.0018756775368389364,-0.17937599184183262,-0.01906492573383211,-0.015297452194907534,-0.0014715630407038233,-0.02348275479797482,-0.01683425003926693,0.09447098254517286,-0.055529028450330246,-0.10704585438935076,0.39152284809360705,-0.046977934270404455,0.1193856596287254,0.11742386796411919,0.6437903736036483,0.6157593930864766,0.13118236981690737,0.6357246074533645,0.1168748497111414,0.010342533859469656,-0.026030742626858932,-0.03383773523149892,0.13432365840175453,0.0646829563200304,1.3013652974093943,0.8967928685900954,-0.047769392350386596,0.745828395158667,-0.20004126748951573,-0.7845380837475321,-0.1311773735547987,-0.0391289387358266,0.1247644131346739,-0.11060618245011676,-0.06405864543471454,-0.1350585802304413,-0.03694007025526121,-0.020059418075394856,0.002650744038945135,-0.11699581495209412,0.27450215247024334,0.19836395341228083,0.27845303341631683,0.2314401803578225,0.08072679275643706,0.08949023647447113,-0.0057516239850693585,0.6915656058080418,1.2356935326468017,1.2494336050917454,0.7181109977395131,0.7475618818044281,1.3717224071965064,0.00354126329438189,-4.578254690469752e-05,0.26946701881880325,0.7236222154444506,0.5415425529916387,-0.02918190655782822,-0.022464509875008552,-0.10164645198511889,0.6004652460013331,0.5412119345754431,-0.11543530977085818,-0.04996926866733796,-0.07662088883136361,-0.07919904041679714,-0.06853804111601987,0.09332032965529453,-0.04009464884334858,0.10397047976977246,-0.03625950585300203,0.18546269429954704,-0.06416212676930212,-0.05111086577731554,0.23197811103212676,-0.05082865591792027,-0.1304233110529999,-0.14562691633046398,-0.050505884296137254,0.07493460306746448,0.05388801887392524,0.12292424314644641,0.1375760691682935,0.12842122998346137,0.10860391456489124,0.14482565117739826,0.13374443662448152,0.1463175279697931,-0.16460236188719266,-0.036626702865785295,-0.0596867510709265,0.8265583911434735,0.030674138627617965,-0.17324674326132541,0.030899623973714666,0.10085148595063899,1.2110661930570776,0.03567260021941867,-0.16162597574186957,0.8083770147014833,0.8186900206374846,0.8596019648986379,0.7802482013881654,-0.04809860126386753,0.007657211990715732,0.032621604923088215,0.1333113275787804,0.1047524646941092,0.428094471929903,-0.06722094328619242,0.36062481633471827,-0.15287210228190903,-0.15450462098352824,0.061958265513066914,-0.15243009068329863,0.11948077399832054,-0.08930231421317165,0.030350526917105405,-0.08107540704108263,-0.02480574988653291,0.0045808298764059,-0.08718716199663226,0.11338690396585314,-0.013432867874964468,-0.01882075177819949)
shap_list[[4]]=c(-0.12832059132674753, 0.08671972967719495,0.10791161606882245,0.29063456057881787,0.5665677625935679,0.7106636781862732,-0.18638931456208102,0.013553099003199908,-0.10562699015161954,0.2695132009222592,-0.05769574416882019,0.4704620877286622,0.3812128255955813,-0.0775482274181728,0.07503489452696047,-0.03029240152540401,-0.07005575501661931,-0.06277433600166078,0.10306032829363843,0.07784357818108129,0.12204283239548017,0.06057764887253658,-0.16421668280091367,0.10919299104046479,0.01397871337085479,-0.07407218397116845,0.0737849373897781,-0.008527985660686459,0.03129406273980929,0.07783841172233102,-0.14611942693461882,-0.048689663118095534,0.4959102504535428,-0.4156715579262307,0.39060009359205927,0.0539437282171183,-0.05181967420219953,-0.13333726042098826,0.1896673843769942,0.035037428869249786,0.13027888792375192,4.505795049567997e-05,0.08181417654957399,-0.11424084480769968,-0.013551261174365956,0.07157777138726958,0.004528526891876344,0.06571639222575444,0.08747414775929302,0.053469603290233696,0.20905361618088486,0.09448116657320758,0.09981867650676378,0.016667288462453612,0.04408048740317709,0.08581892083622548,0.035865697936424044,0.13033563128939504,0.06211644077752848,-0.06072031600900446,0.0945831712123732,-0.10800129764590853,-0.04567265070423188,-0.17517230885769727,-0.018752183737692923,-0.02805748962727629,-0.26577536279693315,-0.046088420760685,0.44016118265932136,0.0708175712059834,0.00975783230977062,-0.04298182840792055,0.7362790000664393,0.5555335687415751,0.6110936146617227,0.07456006873040393,0.4622712990362154,0.11554269133747948,0.7412013805567906,0.3184468551715326,0.04118878219296508,-0.030104457296693685,0.3760236034162873,0.08293737342733386,0.12520910682066808,0.0800629783401891,0.04757538967956335,0.011059315544900881,0.059896867133618574,-0.12858907654389368,-0.14174325681314534,-0.1255942935283008,-0.11834701740205006,-0.059222845153505795,-0.06462721589605985,0.8814634572589152,0.38522089704352214,1.2294349205150963,0.5692514216884056,-0.022685949943414184,0.3997212738407329,0.680602293873979,0.7123941911456012,0.722651631324366,-0.12429787179560789,0.38809672904236064,-0.09976599607027618,0.11134631457417253,0.10752208358472605,0.05760685240001486,-0.12397722752971017,-0.09925450621303697,0.1852219936372208,0.009158211467084464,0.08688274616220214,0.1186794634073017,0.056193390421613504,-0.051933287053217786,0.06450378775865748,-0.06694966669299483,-0.006490654805439667,-0.09119146374116896,0.05507216372262664,0.0015606019294064505,-0.20381440924053723,0.024759169730979008,0.0038190564128789714,0.10096417555788519,0.23209903698614975,0.12566038256781226,-0.21243530236112446,0.27527119201561573,0.25390374704231133,0.3909530632057505,0.21389719600333493,0.31890964570151054,0.45242445281605614,-0.0838508824961438,0.3255663529586732,0.006525675576132942,0.01609656812134475,-0.4915342697709117,0.46050802229367693,0.24511419517015984,0.45955114445139333,-0.05706949917675534,-0.31530509692358544,0.5529226217437265,0.01538138291612979,-0.5141465551666327,-0.4908846775992639,-0.4758114087721679,-0.4607785372231418,0.04972250277278879,0.004459028379663177,0.010473526267207225,0.09916002527623055,0.058815000405500875,0.06508412867937564,0.23705304468486316,-0.11376217644353051,0.35731056171753156,0.36079078362278494,-0.008449174506898088,0.09485186676274747,-0.10938686847292266,-0.030549838702365106,0.09393988559176364,0.03333056431742206,0.009099406416081368,0.36181654744872044,0.15320935165335275,-0.026408389217818774,0.012888084043164022,0.05656566882322839)
shap_list[[5]]=c(-0.10131133750315184, -0.13960754937007958,-0.12211673059341435,-0.15261842401405631,1.3885929257787832,1.6609571141632606,1.631269683499355,-0.07783521499751506,1.7758621860556323,-0.2340629997287987,-0.0803750200440538,1.3296282534767152,1.6030867370575583,0.40208942416560395,-0.1069147227310102,-0.081825883437821,-0.06659966443843246,-0.06743767914479881,-0.10932525668460781,-0.10778795055626607,-0.10007069499152,-0.10169392006401669,-0.09291132065317266,-0.11611876847316134,3.307944738572154,1.061097339789819,-0.08205447118055789,-0.06395098091615056,-0.07002392161052566,-0.08261214829671902,0.5705191061273147,-0.08448489993894955,3.5736337197740506,2.688631308304936,3.545368578542362,0.7294079216382322,-0.07556576464721829,-0.10532651500535566,-0.14078698107273402,-0.11972073896855745,-0.13208248195504532,-0.07439349860018349,-0.1116074399847578,-0.08226499892049233,-0.07791601408703112,-0.10823256992507864,-0.08998241480845394,-0.11105191930783775,-0.10646853440885061,-0.09658443049092451,-0.11470765268702567,-0.11220749387456927,-0.11728306237511664,-0.08450077662416929,-0.0964587070026765,-0.1106959656221096,-0.09100694944476004,-0.11249996691241583,-0.10826700446355353,-0.1366168917057366,-0.10307485015344256,-0.07608001412978894,-0.07342318361654326,3.550357342575785,2.9281390190662266,-0.087361448324663,3.4764780349030358,-0.08140542174318197,3.374804946300823,0.1312413933350732,-0.07139978426835834,-0.04684717227848185,3.4233331012776262,1.1945770502048618,-0.1846303167250781,0.03739812612118972,3.8948397114735878,0.41102326080863827,3.202561422067638,0.6186404669228027,-0.013290015425412433,-0.08871461612814299,0.6658771607397821,-0.13587813776373509,-0.13164242535252232,-0.14282364036106818,-0.06910003764242835,-0.0696990263703394,-0.06739970983659925,-0.09629063314372822,-0.07882026472264674,-0.09693857097692224,-0.08841166791764425,-0.0651657595926799,-0.06744989470277739,3.6640597876242564,3.959894869807043,1.2656853434782405,1.1364779007346508,3.443081959811493,3.9379320875341786,1.3335777116768546,3.5892345592929784,3.700056402429001,0.5392039086112159,3.957143423937959,-0.136529342326517,-0.12165636840464496,-0.12157333325240179,-0.09741924032450748,-0.14566763538554608,-0.13649614495506482,1.0734512456805079,-0.08227164310257419,-0.107019477158427,-0.11283443867879095,-0.09596691886683657,-0.0839171527905094,-0.07740536250568426,-0.0780615271428677,-0.06597521725080013,-0.09879209344706863,-0.09522373776108504,-0.08641408863501962,-0.10958514491918837,-0.08633507930586432,-0.11742478848865028,-0.12261019929541839,-0.13465702069197164,-0.12768644977780294,0.923695711126644,-0.10720884513979263,-0.13685562647998817,0.9933403205896545,-0.1300707211358906,-0.14217202217920896,1.0167378320251617,0.04489509166505408,0.809491381744721,0.031653441959860834,0.4531432147279188,1.0987845489489971,4.165200800619221,0.7824886704059558,4.167390755833117,-0.052704898171492265,1.4770851279213069,4.1690046292140295,0.5798349708588584,1.0606208997069273,1.0625453357353343,1.2396322507303257,3.777855391892685,0.041317894419013984,-0.06987907759185095,-0.07685351138829859,-0.09398846764013398,-0.0815666716657972,-0.13058331635204212,0.8063548260304373,-0.11898455211587881,-0.13399954293484687,-0.13289674491609627,3.2807300166916624,-0.10016629818772006,-0.11415485056144589,-0.08425804406311567,-0.12193887583763525,-0.08591958505240342,-0.08391932391684062,-0.1589704941936664,-0.13211936530953433,-0.0812341913227076,-0.07199555233555696,-0.08424117416315231)
shap_list[[6]]=c(0.08144184059214143, 0.22663393913379923,0.12832393087687397,0.2070596461105858,-0.0010903949700988235,0.014240166156299939,-0.010289283644649849,-0.07524638886680973,-0.000714344546865985,-0.04977476485278135,-0.05782053619024185,0.012347942570800796,0.013341599566083138,-0.040810830782858694,0.12118362768870983,0.08576914440780121,0.03134224131718366,0.028338649929163934,0.11094632779053422,0.1306672232863325,0.060649745873176085,0.11021539379759476,0.0711125552971738,0.11370588022052237,0.228759751164811,0.20586353933107787,0.042471457268289436,0.031529568306421125,0.03420533649682567,0.04365789966408891,-0.18934655101266742,-0.027630587490671807,-0.16897755201436457,-0.1877995460585558,-0.18538402453618616,-0.14944350430821882,0.039179159114270105,0.13651754095430682,0.17126220436812692,0.12232685402732327,0.14546094738671206,-0.03943363737642752,0.07360933907871611,0.030714416211506473,-0.05368566895238873,0.0030226450217592455,0.018463181779273204,0.09157722562080128,0.019361874257639224,-0.009230191859395474,-0.09785814365430208,-0.03762105331864519,-0.023188749652596017,-0.021433310167088767,-0.042324284733047834,-0.025718644044767678,0.11470143536056536,0.09771432282148064,0.10688052994547691,0.17804095797116898,0.09949748407076842,0.03136157400938209,-0.027747415339371556,-0.16783479289557107,-0.16604346881487772,-0.02568236817602162,-0.1770468112008299,-0.02329115967340843,0.14014666477251653,0.10593618279050657,0.04057386282499664,-0.039680247880778535,-0.038651405951689304,-0.29772235968479016,-0.0664707494259608,-0.07419006826501083,-0.05129307683162319,-0.10711014859015869,-0.1273041670353237,-0.20829329633284313,-0.06276971679697363,-0.026685219029466575,-0.18882250889777982,0.17037617040516578,0.15371888533622155,0.18890236149746137,0.05156529576951816,0.04598194095920368,0.043568438560805646,0.10749011617789463,0.08042513140067409,0.10728461162717519,0.09135163585719949,0.027623612582807672,0.028812911598396215,-0.11468917752606743,-0.05226853266121963,-0.11337876112350449,-0.3053819296530802,-0.2016451458674482,-0.07023855740277016,-0.28488224416685237,-0.16878752975323325,-0.13978167024534865,-0.19287537414330488,-0.05982120681011309,0.24358923580637765,-0.10022516603402024,-0.09842346456683713,-0.07168053781942361,0.2722967402279992,0.24246081136530512,-0.2595964422639623,0.06611209412905124,0.09005343645121791,0.09957896378252319,0.07938364842054668,-0.026984269230388422,0.03883361048579505,0.033018192497926376,0.029041092143694318,0.11227929406438261,0.08216143871531106,0.0692147268212549,0.11916919402655354,0.07277773844903589,0.09653284866587242,0.10944922381735434,0.17686853782593193,0.2221920068422341,0.2158323120207521,0.1931972498796639,0.1938141740995833,0.2523596166907143,0.18174794968403923,0.20992250859829759,0.24001674898695238,-0.050316320995577944,-0.026971670489337508,-0.05318776931414032,-0.02288451600005521,-0.0009452938788389832,0.13211541709174046,-0.05394232345851694,0.13413437453523477,-0.040936098066195685,0.045601613268190906,0.12738505972954414,-0.07024959300415072,0.0040480061588856284,0.015279422831251036,0.014327087496789737,0.0796031388050821,-0.05252150375014262,-0.04370676567437758,-0.029293700250306892,0.025963887037580794,0.009923608795477155,-0.04582405481611415,0.09273788686666609,-0.048604952360687646,0.12498233681337215,0.1273554456811907,0.24164413713907976,0.0689210387525703,-0.06407974808023674,-0.053504810972757354,-0.03696580844388,-0.07195814530410606,-0.07657833629110433,0.26374114651191044,0.15320190470973646,0.05954710750770476,0.042263347207775116,0.04952421743610603)
shap_list[[7]]=c(0.003002660281706891, 0.08265594064351976,-0.04766439705145947,-0.011732763848390254,0.2328319173304784,0.2689921104932736,0.27070080364280025,0.003227843906005355,0.2915645651469682,0.16821164531257696,0.012298749925176378,0.22280759553903232,0.2770726634791708,0.09992100441141633,-0.013457242301540264,-0.013118280197299064,-0.035111713746566714,-0.021121484453765257,-0.016142438225658053,0.013290198129265742,-0.014371926897760184,0.001351846098695155,0.0008276161731649993,-0.017187280546584468,-0.059403545203064234,-0.03710952392234363,-0.03889301521814415,-0.022510387371602793,-0.03053658903938406,-0.03859324243843693,0.05127426346328025,0.02288298821468542,0.3763114521852536,0.23238198683551173,0.36784835749426614,0.07081166927836302,-0.008114967640748653,0.03317195215437091,0.11784827787032827,0.21373023202188549,0.15354570957781305,0.01103728980935278,0.05759854777548067,0.0252004095430302,0.011284643445089197,0.031444571727020636,0.0320517701661457,0.06466142502871566,0.04140724576305031,0.023961929160555645,0.03190675607484288,0.027089541302711902,0.03484779442335419,0.017669823258582632,0.019284707142173906,0.025252119538214445,0.03296442202246508,-0.0596638399191875,-0.04755796216625359,0.013016225775151132,-0.04360181805547792,0.003280744151439218,0.025337652654030762,0.3078310182035081,0.26531386555928105,0.026414498455043966,0.2988542029559289,0.025677812950856214,0.0376306309057915,-0.003796787178721733,-0.01745363098983377,0.028053595457420304,0.2943578413570765,0.18599424333608577,0.12734358459915013,0.02214960273522125,0.29159616073874006,0.043588743525751865,0.35108570722116905,0.07447609860526752,0.01679790592592612,0.0258540920620232,0.08355631353845706,0.27085704027809254,0.14934043402463132,0.3058286006577091,-0.02280164635035594,-0.011132260148715016,-0.01253893760423207,-0.03222146060976123,-0.03204067324428487,-0.031388466168952044,-0.032446798831360396,-0.03027929258060393,-0.038861176613827264,0.3522321512597108,0.29508986560462913,0.2380516738825193,0.17662214250729094,0.3060098317736758,0.29637543309230185,0.21545736808112365,0.3822912299097412,0.3810608532973998,0.0495179343304847,0.29436936793969265,0.09838468528339289,0.03366604146895372,0.03878080459362574,0.03913798239730376,0.11163961444370869,0.1001270496272618,0.1332670278168751,-0.03951373003397337,-0.0531319400498395,-0.05249225849159345,-0.05042032301626766,0.02226272711795152,-0.036075849303940484,-0.03801218928504515,-0.030056813676784994,0.020129494672392213,-0.047952786350286,-0.04318189387267592,-0.01379757597683003,-0.04305500761118022,0.07989788999576046,-0.02162589555833461,0.015590901479493947,0.04064456267416773,0.007580297964905419,0.37742582003368375,0.3149500993902318,-0.13084312881046903,0.4187788189397016,0.3377967887690675,-0.13767657835011632,0.053278473901723966,0.05396827198733772,0.0055073866067547935,0.04018719443778902,0.14190389084344124,0.3110130978710053,0.04150804478163716,0.31107130452718174,0.0170584921121387,0.22403673932556997,0.29714273395942853,0.01386034532703753,0.1414610090067695,0.14562633490512045,0.15782166914851053,0.2385909073894157,0.007316904137407114,0.007698502096506709,0.014931316659091367,0.061065896475625506,0.0406942486129347,0.03229156952858185,0.12414424336174264,0.0588455550741009,0.0721688404535592,0.08865950787522535,-0.06867619900463344,0.031214200747369334,0.05000764793215793,0.03126633164755827,0.05936931130407555,0.017603819643759972,0.014795776178489102,0.05693060048760919,-0.011115450725213402,0.0036905410623024664,-0.016825997841721226,-0.023723658994161272)
shap_list[[8]]=c(0.023267001265873426, -0.03556668009227815,0.08558449163482658,0.08820441613196163,0.27414840258305767,0.30445732796177016,0.31290313747107923,0.018020160452017292,0.31504638211759073,0.22158521743656445,0.030210964611967036,0.25751272368973105,0.37583380229778973,0.12939327119031735,-0.02617293872705857,0.015102728945401813,-0.09936235862716883,-0.06570062534355967,0.0048308155086285946,-0.02793541713864828,0.0247583486010508,-0.015421076309470897,0.03847679125150521,0.04623106374946548,0.16431322538443477,0.2037179725964397,0.03476348625017516,-0.022279479271733012,-0.015431504383020558,0.03561224516443125,0.11573223477286168,0.0465268254675143,0.35668149198300353,0.2415058344264738,0.35773007388158506,0.11566100512891131,-0.04106604477453559,-0.18520719989205178,0.020727991989242394,-0.0033496542553465088,0.013636033428769043,0.00648484984996097,-0.053330168969178846,-0.13543034780525465,-0.010692822101011672,0.0026105984649780136,-0.04470066607164804,-0.04807468254569934,-0.040060456469226555,-0.03216418206595813,0.01361391525394826,0.007663100122413066,0.01832105879074757,-0.04516335266834947,-0.01119766169705381,0.02697917297821836,-0.05587957776604258,0.045390488066119845,0.05491075726888703,0.09949649290563438,0.004461396498955911,-0.11396036007901927,0.054745889308434444,0.26472515016660103,0.24167156327911227,0.041993210792383044,0.26864435477436494,0.05573644862081444,0.17607209430998821,0.07939402732486298,0.02731251901235759,0.061521293524947306,0.2239630666112193,0.27498236971025986,0.17486708374029442,0.0445284279242216,0.2145389921910878,0.0805940225207435,0.30533883159649744,0.14160226207958082,0.03879054249074588,0.04143849121415643,0.13565457604038286,-0.016963435604385745,-0.021870626161565886,0.02081235892554262,0.025639851815443822,-0.03381947091489584,0.0054652346228558305,-0.2994865419678759,-0.3347522509241888,-0.30115729204689295,-0.2772370168095386,-0.08806306918729274,-0.08987087407942305,0.28959283247580964,0.20239839326389755,0.24774752539387943,0.2509835725850096,0.28436125492050335,0.21437153818435079,0.28502270079002606,0.3440954213748387,0.324922370902292,0.10992967786049809,0.20750293852826077,-0.32494561454784954,0.07941831167009022,0.06834558469362678,0.01487679738263794,-0.23861880059465793,-0.3260108042495995,0.22072379837579698,-0.05585510207295806,0.008103190097420821,0.0063912119932359075,-0.02640954498356014,0.038541359737292426,0.011313748701537361,0.002149395275013389,-0.0015806642326186518,-0.07662759937926594,-0.025866767047580994,-0.007053565319862556,-0.0037729231111090396,-0.036012165564948344,0.09528109529548995,0.1093870462122563,-0.024216630573681466,0.04877409464828568,0.1423267025259286,0.08958018789864493,0.0669359633530372,0.16855965941359627,0.04546655135292967,0.06948716635220764,0.19118211168344207,0.07717756545043461,0.18024717193597847,0.04132136309532561,0.08553091077737435,0.23379397983065395,0.24728066983139993,0.1786230929869911,0.24652289460993076,0.05568056447653924,0.29521049797346943,0.23010596697888644,0.11799505690030701,0.2114683999725159,0.21565976834427655,0.23870691393391874,0.21107114844903024,0.04588458294908111,-0.01869145467169269,0.0058175352862427756,0.05117090594620244,-0.01564013778981826,-0.07264266230207564,0.20611590049091383,0.07339509070855384,0.12237873474010887,0.11283703376614476,0.17008191302204415,0.06646559663412309,0.08469245177474166,0.04588268630991246,0.017101003395641082,0.03853439025065847,-0.012903577953755501,0.02098033300563887,0.07381432425840707,-0.04014248383691059,-0.01389730089247068,0.027610387886789305)
shap = do.call('cbind', shap_list)
baseline = 0.31527216215150833
rate=c(0.3925060745837964, 1.1357301317503485,0.5936240435887801,1.0855036027793716,3.62056052256541,4.2503417644516155,3.8231560975994885,0.12037196380122901,4.209801507431665,2.3936108543773944,0.1820725020058319,3.4589187987238477,3.977482373576148,1.2941279944736925,0.5240288140489185,0.2910747493492062,0.1609389594890712,0.1634504695152067,0.4233504127834622,0.5392908272418704,0.379566352145214,0.4343903926952831,0.29131969605708524,0.47283564453514804,4.458298502649801,1.8757753286276218,0.26456648173016434,0.209413441635749,0.18156158957923674,0.27031816777170886,0.6909403446388404,0.30410445815980786,4.8722062555293375,2.7230805760333325,4.740205547634967,0.9211907243049456,0.21120549331274951,0.6172222419901571,0.8214503442682055,0.7373414465950692,0.7806061495592648,0.1772510757411055,0.594081567057233,0.25735464780026823,0.19639023944340983,0.4382287571842075,0.3510329926414942,0.6240567670469004,0.4939368263432706,0.3469266434529475,0.37609606645116367,0.4284135315678892,0.4962473657332333,0.2603217197471941,0.31051489395090787,0.4250057757209047,0.57638079501894,0.4774080852281897,0.43055472201325073,0.992708409397721,0.4086043808683423,0.247658421814234,0.34282312858197234,4.865940795415968,4.192690369791646,0.3582425369991131,4.655529038917985,0.34274777379635385,4.495766056454794,0.6279730705432232,0.22199919566115153,0.37710350755848077,5.154837670957091,3.126007913223616,1.7099163472658943,0.28316456923267846,6.03345762429567,0.5172658275266288,4.03296478330548,0.8223242332492182,0.238631287570637,0.3455199308308655,0.8580843234685307,0.954977018435769,0.7163746238965882,1.1243945180595782,0.2602858515145299,0.2326408017697542,0.18667865384493265,0.5423561492348348,0.3050997774812528,0.5526680266997726,0.42460109373135674,0.1965342431564834,0.18005503743110904,5.327497081142302,6.082980046722057,4.244373951664716,2.89105241507902,4.74559624852427,6.036719459275999,3.6266627445167585,5.046320676469918,5.30415792416475,0.6368150533156103,6.071808838188959,1.4355469752216148,0.47266356438190155,0.49609656441642946,0.3224860711588377,1.6950775329439525,1.4361965159364662,1.8080603611347663,0.26535391994720037,0.44163044917970695,0.5012525391045793,0.3510886981471553,0.29032406889518414,0.21783485804024377,0.19022692516321707,0.14234218195563844,0.4622830015240572,0.3465891843042613,0.2854622884760268,0.5390271341633759,0.28781347451465117,0.5923963083183575,0.5627851535497709,0.8527934193116851,0.8895311925639985,1.7030405839506753,1.4754868941783903,1.3163380440464347,2.4481167502499295,1.3800927434539134,1.4370878719614488,2.563248353411036,0.6123658313406761,1.3227806330222036,0.2536527475437813,0.7630995501170882,2.050562571157667,6.029574952563702,1.2138098250329064,6.032439592491179,0.3242797513682777,3.531151484412823,6.051878095692558,0.6052171617706923,1.9763474690735925,2.0290096921759706,2.315898166398052,5.2019436730501205,0.2742079435373203,0.1856720428004748,0.27667028846905095,0.6913731059235722,0.5041817096538521,0.5553241016089175,2.1004842386673443,0.5975165361743137,0.7694497635306267,0.7782904144773003,4.415206411515595,0.2960990056429847,0.46525604914156254,0.28197102818629305,0.6423482403754112,0.24404482023408,0.21583363938491193,1.3321803655385331,0.7360265364699065,0.33584841015037886,0.2015545542137964,0.25255296411524475)
rate_lwr=c(0.04567554667936713, 0.06871677375056942,0.13357823030986038,0.22018532674179914,0.04283470315758864,0.025298937927189846,0.0828734857628145,0.004831017443218039,1.1275090756792987,0.11881533138917039,0.0032609510280710297,0.03585231487964502,1.1368454352912336,0.024848752258040674,0.06406698062672347,0.02165274355076585,0.028532543090876245,0.020963922133585666,0.08973438257704036,0.0715129519885346,0.025048669140711854,0.09075124111047098,0.03747034140689859,0.1195673045165318,1.3823087742937725,0.09978288035509877,0.034927389754656285,0.006182107661953845,0.034758082848634575,0.03335568309786108,0.1565639723901706,0.08906368438094608,1.6555410696112063,0.14642295376986314,1.8442790557135946,0.03994291317243387,0.021909143722723692,0.05150761259166592,0.1116618149546344,0.02979606566415824,0.09751012861965816,0.007939980737813268,0.1037044421713671,0.01064901535759305,0.01875114983002385,0.11982743543858182,0.05142807486280851,0.0732347976834925,0.030174047405558402,0.07334184804665816,0.011074099590103387,0.09091599047086452,0.08692641708501636,0.059635804559222294,0.06841783353564318,0.08389401475908465,0.01247042606843729,0.05739985894944016,0.0590365960549174,0.04465652898640057,0.07889090867689855,0.0184972176139922,0.10829653580521534,1.500330816824666,0.20304599644079652,0.09140710102771049,1.3824739416667198,0.09509371165754565,1.2600924249502383,0.026245715163042804,0.018484278886399835,0.10171434647276664,1.2840719277636854,0.8378425448590552,0.03622075711613015,0.020145105978059658,3.1285079808145397,0.025114895561656525,0.33376145015296066,0.10797491902198181,0.022048461677598163,0.10058336610859656,0.1054177040509609,0.09603153743591036,0.1621538468267769,0.09828320431798085,0.06527702420035114,0.02228159534765428,0.006731795907407301,0.11401449178984757,0.07851859741960346,0.114480032192769,0.09949420634601719,0.023223231253664767,0.03575267547176783,2.674491488253498,3.260314966790514,1.431764415765137,0.6779739706953581,1.3884870881432032,3.3095522773779966,1.0999415775709844,2.1905506377794017,2.7989530254188533,0.12696542441741093,3.1570076664436493,0.11332312967446076,0.06032951233968642,0.03555733118902671,0.00910332370942507,0.11298342872795203,0.10805751998026439,0.12267296037725234,0.06937808692341729,0.16001014447220263,0.13137249046392424,0.11950683643872081,0.10249231972535489,0.02241597350257926,0.020152737018544226,0.014995714518489078,0.0279805201357331,0.10501844663573068,0.07173610238107042,0.042282704662098436,0.07341013648164735,0.0376911189593897,0.054687077862033,0.14777329521227217,0.040319953982523304,0.050629551490236735,0.22525783069678812,0.19455618984259904,0.34107144235784237,0.06651815687917101,0.18369271814358235,0.6615902944792771,0.02623982153370258,0.23529858799972297,0.027476827652628655,0.031260512123736206,0.44106709887870466,3.331486729278234,0.23923409863015369,3.442273726103746,0.017146863813862212,1.0857899178402084,3.265425466452332,0.10451013535716605,0.4357546101107746,0.3691905868035576,0.3169677223803994,2.2560203068810383,0.012934546355615972,0.02650937143837545,0.03512570045693936,0.028197924960012888,0.024214402700524607,0.0172916916020891,0.012792234969369654,0.016842314711417616,0.08933796598466887,0.058149598575628625,1.2467640617129871,0.013668578605146059,0.01414565961368816,0.006069308417450764,0.07110120221490601,0.01921366758617843,0.022112765644283605,0.15111608335073334,0.1762198063231552,0.006972074392332495,0.054735179342017104,0.052783858453793964)
rate_upr=c(0.902341640653225, 3.096372330546052,1.2690104098470565,2.3792282139170875,7.121123749872397,7.175370970395806,6.5844510743083955,0.240442310520186,7.541636132658725,5.0497057789325135,0.41468700027196587,7.213678496744585,7.096252896194536,5.6514840747793365,1.5237702474570451,0.7595591931180627,0.3163096985046719,0.32963429072933803,0.8587056489201916,1.3273218371463442,0.9526736925622459,1.016869693217856,0.6665185035771088,0.9862463340384954,7.868028612919564,4.294925205795833,0.604984583543156,0.5479261570966645,0.3415050379020216,0.626616001343227,1.6198179429970936,0.5365070373720225,7.926193207656277,5.564639342294259,8.10808647700937,4.1519382671449945,0.46321422455965144,1.7400550306115796,1.8568747309164695,2.2725474016688683,1.9478723138851657,0.4128062381672965,1.458375321371677,0.6122855388499283,0.41194040592258185,1.0165555680623493,0.8032132030020909,1.5239485763839906,1.446549277001841,0.6736989694184105,0.9233393877667617,0.8527622956015947,1.035228008719306,0.5103877716002536,0.6138088488662541,0.9441179559196671,1.771734685154773,0.9803860703035701,0.8633729807601898,2.89131605379219,0.8065689946510626,0.6578557856460686,0.6485068216363499,7.755118875259141,7.877847430513452,0.7701838827551037,7.562607891419945,0.6398364542378516,7.794091312876764,3.309163573529895,0.5222809371549191,0.7801439655175848,8.758010910142815,5.517454023246194,4.156255543529615,0.7831568450149669,9.130312920632184,1.5496393579051027,7.203058554608891,1.9630425509121197,0.661478119823506,0.7177138578064719,2.024670828593259,2.3768526627252693,1.4965557672523988,2.8583559213677074,0.5131128758558967,0.5813814476175553,0.44209544793740835,1.1799234661268512,0.5688748358296014,1.2021289758492597,0.8540499151505521,0.47891686865990835,0.3890309843481013,8.551245738671227,9.172379725064262,7.315073630810623,5.36166187719284,7.6753529705464585,9.333114453624555,6.177734113086199,7.975609383590825,8.46844028133469,1.416677365272244,9.148806661749733,3.3517311423012703,1.1240979386957726,1.2328967296551312,0.8636508953012898,3.790878759108442,3.327916174908829,4.697114873766226,0.5127347833781046,0.8580651608710335,1.0565600220931886,0.613646015949687,0.5273907453614005,0.5159850473635279,0.3893965307624864,0.27837546453775697,1.196744775174506,0.5978403112896837,0.5688141201954597,1.2776375961184374,0.504913804227671,1.4002253244887264,1.242565171885162,1.9314361883514528,2.599094502468956,3.961880970731118,3.082196598464703,2.741110590605908,4.644230685068483,3.0912532371294366,2.9055878975651215,4.992973726922976,3.1419701334365104,2.657977646751883,0.8436536269070551,2.319488004978507,3.7759989536194976,9.162309437835356,2.4712752535977933,9.25650275302343,0.5997117522928037,6.255516565439986,9.021539676868219,1.1885193734577548,3.646135903538232,3.797202387868878,4.608843356991974,8.86376025102888,0.9080042634597981,0.40310065774991855,0.6289049080902421,2.2806660328811645,1.4828506313655794,1.5368142841569084,5.321132938042893,1.7100861053043523,1.8337413359509964,1.8455509572010802,7.81723316380614,0.6613876258017417,1.1570894503004516,0.7487288327557602,1.9361490952569251,0.6365820772315778,0.4564383600725153,3.091320761252906,1.4612945077176074,0.986158861342806,0.4155261127172891,0.5697496483029788)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,10.70649647352556,18.316996330471802,12.762457973341409,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,12.762457973341409,20.505765520098972,10.270132845364204,17.06367135403042,18.771662988592148,10.119360120925535,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,21.779996265378173,10.683496473957888,12.585271438210423,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,20.05366296449453,15.133227159547541,11.566150303520583,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,15.70349637959748,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.604602479656231,18.318996330434206,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,8.275121519227847,16.211996370039262,9.341546499182357,8.275121519227847,7.305996537444376,6.486996552839075,18.08099633490787,9.341546499182357,20.39513914855202,10.15963284744126,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,10.70649647352556,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.676359941283643,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,12.762457973341409,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.451546459520934,10.74007339597134,10.647178292822375,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.723329637370448,7.629996531354187,12.543329772332134,15.453496384296702,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.336662977971898,7.305996537444376,10.70649647352556,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.058496485705948,14.172329741711991,17.899611722932722,22.72199624767148,21.1276885853318,13.580403826912434,9.906796488557434,23.096662907295563,6.560946551449007,6.758613214400147,17.61049634375181,10.757363139236089,19.87726902841626,16.67272363410629,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,2.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,0.0,2.0,0.0,2.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,2.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,2.0,1.0,2.0,0.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.060215653706084706, 0.07120382813832113,0.07547321995439363,0.07553303844941986,-0.0655538117244973,-0.06573057611922166,-0.06633580481400116,-0.06480512175509773,-0.06591718893891202,-0.06566107305410074,-0.06635612976227534,-0.06575530260523814,-0.06648522666727343,-0.06648264820611907,0.07160382314916693,0.06991591455568481,0.07896828005153499,0.07164279384062808,0.06241612237200713,0.06181710864179994,0.0620542230992475,0.0619257982089976,0.06205565514682178,0.06244715441567639,0.08536162860888764,0.0781485833424689,0.07800774329487155,0.07772811300512934,0.07791664489091751,0.078430858070029,-0.09655939017353769,-0.09453166367784402,-0.09737056775704644,-0.09756836188293168,-0.09771124102236046,-0.09489448605075196,0.06662273298427293,0.06435602673638904,0.0718496307755567,0.07669770254638532,0.07692469496334695,-0.023811058440237867,0.0018380841934253433,0.0407606456727695,-0.036574292472077,-0.023845383442355428,-0.0017349507967650468,0.014216762802039094,-0.023744632999080615,-0.02373427603273566,-0.037920230330225964,-0.039432285387830904,-0.03558678234927401,-0.02138892519882995,-0.03582607098234195,-0.035828890942609874,0.06072130955268081,0.07585985691369515,0.07584998206790093,0.07613083952438973,0.07570774052612286,0.06104586873054804,-0.0946662360659525,-0.10113752730055107,-0.10059543849877811,-0.09528738906089164,-0.10113752730055107,-0.09926244016805601,0.07296979120199583,0.07265363504589992,0.07266446239131709,-0.09734564055824746,-0.10020881386256153,-0.09980392711708956,-0.10025595042197993,-0.09927276219800274,-0.09986184842365976,-0.09937675679747424,-0.10015276488077163,-0.1000820730366025,-0.09894708948071829,-0.09650100529132201,-0.10011192494549465,0.07204411677737774,0.0720409085823848,0.07216120837451634,0.07040210413484989,0.07034059170263873,0.0704032385023171,0.07654583752209874,0.07581088243605578,0.07604993324287385,0.07575062624005621,0.07633350337467917,0.07936294367314294,-0.1026471592634567,-0.10258589682391282,-0.10234912772853237,-0.10242877572479905,-0.10165134907594976,-0.10265720284985663,-0.1026894064057499,-0.10219141035004033,-0.10218639750686921,-0.10149191211782835,-0.10252880434772459,0.06462529147846456,-0.06738633067926358,-0.06761009026148805,-0.03804202633149428,0.06441870183422228,0.06403360542154875,-0.09587218596652905,0.07134321207721041,0.07162023643627316,0.0717251785857892,0.07185609124303338,-0.09084025950359412,0.07375596733613446,0.07315591380310436,0.07355940509139895,0.06737174068853075,0.07267153216546134,0.07349527333613609,0.07338422109689738,0.07344676701043965,0.08341550187531026,0.08285147216065267,0.06835254934915627,0.07054198971392792,0.08553387242806472,0.08524815010790283,0.08461285383974707,0.08573855466517519,0.08398315804706857,0.08454314169323841,0.08566796878332675,-0.0911824241355365,-0.048262415836383556,-0.05024985142083372,-0.05030363800366674,-0.051911085061191596,-0.051048317987344986,-0.051436728991880225,-0.050255571233606716,-0.04926137264069275,-0.05180483492290015,-0.05144358462083344,-0.051128221573714376,-0.05153287108042268,-0.05041072053979207,-0.05194629699338727,-0.051644091426492,-0.04799014381100187,-0.039791771046979264,-0.040611366755548405,-0.04136382300595065,-0.03980091860007938,-0.040660002401300695,-0.040619834562899845,-0.09306661676176632,0.08536451961562791,0.08515029335992289,0.08555005833959368,0.08533475374974679,-0.0860966991869381,-0.08605855962711326,-0.05652552347909637,-0.056327161796512655,-0.05626178296176147,0.07179264123136686,0.07216393927554056,0.07026455344348272,0.07072804241420669,0.07027260398820519)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.031487973809310954, 0.056045089244965714,0.06523571853511792,0.06536433864146353,-0.0011094764495186403,-0.0011168188960492711,-0.0011430371275704834,-0.001077228436486598,-0.0011248855286571248,-0.0011137529284083788,-0.0011439098058443125,-0.0011179817140537529,-0.00114951110258354,-0.0011493678934149365,0.05676235197091913,0.05340344654932186,0.08269510173950885,0.06251136095074591,0.034526476491236406,0.03369347399364835,0.03402759880386093,0.03384139074294292,0.03402746728310914,0.0345680045535573,-0.21428849064429292,0.07868295706447608,0.0783310114501287,0.07762723168256738,0.07810157622965398,0.07939525945859789,-0.007414690392607977,-0.0070141157470689575,-0.007572534451876783,-0.00761099043763912,-0.007638740726438832,-0.0070837457627604995,0.04528297598805638,0.044616727555077444,-0.1307261488795868,-0.16033176060718551,-0.16151989956009763,0.0044100693014426234,0.005956278106038162,0.008032215785280952,0.003353603597050532,0.00442590962853442,0.0057042066024082586,0.0066779873114222316,0.0043793364927230405,0.004374702895625441,0.0032942726778237698,0.003174692081930204,0.00343353444054799,0.004428102511348008,0.003491561408617302,0.0034607673295661326,0.034231170322423225,0.06609362600833785,0.06607107539503415,0.0666842438485572,0.06576291053964763,0.03482298873069152,-0.007050793193479975,-0.00840147683907096,-0.008289694257841452,-0.007182109141907853,-0.00840147683907096,-0.008011753510916899,0.057407189219284616,0.05678740883646508,0.056808445818924164,-0.007573851662116367,-0.008150800022863188,-0.008067945610696846,-0.008160323771842844,-0.007961318344967898,-0.008079582704278861,-0.007982180127202733,-0.008139393929796675,-0.008125115008795359,-0.007895865747821472,-0.007405402175669493,-0.008131146012157506,-0.13079101891081943,-0.13077586607344505,-0.13132023871835244,0.05239197322190802,0.05227834076142451,0.052394154015620455,0.07606307435114548,0.0742338570128532,0.07483708488378318,0.07408646138213007,0.07565447722337876,0.08373512963515507,-0.008722825880633937,-0.008709861562225587,-0.008659825864249663,-0.00867663217611596,-0.00851225422478999,-0.008724941121608584,-0.008731743484831687,-0.008626662572066051,-0.008625420180948667,-0.008479073104229129,-0.008697696772623002,0.04557933554246334,-0.001604548523668928,-0.00161785608045529,0.0033207676491175697,0.04474996455264182,0.044084762391282915,-0.007277706573412467,0.05624957568820766,0.05679590739029155,0.057003292640960386,0.05726308897559785,-0.006278326651827772,0.06746525231095829,0.066103306447857,0.06701777149961241,0.048170664401342926,0.05918794764632315,0.06097541210223828,0.06071927522484218,0.060848208921999804,-0.2020040363903387,-0.19860827086678615,0.05002422625189043,0.052632824789420704,-0.21536148146799203,-0.21357386846857998,-0.2095695871320363,-0.21664944548719434,-0.20566232443163227,-0.20914012696679674,-0.21620631582768957,-0.006344281323543723,0.005878368841510932,0.0065521069337260126,0.006569726957410954,0.007119867634661843,0.006825824523182357,0.0069582390748420065,0.006553963186440205,0.006225436056580161,0.007083652773250968,0.006960542979082788,0.006852494800865196,0.006991146511649723,0.006604663837464395,0.007131868822396479,0.0070287895461951895,0.005795803649463602,0.0031281809083915867,0.0033618496913559275,0.003547537990150454,0.0031139096737299488,0.003397708089845245,0.003331377393129029,-0.006716784047259043,-0.21430225256155924,-0.21296567959361842,-0.21546704479079568,-0.2141167721778152,-0.005324564608243708,-0.005318704749656681,0.0003839010613670945,0.00038055321763787425,0.0003794442814260127,0.057155664445274916,0.057896123329980016,0.05213564746093228,0.052998181163972556,0.05214989365391874)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.438, 14.895,4.4665,6.289499999999999,1.2905,1.2905,1.2905,6.289499999999999,1.2905,3.0900000000000003,6.289499999999999,2.19,0.4535,2.19,12.725000000000001,9.438,31.0,25.565,9.438,14.895,9.438,12.725000000000001,9.438,6.289499999999999,0.005849999999999999,1.2905,6.289499999999999,14.895,12.725000000000001,6.289499999999999,1.2905,3.0900000000000003,0.06885,0.06885,0.005849999999999999,0.4535,18.205000000000002,25.565,9.438,9.438,9.438,9.438,18.205000000000002,25.565,12.725000000000001,9.438,18.205000000000002,18.205000000000002,14.895,14.895,9.438,9.438,9.438,18.205000000000002,9.438,6.289499999999999,25.565,6.289499999999999,6.289499999999999,6.289499999999999,9.438,25.565,2.19,0.005849999999999999,0.06885,4.4665,0.005849999999999999,2.19,0.005849999999999999,2.19,6.289499999999999,2.19,0.005849999999999999,0.4535,0.06885,2.19,0.06885,0.4535,0.005849999999999999,0.4535,2.19,4.4665,0.4535,12.725000000000001,12.725000000000001,9.438,6.289499999999999,18.205000000000002,9.438,31.0,36.272180500000005,31.0,31.0,36.272180500000005,31.0,0.06885,0.06885,0.4535,0.4535,0.06885,0.06885,0.4535,0.06885,0.06885,1.2905,0.06885,31.0,4.4665,6.289499999999999,9.438,25.565,31.0,0.4535,18.205000000000002,9.438,9.438,12.725000000000001,4.4665,9.438,9.438,9.438,18.205000000000002,12.725000000000001,9.438,12.725000000000001,14.895,2.19,1.2905,12.725000000000001,6.289499999999999,1.2905,3.0900000000000003,4.4665,1.2905,6.289499999999999,4.4665,0.4535,3.0900000000000003,1.2905,3.0900000000000003,1.2905,0.4535,0.06885,1.2905,0.06885,3.0900000000000003,1.2905,0.06885,0.4535,1.2905,1.2905,0.4535,0.06885,3.0900000000000003,18.205000000000002,9.438,2.19,14.895,18.205000000000002,2.19,3.0900000000000003,0.4535,1.2905,0.005849999999999999,1.2905,4.4665,4.4665,9.438,6.289499999999999,9.438,9.438,6.289499999999999,18.205000000000002,12.725000000000001,6.289499999999999)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()