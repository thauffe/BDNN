pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_5_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 5.0,2.0,4.0,3.0,6.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.014471283931350774, 0.08391408855700855,0.10702122543537118,0.14622216872489507,0.15809186350745955,0.05677066398325395,0.07346056971338324,0.05415538160031907,0.07119711029701735,0.2527343661499386,0.027893935418101784,0.08388249435560513,0.04158503839836546,0.0751113821917195,-0.08920340786191129,-0.05681649221079227,-0.445262622049998,-0.2930148488476334,-0.02322992306237539,0.21312931413980027,-0.17538215293655388,0.05190864455416997,0.01495170107789348,-0.014160247320399156,0.19672020546616595,-0.20342518987967648,-0.26257588661816467,-0.2535064175629397,-0.24512216562649988,-0.22384324893612942,0.4967202519734708,0.3596295629075245,0.5737590954268478,0.5171266553983209,0.5231750766659639,0.29212162958105387,-0.13963070775332792,-0.10284033400170627,0.09387834724722045,0.2748880656781719,0.26790801631355265,-0.020114608436531834,0.0665423341129744,-0.08339336389208876,0.01667928927850376,-0.04639380665240932,0.01403303035969685,0.09183898697155306,-0.09467332587209454,0.035786227526936894,0.08314875773907271,-0.05447431705874156,-0.019203630693959153,0.024516519642744185,-0.06709289981939184,-0.03699012336720066,0.2738452710640111,0.09340733775983044,0.12369538143354365,0.13230923720294824,0.11183899370970583,-0.3343706153762785,0.360720176764726,0.34702645817410804,0.45204171934330584,0.35342591682878627,0.32993112725749685,0.3465241836398783,-0.04002320344859968,-0.07997331386200399,-0.11403128171844813,0.39723625766680243,0.6341256364590445,0.8937308857981034,0.9377064610668121,0.5100426671768227,0.9533232199365699,0.33649596855306846,0.43990994967396574,0.4696157380895232,0.4696235053304504,0.35333791199860576,0.5630353801028944,0.2027732234946928,0.12083498986518416,0.08572431944476742,-0.08241822981292699,0.0074478928912856445,-0.05118006039880284,-0.3462039438014596,-0.36941157808757796,-0.36994104393501026,-0.35992961068217905,-0.4364694361547407,-0.43424080051629727,0.6193810164652956,0.8949990082495071,0.8738904034545183,0.9541921616509831,0.500770266193485,0.9071845130096124,0.9578697144547768,0.6108212933423113,0.5722211139473743,0.5226839237516007,0.8576525865586642,-0.18453703149502093,-0.037014557645351276,-0.04795843872254833,0.10700196323353897,-0.17634870444132728,-0.1812882192655471,0.3624966981272356,0.06703921961864034,0.0681840393177466,0.006005316068461336,0.004232858055135054,0.3154887074822534,-0.31428409156440534,-0.31734430062860325,-0.3806858367794067,-0.031604484962848456,-0.01661168935273606,0.08164293930409042,-0.030626992703869853,0.03657972319707781,-0.0011690758514204013,0.05156787802613151,0.14606884844869844,0.16329277845184967,0.08949841103201676,0.01936044216941309,0.09078470735223138,0.14244863996948637,0.0694582004052569,0.1255027978034128,0.12998039202452527,0.30689259999393836,0.2807604685142755,0.28328901262875217,0.307393748532457,0.3614091474330487,0.28329987361014874,0.2620051350257403,0.31179204907634683,0.264412761227718,0.36866807992285455,0.29010901294389496,0.25313164092419416,0.3608413030186758,0.3481391544438636,0.34622713218018614,0.36928446285445854,0.39595953967625863,0.3553926781820746,0.2022970398009481,0.2147357108120236,0.24863800870478328,0.34383284626290617,0.23848925716633604,0.5051414463523267,0.23656816077296983,0.1966058119634369,0.2478576676531982,0.23237714308060867,0.1441810828037585,0.1129079929318111,0.07943964065219089,-0.04529025120468027,-0.025824166559996455,0.11779590416022429,0.08252009773175463,-0.0668900914841618,-0.10656486336128008,-0.09350306706508224)
shap_list[[2]]=c(-0.06456488791765656, -0.019160226537959787,-0.10343230986936883,-0.09332455041864746,-0.021677706658516198,-0.031188649919803104,-0.01368130473194995,-0.030438216512081746,-0.013685256420096442,0.07013773791253469,-0.02014770096678854,-0.031771365307633206,-0.0284147705156904,-0.018750278679353003,-0.00745436401723509,-0.05362660714857562,0.044379957632027456,0.0635748749206527,0.020634155431335715,0.030931014832063508,0.0052620666431394516,0.06120537040559035,-0.05623232292579255,0.03647272458559049,-0.015937217246623718,0.06828330226191161,0.11786956650454386,0.1316598286810653,0.08318254008663452,0.07350467511711659,0.0385007240203191,0.025167239064169893,0.043898063278392935,0.04173387665895394,0.046958475980773885,0.03195192883403001,0.08950259166901202,-0.018545578378150608,-0.027977869893842593,-0.019932080641130525,-0.03297573844940152,-0.03394526371767045,0.052876969525648285,-0.06028007787317293,-0.0008797498776628672,-0.012062981852659966,0.013195386759117925,0.0571934039519722,-0.0003579981397916711,0.03130223609387827,-0.06939754071720121,-0.02109565267238619,-0.0032059286604815187,0.029207148578747393,-0.023612678523234284,-0.009112542554055188,0.07047231394609492,-0.1164604299817359,-0.09326274765248281,-0.02194811691588816,-0.08126988773277845,0.00894723117241953,0.051625919313564736,0.03291035222656338,0.032124209790683776,0.03956602406112826,0.029421094324551936,0.03699532546160362,0.06323041484365564,0.08388407509846295,0.056838274902039514,0.025390512298959177,0.1842129574206866,0.17144442071559837,0.21158963157791327,0.07260279105987304,0.19484598245477017,0.04817243031383919,0.11481910925536101,0.07141621631565159,0.043594376699670444,0.027400487958936966,0.10290628328960524,0.012622675707521484,-0.010657612442331125,-0.004319689495690403,0.027114292935512103,0.006794948922641207,0.032519080997716485,-0.018349193534332474,-0.015336733422130634,-0.015406010774368276,-0.017398621928897642,0.10443909975930639,0.07663355819399852,0.09404978764278497,0.1702399604429035,0.21737929428850378,0.1783129725647818,0.0504722159633936,0.1864313719429692,0.1930562775416302,0.07573536858078299,0.07591901065495393,0.055053071424751965,0.1865783237010501,0.03264928673263702,-0.012749335084614875,-0.018250545645974052,-0.053456393716067495,-0.0019419869992658627,0.03293486266290071,-0.017812496951646672,-0.12284446789194908,-0.11805260629327871,-0.12505451669507214,-0.1266026157245876,0.02117057594071817,0.0323207969990872,0.049944221858584985,0.059273199649432486,-0.035464193131248975,-0.101696262239867,-0.11906595417337192,-0.0477521081058486,-0.11329715318258038,-0.04270415769292762,-0.0547536494188515,-0.045757371516964684,0.1021275969873147,0.028216166966697088,0.09724113670073256,0.08976438532298853,0.060451321723893656,0.1415269047235823,0.09964461066230769,0.0546359137183957,-0.01878942078337001,0.033575179193635125,0.01704427650529947,0.00968284977150224,0.034946966627606976,0.014538955841472745,0.022227305663947115,0.017163124330353514,0.02139969513637541,0.0207457143954794,0.025071019723751455,0.012525696177262412,0.037547403609989274,0.04505953632812998,0.04507990482170757,0.023755868233779974,0.05907945314686811,0.002135080261189207,0.0026665105073778784,0.04029579407748638,0.048248592869980275,0.01668563579539374,-0.024775276196985288,0.03047520100485139,-0.014205289253995217,-0.008930149990023757,-0.0040275032139720215,-0.00654682572673205,-0.010448421530159619,-0.017357964655325634,0.014027890301151747,-0.0278620705078941,-0.00953346962502339,-0.028186030191668716,-0.08260714937739062,0.1501104576356832,0.03471850663435096,0.009353294184930144)
shap_list[[3]]=c(-0.07245875554525048, -0.010460214327888462,0.13144981171016562,0.181105612747299,0.028575847719298376,0.0042711792796495274,-0.049489203779411656,0.012005782021144933,-0.046463956469207104,1.1783415266177777,-0.04523930204433725,0.010882834514188918,0.0021614338535949637,-0.050492248687537496,0.06759961131933816,-0.21964025905630147,-0.017861044334901165,-0.01939046322641392,0.04814640071581307,0.21552425525462587,0.056986638536862436,0.1384640544830325,-0.06248144942465051,0.07346263048645102,0.06895444981311785,-0.015493693564358696,0.04953792296541592,0.06005179460983021,0.03269945267810638,0.022775803034560695,-0.0405996671386927,-0.06274172227965664,0.029008934104249498,0.09510409134846275,0.01965789716505608,-0.22252233882537448,-0.043215819755794055,-0.060337873745375276,0.15761954618896656,0.16386632822328764,0.11765480101338642,-0.22254872771945222,0.16311123494099597,-0.09733639536655496,0.08419061618322173,0.04477323638964096,0.1166599367136592,0.19633887904440667,0.048105008521270115,0.12533236965743993,0.16350996110488836,0.034394895527644416,0.09629090018631536,0.12452718791169959,0.034012517055365794,0.05418514480852822,0.27527282467983916,0.035870469730973936,0.13249165000961363,0.034940160979988484,0.06138918831240101,-0.014428070904543091,-0.056900959747914676,-0.05294259785723713,-0.046804997597361266,-0.04247390818495098,-0.05579896278410251,-0.06049582237387937,0.125589257917649,-0.10526356829295057,-0.08619406110846692,-0.05606098611625582,0.29861152746395936,1.183738900895885,1.1480548516689362,0.02651777829632939,1.2104782588311984,-0.28386789544165986,-0.05229374196226553,0.03482975424651464,0.018038611848794846,-0.04834232248920148,0.04319760470377777,0.33991389552419116,0.21754366336783273,0.23432772379067604,0.05868219985187298,0.09135175513978129,-0.09132783514383028,-0.0106576436433459,-0.016626395097853883,-0.016487020398800952,-0.018600981296932897,0.000675340342462052,-0.008116775955343988,0.046219980531413477,1.272670386300814,1.0892087556392231,1.161902089476342,-0.033692290393116886,1.2423759769040463,1.2221224371476003,0.03401003128085597,0.0374699938227364,-0.02734061155533846,1.2673006162975684,0.022761415567027387,0.03789513771849259,0.028081949952741228,0.19070381757191074,0.002743367202510549,0.02244783969502537,0.02787433599114223,0.14948425475183952,0.15008716766927482,0.08171560577029338,0.07759530752300695,-0.05769313053083448,0.02092181571342029,-0.019793103001567492,0.05332134028433843,-0.07652506973214138,0.049132000445725355,0.14130411342890045,-0.024309230483070335,0.08475341446252782,0.04642281507406819,0.05992341532990751,0.24126995601975443,0.11120227244780825,0.12189747850926368,0.2053073426124847,0.24649065099021764,0.23559688440870036,0.20911005943939306,0.27128603410560587,0.23833509669509945,-0.05308412123417295,0.00636427827369682,0.009240868119759466,0.026622162233610826,0.649350900974568,0.005535909525351111,0.0010584064223384446,0.011791869270256179,-0.05453193938970841,0.7934858909417198,0.002663478885321306,0.0003237688952203894,0.6508333784400286,0.6576174043986259,0.6644447388789291,0.6406546985095225,0.026190807258454643,0.08109944581263258,0.047623207365187506,0.10678875360909161,0.1191380319688265,0.718248422460418,0.015519970287307703,0.7394395287082491,0.008698471030355365,0.0023764511647755204,0.06905703862439781,0.014523026174164592,-0.03236958526383511,-0.1827940418965388,0.06682577647259298,-0.14793119696880075,0.04922975107573349,0.23932011724204352,0.14490739458970647,-0.02592179465498589,0.006750063017337223,0.04283054573863481)
shap_list[[4]]=c(-0.04126212868787834, 0.06663675101191494,0.03638297288832353,0.058306055619485,0.015740101436844598,-0.039508781843521176,0.018594388609264316,-0.0017979003507843873,0.019578954666868546,0.1377977498537546,0.014607250589488363,-0.007653263659769952,-0.011900640318063996,0.014216010969238083,0.05571190586987427,0.013863675121459675,0.025604438026249763,0.03677843339463741,0.014019574146843097,0.14195567006379453,0.040431215798819774,0.09398048600919186,-0.032267436495042816,0.042838276348655585,0.11142565844967678,0.016593727704320098,0.024542243442616546,0.05024244273596915,0.00243622050916283,-0.013941437320918591,-0.021602607173194725,-0.02513623007372794,0.029679287631622517,0.05402321578924506,0.020570424757253906,0.030250341598781053,0.039104359368720525,-0.024821770489303053,0.004173121345185884,0.097785804347984,-0.0035396234506302046,0.028283671763934357,0.10530767052868477,-0.07463490554634948,0.03830716333237831,0.03288317381225419,0.06591513914473299,0.12152353986590814,0.021366050677207784,0.08502231710913112,-0.02514604896400942,0.01330709840123443,0.06485857353017671,0.08401105258728674,0.022709232760002813,0.04032644754043615,0.12484331858032116,0.02266840826958326,0.03787799345858316,0.028812717978900476,0.043417254259204695,0.025347867909961793,-0.028067951956202025,0.0036033129308803155,-0.009230082500510618,0.003913828395794567,-0.0019753333540159694,-0.026956609264534626,-0.04671216131433651,0.019383835901016395,0.014688599977358668,-0.01726662964929261,0.037001103391044246,0.26055865907363457,0.261014406570748,0.034110642931719344,0.2941989790852818,0.027528190564731946,0.045011692235601225,0.0382403214579714,0.021291867637681785,0.0008180451672338273,0.05826103825381001,0.1162059678333694,0.017670005811643786,0.10616581126988374,0.06877323294917863,0.06755877794738865,-0.0017250290291899487,0.013904096283284477,0.015525082416275603,0.01549316862207241,0.01583418292860659,0.04859468004728925,0.030257468737977185,0.0628349063402651,0.2877823223668941,0.20337511738144048,0.2732852951572572,-0.003245440722163212,0.28538284432599625,0.29884791694242263,0.04252554844377109,0.04849117103541154,-0.0034556566840528613,0.28148449401110726,0.04438098964149041,0.013881311625617116,-0.0020143219176009123,0.09494629803156336,0.0271262889297329,0.044402730263782775,0.024105204278040564,0.0976158323155567,0.10085979674669929,0.058883615252134126,0.05887377454758866,-0.02646301771366248,0.009240475675713507,0.020417507235970103,0.032459794590747146,-0.02155315111600645,0.043323849012682644,0.05315657935384321,-0.016826199574737393,0.06614367606792051,0.04828837550238007,0.0486386524607419,0.07136462796955996,0.02969154575702914,0.04646815489182265,0.05134698279333022,0.061376633146509346,0.04096923956220664,0.06306616760417721,0.06237794861492087,0.04492951584513561,0.005665340191651845,-0.023779133216520257,0.017998494270157605,0.02984426951972583,-0.12042766214427574,0.007715017084665137,-0.01853129258255475,0.019308408384825674,-0.0064221321306822815,-0.0631868315847445,-0.009902025711938269,-0.00500963179112829,-0.12773250888340804,-0.1125161787876462,-0.10663084942308836,-0.13351094860632298,0.017804058762934925,0.051299611992023965,0.028395673585143433,0.18108103853917376,0.10435635528441903,0.08551223850515771,0.014745342768691579,-0.15196256575194517,-0.021616170602625065,-0.018479756184232324,0.11032474825363198,0.025103404144940958,0.031785515830038816,0.03386814001650105,0.027691449856238826,0.015303641193594229,0.04313659167278947,0.0738392476995462,0.041796946099490966,0.06147227329773237,0.0033023868325196145,0.03767157117851707)
shap_list[[5]]=c(-0.011419691864195466, 0.044004179568945034,0.03413085148051074,0.071176453606885,-0.07247034945265186,-0.046801113978363146,0.008936653902077814,-0.05541568596764999,0.010524423883598297,0.05456812328170743,-0.0004329714362623416,-0.058802387300927,-0.03141452071792714,-0.0017515118291303025,0.04007721496100214,0.010954569368882835,0.02188801500650375,0.023968227753250793,0.045189544136720015,0.12659045614863973,0.03073494713634774,0.09748362995157533,-0.010127995236038051,0.058990599623770346,0.05958959817466399,0.013091513316650562,0.046831344693880714,0.049258775108982224,0.033187864667901835,0.024144967209221047,-0.021077377832167885,-0.020941475561748336,-0.02190576263975209,-0.014420588655052614,-0.015834546742598987,-0.004819453123800394,0.026938558669337462,0.015927636369266543,0.09757880532730023,0.10869213415251353,0.0875124384255844,-0.018160161434756034,0.008111236150618905,-0.008358955693589763,-0.043773965684042154,-0.047410566605315146,-0.022584233150602102,0.04661319301976258,-0.032653947369398265,-0.02821570704222798,-0.031855830213989966,-0.03754076928549299,-0.04321881791716216,-0.02419160303039101,-0.041583967940742685,-0.0494102200426615,0.20149554571204234,0.02046883781558952,0.03737701888562181,0.04826375771458081,0.039627001054699455,0.014650370638877823,-0.01985039077920471,-0.01626640358571978,-0.0205187535118561,-0.01226742085743032,-0.016019498947577634,-0.0189509867371669,0.00626688660818074,0.017633887623894347,0.012398039402772674,-0.020225521304641083,0.11914564293973853,0.15811571106973374,0.20386620833168387,-0.004082225594873529,0.18388921871489863,0.016837869037526786,0.0642557251296426,0.021865067397173123,-0.018636526854219838,-0.014148186241582058,0.027539912034673056,0.16435512142902792,0.11942813885138906,0.11462902858996236,0.05478979750350294,0.07844988835897572,0.023203884396494772,0.01689619736586356,0.021553611184376098,0.021589715209841397,0.021877729104566788,0.03455420846161711,0.021656402834179224,0.022013284510376378,0.15555637698884472,0.2001299275254659,0.16886771326489813,-0.019786056291689474,0.16851366877390797,0.18234010754936697,-0.0022891595294016838,0.013283522053850493,-0.01860961612186862,0.16619746780391387,0.06548454597679508,0.011283809821559373,0.017790393736934307,0.004997644171822796,0.029075734419351348,0.06637558192681779,-0.0272956455382065,0.055519302845994226,0.05740670698701743,0.024781697406563236,0.02347004216568719,-0.01595156625177038,0.01851356737093423,0.015999705478908208,0.03430951853319264,0.003036353641206726,0.01571215368428471,0.05538207617308836,0.001212248098744118,0.030848996221996557,0.03681812890975148,0.05378565951758208,0.11456933906842283,0.1372395827875392,0.08743629883083509,0.10030898168881212,0.1196157297907619,0.10839511651935767,0.11450202639955,0.13160455751916827,0.1093325558338709,0.0010709974253687875,-0.04537242943307078,-0.04893767833071017,-0.041112935928139666,-0.002847607684226389,-0.047903088973268865,-0.05249399095711901,-0.04786545559053259,-0.01991737725550195,0.005740832023762935,-0.04927561990989502,-0.04783401726732788,0.001404896564909527,-0.00021715679955618293,-0.0013318748472274365,-0.0014464968169658442,-0.04082900131876949,-0.05419593874998628,-0.04016035210207619,0.0299942332696049,0.015813052893470226,-0.0021487868450673926,-0.07105685958546613,0.013191686880965208,0.029247210702738474,0.028986200444347434,0.05984979287691909,0.03789620550718627,0.024487026445118326,0.031202280405244743,0.02478767281527583,-0.004897542382225941,-0.014500564275737319,0.12021756264769322,0.04176582823857276,0.04158609443863247,0.013316157859947846,0.040025720179530225)
shap_list[[6]]=c(-0.019618441647797927, -0.001774558368465219,-0.02420355970663963,-0.0032744301779604316,0.006464218032144762,-0.008158308148366626,0.008073310680150271,-0.006340006035428317,0.01097278333130848,0.11434436342251811,0.001937490147290042,-0.005076067146337544,-0.01177001600422184,0.004824493267379003,-0.01910011634164398,-0.015855780291413143,-0.06111757010046205,-0.04308192091312382,-0.024540904700337787,0.014916427811298948,-0.025069153013570874,-0.0018869501571029763,-0.023446327755591738,-0.018713325837790052,0.199431982485478,-0.02733021766237294,0.03648497003122366,0.033616131569080845,0.017080059613455083,0.007043951702373486,0.053269962189743204,0.03676912289704817,0.05304263503152083,0.050749402147315846,0.050769674396183774,0.01837965072667564,-0.026310296158857552,0.0017755420006248916,0.2226972548228215,0.26635269643050946,0.16819597295604263,-0.0006294346616183304,0.03332782920317252,0.0021556488412803718,0.00817590384272293,-0.005601320564854976,0.016295749164672916,0.04071638517029979,-0.002108317221315043,0.02207772245343877,0.04748475280807276,-0.00600567377458339,0.013421225700115742,0.02121217579608276,-0.00773167882341529,-0.0013339951655823835,0.03110534946200482,-0.03352974519778748,-0.02551950693068704,-0.0059812321415398,-0.02662944150154771,-0.012524198294487919,0.04039612770517482,0.03878519537020063,0.04992295623570302,0.04904312172216615,0.03436098233258524,0.039184591539342443,-0.02759006799549743,-0.02794924764501659,-0.027507976815854308,0.04440220097630824,0.13302199809843235,0.21238842474254485,0.21041341010576106,0.06345515157881172,0.22028934952926016,0.029762184324116755,0.08059721170068473,0.06942494283709824,0.04908102934315119,0.046096350353046094,0.08401300625777292,0.3665292781468561,0.2583511671260431,0.32060947022895053,-0.037220361312801514,-0.030388470150039815,-0.029528939640825452,-0.05696801299481196,-0.06123705547884523,-0.061410713930376934,-0.06326089639659795,-0.04283931953191924,-0.05414987672083319,0.08776729121307567,0.22397980807636628,0.19687750966853762,0.2147326329695432,0.055747643785401715,0.22387268047587489,0.22471467401217396,0.07254843853422667,0.07722160813366644,0.06099029193098095,0.22524193969921807,0.009343187268198985,0.010797252870439146,0.0066936406193185815,0.05705815474624911,-0.004235289783079261,0.015814544042918693,0.032341664197083946,-0.001490020662209806,-0.001400015185755565,-0.020764123570787985,-0.021190937519816315,0.03452606268448182,-0.034837817739446275,-0.052803494708834324,-0.036319451830864435,-0.010904294764627221,-0.02905067837948173,-0.012997233615940594,-0.021556951958401974,-0.02183529422273636,0.20026102283892364,0.20530657081496514,0.03348807985860425,-0.017195025968128004,0.33724804830666977,0.435818267433521,0.4299212727716296,0.3953538615690363,0.46746179660877824,0.4441721628167532,0.40028113096550755,0.03772392991108246,-0.012507763375969276,-0.01484312456977426,-0.012495170525771591,0.008984464652740876,-0.01566663981123023,-0.01810569830708118,-0.012886579917395712,-0.0026109226941217916,0.02010558835313869,-0.016110362321233494,-0.018926407323285783,0.013656248477121774,0.012360890711611696,0.010106054910648213,0.010102490052367121,-0.0018075003576356265,0.018607001320229678,-0.003020938676475995,0.016187529044764157,0.025114749120492295,0.06792947905376834,-0.008750750601877865,0.10147393133803022,0.09225900130609649,0.09376445877023729,0.1909587470081907,0.11106194195227871,0.030119277656332297,0.013402675575506843,0.018763739877748258,-0.005528169613807722,0.0060160807834295305,0.030327813324853348,-0.011865415580996384,-0.01846892749551591,-0.04629897728922611,-0.04370701540961283)
shap_list[[7]]=c(0.19485213113805275, 0.12176748733334486,-0.02080054987947342,-0.00784747730501386,0.1082735291293109,-0.09141162620100361,-0.06906559824457781,-0.029955770654360257,-0.036149210659821476,-0.2384808158738918,-0.09926619036488347,-0.020760214262615113,-0.17626179966338984,-0.09197262654268576,0.10807431333387389,0.2117333151579545,0.5205924797358904,0.33570342459722724,0.015911955294015064,0.32076747710694853,0.1856150572109635,0.17084603234590537,0.06182457338253249,0.08752020619539214,-0.23432522702533165,-0.07651701833614503,0.03795591465141398,-0.0023381871792075544,-0.01343338033586707,-0.07531839450773971,-0.1896640469422727,-0.15194631278501777,-0.2182703574067527,-0.21744450099631907,-0.26228541151535517,-0.1280577031269717,0.28987858004084827,0.50773452360596,0.13148024343004555,0.016335054131372637,0.013208000186149794,0.21874173133155217,0.36021093193681347,0.582994841576099,0.2606455499904075,0.0784788594978206,0.29737174728896537,0.3869461466282716,0.09548770292377098,0.3222748810298207,0.29984429341456637,0.04024496804316476,0.263061485292629,0.31550428669046515,0.04195048203136974,0.11665232161112384,0.8228344374563975,-0.025982236643472427,-0.01840075942685157,-0.1062765327533692,0.023399061010686544,0.30997201944670977,-0.15323552057801942,-0.24348006089230986,-0.19827604636202292,-0.09466354325242361,-0.2550342087509671,-0.15130722740213895,-0.13815530712478713,-0.053882790518716396,-0.07266433075984588,-0.14935232412923644,-0.28750595411846797,-0.27602135539228145,-0.30085351073857713,-0.20466579034365645,-0.29905259747817803,-0.1393772086529309,-0.23479780965642194,-0.2957145388039382,-0.1949350534335621,-0.10105727037091448,-0.27875922012382187,0.2775820295241116,0.1483280784173138,-0.007920493617122623,0.22512676471220325,0.2774522391959784,0.13138793705850518,0.4162438279243923,0.5546055465201832,0.5546639999161956,0.5637500005417819,0.5594682613963947,0.37951862090718597,-0.28061417188263726,-0.32197878628698223,-0.2872197414851085,-0.27200986403497784,-0.2582676784619944,-0.31391670684173023,-0.30163918769711073,-0.2541416499227507,-0.29521081546396005,-0.22660258725702975,-0.3187255574265327,0.7496239479354689,-0.022286103669946225,-0.07503498256225227,0.0775443704162522,0.3529972850231888,0.7537386094626514,-0.1600133890301575,0.32327215381672025,0.32099018305043125,0.1729472594229034,0.16898734433284993,-0.07690472850602377,0.0681537055360157,0.2542978171973298,0.26944714034859313,0.30581637191410194,0.08703760551826493,0.3063691158040809,0.0445523154134936,0.16194541933231818,-0.210451975157263,-0.021946815245303012,-0.000822251619412417,-0.09501623176210554,-0.2055715002722993,-0.17388124320078252,-0.1843585945223336,-0.2804308833559758,-0.13084252035967503,-0.1428734223476325,-0.25299013380497776,-0.07004595885056511,-0.20312901879974476,-0.15400490558765506,-0.14624492304610498,-0.251718828603748,-0.1945735255571452,-0.16298639534131582,-0.1566903146694988,-0.08351241086929746,-0.23720669292660387,-0.1919640386912329,-0.23216298272425706,-0.1702109228894361,-0.24559858906920404,-0.2654940480294349,-0.2031623759466192,-0.07703284835790732,0.3765141946608088,0.10557203938108807,-0.21500330268639864,0.1546620143446647,0.1938064476818783,0.020919795658668985,-0.19267058068709,-0.23877498516527704,-0.16747845736793684,-0.29866341038476196,-0.1358037065768146,-0.058242796649474245,-0.035215186493412584,-0.018655755242513533,-0.003890482237413612,0.05285714195157218,-0.004767558209567036,-0.019518997829333116,0.1821949750231075,0.008626576980295045,0.20799868294081927)
shap = do.call('cbind', shap_list)
baseline = 0.35731404628595703
rate=c(0.3611598547996018, 0.6395855990538164,0.5199576806723845,0.707867795219641,0.5821776525436007,0.2045359589176603,0.336036399628771,0.30246137230517345,0.37469182149689034,1.9101600038803344,0.23910119070047733,0.3311327692008883,0.1436191615528083,0.29083625606175145,0.5081579832566977,0.2499459656515064,0.4457057717431915,0.46096794158709986,0.4500985342106782,1.402790876148414,0.4732280427957615,0.9563536064620121,0.2531621408098434,0.6171851111489361,0.7435987812998476,0.13479159473615754,0.4053433209216267,0.4233916294200759,0.2672568874984483,0.17342824806860363,0.6753391684743458,0.5214632841224791,0.8481176242271599,0.8831387098735218,0.7424422993047088,0.376108090151346,0.5934234460077861,0.6759361126881286,1.0337028803918202,1.258318501809496,0.9744799178922794,0.31099673240285963,1.1345764928839854,0.6226811401982493,0.719112926501662,0.4016370877097031,0.8525189052151819,1.2829295491775627,0.39131600804337263,0.9432869524610917,0.8248062862628824,0.32663911227160203,0.72563875988852,0.9245944408165606,0.3165582567650911,0.4708165384105946,2.136268266474626,0.35509647892710233,0.5533377911625738,0.46559822332397083,0.5273880161313227,0.3545728627457449,0.5550749257193227,0.46983525077164845,0.6191926100010823,0.6556460170765586,0.42516683969615005,0.5255895408964889,0.302210632413603,0.2125355147123358,0.14276180098567529,0.5843369100757392,1.468974196985775,2.9404346096332596,3.007660879799082,0.8557034840205506,3.0917877829365836,0.39388692588876917,0.8126490215502172,0.7670562579668253,0.7470841512888506,0.6235547630676768,0.9563544484392642,1.8199865090458316,1.2219501825488517,1.1960922507038905,0.6686137712854558,0.8506139676657049,0.3712774700144568,0.3721244767002066,0.4864810016751867,0.4859222742594467,0.4998912418781424,0.6233398755252815,0.3686501864328053,1.0079730016592807,3.0157144572222196,2.8324613089115562,3.0160849739658206,0.6516492328823917,3.0326948150381194,3.1106671381459994,0.9370794086146532,0.8867853967836852,0.7219022478417934,2.9979106547127095,1.088620964777711,0.3590406555409498,0.2673924467216647,0.8324496794511063,0.5823637488740373,1.1030233214539265,0.6007479143417814,0.9186531765816952,0.9277312730754108,0.553846144123894,0.5410137253201192,0.554437924514267,0.15888795313211143,0.3086332494099368,0.3880899782890263,0.4925063353385681,0.40478303642533187,0.8580665880308483,0.26397514851141785,0.5997969456184451,0.43579830507576933,0.7002379198931551,0.9099298110519676,0.780724723723956,0.8621742630552269,1.0870582732803462,1.2034761203987072,1.0557951045336478,1.2836400160373,1.3403327420710722,1.0769077244959269,0.5682975567126018,0.39624514696266555,0.4694866708450065,0.5330021565367747,1.0420942433866014,0.4129897256387943,0.3935733529893394,0.5021649269913333,0.4788609026445993,1.2663548715361448,0.41093088646641296,0.3225677539247449,1.1297847820941749,1.0667961795081928,1.0537607809495935,1.0693029709420792,0.7370832353434444,1.1857831045832037,0.7023412116757191,0.7270801777768658,1.0691933664437343,1.7911781054954294,0.5451125297982223,1.4046661277218946,0.45665891652884544,0.49143862522156956,0.7339490887201885,0.6415777599831985,0.4875337070735867,0.3149214038497187,0.5665131293738466,0.1401543254846642,0.45771782781961406,0.8978185244256336,0.5548598302455885,0.6791389873295136,0.2720754059193578,0.5566959741458682)
rate_lwr=c(0.08007945147365308, 0.0450728169531287,0.12905480704017533,0.15344362861486205,0.15240637966353549,0.02563085712231894,0.05448410186444766,0.06168711023950807,0.06595148531329875,0.21322576489740835,0.05615685109381463,0.08602896942493471,0.012764429341951433,0.040518628849341376,0.04639293039227421,0.014511948529066676,0.09983096930841368,0.0621232247538549,0.03898371836279241,0.34690648986682493,0.060428989783840426,0.15784267591479212,0.04124112638206584,0.11168602194869309,0.159909441031458,0.005134842491501979,0.061964877771991334,0.031123361588205833,0.040311500687592206,0.01381658891085602,0.26943267509194524,0.2534315810358093,0.2787873289061409,0.08074622538534187,0.23033930447089473,0.0296643354755598,0.08691370394815068,0.08738734251450564,0.25420159853212243,0.24285535864825428,0.15298125258869416,0.027067543689706985,0.35082514170531576,0.09121469402901256,0.12952114857898636,0.09337870685666322,0.2634345642318935,0.3589647426213579,0.028475764918400426,0.2977191929256338,0.09642663291987655,0.08551731447032229,0.23581254544747327,0.29737364681808787,0.061999954176779365,0.13869442227062287,0.3060711463653602,0.03308623515117304,0.10661460293900471,0.004659251484618376,0.03710483767793188,0.02987142381779828,0.2061845049665572,0.16988372750361536,0.2412848801162538,0.23249693542641914,0.09307386551195368,0.19409714677440146,0.000297979257217966,0.020890989113965752,0.0011094316646825392,0.26910365015641313,0.05365457594494355,1.319986718393491,1.1539325594907226,0.28988619306891594,1.4476302161022874,0.028038713040599073,0.06471534263281573,0.15135996363956739,0.23192044180891164,0.24242272645763116,0.2939707090321714,0.38822972927863275,0.18322341663330405,0.20989136587895335,0.09988968769802564,0.16622167033598997,0.014612396301228792,0.06544283938505502,0.12652422130745755,0.12754001864437264,0.13231617679742852,0.08741288588041823,0.05486818261536991,0.32358784004926194,1.1587302673746038,0.9516988360684235,1.3671904009577378,0.22866829284521276,1.2843626148968665,1.37085516781016,0.3064021939685421,0.2468030891982245,0.21930556092222073,1.4132250795868777,0.15600465080662762,0.03970652185842216,0.025176122821131686,0.0409381274274091,0.03218833772989821,0.23818753707258217,0.11227309828229187,0.2930271124428909,0.2518242718201583,0.12069878740870665,0.12755900831088965,0.16513583157436276,0.016138322931062432,0.02011811377061326,0.024236644455422285,0.11189093250039722,0.06798969668391092,0.15348862270748642,0.015821051822218712,0.2244929690495842,0.05050467962831989,0.17774397764315905,0.06108914561323453,0.03046502856771166,0.03938064141200592,0.15671979477030246,0.24614937933303122,0.16840373134496814,0.11994830484080879,0.2561106684902417,0.16417420804834149,0.10462231071042899,0.07290520353975788,0.15952089651229232,0.058902757514206316,0.3894636079116196,0.0992674199987661,0.12700022727021404,0.16463729739825,0.08417052704957184,0.3045392901833347,0.12252356296315697,0.0860913840851261,0.43402693005109905,0.32262557918251705,0.25673331600423965,0.3672702018933993,0.17948787711441033,0.20714691994785273,0.1684076773719535,0.011863175160909734,0.15276413122609073,0.2886103770415154,0.18129753301477236,0.1846852735702231,0.060696145308233196,0.08685548066087662,0.14220856849215346,0.1297752172289093,0.0522865731516268,0.02218506927470726,0.0538113373625736,0.007514623602986048,0.09024930696986044,0.0775386746768072,0.15509303811715147,0.0623253326321192,0.06456140668644689,0.12029445492178131)
rate_upr=c(0.7550170702099639, 1.7715066869942575,1.0353705489071916,1.4182800963957634,1.1781069323886624,0.45454113334048213,0.7286952584044538,0.5652331451282459,0.8309743074287164,3.8661594312596597,0.4742039620443206,0.6173135056799386,0.3455222888450914,0.5501797634871369,1.268237492912586,0.685227545776653,0.9060828066909838,1.0895359102845266,1.167518946858523,2.851540940429347,1.1027784333273754,2.054071381707524,0.5129693741164025,1.3110707843579177,1.6372360617065955,0.3302196409691486,0.998812120439182,1.1590004527727003,0.6074692870760542,0.37721748909391023,1.1846919458189449,0.8743655591557737,1.6421774228108659,2.0420728605675054,1.295621183522904,0.8224363665469577,1.2222845970586786,1.5744409829786288,2.143399142247664,2.5317404801969463,2.06934885578909,0.765506402123753,2.18457940044673,1.317517291546601,1.3483645362358851,0.752347399748561,1.562736658792371,2.4148701136390285,0.9710950533309654,1.7244657381959851,2.005857055082638,0.6365156115815531,1.3496628441313019,1.6252931791728804,0.6125218837413311,0.9182627957104026,4.181457062986138,0.7769120519455874,1.1153226176330202,1.4851018840043948,1.2163500472044682,0.8588054807023568,0.9472086866059024,0.8470172402367953,0.9972250432442411,1.2047999365462319,0.7469633248290006,0.8388942437911338,0.7873763357188752,0.509725749304619,0.4117030986599341,0.9347183374006439,3.201141815467211,5.018738923061149,5.057214756405974,1.539561829918096,5.1704512026451495,0.9491932922243866,2.0194985371232335,1.53259643232261,1.3399433444900815,1.0649919872118572,1.8239738644055423,3.5304623391432863,2.5144530014437265,2.527530412986328,1.3881328704487546,1.8787289140569585,1.0248032760780246,0.7382672278671543,0.8890635326977618,0.8912914063794746,0.9193047391356756,1.4896795723260112,0.877786403192574,1.8652666819415789,4.823983444312601,5.114237209285654,5.139957850429834,1.1788072049234062,4.979006810322229,5.069614462998123,1.655884690010078,1.5990377962279525,1.264360106684622,5.014061236588821,2.4723640768237845,0.7978492971346346,0.5806072407457452,2.05437774980198,1.493511084659588,2.6318900239820175,1.3388883293663012,1.667463765555449,1.7160801821094471,1.2088587518414549,1.1599756398304333,1.0133226946056235,0.3517051875880455,0.6513557285237321,0.9640814906566233,1.1161536310222409,0.7759134878762333,1.7608472482680586,0.6498359031521581,1.0766084418335722,1.017892088437975,1.3814433156101593,1.953802456199062,2.0193490991824508,2.1544720143732383,2.1918197044277687,2.322164184886801,2.118669029987707,2.6881835128802902,2.646620850164757,2.086538174649773,1.2360623735765914,0.7977601702429868,0.8848515203982154,1.0427488229956676,1.8570542033032167,0.7211239496887967,0.7350992391241984,0.9230879063757934,1.0399614349256803,2.4754576196977096,0.7254476973777212,0.5909651026862908,1.9831196419494683,1.892068778016379,1.8790403865515475,1.8935303710897082,1.5375558406430003,2.453824194923281,1.3729107530488267,1.9632599815265341,2.4074455797646217,3.3024616897639865,1.12184777580201,2.8953386443416766,0.9103862269670576,0.9397581473432282,1.571971609560313,1.3316057555543637,1.1207244738270723,0.7699520979182328,1.437019645290634,0.33245135080809635,0.9262771076849717,1.9738264246021124,1.128314965707224,1.6015586512934945,0.5535970203582572,1.1390691781925701)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.709087213395712,11.763688761345936,18.88884247356902,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.78599643443742,13.509885309719447,12.762457973341409,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.275304079953862,11.610334918074667,10.928438777046042,19.116662982107215,19.495450853775065,12.67666310315921,22.62499624949477,10.612329808628933,14.86899639528348,19.605621306249663,20.901710567601505,10.74007339597134,15.109881006140222,10.62649647502931,16.037350539988736,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,18.06782966848869,18.560496325894754,17.761269068190476,19.184996314156102,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,10.31349648091274,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,6.680496549201861,11.108996465959809,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.109881006140222,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,2.4423466288659075,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.699996492444631,7.690746530212313,18.210596332471788,9.341546499182357,21.04119030911618,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,21.04119030911618,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.709087213395712,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,15.307996387031654,14.445304095555281,9.062465735197444,10.647178292822375,23.096662907295563,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,9.376360134891607,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.62499624949477,12.543329772332134,10.15963284744126,12.685450981781905,19.64726903273955,19.555996307182443,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,23.096662907295563,10.647178292822375,14.172329741711991,18.04222710486738,22.62499624949477,21.1276885853318,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.059387768288352696, -0.06635024969424876,-0.0708063515722278,-0.07078678609959861,0.05737976972196979,0.05773527031021097,0.05848323444618694,0.056220643338291035,0.05780596017985928,0.057580879583128124,0.058360572025794075,0.057592932039975814,0.05859879268591821,0.058608744342802,-0.06712506806737141,-0.06545782029640747,-0.07450423918103796,-0.07964689862698907,-0.06018878129801658,-0.05978324761651764,-0.05965556963895285,-0.059928222278189294,-0.05981386828584074,-0.06013930105611158,-0.08549225787091622,-0.08988063191519269,-0.0896410850801782,-0.08930185111789882,-0.08958459518082953,-0.09021385228196568,0.10112922959369168,0.09819125808315958,0.10162758988483282,0.1021848973032313,0.10229404631449408,0.09863998632210136,-0.06408905836792231,-0.05500871903952676,-0.07519890339980873,-0.08051897260282373,-0.08078391898800781,0.017256440045616637,0.002743476583820596,-0.0398106458554509,0.02891486860012389,0.01732844585137824,0.007034032139259238,-0.013818215767053521,0.017172460932010723,0.01715839370202774,0.030152714193354933,0.032256121059501694,0.024110878125944472,0.013631673220248261,0.024273740462804932,0.024958339217256244,-0.05651773235091368,-0.07184272905151363,-0.07174781876321179,-0.07205942895451418,-0.07174668493894258,-0.05754162690598097,0.1000841699904288,0.10595688134880177,0.10521679322100083,0.10110051611448155,0.10595688134880177,0.10372380614929427,-0.06761923557877009,-0.06715121848224066,-0.06742492164821695,0.10288807940425032,0.10552152655813887,0.10451606174821428,0.10552703807314998,0.10393259090951187,0.1045816556408337,0.10406741611617491,0.10537877633133472,0.10531899535252588,0.10330831590315316,0.10150757155113878,0.10534653164406661,-0.07186059100550231,-0.07201928593745101,-0.07212111534458017,-0.06508831891979101,-0.06502324130233893,-0.06510207690110949,-0.07275218324233816,-0.07215868507238016,-0.07218240371930928,-0.07220665674121693,-0.07219897311764889,-0.07497112320764868,0.1081868412905659,0.10819328848742243,0.10799119352263092,0.10752358297024942,0.10648501496208028,0.10821429998398951,0.10821590404488163,0.10730664755487478,0.10728136475991235,0.1063387170872637,0.10768599560624686,-0.0599998554689491,0.079737263735299,0.08005979166158604,0.030309213017941223,-0.05841716089442444,-0.05809807724947796,0.09974731755216798,-0.06693888324737195,-0.06733002617946952,-0.06754449896215574,-0.06762733970627724,0.09051751043076595,-0.08512672680741099,-0.08462333380053141,-0.0848711674209413,-0.062110302723273794,-0.0688149449096419,-0.06930908310808874,-0.06905440691917573,-0.06916035743551872,-0.08330140244086491,-0.082674393969518,-0.06470610023758115,-0.06557993170404532,-0.08578815580315716,-0.08553018562611985,-0.08461908696026925,-0.08608160059145757,-0.08298247447543718,-0.08453182213639747,-0.08599164046050523,0.09566976500610483,0.042762134114811966,0.044953884550026225,0.04484818612675037,0.0458540681407735,0.0453805518933599,0.04535857277891386,0.04496630136596533,0.043269621156514906,0.045471753809806226,0.04536195700709896,0.045422929088958106,0.04540102991886733,0.045038747753857966,0.04587289233419695,0.04569700247197046,0.042539301311676214,0.03301697589699761,0.03412768743715691,0.035066035961058735,0.032928107582616245,0.03440083298562545,0.03414024476173379,0.09954765251605029,-0.0852770725065719,-0.08493143866479445,-0.0856629471012244,-0.08515467260995084,0.08111632542086174,0.0810260196907501,0.05283607948218731,0.05265133436601618,0.05264149679344857,-0.06768467808264407,-0.06809904808561297,-0.06489158659342296,-0.06534267349699995,-0.06493373561910934)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.023511543798606396, 0.02485481511355266,0.029445769520607255,0.029425784274435308,0.0014312673708845108,0.001453223490750373,0.0015010970394413903,0.0013579703237924562,0.0014576337465062224,0.0014433879835355266,0.0014932892397957324,0.001444382516843112,0.001508447070371726,0.0015090243117623346,0.02559181166950604,0.0240029627502618,0.08553893687496636,0.10865179255232135,0.024304052678009298,0.02390038859570212,0.023775704607253045,0.024043204034948987,0.02393085933031922,0.024254264834932395,-0.20209315100050934,0.15000041092777378,0.14901903478491596,0.14762286301848615,0.1487868344656515,0.15137619854111456,-0.008876902088249794,-0.008220061526357686,-0.008986022615741383,-0.009108600806963435,-0.00913250484909554,-0.008316872392645742,0.032748134754443756,0.02117791737493964,-0.14294415704498764,-0.1733145169798574,-0.17472274543314192,0.005842344795806118,0.005761231626007823,0.005530520478278687,0.005454807287676373,0.005902495101733049,0.005698139896681927,0.005723920261144957,0.005771776567458741,0.005760372654946011,0.005557644106980096,0.005432357924643439,0.005605279558256025,0.005663899970445122,0.005699262704120264,0.005595536815549172,0.0228479311250197,0.030555257819560654,0.030455372442384762,0.030782361516897307,0.030454918053744735,0.02420844796790055,-0.008664193935706476,-0.010052837520262798,-0.00988029517537304,-0.008909076369200391,-0.010052837520262798,-0.009527245444893626,0.03752543375043988,0.03688770766715982,0.037260782484221204,-0.00928074145162485,-0.009884164279428634,-0.009649904383250689,-0.009885430711412341,-0.009517708378380977,-0.009664789123542447,-0.009548215325532005,-0.009851283744206534,-0.00983756695951749,-0.009375383438743607,-0.008967933355556382,-0.009843887061100884,-0.12267404866166363,-0.12334178434996085,-0.12377121461784679,0.034033512790720505,0.03395004224989664,0.034051459888880316,0.07991683823428664,0.07831478643761068,0.07837804313571615,0.0784427068255945,0.0784605500233708,0.08687450550282441,-0.0105931883407737,-0.010594733059764147,-0.010546091987646392,-0.0104337001429042,-0.010183234971015536,-0.010599787994002333,-0.010600169679071736,-0.010381669030046168,-0.01037522218037145,-0.010148880679761574,-0.010472481487215853,0.03785025670671119,-0.004045516668460302,-0.004085885180573337,0.005628940964971373,0.031947335511592956,0.0315192416686601,-0.008565805217977491,0.02541857486394081,0.0257871458410737,0.02598996783919366,0.026068418136656436,-0.006480124714145462,0.13033743764842326,0.12844495086465588,0.12937640103335318,0.020717187790427475,0.027396464969421917,0.027914084356397733,0.027644340650739476,0.027748851465810735,-0.1891660503427121,-0.18567444090593388,0.02318938627953386,0.03467741924631223,-0.20396384691220623,-0.20245927100867175,-0.19707746342552684,-0.20568861576971573,-0.1875291563454253,-0.1965777992424507,-0.20516099588731615,-0.007645633214668031,0.013982917472568877,0.015937197554148855,0.01584522634353796,0.016745407668231783,0.016319875597483734,0.01630053551205552,0.015948003643877485,0.014454934868775754,0.016402288346381983,0.01630351854204209,0.016357325115278248,0.016339955916635306,0.01601142913839598,0.016762279161349192,0.016604675331204754,0.01380328507670496,0.0055923672488597505,0.006448376134582821,0.007076748427109089,0.0054974711645372175,0.0067473678170825255,0.006391520421790573,-0.008533775365560428,-0.20082717721911142,-0.19882944675525513,-0.20308604775924424,-0.20011814009408616,-0.004315089917494099,-0.004303282276083017,0.0018959177699619733,0.0018795740552441122,0.0018787105307452737,0.026133342589681273,0.026529678674915808,0.033782030809933875,0.03436507887407113,0.03383589945066327)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(18.205000000000002, 14.895000000000001,9.438,9.438,12.725000000000001,6.289500000000001,6.289500000000001,9.438,9.438,3.0900000000000003,6.289500000000001,9.438,1.2905000000000002,6.289500000000001,14.895000000000001,21.735000000000003,36.352536,25.565,9.438,14.895000000000001,18.205000000000002,12.725000000000001,14.895000000000001,12.725000000000001,3.0900000000000003,9.438,14.895000000000001,12.725000000000001,12.725000000000001,9.438,3.0900000000000003,4.466500000000001,3.0900000000000003,1.2905000000000002,1.2905000000000002,4.466500000000001,21.735000000000003,31.0,12.725000000000001,9.438,9.438,21.735000000000003,18.205000000000002,31.0,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,25.565,9.438,9.438,6.289500000000001,9.438,25.565,4.466500000000001,1.2905000000000002,3.0900000000000003,6.289500000000001,0.00585,4.466500000000001,4.466500000000001,9.438,9.438,4.466500000000001,0.45349999999999996,1.2905000000000002,0.45349999999999996,3.0900000000000003,0.45349999999999996,3.0900000000000003,1.2905000000000002,0.45349999999999996,4.466500000000001,6.289500000000001,1.2905000000000002,14.895000000000001,12.725000000000001,9.438,18.205000000000002,18.205000000000002,18.205000000000002,31.0,36.352536,36.352536,36.352536,36.352536,31.0,1.2905000000000002,0.06885000000000001,1.2905000000000002,1.2905000000000002,0.45349999999999996,0.06885000000000001,0.45349999999999996,2.1900000000000004,0.45349999999999996,2.1900000000000004,0.06885000000000001,36.352536,9.438,9.438,12.725000000000001,25.565,36.352536,4.466500000000001,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,6.289500000000001,18.205000000000002,25.565,25.565,21.735000000000003,14.895000000000001,18.205000000000002,14.895000000000001,14.895000000000001,2.1900000000000004,9.438,9.438,6.289500000000001,3.0900000000000003,4.466500000000001,4.466500000000001,1.2905000000000002,6.289500000000001,6.289500000000001,2.1900000000000004,6.289500000000001,3.0900000000000003,4.466500000000001,4.466500000000001,1.2905000000000002,3.0900000000000003,4.466500000000001,4.466500000000001,6.289500000000001,2.1900000000000004,3.0900000000000003,1.2905000000000002,4.466500000000001,1.2905000000000002,0.45349999999999996,3.0900000000000003,6.289500000000001,18.205000000000002,12.725000000000001,1.2905000000000002,14.895000000000001,18.205000000000002,9.438,4.466500000000001,2.1900000000000004,4.466500000000001,1.2905000000000002,6.289500000000001,9.438,9.438,9.438,12.725000000000001,12.725000000000001,9.438,9.438,18.205000000000002,12.725000000000001,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(4.0, 2.0,1.0,3.0,0.0,5.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.039297600917990366, 0.00864008329788698,-0.024442538958870438,0.018021716902963378,0.31937181983297097,0.30361593894289035,0.21171212285763644,-0.022696889185678058,0.23674359179832083,0.13824472003224353,-0.045013734847263745,0.32267564640004115,0.43428232226047075,0.07330608769111452,0.1067961715961787,0.024780999195472206,0.20897436638915534,0.07561297306750452,0.00996992777042424,0.04681687863204584,0.03453427478235639,0.044957600846885694,-0.042111132482721046,0.012962122792992414,0.1572924862268711,0.2605689418865079,0.06621053185218842,0.037784785263027185,0.03389209698591923,0.06749600048008779,-0.26276593423719896,-0.02670708412445817,-0.22261475117821375,-0.13748646352406227,-0.19384616477712013,-0.14792485057908286,0.046534583208493116,0.15004874336399526,0.06443895305506375,0.006478951660298121,0.03250464600502815,-0.012008928448766545,0.05564715386712387,0.030599139449133006,-0.004698933484566707,0.023808404457406614,0.02489317047455026,0.0682109778256284,0.10716141330118813,0.028883284337490312,-0.003599291973465535,0.015669506432548115,0.03653403567117678,0.031009983908025996,0.021920480920252373,0.06276450064541775,0.09120905303750902,-0.025033489851932832,-0.0395828426441386,-0.03760325225758506,-0.01582973970853233,0.28331691789655333,-0.029443614442027276,-0.05206519255136485,-0.251663667332787,-0.02797780361482887,-0.05989970350483162,-0.030703019714601404,0.18339859799339026,0.04477053192804203,0.04050876821649664,-0.11944611773897561,-0.04530587310157836,-0.19453328805901532,-0.10861250873255221,-0.06758422350593879,0.029739507147737564,-0.14957573405613223,-0.13717677512412707,-0.3090603420095679,-0.08514517909310487,-0.027473859796430734,-0.3542083747303837,0.05907920313866043,0.07342001792844076,0.06439400061351339,0.011514582774984697,0.0008615407515838282,0.005652519033441696,0.3396023340588312,0.2870749131087388,0.29137244922332456,0.26353174026748893,0.2194592232650378,0.25478094877265456,-0.18158780632267388,0.04974610928219099,-0.11352493164881672,-0.26914934649588723,-0.2496148545867872,0.0498326867350492,-0.21518932365175636,-0.31966846168228286,-0.16447678668457583,-0.2806614029126828,0.08619774358814972,0.44711476676874,0.017563678841525116,0.03328865167654027,-0.014282130307346172,0.5718111448386413,0.46204025167394436,-0.15471170392085531,-0.00636270594597793,0.014231450978753255,0.02495780361830226,0.009395139585545947,-0.025865935700841176,0.08529571590376489,0.10857066981125188,0.04598090163644005,0.011595146629985688,0.0040985670279631,-0.011036061417944356,0.020413697920439206,-0.009478064858311031,-0.014659011060934021,-0.008673985055763438,0.05007922874191965,0.06950066310246403,0.13711945412678617,0.11493901476774124,0.08054008556004535,0.1281919565631607,0.10894597690661727,0.08657027384824387,0.13595795782001244,-0.032115335938110064,-0.08548751553545611,-0.0429284972408717,-0.035921118785990566,-0.0540621825598568,0.10847098783967205,-0.05527351509048985,0.10875899785730941,-0.022321974900624774,-0.012478117583955046,-0.10530069689988106,-0.1032240650986402,-0.05078482808922326,-0.03367144729326739,-0.028445006069528395,0.049226602315661214,-0.0234937513560732,-0.006330503703406426,-0.0021796495824327826,0.12468104107897689,0.02397064134467915,0.008222185635343361,0.12641903180355113,-0.01142632902189023,-0.0031616689423299453,0.01405928841514603,0.1513868313606214,-0.03384792560228243,-0.04528310969761531,-0.01189510763343623,0.002714229287563001,-0.0004933515871059814,-0.008584801618327793,0.07479990643641074,0.003752289511641208,0.0316174392656032,-0.0023220591650699534,0.012798780608407143)
shap_list[[2]]=c(0.07718134325499564, 0.1351533017687553,0.24373624283940448,0.39374855306830187,0.4478532563906965,0.4446653332670607,0.31118558207555697,-0.03578488859854031,0.3395686204793865,0.31799289464440567,-0.03126364991306309,0.4724224839508274,0.5941776018979921,0.1553263012642376,0.2196018052140801,0.10783174651327908,-0.08328055169584363,-0.07576931775206222,0.03997776403687829,0.1540885389799973,-0.00814899171024795,0.09369036559643226,0.05467015295652482,0.05251534800578883,0.34307205319906314,-0.28535420974121967,-0.07855773317717758,-0.034038489694180156,-0.06273855102523378,-0.08003993679204749,-0.06605642474013934,-0.026712498868095135,0.17366022383939242,-0.017603781460649472,0.17719326552494266,-0.052789398278345,-0.06976463063578045,0.1422413579421558,0.4040654567368825,0.16756340686036925,0.2713368616823276,0.06726548654217997,0.13712130932473482,0.08700355860542619,0.061829452807137274,0.09931384729710796,0.09264238351816395,0.1536071651989511,0.15039589710245352,0.10399895653941647,0.2177352992805461,0.14199355526936258,0.1567106120935838,0.10026535795336199,0.13215774965222243,0.14631907406388525,0.12199089741028891,0.15860312890165226,0.19418968242296622,0.3249045063543229,0.12708955709454828,-0.09494164098364548,-0.02142358752406022,0.08382560452126703,-0.04125300724043128,-0.02437286296161931,0.07718083100913112,-0.024098760798721267,-0.29323398660742067,-0.08584611529349029,-0.05756459920806168,-0.02998555688758364,0.10035026129585793,-0.12330412345905337,-0.04127145358940878,-0.04293196362820747,0.09499161042894022,-0.04177372744394927,0.12547156705504536,-0.04861175612763806,-0.043385556914374526,-0.026293335597440553,-0.12927024579603577,0.3448912498428765,0.4039440103047557,0.3851528969074016,-0.062356745382901535,-0.048402418287304703,-0.05446166961131278,0.14935762338707737,0.10363987795321823,0.10764674018561862,0.08212135705323347,-0.045498253907837356,-0.06912353014944383,0.09023953081444545,0.1972345665425204,-0.06974030303966236,-0.14968394648422864,-0.05015525276804187,0.12059893842226571,-0.027588143139063895,-0.05988727974205264,0.1625729231250426,-0.0899100538254493,0.13141986276398476,0.3530079171686746,0.15176809717957668,0.21365824576532988,0.19504402895450565,0.44423405756048967,0.3586015975444661,0.43329290718612895,0.0982222097875296,0.159878870919242,0.18288485007634464,0.14530247008373426,-0.02496376370595207,-0.08605688479826885,-0.11649583543399053,-0.0696261643642406,0.0508546046946226,0.12961718511772488,0.10140105323127167,0.22683864256241543,0.10246612699599006,0.2627677966948153,0.2746541621838893,0.44993144017307046,0.0063799682243150324,0.1496783524252511,0.04808191918930278,0.032330756576731914,0.11852130433048115,0.08728014019427055,0.03802561317653909,0.13900506603019894,0.10479074809542958,-0.08536154217364963,-0.08256719442768973,-0.010047117205014775,-0.05151106654006695,0.18762845775674605,-0.10139881656316518,0.1871765421272838,-0.026592507298948957,0.016084094386078506,-0.12021933060503087,-0.10331624637638287,-0.06457986597600165,-0.07103907026173542,-0.06695782998389986,0.13150235014535352,-0.04377174361576789,-0.02756575063762643,-0.017357080070656967,0.17922535559894148,0.0206742880411442,-0.041888315774295116,0.16659297074604898,0.1012567103387012,0.04037831075194951,0.04413886149731478,0.3069443998349242,-0.030917891152336372,0.22921741239459725,0.16498669104461738,0.2272590362337699,0.10253583110157223,0.10245675605511728,0.4506513236705972,0.2642530055330987,-0.0344356889030092,-0.05416579369080575,-0.058420902316549644)
shap_list[[3]]=c(0.1559107825394333, 0.358648756754646,-0.12460095554845022,-0.035241345315684645,0.037670009480846436,0.0498819927661043,0.6348470971632285,-0.043292537186329416,0.6548282441277259,1.4548139601155763,0.06822105143962694,0.037761855728904094,0.0020898160913868018,0.37441831787249147,-0.028851801727861955,-0.12181774455298158,0.14381197990072406,0.08722153154698724,-0.0631129694995193,0.014687439203137049,-0.07510470939347215,-0.024011338282188613,0.1357825202578544,-0.07452285918221606,0.0787074296487151,0.4872729084980892,-0.018591216896668646,-0.010480076727490642,-0.026109251985781932,-0.016778305172667134,0.3618581257078811,0.10486621854254538,-0.026899468338035436,0.024137261073239453,-0.023879239323632277,0.0035553319013813416,0.12731948328209752,0.24433543863492055,-0.005641500155331159,-0.10192858074568367,-0.09468103721844827,-0.11154766474403296,0.04453964659473206,0.14734374789100832,-0.008010057573656696,-0.01018310328578943,0.02888028330685131,0.0691934350284537,0.019100653053235238,-0.0025606435590468423,-0.1729149139646617,-0.042978604000041,-0.04374541884705209,0.020348196792269874,-0.043081935405099143,-0.03290767086464935,0.1185972542725818,-0.08716536050034443,-0.1268918569869698,0.4966765413509427,-0.06500470145996645,0.19307502583576283,0.12504384147506215,0.45318756875763166,0.44308637152490343,0.13545489946946532,0.4588889393868941,0.12423042527697145,0.0677583330478736,-0.027191970254880116,-0.03883686658557441,0.29936569777500144,0.06212719655841583,1.388121618712395,1.0934910477281945,-0.05169817829465068,0.8048919272480078,-0.2731124501818952,-0.7860975593056068,-0.13028664931899234,-0.06568795856320422,0.128380627187321,-0.12052420624697428,0.005039285346840076,0.0029722443302249595,0.01561840420874887,-0.034757224392498995,-0.006422613044745843,-0.12488643286654329,0.34172168847379075,0.25358635390613926,0.26124939509164036,0.25175440733322574,0.15977984970084433,0.17908793373776194,-0.05989366290290667,0.7885749066514324,1.2419472472425588,1.351581372131978,0.4364184738843544,0.8101903980276937,1.4111594716173113,-0.11028377506592629,-0.04908084434712697,0.37972597532164654,0.8014549600923597,0.5137338460082597,-0.05139727789384991,-0.04221174016992149,-0.06458890414882383,0.6680443565075943,0.5288999623407932,-0.06571414835708841,-0.05383676763933835,-0.09873272205683431,-0.10149815862924802,-0.08806288978335809,0.10023487705505246,-0.03500166871308786,0.127216340520959,-0.03699634488577601,0.15207170690509056,-0.07740179610851045,-0.06647365659937558,0.3015551953349052,-0.05873467848523724,-0.1254170926354209,-0.13418392145861086,0.005823484668347527,0.018703674660004114,0.057881254605984124,0.07533956835315077,0.08590262237273041,0.09444237276520767,0.07558565600344627,0.09572461145776465,0.1012484982427863,0.1514593410701589,-0.15311577895165843,-0.12399539309889895,-0.07998872776129903,0.6771423169882225,-0.01839270553198506,-0.1847038677214473,-0.018361072522309885,0.0995751670326821,0.5142024960656555,-0.18194135029470576,-0.16874514917892866,0.6344887109636913,0.649457801521564,0.6807272962925176,0.8138388283429504,-0.03767423941450158,0.0008909152463810713,0.019955982452091642,0.1302643978911755,0.07719366379325276,0.6053871902337984,-0.06471559618446855,0.5422788540250605,-0.1356539480852367,-0.11589577890916385,0.09373760594039986,-0.1390718228280895,0.15946372163384695,-0.09305819365465672,-0.02061069771657834,-0.09285447506233266,-0.03565428051512346,0.010532610105169659,-0.1122067300696183,0.13084173015585218,-0.021524477467917354,-0.03185135407826924)
shap_list[[4]]=c(-0.13245714671127803, 0.07161098236067291,0.08763437412874044,0.30809640680430983,0.4943956050642475,0.5386165570997248,-0.21211522306105454,0.013984872741933307,-0.1288109677896899,0.2905239172344863,-0.06425728510334006,0.43774158306117267,0.32130088926558487,-0.09829658948177276,0.09270886105827865,-0.030314487183641572,-0.05895090424247695,-0.05093794187182484,0.0819375526709302,0.10232494151034012,0.10735229528461147,0.07417282337897228,-0.1687946628070068,0.088592901037467,0.024208116929227568,-0.06397348514097051,0.08624162756194514,-0.006447205193199715,0.033803178848854025,0.09157320517322767,-0.1538549166116417,-0.04773654876286784,0.5122397298685439,0.08518812414699475,0.4287484074686949,0.04014544163225245,-0.04319792978787293,-0.12815562843866596,0.3526989929354051,-0.019619502095884533,0.16747642718487563,0.004882275810480984,0.07517746653147214,-0.12981208706657948,-0.009266784993396327,0.04378446614873171,0.007755660103791146,0.07438671081724892,0.105162468462893,0.054457406559865,0.22386790618260216,0.08995478363044361,0.0960202783831218,0.03440043120383142,0.07252458194976533,0.12484462551968237,0.07470360721228383,0.130567803832649,0.043188326766950676,-0.07770116041228488,0.09246876334694983,-0.0977005096507403,-0.044559460478392834,-0.1852113340548421,-0.10546957691279135,-0.0317265539192354,-0.26903844914214453,-0.04643924592854315,0.4999413611027912,0.05704188412487639,0.012860730943643355,-0.1007443518817476,0.7677068883321894,0.5618866906409533,0.6566929475694309,0.08333325459427961,0.5717341988264174,0.13365459096616356,0.6623509210309895,0.34727085563363874,0.0774678065647633,-0.034189867720297494,0.38058921028156345,0.0581094606565094,0.2283994190081948,0.03309522874974631,0.05018510644683591,0.004870565757397362,0.057205021465469734,-0.09489320835704666,-0.10946909181377357,-0.10727188142608493,-0.09407772311739673,-0.04504912590441169,-0.051507386763917695,0.769947777199018,0.5077294925895671,1.067242687293189,0.530352011378693,-0.10123277705575169,0.513393342710483,0.6716424925176241,0.25454133378544996,0.7062904574294614,-0.12221282718133891,0.4967517336720288,-0.07614184841647728,0.09175309072060912,0.13192345450696696,0.06327931677434823,-0.08280203518332477,-0.07593677745168656,0.16238740212388417,0.0021848835525492888,0.07531000705082704,0.10881107851559162,0.06393236852819505,-0.052634264885366724,0.10099586991274936,-0.06631301208321969,-0.003530877113199838,-0.09682321373076483,0.04856479295676973,-0.00214263975113834,-0.20697627395819035,0.018330799276878352,-0.027078394404082683,0.1307930272327185,0.40668128276550625,0.09633933868379065,-0.13996492197269725,0.2544709174540107,0.2340622728778231,0.36566644908712903,0.20178933013037825,0.31093363313400807,0.44119825364865345,-0.10019179755726994,0.35326728118011885,-0.003056063509048569,0.07131399240909284,-0.50939412312159,0.46206478217677793,0.17384035957597885,0.46138238784233365,-0.05611478511314982,-0.09596960041771224,0.17040055830775827,-0.01572322423961106,-0.544781947550926,-0.5233711853356092,-0.5104349645599301,-0.5011869867494237,0.034935635001071844,0.004076103210095484,0.006852292519474979,-0.155776077644595,0.05105533178771734,0.10392637895171898,0.16918323915230452,-0.1335431870281034,0.409629432207719,0.4934322386865325,0.01025913701218744,0.09738974185481593,-0.12231531561843641,-0.03219492882553472,0.08359410693422385,0.0486880338422761,0.01745312856893604,0.42068421355991775,0.13993302598284738,-0.024946125579805186,0.007417424756070965,0.061295584562362296)
shap_list[[5]]=c(-0.10748967507951102, -0.14490919878337374,-0.13065491115767422,-0.16916474430136588,1.4938212132641675,1.5091831870219554,1.759445214094113,-0.08475328241874533,1.8562073338274943,-0.2583996366488592,-0.0870425698067938,1.4352646243915066,1.820536913388733,0.850274392135172,-0.13236693695538157,-0.09648054786723538,-0.0823570532382397,-0.07337581440865396,-0.11477163216457338,-0.12913426732703961,-0.10854908498926161,-0.11908272513345701,-0.10081723420276842,-0.1216170754239152,3.4490129151660898,1.0991491815286802,-0.08673415923340388,-0.07072589937986092,-0.07441944141044086,-0.08718440918169998,0.8524320980477074,-0.09343147746057634,3.647489486067728,0.7053897569912634,3.634724204153394,0.7465613711416165,-0.0907147502711414,-0.11796628572971912,-0.18180287689979216,-0.11784361552954994,-0.14653306761490226,-0.08347762418840171,-0.12284965818528824,-0.0995290285194736,-0.09199832454437729,-0.11101294418818755,-0.10356359232259744,-0.1268814582769191,-0.13009002183469062,-0.11207367558013592,-0.13115792831049258,-0.1196012945987007,-0.12314952562941113,-0.10775229664011976,-0.11805979073956449,-0.1372700560773441,-0.11203235974106883,-0.12838378397762795,-0.11688767300468368,-0.16831759659078266,-0.11943319001193535,-0.10067085044379695,-0.09213622438826558,3.3988972070750365,1.0326562974891804,-0.09697893422544453,3.328763480742393,-0.08508541004820197,3.391967740393248,0.008690030961218653,-0.08494693457803061,0.4813364579214767,3.5770505014486993,1.3922050854346288,-0.10639900585160052,0.05303463853900173,3.7569912859387014,0.582257248769497,3.244053671275259,0.8437005816568368,0.15409443066710368,-0.0986326983016346,0.7905482586490312,-0.15925266108672018,-0.18013713332343587,-0.16515563774121148,-0.08310922325942542,-0.07412726686018935,-0.07239802926918038,-0.11774820890693748,-0.10085928187313631,-0.10243427528243232,-0.10176880229191326,-0.08391595558700143,-0.08741967930312558,3.6285316726709453,3.810162263154287,1.3319766358053116,1.3178421116505514,1.5167937886756178,3.799882102130821,1.4795689879647407,1.2908937043450088,3.7273368779308207,0.8327683486435764,3.8190748047560863,-0.14674227005270532,-0.12353378059399542,-0.13678278094887594,-0.11156681940219293,-0.16970564261828971,-0.14887730978722719,1.180125793475405,-0.09403963869692748,-0.11728627900528704,-0.12534565168312345,-0.11252399485640929,-0.09192889462661527,-0.08928098035186006,-0.08457332672687512,-0.06760767232992326,-0.10272073073317069,-0.10912824113411035,-0.1005677638729917,-0.13270589963259333,-0.09990462120627497,-0.1296039600122271,-0.14406392285072128,-0.1792281654899369,-0.11782260434559798,1.0907895882119836,-0.10685146406484258,-0.1406134582315362,1.1008533399697615,-0.13522951308746295,-0.1461832515254818,1.1175248030654967,0.06777092941901351,1.0337985536243424,0.5034170792803423,0.8391950889456443,1.3128004171207674,4.06713915631973,0.8951645883485249,4.068589055540753,-0.07109428596705661,-0.13066335501452886,0.8851631857809931,0.7374888913736735,1.0851680224411762,1.0942320704559583,1.2138998105435175,3.596719649088674,-0.05294981551631144,-0.07840687704690896,-0.08079705639548368,1.052646864492313,-0.0899649411447805,-0.15884867752906937,0.7956010060563584,-0.13503556563048918,-0.14923738431111316,-0.1542024484016752,3.407797897867753,-0.10937231698732895,-0.12587414426727994,-0.09448364414802898,-0.12096491475416232,-0.09958737225818287,-0.09621053682055968,-0.1814949461181229,-0.14217491521529113,-0.09090297413590963,-0.07742173891378998,-0.09245005238525528)
shap_list[[6]]=c(0.07907517699583433, 0.19678177401037117,0.10331263171150527,0.2158356159927947,0.08663140027975405,0.07543253018419611,-0.022586038588881658,-0.0646111630144219,-0.014001396915875045,0.0038348814489538364,-0.06117587073423781,0.07382938836199755,0.10185611019234203,-0.04092426417169779,0.1513225954218898,0.09502966561808944,0.040663894217360275,0.03210111103846615,0.08702276727943052,0.1466555078304079,0.054443409038928026,0.11501070699941646,0.07628429084182127,0.08609758073250241,0.16610094105887702,0.15774551501470713,0.054213186743772165,0.036345881922469216,0.03950321819479651,0.05596787810677772,-0.17484069683476447,-0.02392126199945891,-0.00011246583911656898,-0.08271553575660871,-0.01924237630468959,-0.12118129623948978,0.04854157805498085,0.11651776836739516,0.18897359856424112,0.04976358243664095,0.09775367586283007,-0.041307019990045185,0.051984125356584664,0.03921728887504488,-0.039779938713433514,-0.005566397745957774,0.009521908640512408,0.08829287856789415,0.05174571169566439,-0.0006823021771069577,-0.08965819152341754,-0.0429763832513519,-0.023483095623154513,0.00531353539928989,-0.028883838632566508,4.063195743586288e-05,0.14357583017408806,0.0920642578351887,0.08403653063318238,0.21753823740281322,0.10096991287254851,0.048673029985874625,-0.020403339579205832,-0.21192700288353553,-0.21238085013230934,-0.023465856179363826,-0.21992417666709144,-0.019835817761286654,0.07905906869612941,0.06814853728574399,0.04559072308384272,-0.12510615750309517,0.03896941090271327,-0.15267394523732522,0.006393965336006029,-0.06064951792913402,0.015536107718371477,-0.0764921460913223,0.037129966309377614,-0.14627238633736664,-0.061901137251348506,-0.025059175585562882,-0.13610833158153238,0.14643447027830947,0.19075509069771965,0.15056399602633969,0.049572316439229,0.04095814412709668,0.042942969791546236,0.10132040357924982,0.08034243470741122,0.08167461994705082,0.07920351424899111,0.04836174109496779,0.047614563407479736,0.044587282743207446,-0.011777683603405684,-0.01611263277237217,-0.16830973853695852,-0.18419271009161667,-0.010696739259135328,-0.1464258805587306,-0.09681025849957013,0.03745559872160223,-0.18173034665687532,-0.006773539341352584,0.2157981369704334,-0.09401783227173509,-0.0887928080336542,-0.03841077713275078,0.27114195365211397,0.2212554828020577,-0.17168312501705268,0.05682160328337846,0.0736937597486325,0.08595405447871063,0.07204594069167282,-0.026733103865558917,0.054429630345733844,0.03481972210467175,0.03233779313540785,0.09298929235931602,0.0750845206213258,0.06054480820007679,0.1385973895763936,0.06631722540806649,0.04725701612704051,0.07595712104374995,0.27104937747858127,0.16367528498929235,0.1424979592103613,0.12237560145347792,0.12672759561772334,0.09790571049762264,0.13306233804583187,0.1396744935763233,0.09001228123555366,-0.060980211166175594,-0.029892916210206517,-0.04680584370512429,0.010779312495175076,-0.0194792577612806,0.1854724487397925,-0.05705643637587874,0.18569707842409222,-0.03306965138841198,-0.023171687143582004,-0.060320163343782866,-0.056812309877458,-0.026908363800284222,-0.016982808202340244,-0.01579227021210166,0.07288866172623049,-0.04808682868861107,-0.02987313459899061,-0.02472488658115541,0.1043163085712162,0.00559196937952789,-0.014122398561633824,0.05038970565081303,0.00029219993559616834,0.08703062344365457,0.10872142912811016,0.17520612183876386,0.045974278998786935,-0.07396153854383813,-0.03841809667575749,-0.019044682916656504,-0.07405609494678798,-0.06529528584776405,0.3016941152458237,0.1277064354052795,0.05598391633156228,0.03813092510966841,0.04935408354898167)
shap_list[[7]]=c(0.006717764837476367, 0.054086223788765736,-0.011206186019713007,0.02836644746626888,0.22627198421704858,0.2310602422450841,0.2625360726100698,0.006046347305018845,0.2721742576174635,0.19611455316500703,0.016065338017865284,0.22493213437966472,0.28452782690327744,0.1435273916594981,0.04938780702995108,0.009964193095325055,-0.05959158992554929,-0.08448244139579746,-0.001344964902945564,0.04542167131841986,-0.006480244825431026,0.031084711403424038,0.007542729053788244,-0.003935729085789267,-0.0021415119717039474,-0.21394909812016313,-0.0819506901167002,-0.0570527153081887,-0.06539960906701663,-0.07993260258705075,0.1123086454754378,0.03820798324309025,0.3609957941456387,0.10183417451548699,0.3572731297449778,0.0989855368896549,0.0024877390219558747,0.05149109006155358,0.29939163666021484,0.18236190520737539,0.1853780623264542,0.014043496342129543,0.051161394546739576,0.04011810259843192,0.018180356736743786,0.02864634986819083,0.033203545573239,0.0654806448472319,0.05701703913436199,0.030614324874175466,0.03413054760867212,0.025846320861754337,0.03364769253387481,0.032931269169227506,0.026814096391986206,0.04152837117272036,0.07133868893544415,-0.015548715987473552,-0.018901296336160982,0.04705884438983331,-0.004131675557220413,0.049569662637869855,0.04237819968917729,0.2572721984822369,0.1345913342699299,0.04042236146504222,0.25576980448331643,0.04345651152898986,0.10098642795797652,-0.012462786797012956,-0.019201533746629654,0.09673552623207092,0.29998549974242117,0.24350914140193866,0.15120482507914207,0.041120013954998445,0.3042322065125809,0.08225991413726715,0.34918505624729723,0.1246173175411207,0.049045832865059286,0.03933770315669894,0.11651652360974336,0.3935908090311186,0.3795538980309782,0.4202363668177295,-0.021041187543169616,-0.011278271483110766,-0.010591893778601228,-0.04096267324184505,-0.05141749572415653,-0.05004761895336666,-0.052063752252351804,-0.043395729598090585,-0.057470708408982704,0.3335240423023237,0.31031987275939776,0.25573242099252225,0.22848530098904551,0.1586399843551199,0.3096605298193377,0.2585751664377803,0.13591709758657333,0.3566273764024268,0.11239372300073575,0.30962823057935523,0.11324210346967757,0.04092652502521063,0.057037035630216414,0.04051967275357047,0.16334098394118102,0.1323659658263963,0.17767822610504252,-0.004423340790884635,-0.009543933069506134,-0.006670381155378149,-0.008913758198474658,0.03600558532068417,-0.09847912809096888,-0.1528099714128641,-0.08532230133846194,0.018714530008595034,-0.0076049411338705904,-0.009140763277429654,0.019123593532920258,-0.00657569683738002,0.1532827534726677,0.06321313257733263,0.06925790259067577,0.019958026556032307,0.0869108578996672,0.37632617056955947,0.32462381260620404,-0.02680841067040224,0.41686567223552895,0.3534538449679784,-0.030349859701662266,0.0654493602532035,0.034692410011805945,0.0014296523080661295,0.045562643260658536,0.10326234891598512,0.2582553807353955,0.0020803183085407405,0.2599671149667208,0.015154137507955412,0.04438545629315392,-0.001861683058820787,-0.00407300213222813,0.09117932806313737,0.09689662848473678,0.1004635812991983,0.20040103164125753,-0.0003829746499593664,0.014080735107100293,0.019474561224226986,0.16881221598929205,0.04497942843877849,0.05168159084823042,0.10223669501437098,0.08926906591262936,0.12350557205874504,0.17735585146846827,0.0034221935857929714,0.05624513291303991,0.055506603893095634,0.035388118752519,0.041938381789327774,0.02561200337390588,0.02068620944317538,0.07483535583744189,0.01507560147482533,0.003507859643747356,-0.0165106142061154,-0.02122461904085002)
shap_list[[8]]=c(-0.005522943246705224, -0.03645754151474752,0.08908395787041608,0.11696193798100885,0.2982594305668384,0.29637331974033526,0.3171859082990181,0.013686835551378165,0.319867816245012,0.25767027520098706,0.028107818585283724,0.26826047696152866,0.3654727365844232,0.1929256073390478,-0.033195584395790345,0.019369735311624215,-0.1493112302200478,-0.07324106826307318,-0.001481458749175382,-0.013082630594304267,0.03093045140562722,-0.006650007175864794,0.03230143788993384,0.03510131165253719,0.1609133463336742,0.22075732390382447,0.044706585965695086,-0.011945288094211597,-0.014836514010753454,0.0460320814852299,0.15710840040140403,0.05185196412038324,0.3503795169487783,0.09433943931928637,0.34772110367671305,0.12879830177649199,-0.05426408007953605,-0.16853489882000386,0.02895248136750961,0.00923519606354603,0.01622963900714205,0.009340602946449174,-0.034520328805776185,-0.11171055060942715,-0.014138625986019367,-0.021492476905571774,-0.033221722834017996,-0.027170959928634855,-0.029466137520154416,-0.03165715011038218,0.014102182653908515,-0.0014236296506464348,0.003878677095447785,-0.03719089880782607,-0.0036203861241225987,0.04256451925209041,-0.017614424619937858,0.04727085362533853,0.05664593273120667,0.13957379231733477,-0.0011524539592641546,-0.14857857996944707,0.06046256949870138,0.25506384023307876,0.2051188277290748,0.04512244553558267,0.2556733055199562,0.06346941406089869,0.21614544549832113,0.0797123726955263,0.039134895548024594,0.1345772216433619,0.2545188979576293,0.2912652949485757,0.20562723687868553,0.04972953918552459,0.2270740102383529,0.10530822726868264,0.3365507371973106,0.19006492246799836,0.0594922663281018,0.04449576890187484,0.1683022794533831,-0.025412635426748077,-0.015727087338030795,0.02752312803286255,0.030056971687833656,-0.03098802528710446,0.003105184639877824,-0.27106804667546275,-0.3171697607831716,-0.31546304119047835,-0.27635171437862177,-0.14752723508040783,-0.1397866206128021,0.30303263341396885,0.2225252404846936,0.2617568716043436,0.2633522660231877,0.20713431153669673,0.23000694072152786,0.2959523478754878,0.1586931401951595,0.319352781404956,0.16126420087594254,0.2269486400108428,-0.32207009289161126,0.04553099749274766,0.08405477774228945,0.013955172051989885,-0.20333831552671786,-0.3220857285829035,0.24122156540196382,-0.04990825883697792,-0.0004324958091455668,-0.002573367134189703,-0.022527467113205673,0.05273532636408709,0.05030508112850644,0.010800282674400167,0.004026075088632893,-0.08191647564563206,-0.02919163897844108,-0.007443239835950176,0.012169938099348174,-0.034758372462401155,0.09400774686893425,0.12459210302454068,0.05889792800064939,0.03035908931769331,0.14302977871168812,0.0869985996153869,0.06350084483178635,0.17079298927744835,0.0486183510792533,0.07038420387192731,0.1938108615361077,0.08993608413772237,0.23495077822179392,0.09294416017287971,0.11729903084392504,0.22097836512485128,0.30650286373254754,0.18015775771952616,0.3061733007468044,0.05047256688326859,0.10369512422544233,0.1822069851433458,0.11128894675161645,0.19366407818354517,0.19710047407639575,0.22522337131697007,0.2552275917613575,0.026824143127348852,-0.010911526106245815,0.004694228361651076,0.16651767161911823,-0.0058744833761348375,-0.06773579427891986,0.19607750084078268,0.09031972147623553,0.12223099706001131,0.12510043463022602,0.167313338945381,0.06501494609386145,0.09224483539729726,0.057115840604443226,0.013174458008116811,0.04630254054847481,-0.011460622856121662,0.05594893106476371,0.07978128821532862,-0.050925409469489744,-0.015604653440844192,0.030166111904805427)
shap = do.call('cbind', shap_list)
baseline = 0.3322840991584792
rate=c(0.36640180083073426, 0.9758384808414556,0.5651467140238375,1.2089086877570763,3.73655881825505,3.78111320042583,3.5944948346081658,0.11486339435309433,3.8688615985483166,2.7330796643512802,0.1559251967965565,3.60517229239412,4.256528315742687,1.9828413434665708,0.7576870163998234,0.3406476592884104,0.29224301034356137,0.16941313112002546,0.37048108559992865,0.7000621787114834,0.3612614987515896,0.5414562367920994,0.32714220066590566,0.4074776996878465,4.709449875749296,1.9945011769879328,0.31782223185812924,0.21572509194684367,0.19597922568882223,0.3294180106703368,1.1584733963671652,0.3087013938490415,5.127422164673198,1.1053670744634287,5.040976429321758,1.0284345374029573,0.29922609195167565,0.6222616845401105,1.4833608414226724,0.5082954430155909,0.8617493063937861,0.1794747234284726,0.590545208388802,0.3355142703820436,0.2444012434069103,0.3795822448044095,0.39239573561897173,0.697403493238333,0.6633111225534304,0.4032643000427545,0.42478970911217057,0.3987683538518478,0.46869735483606667,0.4116096781365396,0.39205505717135264,0.5801680948277176,0.8240526458396679,0.5046587930359288,0.40808090274083214,1.274414011713074,0.4472605717756071,0.46502715446690984,0.3522024834094682,4.33132698873799,1.5369698285532485,0.34876179472807717,4.159698130986098,0.35727819577398473,4.578307087240786,0.4651465838085029,0.26982928283219,0.9690168187189879,5.387686882294835,3.7387605735415783,2.1894111535763745,0.33663766207435275,6.137474953217584,0.6948100225267909,4.163751683844026,1.2037066426645082,0.41626460376147484,0.33284926140300775,1.048129212797275,1.1547632809393258,1.4154645587973274,1.26371248277361,0.2723486959293666,0.2077557548321019,0.17885176856317703,0.7396140114761368,0.4780120486397487,0.4990104867537506,0.48463312602113534,0.39449861314158013,0.4084596198381034,5.260665569076812,6.206798867019166,4.291562094635554,3.4367541298148603,2.066075063108069,6.1551522984665255,4.059979218221875,1.5856796000808377,5.428362483141084,1.143921716424035,6.196986535279931,1.4302266581834693,0.41087759765856835,0.5844589353273705,0.4162336587017794,1.9950106023301681,1.488547543524319,2.1348810161559086,0.2809420838718302,0.4294027579151608,0.49880432724548907,0.3909319080961798,0.29913392511396875,0.314491734495048,0.19349896861281285,0.1515455089873583,0.3770489596465217,0.36632254752732996,0.29742583583499765,0.7113003825941177,0.3099468169898098,0.5928409542092722,0.7145718158556146,1.4647765780872932,0.6193775403464731,2.0002264223775033,1.3039644264962664,1.1393586313699875,2.381849810978887,1.269202050666344,1.2808675216657819,2.5206919610356264,0.6184032174724512,1.6351353693255688,0.6307219989381334,1.2904772033606697,2.012020917325513,5.889425470927157,1.1850944873600677,5.8916675041414655,0.28829276591419284,0.7483685099690319,1.100411604188354,0.7291679403805194,1.6497292333935947,1.7249065626041806,1.930968087785222,4.95090182743054,0.18768452404567534,0.1982440606288777,0.25820249108619486,2.102971876754918,0.4599099974226639,0.8189062586836516,1.8740686522382402,0.8756955691662195,0.8270060333418798,1.0249939756734379,4.648351625544305,0.28369824244894587,0.5012825643501465,0.31972477862264453,0.5403440160240836,0.28843121417029877,0.2556746655678112,1.539935608960481,0.7084040999965902,0.3530248464670301,0.190283112139676,0.28195173196211126)
rate_lwr=c(0.047578737565217966, 0.04032217595521842,0.10821850806366945,0.23804710787028965,0.01699731526471393,0.027241328125968634,0.7451946240558862,0.004635202143662948,0.801768177998621,0.18924351287248745,0.015290430397122468,0.022145602839299894,1.0801344565971271,0.016935735543882724,0.04389663871123811,0.004368518911153613,0.03894577694533763,0.005255075746839616,0.09967864922879932,0.1258606171946997,0.022501340395342573,0.050765350911296914,0.038038736990158695,0.0876216162982949,1.5332068156135321,0.04487968526569894,0.054353446472220734,0.02365641542113492,0.0380807068732153,0.03408160421625356,0.19418766168142862,0.08232667512774172,1.9416663887819705,0.06869579153825353,1.9516615309405811,0.07363850512191134,0.03488258214370499,0.0523369360435208,0.20947743077657233,0.009657258444502992,0.05477020135523719,0.013815156359558156,0.11009747557602623,0.03639347980416163,0.04709801310503903,0.10415891754431955,0.07749158171627837,0.10803674902296934,0.03629527856392489,0.12705355445272923,0.03188331076329631,0.10469507808614903,0.11431209187633146,0.08759955089819474,0.12363915848230747,0.07885658873645263,0.005131912679844586,0.0483961054653998,0.06726673028319696,0.04823399540580181,0.09383418699329399,0.035616633613591187,0.08529863618676453,1.0833989581718932,0.25738755968144783,0.07718063413164686,0.8405925075096519,0.08888330422668819,1.544034450963017,0.011743551766729227,0.022920776249537367,0.12034113258373519,2.0191138192138665,0.9721698850561895,0.02485648952376962,0.00295959097548551,2.873115251921479,0.005408610837358718,0.603681737595679,0.16368998907083693,0.009583006996447874,0.07042041595707232,0.10566961002591535,0.08558020402651786,0.1371062897300866,0.0778713161896929,0.040249167577389056,0.015415042172994942,0.011403553558343826,0.13923031328862312,0.12353726374165491,0.12944387238201893,0.11877831268025596,0.04317335720483215,0.04017649985388083,2.4852897866823653,3.1707745789941972,0.7316130187906507,0.8442017434063682,0.3239996529429382,3.2847934253265025,1.2727337744871343,0.05034786438301583,2.50194927382904,0.21127771163449366,3.3079856310942737,0.07622555781728946,0.07335198356502137,0.08117767482416552,0.008653693228800885,0.2722565962655833,0.15059349894394017,0.17063736792081358,0.04387816236848707,0.1113651642668167,0.12563541914937368,0.11009535109069296,0.09044835676024715,0.03009464948400531,0.01911165835334655,0.02210874308993449,0.05839528971681468,0.11405930489333288,0.06918944453488479,0.020956926133834375,0.09160170486221553,0.03719923004118958,0.061717359907527664,0.25524674672143205,0.02577119399798472,0.11578904067273671,0.17582102848736644,0.14287784599801187,0.5541813809731282,0.06337130792165618,0.1991852599352004,0.4672332404518708,0.013848158742429229,0.3616371776583279,0.03259884765059648,0.03395401414201665,0.2692751378199778,2.8540222260505406,0.33632810640842487,2.861196596922242,0.010916826432195936,0.018053889907626436,0.2662437361905805,0.1597133762180432,0.39468913943020295,0.4299474350981566,0.463733310593819,1.840799376608378,0.00564952141284647,0.010926710555397012,0.016612294519447984,0.208684540136917,0.015038812175801719,0.02414261558519043,0.014832940406007106,0.02174034554656218,0.1025642615998158,0.09965842057256061,1.3847114572435042,0.021269907964825807,0.03686331017669367,0.005966066567389378,0.032896640942476796,0.013534837657432963,0.049331595720368215,0.18799792132095167,0.11569526390481819,0.017064771400274792,0.03319606601315589,0.03459195502824136)
rate_upr=c(0.7752269742097788, 2.708243204079731,1.153201491623755,2.616403947030854,7.269516429231873,7.24428347180564,7.08443439478634,0.2543365371721654,7.028070956608454,5.774723841171578,0.352980425418572,7.129856865330455,6.753886741601163,6.199047631135079,2.354347444995756,0.9972376158077862,0.6970847126093351,0.40503910824893236,0.7636857506047752,1.844380389824482,0.9486096102667672,1.3861267066519094,0.796346898393409,0.8261429236116675,7.8951241492589475,4.5480833941297325,0.7214101901227666,0.5474307664137307,0.404265710387527,0.7549001706057004,2.3004712255410773,0.5488905822610812,7.958258288658104,2.583339310099599,8.140444662667733,2.6694520660308596,0.7278651021007208,1.4937741262488675,3.4536806984360826,1.4849513056598131,2.2433357663688804,0.4569288874080599,1.3685434711963307,0.8188267090211258,0.5058646650276123,0.6904461298954352,0.8833829685192354,1.7713014592101688,1.9805530269157459,0.8080914346125513,1.0252910709023277,0.7936164943015672,0.9366829359164854,0.8807174903160272,0.7255494443004473,1.3590273152156327,2.4012391002660807,1.088282206261976,0.844046752480498,3.324700966658867,0.9512948783147407,1.1444843316346958,0.6967501614437454,7.687917815180483,3.030702894206318,0.7114004250369903,7.339090297563924,0.6546339520561058,8.51018279325848,1.8618387606639342,0.7340171589895452,2.521449699448331,8.522263914045375,6.305768811932067,5.328469161811542,1.2254230019221521,9.007639680319157,1.919967685965183,7.243479244910885,2.678927365450484,1.3665997122945603,0.6482669492453839,2.2880074125286356,2.9295284362283778,3.1245154662054055,3.270843515129889,0.554753083574435,0.5101962678891618,0.4410143339215702,1.8083670719895784,0.9251553390117306,0.9795337653513927,1.0763229877383667,1.1303723219412505,1.1144584166650175,8.532338210570524,9.432958464460315,7.285695886153422,6.057724990919599,6.191460995226985,9.343800723400358,6.89863460319415,6.760522285444962,8.394413751675083,2.2778446012239115,9.440805626013717,3.2837264701735895,0.9152534274934537,1.4643278593518123,1.2363709440647852,4.3140593288433395,3.372159117262155,4.424418638521889,0.5361224945074945,0.785541629817507,1.0316696019004017,0.7645344043300109,0.5516161444085361,0.9481905575022425,0.48132577071013266,0.30572209725359,0.9108880130923731,0.6353799708000271,0.5578049606021351,1.7235877165283162,0.548516793261484,1.3708351553854585,1.6232951935044786,3.2516033070490424,1.8678995915150538,4.639219078501857,2.670902803290216,2.351708685741802,4.955938281883078,2.9493827351363575,2.6698556747130957,4.951438011931469,3.2962065363587887,3.382931502835996,1.5520345860396731,3.122971233916637,4.979336382321279,8.866818631601035,2.3202680735268206,8.865196443144354,0.5872534306534758,2.0359849011209175,1.9567036236011095,1.4579263963804354,3.046724972154719,3.3235506592633053,3.870252926921251,8.303977670642778,0.4185709794364824,0.5080048571793156,0.5915316168509179,4.75461417799862,1.308838397814068,2.322172524714875,5.27510845406986,2.215017685599913,1.9104136920267623,2.5447434571190137,7.89199920294607,0.6353115905055122,1.3334554058184236,0.8076747614286466,1.5238982808186765,0.8267058864060517,0.5106016343393978,3.304069843904859,1.4636744072210053,1.005209815152414,0.39402736698247465,0.6628294978720388)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.675380920322993, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,11.45516312611962,18.316996330471802,13.644381033687072,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,12.762457973341409,20.505765520098972,10.270132845364204,17.06367135403042,18.771662988592148,10.119360120925535,15.275304079953862,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.197688715594296,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,21.211041052192133,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,21.04119030911618,10.647178292822375,10.15963284744126,12.8613425868673,20.792329617276543,21.04119030911618,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,9.991905577866738,18.567611710376397,13.839996414625494,19.296292608360368,12.762457973341409,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.451546459520934,9.062465735197444,10.647178292822375,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.723329637370448,6.680496549201861,11.45516312611962,15.453496384296702,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.555996307182443,8.396996516936989,11.45516312611962,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.15963284744126,14.172329741711991,17.899611722932722,22.62499624949477,21.2476885830762,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,4.276046594398034,17.61049634375181,10.757363139236089,19.87726902841626,16.67272363410629,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.059387768288352696, -0.06635024969424876,-0.0708063515722278,-0.07078678609959861,0.05737976972196979,0.05773527031021097,0.05848323444618694,0.056220643338291035,0.05780596017985928,0.057580879583128124,0.058360572025794075,0.057592932039975814,0.05859879268591821,0.058608744342802,-0.06712506806737141,-0.06545782029640747,-0.07450423918103796,-0.07964689862698907,-0.06018878129801658,-0.05978324761651764,-0.05965556963895285,-0.059928222278189294,-0.05981386828584074,-0.06013930105611158,-0.08549225787091622,-0.08988063191519269,-0.0896410850801782,-0.08930185111789882,-0.08958459518082953,-0.09021385228196568,0.10112922959369168,0.09819125808315958,0.10162758988483282,0.1021848973032313,0.10229404631449408,0.09863998632210136,-0.06408905836792231,-0.05500871903952676,-0.07519890339980873,-0.08051897260282373,-0.08078391898800781,0.017256440045616637,0.002743476583820596,-0.0398106458554509,0.02891486860012389,0.01732844585137824,0.007034032139259238,-0.013818215767053521,0.017172460932010723,0.01715839370202774,0.030152714193354933,0.032256121059501694,0.024110878125944472,0.013631673220248261,0.024273740462804932,0.024958339217256244,-0.05651773235091368,-0.07184272905151363,-0.07174781876321179,-0.07205942895451418,-0.07174668493894258,-0.05754162690598097,0.1000841699904288,0.10595688134880177,0.10521679322100083,0.10110051611448155,0.10595688134880177,0.10372380614929427,-0.06761923557877009,-0.06715121848224066,-0.06742492164821695,0.10288807940425032,0.10552152655813887,0.10451606174821428,0.10552703807314998,0.10393259090951187,0.1045816556408337,0.10406741611617491,0.10537877633133472,0.10531899535252588,0.10330831590315316,0.10150757155113878,0.10534653164406661,-0.07186059100550231,-0.07201928593745101,-0.07212111534458017,-0.06508831891979101,-0.06502324130233893,-0.06510207690110949,-0.07275218324233816,-0.07215868507238016,-0.07218240371930928,-0.07220665674121693,-0.07219897311764889,-0.07497112320764868,0.1081868412905659,0.10819328848742243,0.10799119352263092,0.10752358297024942,0.10648501496208028,0.10821429998398951,0.10821590404488163,0.10730664755487478,0.10728136475991235,0.1063387170872637,0.10768599560624686,-0.0599998554689491,0.079737263735299,0.08005979166158604,0.030309213017941223,-0.05841716089442444,-0.05809807724947796,0.09974731755216798,-0.06693888324737195,-0.06733002617946952,-0.06754449896215574,-0.06762733970627724,0.09051751043076595,-0.08512672680741099,-0.08462333380053141,-0.0848711674209413,-0.062110302723273794,-0.0688149449096419,-0.06930908310808874,-0.06905440691917573,-0.06916035743551872,-0.08330140244086491,-0.082674393969518,-0.06470610023758115,-0.06557993170404532,-0.08578815580315716,-0.08553018562611985,-0.08461908696026925,-0.08608160059145757,-0.08298247447543718,-0.08453182213639747,-0.08599164046050523,0.09566976500610483,0.042762134114811966,0.044953884550026225,0.04484818612675037,0.0458540681407735,0.0453805518933599,0.04535857277891386,0.04496630136596533,0.043269621156514906,0.045471753809806226,0.04536195700709896,0.045422929088958106,0.04540102991886733,0.045038747753857966,0.04587289233419695,0.04569700247197046,0.042539301311676214,0.03301697589699761,0.03412768743715691,0.035066035961058735,0.032928107582616245,0.03440083298562545,0.03414024476173379,0.09954765251605029,-0.0852770725065719,-0.08493143866479445,-0.0856629471012244,-0.08515467260995084,0.08111632542086174,0.0810260196907501,0.05283607948218731,0.05265133436601618,0.05264149679344857,-0.06768467808264407,-0.06809904808561297,-0.06489158659342296,-0.06534267349699995,-0.06493373561910934)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.023511543798606396, 0.02485481511355266,0.029445769520607255,0.029425784274435308,0.0014312673708845108,0.001453223490750373,0.0015010970394413903,0.0013579703237924562,0.0014576337465062224,0.0014433879835355266,0.0014932892397957324,0.001444382516843112,0.001508447070371726,0.0015090243117623346,0.02559181166950604,0.0240029627502618,0.08553893687496636,0.10865179255232135,0.024304052678009298,0.02390038859570212,0.023775704607253045,0.024043204034948987,0.02393085933031922,0.024254264834932395,-0.20209315100050934,0.15000041092777378,0.14901903478491596,0.14762286301848615,0.1487868344656515,0.15137619854111456,-0.008876902088249794,-0.008220061526357686,-0.008986022615741383,-0.009108600806963435,-0.00913250484909554,-0.008316872392645742,0.032748134754443756,0.02117791737493964,-0.14294415704498764,-0.1733145169798574,-0.17472274543314192,0.005842344795806118,0.005761231626007823,0.005530520478278687,0.005454807287676373,0.005902495101733049,0.005698139896681927,0.005723920261144957,0.005771776567458741,0.005760372654946011,0.005557644106980096,0.005432357924643439,0.005605279558256025,0.005663899970445122,0.005699262704120264,0.005595536815549172,0.0228479311250197,0.030555257819560654,0.030455372442384762,0.030782361516897307,0.030454918053744735,0.02420844796790055,-0.008664193935706476,-0.010052837520262798,-0.00988029517537304,-0.008909076369200391,-0.010052837520262798,-0.009527245444893626,0.03752543375043988,0.03688770766715982,0.037260782484221204,-0.00928074145162485,-0.009884164279428634,-0.009649904383250689,-0.009885430711412341,-0.009517708378380977,-0.009664789123542447,-0.009548215325532005,-0.009851283744206534,-0.00983756695951749,-0.009375383438743607,-0.008967933355556382,-0.009843887061100884,-0.12267404866166363,-0.12334178434996085,-0.12377121461784679,0.034033512790720505,0.03395004224989664,0.034051459888880316,0.07991683823428664,0.07831478643761068,0.07837804313571615,0.0784427068255945,0.0784605500233708,0.08687450550282441,-0.0105931883407737,-0.010594733059764147,-0.010546091987646392,-0.0104337001429042,-0.010183234971015536,-0.010599787994002333,-0.010600169679071736,-0.010381669030046168,-0.01037522218037145,-0.010148880679761574,-0.010472481487215853,0.03785025670671119,-0.004045516668460302,-0.004085885180573337,0.005628940964971373,0.031947335511592956,0.0315192416686601,-0.008565805217977491,0.02541857486394081,0.0257871458410737,0.02598996783919366,0.026068418136656436,-0.006480124714145462,0.13033743764842326,0.12844495086465588,0.12937640103335318,0.020717187790427475,0.027396464969421917,0.027914084356397733,0.027644340650739476,0.027748851465810735,-0.1891660503427121,-0.18567444090593388,0.02318938627953386,0.03467741924631223,-0.20396384691220623,-0.20245927100867175,-0.19707746342552684,-0.20568861576971573,-0.1875291563454253,-0.1965777992424507,-0.20516099588731615,-0.007645633214668031,0.013982917472568877,0.015937197554148855,0.01584522634353796,0.016745407668231783,0.016319875597483734,0.01630053551205552,0.015948003643877485,0.014454934868775754,0.016402288346381983,0.01630351854204209,0.016357325115278248,0.016339955916635306,0.01601142913839598,0.016762279161349192,0.016604675331204754,0.01380328507670496,0.0055923672488597505,0.006448376134582821,0.007076748427109089,0.0054974711645372175,0.0067473678170825255,0.006391520421790573,-0.008533775365560428,-0.20082717721911142,-0.19882944675525513,-0.20308604775924424,-0.20011814009408616,-0.004315089917494099,-0.004303282276083017,0.0018959177699619733,0.0018795740552441122,0.0018787105307452737,0.026133342589681273,0.026529678674915808,0.033782030809933875,0.03436507887407113,0.03383589945066327)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(12.725000000000001, 14.895000000000001,4.466500000000001,6.289500000000001,1.2905000000000002,1.2905000000000002,1.2905000000000002,6.289500000000001,1.2905000000000002,3.0900000000000003,6.289500000000001,2.1900000000000004,1.2905000000000002,2.1900000000000004,14.895000000000001,9.438,31.0,25.565,9.438,14.895000000000001,9.438,12.725000000000001,9.438,6.289500000000001,0.00585,1.2905000000000002,6.289500000000001,12.725000000000001,12.725000000000001,6.289500000000001,1.2905000000000002,3.0900000000000003,0.06885000000000001,0.45349999999999996,0.00585,1.2905000000000002,18.205000000000002,25.565,9.438,9.438,9.438,9.438,18.205000000000002,21.735000000000003,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,9.438,9.438,18.205000000000002,9.438,6.289500000000001,25.565,6.289500000000001,6.289500000000001,6.289500000000001,9.438,25.565,2.1900000000000004,0.00585,0.45349999999999996,4.466500000000001,0.00585,2.1900000000000004,0.00585,2.1900000000000004,4.466500000000001,1.2905000000000002,0.00585,0.45349999999999996,0.06885000000000001,2.1900000000000004,0.06885000000000001,0.45349999999999996,0.00585,0.45349999999999996,2.1900000000000004,4.466500000000001,0.45349999999999996,14.895000000000001,12.725000000000001,9.438,6.289500000000001,18.205000000000002,9.438,31.0,36.352536,36.352536,31.0,36.352536,31.0,0.06885000000000001,0.06885000000000001,0.45349999999999996,1.2905000000000002,0.45349999999999996,0.06885000000000001,0.45349999999999996,0.45349999999999996,0.06885000000000001,0.45349999999999996,0.06885000000000001,36.352536,6.289500000000001,4.466500000000001,9.438,25.565,36.352536,1.2905000000000002,18.205000000000002,9.438,9.438,12.725000000000001,3.0900000000000003,6.289500000000001,9.438,9.438,18.205000000000002,12.725000000000001,9.438,12.725000000000001,14.895000000000001,2.1900000000000004,1.2905000000000002,9.438,6.289500000000001,1.2905000000000002,3.0900000000000003,4.466500000000001,1.2905000000000002,6.289500000000001,4.466500000000001,0.45349999999999996,3.0900000000000003,0.45349999999999996,1.2905000000000002,1.2905000000000002,0.45349999999999996,0.06885000000000001,1.2905000000000002,0.06885000000000001,3.0900000000000003,2.1900000000000004,0.45349999999999996,1.2905000000000002,1.2905000000000002,1.2905000000000002,0.45349999999999996,0.06885000000000001,4.466500000000001,18.205000000000002,9.438,1.2905000000000002,12.725000000000001,14.895000000000001,2.1900000000000004,3.0900000000000003,0.45349999999999996,0.45349999999999996,0.00585,1.2905000000000002,4.466500000000001,4.466500000000001,9.438,6.289500000000001,9.438,9.438,6.289500000000001,18.205000000000002,12.725000000000001,6.289500000000001)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()