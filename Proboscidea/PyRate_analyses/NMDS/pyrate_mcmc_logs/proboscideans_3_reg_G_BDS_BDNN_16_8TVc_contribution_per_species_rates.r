pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_3_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 6.0,2.0,5.0,4.0,3.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.011610576134342908, 0.1198009839118627,0.11091392614038477,0.1418318138315222,0.142695965584768,0.05852731543995625,0.09545451106660494,0.0609733033388632,0.06341294058206573,0.3129973536303071,0.03842225147847003,0.09036644188145006,0.05497198727527671,0.08102716773283994,-0.08581173965630964,-0.058161118097253196,-0.49627979035937236,-0.33119090217620606,-0.030736884614341174,0.2072663435914954,-0.18451999336085123,0.10015190148133511,0.01896125755335266,-0.05374036539701075,0.19850331177448463,-0.2168595719036039,-0.2757986181992205,-0.2683672988018139,-0.25336389678245835,-0.23188330563652626,0.4751536421045791,0.3483404407342297,0.5560064707207042,0.5556578147385763,0.5135314207075958,0.2751594557897689,-0.16830801237907086,-0.10745209152698647,0.0781438287190344,0.300912240726605,0.24694841533590578,-0.02848363395472318,0.059354228167121374,-0.07421579259671993,0.013502737073332384,-0.015359808164043613,0.008131936432688806,0.050438784487593744,-0.06846132641563245,0.003051555564288719,0.05279898439047822,-0.04344163936275922,-0.01964737672314623,0.027669612990667503,-0.06301169310333694,-0.04599417707175167,0.3060507867619126,0.12461735654129055,0.1270423477712468,0.1476670482572346,0.1192537594125673,-0.3136176671247921,0.3455658715423042,0.3266795340695456,0.4301552212286454,0.32710089578110585,0.3211042125216032,0.32174311276805356,-0.021396361753301424,-0.07131011040706434,-0.11018844731576945,0.3831355520967302,0.6492888919868572,1.0034424328610196,1.0057139084873592,0.4871205999203591,1.044573534853716,0.32257645713380484,0.4354273293167114,0.46050682160865014,0.45249271145857217,0.3232543343891376,0.5362535583567235,0.18513722732249963,0.08446395834299893,0.1078809999964927,-0.06698877895464427,0.042850724638444304,-0.045473848943117796,-0.3652988493372702,-0.40088715884273046,-0.40146789229323254,-0.3916779832078187,-0.5024066289441551,-0.4943006974968885,0.5977212055986956,0.9760483195045114,0.9159971870609556,1.0574289296046564,0.48455622245222096,0.99999265402859,1.0453371604376231,0.5880550031962939,0.5535189824575368,0.5016688721905939,0.9468529196804606,-0.20923215363893022,-0.031406668420972304,-0.04740720710919824,0.08046326517745798,-0.19016950697150273,-0.20855742372343883,0.33971484606923796,0.05540105858598005,0.05842912571120734,-0.0024140039628366998,-0.004460404483007865,0.32129593334502804,-0.3296008520782557,-0.35168757720962757,-0.40920024635017666,-0.018934487593873093,0.01377595810347616,0.06624614255943553,-0.027471648804177372,0.04253501454193667,0.009559547606513917,0.035601072061924165,0.1917585102579444,0.2758506243399547,0.10987443218800186,0.10930306115625889,0.17386587234005532,0.2142880993497593,0.15353126284905957,0.18941786660176038,0.19861607981366236,0.2987568202345829,0.2502375258489946,0.2658355823422171,0.3008842093776683,0.4377962584288933,0.272085748628749,0.2405123611290564,0.29626086624709086,0.24485906193878623,0.4313190862962288,0.2721676561852964,0.25159103578595143,0.4309613352830404,0.4280829777982731,0.42697484538619346,0.4337731419186727,0.3502099697890763,0.28324960643286384,0.1934172284510129,0.24386613581824954,0.2558440224864456,0.45143264895536217,0.21323513089745172,0.5669341476015992,0.2276138283793236,0.18770242626963016,0.25659903721076627,0.21230093791204757,0.13696316526477206,0.11055935410720784,0.08970558083691596,-0.03683822390441858,-0.023514057628067735,0.11585702263827027,0.0810693911280435,-0.07188836617138726,-0.09793683671687556,-0.07761355509865613)
shap_list[[2]]=c(-0.061539367805584846, -0.0014057631642566458,-0.10664481796788579,-0.0984842928266776,-0.02457728276601155,-0.0236276014946487,0.001706424850918275,-0.024717022224157736,-0.005422306563957273,0.0818881923440817,-0.0071960763776883,-0.025742384291693433,-0.022073029276784877,-0.004970242006111615,-0.011302297862201448,-0.04867258486286023,0.04404472577724827,0.05608397497008311,0.019062205502750777,0.01688153317485827,-0.0006559334714325994,0.06754716822468332,-0.051424084550999595,0.012069775217313818,-0.027576319205718593,0.07366835369335965,0.12695664114971983,0.15288947842974007,0.08302159725460109,0.07663725510418362,0.03519083208066503,0.023217102424909625,0.05347368301167911,0.05931752500975213,0.05377967848488868,0.03146779667375181,0.07067983402030767,-0.0068789998571863464,-0.07456100430100664,-0.023957645488968175,-0.07226475951142622,-0.02419134320850422,0.03781199902671891,-0.04305198603487404,-0.017383176560949298,-0.006557295183681791,-0.004106837878201396,0.02180002982038521,0.010718879930341853,0.008407270803495627,-0.06932987061663237,-0.013440935086829569,-0.01087725066898641,0.018904866356229292,-0.020015327284215897,-0.014336689983708283,0.06132261684150649,-0.11042708962898118,-0.09898460102824301,-0.0361123692958044,-0.07650307467149825,0.008822965270306097,0.0457350608057605,0.032170766346170054,0.031280219690976385,0.03658098319000104,0.03192865533029575,0.030298260743688844,0.074692770847224,0.08893745730510791,0.05832304629888311,0.024874753340993285,0.204104320857612,0.24340777943875797,0.2553065147467818,0.07572360871433297,0.24964497307228634,0.0504555069568349,0.10810350595129757,0.07015816027138902,0.05155434891591542,0.026136139065101153,0.10142045156083668,0.00661638506710715,-0.046934071962975665,0.010496872004653171,0.07295628911821009,0.05664687570482556,0.03881949779238306,-0.013560562696931146,-0.012234386885487608,-0.012200196174099516,-0.01526837899678367,0.09940779346814414,0.07847734037766613,0.0987252908747276,0.2150594270196022,0.2503693600833159,0.24540402808324055,0.04801879377762905,0.24439796236184644,0.2466461142516596,0.08171061252345736,0.0803316202048321,0.05175675899962946,0.2444338235646708,0.045063382581204674,-0.012016235153139576,-0.018755267202418994,-0.05930055488438812,0.018097606979547622,0.046146391378221734,-0.013650570608992406,-0.1458029310281075,-0.14194944929188674,-0.13108892692541435,-0.13058984870478027,0.021317175357697574,0.03421040768307266,0.046374788756888344,0.06455607730250758,-0.019111291991198813,-0.1194861045313084,-0.14436717828242093,-0.054552421941945727,-0.12288110172621208,-0.047461103539018355,-0.07336812370215465,-0.07021014741078735,0.12272973784346276,0.040496817525146216,0.2176964697709634,0.1825957822267795,0.12475934122012887,0.2803489130204147,0.18540013039227957,0.10851958856764293,0.006678811005483851,0.019368664345631365,0.019661063858706924,0.02072261605519653,0.09166057424333807,0.017436333911945594,0.01430709795634386,0.019653208071873866,0.019785712288433767,0.056414697831237884,0.019682452248631875,0.014062163775212327,0.09423093027811859,0.10682201652413446,0.10712664596518483,0.06943385218014902,0.043355178481708466,-0.028858916057823217,0.007206934148496281,0.05124537587931769,0.06337494476670705,0.07124284715281101,-0.02510116441360616,0.03236615656828774,-0.0060144753273969655,0.007869427031025191,-0.009143338631239114,-0.002528516271471987,-0.003493668196264225,-0.011198450045976884,0.027237235285879933,-0.024465117737211616,-0.01681012297558349,-0.03986130243367594,-0.08005447749883716,0.14081026034431396,0.03894576606243811,0.04446246946232531)
shap_list[[3]]=c(-0.08849555894561434, 0.0027407618170064737,0.11682843989088892,0.14246220699788037,0.033647378628378785,0.011236393602546857,-0.061181459492056105,0.021110099163279238,-0.05914485634036137,1.4699353234310288,-0.05419691730011849,0.022087097334654533,0.012744491465486878,-0.06297106343003615,0.057721790172784206,-0.19822152768870022,-0.029326096317902485,-0.030878311304749724,0.03987425226607476,0.1934214568655503,0.05092697280575547,0.18012120657232542,-0.08302527152677487,0.03468285966264734,0.03793922412266946,-0.02614246997372919,0.06394302526223647,0.0832672584975136,0.03784593216961885,0.027919302370810795,-0.07607077247437961,-0.09007509172165161,0.04377464698157075,0.13433083071005003,0.04086481245908414,-0.2249266460860205,-0.0917097901642704,-0.06881829616243146,0.07246725884308501,0.17938135385564927,0.044505103827081664,-0.17235403782086076,0.14146535610983088,-0.08636312933884199,0.06712816994654479,0.0673421216626489,0.08999574922650279,0.12814611255259156,0.0639491716565964,0.08498655485296311,0.09708418383167501,0.04693384229029639,0.08467890922044044,0.113184352421101,0.038586952065209304,0.043499041058305196,0.28576792544788154,0.05954388848591367,0.11946276002912792,0.025448797426296195,0.06853648251783707,-0.024074511825461904,-0.0867995009332877,-0.07944884832695431,-0.08023675578412116,-0.06878098736390584,-0.07813010485899437,-0.09233725623893428,0.13950329728021554,-0.10973464213913367,-0.08374540865255868,-0.08299678581396684,0.3323398504725001,1.5741461063089235,1.448667694518882,0.04855266744184395,1.5741935553780009,-0.2682216865391883,-0.04887308856333831,0.055646029082139135,0.03796527269610791,-0.07553867111719433,0.06478698870197287,0.30976228524422694,0.1288061941823137,0.2531790610589793,0.0724662357905399,0.11774482548307055,-0.08621047187260966,-0.016696178292600363,-0.025133204357787528,-0.025004037113326702,-0.02795624063677895,-0.021006219236774162,-0.019055837746610047,0.07233285303979342,1.6290437648953082,1.3277400082566218,1.5351386750543068,-0.06852351099353542,1.6148962480788096,1.5810316272683733,0.05754402628540102,0.06435194195048526,-0.06459267071263411,1.6374646220276434,0.015173196570679594,0.04473610075951078,0.029939379475642312,0.10828291329071747,0.0010704779719853583,0.010452292536599598,0.03723879028279008,0.12198554653352903,0.1243139946291913,0.06405551377466544,0.062074427125137034,-0.07747435069332882,0.028398652865204866,-0.028842103443245882,0.06260224701128815,-0.07110005760969787,0.07382385147225234,0.10992384069359355,-0.03422878814253544,0.08441472741055335,0.02409479163811941,0.0072817322679553645,0.22909820605146994,0.17258224754282167,0.17620701768597044,0.35830919927791427,0.4006529653623413,0.3708678140213206,0.3303194044055703,0.3997550358217602,0.37193978989917686,-0.07302773937321286,0.014386040473352076,0.028707454808468622,0.04579728024742018,0.922248887690826,0.026063205305572972,0.016815567224895408,0.0330104628651898,-0.07416634171033241,1.0652827966615426,0.020771536566210672,0.021313749236519845,0.9174626338785776,0.9359864477767996,0.9422584525563149,0.8921515988969435,0.03268108882445626,0.045771536094221965,0.05211152920616275,0.13248402494348635,0.138620511482771,1.075036875362155,0.021780105392997216,0.956222106293769,-0.04183345636561974,-0.053630012276265925,0.04012660037642871,-0.04313836067364814,-0.051645717704429286,-0.1703892461992219,0.08400145064397058,-0.1333820716124447,0.048621360459624396,0.1846308471642138,0.12313710171720925,-0.07312213886307618,0.019337598816209937,0.06161438924143181)
shap_list[[4]]=c(-0.034367053340040636, 0.07802712047320531,0.03704587324256201,0.04319399734212059,0.0031903375042632476,-0.04801582606179143,0.03740137906343639,-0.0073694151959847656,0.02973927462020882,0.14671635908299813,0.026852601278092865,-0.010843609918080113,-0.016743191603616942,0.02829378594728551,0.04025565145306383,0.013872430344874346,0.03036097884180362,0.04227823272178073,-0.004712457758864046,0.13150480349411134,0.03377788119879183,0.12179024787933615,-0.03326244517503396,0.0022148773903889877,0.14024432749312005,0.022547547659335348,0.023662449419771088,0.0664236728232307,-0.00777185836185696,-0.02351164831467559,-0.007604120565562193,-0.015090868182673694,0.017702085473829683,0.10141254943537964,0.008580657034468302,0.033380636486838616,0.038694760160354946,-0.008132623826755557,0.00236699546351037,0.172042940806728,-0.04540944433100863,0.027074578609640743,0.09633028891728132,-0.059008277450982735,0.03357776476929611,0.04775547068791091,0.05960996300779194,0.09166602705505716,0.0323285448910398,0.05632182639800672,-0.038941101832521204,0.014601296388277337,0.05873634831453018,0.08120359162310127,0.017676755424370742,0.022876616361889892,0.1455061688486085,0.03292683568673946,0.04007229280533934,0.04076713455566739,0.040153920470861665,0.022074532404910037,-0.015312186640493169,0.01206073468236009,0.00046774423388969377,0.010731137856448565,0.013823545404325623,-0.01460078240425589,-0.0649274379841156,0.024390961740070587,0.016161219642918254,-0.008078284204254561,0.04668666177929339,0.2517765078501223,0.19211639821554122,0.014126224858329598,0.26225239273897194,0.02531390838453776,0.04139163691769515,0.011630182240544597,0.00936947247845656,0.008327316779503746,0.02659757364139598,0.15999450632008672,-0.03206185286632735,0.17463205629898915,0.09360671960533877,0.09958823965177815,-0.006714530227373055,0.015115374221230505,0.015900272005978038,0.015869283141194,0.01727183053676291,0.05047304419135232,0.03911029745125372,0.03590233508113487,0.26210774778813706,0.0998223275890181,0.2554827303123361,0.005342599282558279,0.2641473388012263,0.26686098525107765,0.022002010438914588,0.02381658304511016,0.006964967154502092,0.26048027072890556,0.054356416025287506,0.011518129208985558,-0.015330491515628831,0.06895158562916269,0.03861275458570055,0.05315861249826269,0.017148915868501233,0.0843981565204457,0.08873301699336682,0.048839634128924926,0.04763948229217723,-0.009094760983399681,0.007910180444255717,0.026961200263587597,0.042683410871423674,-0.008201773695436742,0.05612580678237151,0.04311631654317019,-0.01160621742280081,0.06303956663903496,0.0829130854460269,0.06675379959043998,0.07256611280738728,0.07422698620551976,0.017357371978457985,0.11583640353367511,0.11790615826803703,0.08450764023791353,0.12131498015116973,0.1051885031740212,0.08510425002454318,0.029484512111217463,-0.05841767252391847,0.017431689142042198,0.04632014754279292,-0.0714636889678642,0.004367415147117952,-0.038718622236589305,0.019465646126570084,0.01643553949123328,-0.017499687009758385,-0.02459716965167937,-0.009066350875345167,-0.08431201381217572,-0.06631230704579866,-0.05778761160601021,-0.09177156714548027,-0.008860663544670029,0.023760310800873513,0.053679266108854345,0.21018207520070847,0.16296683436533332,0.09290896247622481,0.010599284627297962,-0.15844934793774293,-0.039685444446275746,-0.031188208268448477,0.13868261932633802,0.019279703307280228,0.046877530766639273,0.03567367063206106,0.02787543293349376,0.01378060457216592,0.032662752335247076,0.05171351766697567,0.03516482440951236,0.0596352161570647,0.0064363274672808325,0.05668624548245346)
shap_list[[5]]=c(-0.015829237212403622, 0.09094107078213885,0.08291321352884945,0.11033427978881948,-0.0793030585463898,-0.05351092999872042,0.0058587308440421326,-0.06630318910017226,-0.005233717485016018,0.04439391524065433,-0.00835699196035029,-0.06964520004480623,-0.04620180053000836,-0.011007130698756949,0.04532881341651516,0.015892988393553395,0.036578557331222755,0.03960990948157676,0.04337228714708489,0.13787365327791365,0.027277488542033265,0.13430210687361469,-0.014617157421449253,0.032675245549512136,0.09767689263741285,0.027707396817247567,0.07126645031165545,0.07682373120199522,0.050656958900133366,0.042449470560633605,-0.0663349000917162,-0.058998075675549586,-0.062465686592797214,-0.055697620659467276,-0.05643756454026564,-0.025700133597599137,0.029581802317354904,0.011626273880997058,0.1160120421280304,0.18204816622021752,0.11141451152343172,-0.01181314066497912,0.004408412269137617,0.008876189910957984,-0.04204052567016711,-0.042680546969066674,-0.024774381175424545,0.0007663495855696667,-0.029776614597014153,-0.03636457746349034,-0.04455646957733219,-0.04128050331215732,-0.034924091002164974,-0.01730723403345596,-0.04365434576589001,-0.04930758409238332,0.24531484997135045,0.0586074291377415,0.08651433044150245,0.0730905409679023,0.07166104834126609,0.015187957952882938,-0.060828793453003856,-0.0453992052451833,-0.06297942250085076,-0.05176226738643665,-0.043351853462412354,-0.056905483973697074,0.028736309496755524,0.027762359046097095,0.017612333979735988,-0.061233194381495167,0.09720667930187826,0.12194839399006253,0.1752948738408791,-0.0473716970382652,0.1491428251813394,-0.008479780409299493,0.026794872114476957,-0.028866159616422322,-0.056901875130215926,-0.05111924767447859,-0.022640300474557486,0.22666488081712868,0.136662832166838,0.19639416258934517,0.07637337259461192,0.11467427164293457,0.03398992193676525,0.027285022073275312,0.032288662207390226,0.03225775555971307,0.033401950589605454,0.049649081997978864,0.03890049924320361,-0.026831569143684075,0.10524118902592809,0.16935825724119233,0.12209215982816524,-0.06399174490345548,0.12128028838387417,0.14294209193372012,-0.0460385614009312,-0.03195096446652077,-0.06625148652291905,0.11608639697219,0.076875760742099,-0.025421231354763086,-0.016953705514005737,-0.027607080440498265,0.04130363683729965,0.0742515802704177,-0.059749648697229873,0.070907293494586,0.07318296188003326,0.03952350575299456,0.03872283354894635,-0.046423516085816845,0.034175970227820124,0.03348384334020015,0.052017248916683904,0.01969533880152613,0.050193116320233495,0.06787892995018537,0.012263010377134193,0.057375450620364865,0.07214656353761377,0.07441551171193908,0.15005186613444302,0.2191477625130234,0.1441107002624121,0.24289741690182517,0.25792086277121523,0.22684264808795257,0.2623387739131465,0.2545256843408424,0.2239725360240834,-0.016088186937487158,-0.05337609405660074,-0.058692773193611186,-0.05626985631989377,-0.025550817453963412,-0.0566305491248096,-0.059729199359858244,-0.05937906281193128,-0.03330514198610669,-0.024058507233178792,-0.05815599849501785,-0.054217721727055294,-0.021831926444391882,-0.020596529646380573,-0.02296191130503482,-0.025690748309514896,-0.06142308814214714,-0.08647270942133728,-0.05736257153087761,0.023117700340863787,0.0046921487133524875,-0.002068257190443631,-0.07905093426476685,-0.04994060633430514,0.06462037540732528,0.06443426472083372,0.10483931811065937,0.07458353580286335,0.01537861405205666,0.00810984783883616,-0.0007844513536001596,-0.013902935819862593,-0.03629177436774465,0.14137822489084378,0.08359367691766427,0.04695450123752725,0.02296664120407664,0.05808120856368422)
shap_list[[6]]=c(-0.022692006536754145, 0.02057130724356897,-0.04847593248251181,-0.019668421411004767,-0.01003293814894835,-0.017894214670997603,0.005478693038530048,-0.015197733252641645,-0.0009020980789121435,0.1291986762815127,-0.003909389108991394,-0.01601270989535352,-0.019457013678522195,-0.003175218258837333,-0.02746503903864437,-0.020384535602559657,-0.04296209267042387,-0.015964785754645668,-0.02365296144040272,0.023437626126935972,-0.02545495963161011,0.011339311241682214,-0.023088962046189532,-0.025768881205113885,0.19261106584434934,-0.020871714583274515,0.0405533546623408,0.04099380156272227,0.01460788496246392,0.004951435335716537,0.07992682024840927,0.06058153612584997,0.09972464537677095,0.10254018879690821,0.09955143158448844,0.0372140553139134,-0.02141456258104852,-0.010331667612169734,0.1785988626422865,0.3002440338367772,0.14411887149836614,-0.003972825927454355,0.030273265215637477,-0.0058659017516692336,0.006430280507677695,0.0008980808219620256,0.012008258104558293,0.02604454453763679,0.0012730327392241265,0.009296435833839536,0.04557933694253675,-0.0025470347227627807,0.01463421307362742,0.021567175104450168,-0.009187420234475996,-0.008412552809477714,0.02715028700246798,-0.04622182250882489,-0.04949586384203382,0.004044254903969926,-0.04269093933592339,-0.016748143976631717,0.06484561509987212,0.06822753240119965,0.08133960609486665,0.0747468487544586,0.067138713794344,0.06061753880481757,-0.019562236473541085,-0.02558382049027602,-0.02517214915681699,0.07104216576959002,0.21623585112965935,0.38482661233417553,0.34609544842156165,0.12154712534957456,0.3858786578711307,0.052137803272607745,0.13707587557046147,0.13147246248363512,0.09654284515731446,0.07038236359898985,0.150144254189005,0.3858206058783115,0.22855987071106623,0.37547522979764963,-0.031016860010378622,-0.021493776900063318,-0.030005067973118513,-0.04207718369486453,-0.04362455011184592,-0.04369110381220677,-0.04199987912785656,-0.02930976158643547,-0.0407480748594377,0.16220536380698017,0.39456720422040076,0.31186583846854765,0.3986386131647695,0.08913810088924996,0.4014367075145881,0.39958592776869406,0.13623100126487506,0.144507483853205,0.0944735474540061,0.3978245476336669,0.009759506620408918,0.009386241514409638,0.00023155670386381974,0.04748055335424648,-0.0062982725047686285,0.0091252826053278,0.06874076158017359,-0.028262854390891837,-0.02751308415228794,-0.040266184756787615,-0.04091341977002596,0.03855645459984605,-0.03083971675280077,-0.028471912344853304,-0.02418690544848717,-0.0054870902646408735,-0.04073737433413412,-0.042173419151071014,-0.013964664599135545,-0.04083870029628424,0.20626492705184535,0.15702390167791067,0.0424037511517083,-0.01622685391274749,0.41784449581820077,0.6648723192070901,0.6168264647242652,0.5539914812747083,0.7137327537568289,0.6221199634755255,0.5467053794496752,0.0496843203340967,-0.03691296464785433,-0.03106617005071634,-0.027775871414465126,-0.00579080773807839,-0.03245365892266452,-0.03979198732798829,-0.02958339685828815,-0.017880122092583245,0.0004535664061279967,-0.037097280290477874,-0.03460058855658768,-0.0015186485683972423,0.0002995819227931829,-0.004182327635927892,-0.004874494235679545,-0.02931164824734357,-0.007000257696342815,-0.013356453828916013,0.027114749325875518,0.029878051408462877,0.07704552786517295,-0.020789596052505462,0.18123339783135228,0.10105010821314833,0.09537989288429363,0.19326459180234742,0.09565227273976111,0.031455774505914705,0.01339445512485234,0.021971932344071878,-0.007457001462860165,0.000985038792840152,0.030613163463150826,-0.023970100841032915,-0.014547755729457332,-0.045309713710808504,-0.03781177990970716)
shap_list[[7]]=c(0.19181079861880912, 0.15865463208538244,-0.03000249543723063,-0.02047360937187692,0.07562000597016957,-0.10076258655715728,-0.024587646517369718,-0.0357274840369096,-0.07294702004875823,-0.2527950147765554,-0.09467215457111652,-0.01977403854329895,-0.16371792075506422,-0.08738113539974877,0.04716159370948533,0.17608935375495807,0.4872594133737658,0.32696682958587814,-0.02618798002140114,0.2760773865405739,0.15852989519346283,0.22957531568280698,0.09180653518963741,-0.032031252212907,-0.2148705721512581,-0.07795976394086318,0.04014604410244134,-0.001814467265549042,-0.017926583995223323,-0.07316326798395277,-0.18411082532377263,-0.11402770835290339,-0.21622794492751707,-0.2089398498098439,-0.24053765738554045,-0.11391252703221537,0.36363072563530763,0.3616993467292485,0.1809245230825764,-0.004532705224946882,-0.011053956845156693,0.10967281731620111,0.3185400483972299,0.5669267892790901,0.2248020544528893,0.14746234205319728,0.2558457516435782,0.3055968225186787,0.1287007948355977,0.19396313202565735,0.24153308105263668,0.04477237026668999,0.23492736406648532,0.2856813722622278,0.028268950353874205,0.046499650848710855,0.7812830529451296,-0.023514777442358255,-0.02860098475966385,-0.10369101042039151,-0.015563962181581214,0.23311568317997555,-0.1217049905038108,-0.22813658484299063,-0.18457061913921577,-0.08339358568216337,-0.24082266854604978,-0.1398651351051864,-0.13382994264877945,-0.051609343016901135,-0.07265895936123676,-0.11650303977139416,-0.2732755299100543,-0.31025495243853396,-0.31698054891510674,-0.1918533664945647,-0.32076444031453866,-0.12580754421983106,-0.2188487777240552,-0.25389338644424025,-0.18444022006073385,-0.097109905568854,-0.2632646871109805,0.1804656981170342,0.09943730899232073,-0.01594406423744849,0.21416709314468776,0.30126053138765846,0.12423471962023833,0.36727226760468573,0.5145681603511377,0.5147191175061019,0.5227281162544574,0.516412176654346,0.4134287897624498,-0.26854707264993855,-0.34122752748322355,-0.30802081205997295,-0.29382460108735964,-0.2435544409819197,-0.33642926608777596,-0.32294302037883243,-0.2556544013000771,-0.2781019012814922,-0.2196786649684258,-0.3410366007961208,0.6350654959181812,-0.012996239404747577,-0.0952969257933647,0.08171963507909683,0.3376009196616351,0.6287052971133422,-0.16768850079954428,0.27982255874733536,0.2811242872571119,0.11737887505593464,0.11240425224180432,-0.004026964857866401,0.06493599175153233,0.24164457341040607,0.2592035458015612,0.2978086548057333,0.12648313308340298,0.2524268068744589,0.05356975012829594,0.14111051552499151,-0.1932869329902687,-0.036603577855295714,0.11530122727523885,0.01949817798315558,-0.19984454508815186,-0.2020798234995294,-0.17853925431012135,-0.25369309547841157,-0.13296885589431187,-0.17374786655889607,-0.2320383000735859,-0.06633099936193779,-0.17117340635977285,-0.15524751016785368,-0.135793984239497,-0.26302781985435136,-0.17818727788586838,-0.142812706784651,-0.1485613958161702,-0.07310436387956697,-0.2609479633913318,-0.16684841784466847,-0.20022996486745698,-0.17696766413905696,-0.24918011338947124,-0.26945927577172746,-0.2128146471876871,-0.08183499855061642,0.2660619807904526,0.0796166580650029,-0.2022852737889496,0.1305002733593754,0.2045043051148131,-0.014950762136818814,-0.19017199089939443,-0.21312404397064252,-0.15214078724791938,-0.2669916102364746,-0.1438552824169366,-0.0502127034787915,-0.037058072737211685,-0.020124921956257952,-0.0031568743739470826,0.051289413222516025,-0.01683840109401792,-0.05670494316800808,0.15922573067933393,0.01420216500659008,0.2226346348242896)
shap = do.call('cbind', shap_list)
baseline = 0.34877992920267714
rate=c(0.33317366813542126, 0.8118957111729332,0.5131387276191456,0.6470468634104602,0.49194675615598965,0.1777739484191991,0.4096745589778536,0.28424024006674675,0.2999252197956508,2.259122863497364,0.2476342322939093,0.321948835732086,0.15062793582962422,0.29050868464828394,0.411138165032539,0.23087886049031386,0.3797349367454177,0.43530104306742984,0.36424177013296505,1.3192556392763377,0.4069949516436526,1.1771584313962922,0.25782655395052145,0.31778980453417766,0.7748849589250807,0.13336020016301234,0.43618863246456163,0.4947276201090121,0.2557335647952918,0.1735344015515021,0.6088628664481057,0.5069580290010295,0.8429191051081951,1.0355043749941386,0.7707667078555427,0.36295367196457173,0.5709364470510354,0.5201529496529028,0.9032239442548397,1.4445233268122941,0.7693572566397915,0.24610186111458918,1.0260901077933104,0.658302295148281,0.6341845925087229,0.5456623234905845,0.7415472888086765,0.964231947254854,0.4845731605892527,0.6641107900376287,0.6341481194365486,0.3542533421545083,0.6729872169023248,0.8723901052680265,0.29806164643890726,0.3438146164757877,2.1791920172868364,0.44495914192103747,0.5463337529940265,0.49731894994354525,0.5125479701415288,0.27401234584651285,0.5242951317421715,0.4384578238820436,0.5681805008400481,0.5967817291966457,0.423901722193065,0.4621160996459475,0.35371194241693454,0.23259583075631682,0.15068325519685197,0.562833013031505,1.611504804292362,3.589778505106047,3.430192651324274,0.8575610782761439,3.6639789889701,0.39753339784259933,0.8272753000549967,0.7958755545236975,0.7574770650413355,0.5563237684544244,0.941453339971809,1.7856224683455717,0.9458452630244886,1.4365607982930746,0.7745338965595282,1.0512333123518067,0.37805569127048794,0.3214756899328041,0.4302991995479663,0.4299144993401444,0.445992033872389,0.5114894693857741,0.36544218493195,1.019616111085458,3.5590861105497718,3.0969736281046627,3.6422882762242503,0.6035196354869691,3.6276740049337826,3.6781416709051955,0.9338904967198247,0.90565328241773,0.6566030232554537,3.5795035173886243,0.9669629836238678,0.33256508220815123,0.18666165684212133,0.6482652630640794,0.5838517874529425,0.9532998015504711,0.5727150142123594,0.782962995809759,0.8003584357960246,0.4447300182262838,0.43374186985586366,0.5958471912116456,0.15956281862100152,0.28932707655343054,0.39556924885712746,0.5439101192145545,0.5077607663642889,0.7000453771042671,0.2742712434954733,0.5717278954219362,0.5036622908694541,0.5823491162139821,1.0712627963357841,1.2032350460783368,1.0557172043865521,1.8392714609473673,1.9033763981382243,1.658163189263278,2.061033785897967,1.9150812508035995,1.639577104761377,0.578925757620686,0.3165055168754901,0.437445088998453,0.5442192359347463,1.4376159207543575,0.4038115310815438,0.34265254351238417,0.4814890438172115,0.434039580204776,1.5975487058468412,0.37777498003120485,0.34037541208925176,1.5113411569812838,1.4864415218418066,1.472514944041814,1.413995313940099,0.5956273538755071,0.8480010892471199,0.6661997977347437,0.8291633026930461,1.1294108199795305,2.3249450411996033,0.4577875844648712,1.691167096105476,0.4484264507396481,0.474871058777427,0.8083718608103778,0.5684449003718621,0.47409946362163485,0.2992288352115948,0.5742419979166863,0.14580949322045406,0.4054972729537491,0.8097068739287171,0.5112865218264875,0.594539064608106,0.3082463486870081,0.6737901708390648)
rate_lwr=c(0.053553206176999824, 0.03649655227770232,0.1194326676594965,0.173294886467965,0.09439620211880972,0.029447138323577426,0.05651838706424139,0.07177021618140217,0.049070953301694475,0.19488996430309352,0.047781328694964376,0.07651522973821806,0.01252898392357299,0.054500831174074116,0.019892151775977862,0.00975386302553255,0.07824730816908759,0.04616855779237958,0.037246122447433694,0.28720994412886824,0.04041828477607812,0.18110896627808365,0.04532680776668907,0.03399628006054439,0.13601259169715954,0.006225942414671726,0.04555509353680412,0.02757572261491603,0.032669231288488476,0.015173735678514266,0.17847345574015644,0.18984895920513245,0.2707100200643295,0.048747520283309365,0.28318015501377825,0.02861161495144071,0.050104492438690196,0.08427681093440767,0.18555505032489594,0.18124767555457189,0.10660439496121127,0.01958682195335487,0.28781547797661294,0.09465929816764623,0.1500689927055927,0.1708525426738902,0.2639368633579762,0.2227761192151034,0.013274092818197358,0.17156416607951833,0.02147994310246576,0.09310533254990833,0.20697090254873465,0.2509598188521934,0.0901239753961181,0.0857759481854091,0.33322205661857374,0.06401510464297788,0.1439828779142711,0.016891228156934557,0.10796898130031735,0.019736569630954104,0.13962110891718987,0.12363690102927871,0.2439032392346699,0.17536003395621938,0.11964441833231793,0.17885517562563588,0.008816566949639226,0.016685399763177955,0.00535648413066106,0.24375078490914687,0.0697567151631166,1.5709352284224414,1.4510591082292232,0.33497601048033876,1.7279441908620063,0.02872371663384904,0.0406920654901369,0.2162768759264841,0.2718831109377913,0.20240501254137766,0.2509983041270229,0.3132755810968591,0.10857733818388365,0.1845580019112356,0.09802122819447767,0.14151386771959293,0.018437747025994933,0.06103411237323797,0.1446848343575901,0.13080356478485117,0.1623056965963972,0.09066462186856339,0.04186227291892769,0.18705528520924528,1.6941448639467929,0.852805592519648,1.7616114260278248,0.15871967223070702,1.71324975893445,1.6802968128250164,0.3378221362834813,0.26954802460402755,0.24659765590458227,1.6517246005690376,0.16679869994124366,0.04645459072520858,0.02153651331763934,0.04658535787950885,0.09720906400130241,0.20910523257889796,0.048165346770157214,0.21214608106479296,0.23959744800558008,0.13892107509334675,0.15018458128532208,0.10386734144208526,0.01736837622744908,0.039288385334469406,0.03589481008353662,0.09103996749655452,0.18409115812149657,0.16176373365413196,0.017715436461771372,0.22184708573660428,0.03004452605898289,0.09479887332265352,0.18573458542944704,0.04331336378583783,0.038277260766211296,0.48332091507157915,0.5495828745398053,0.31496261722646435,0.5228627291793575,0.4757744895207844,0.3585637775671683,0.11083323791301464,0.0524476017557009,0.13544983098340432,0.10289819251299957,0.42261266883776455,0.1227866223967623,0.1000449184652395,0.1540666017076756,0.0771684501942283,0.2925551490492073,0.1287372707782465,0.11627144857465621,0.5157178172562907,0.4193274040063608,0.4288466335922517,0.49636320946963497,0.1471288708007195,0.23104386538308497,0.1448925165213457,0.026280683209214728,0.16279860117300435,0.46022890178366715,0.11292041291253363,0.2789987899990502,0.0588450284018423,0.055635510220768125,0.13575253715644667,0.08578147550412896,0.03941501462291619,0.02516555234228285,0.025436135151368444,0.011224011905109965,0.09323389435186696,0.04007774860906149,0.09721284012970599,0.03936546322375961,0.06969302712872344,0.09910545760538325)
rate_upr=c(0.66018155428053, 2.183322590431174,1.014115633922121,1.2728736704447874,0.9678121750521455,0.3850822927089245,0.9039574256329554,0.5104539283373836,0.5661725515289349,4.610387487413099,0.5005869853955641,0.6000150269377581,0.32595170434681625,0.5752517243055074,1.1002399294462792,0.6385613060613433,0.7614529503663898,1.020410257761232,0.8697338300679001,2.6307852751599814,0.9609716605980431,2.445773251621895,0.5343636896904236,0.7194415641743696,1.6414420706113229,0.30871605819199227,1.14707230680837,1.3988588746921917,0.594341811722876,0.39794570178505995,1.1165068932812572,0.8660684895979296,1.6521673491680395,2.4697248764347246,1.3648440590111535,0.7561687192182082,1.3130664005790282,1.2222199772480278,1.7936233598044993,2.96958570574242,1.8321629951791518,0.6124306260482238,2.067854451428397,1.5650512665823695,1.2953943569004494,1.0130428300704377,1.4231304187494658,1.7955847744063669,1.28240412620674,1.341366048430556,1.6320658501507521,0.6910565351511994,1.2458583507392242,1.598264479779938,0.5497925856296751,0.6397736604921193,4.111222922860786,0.9160100487052456,1.1554521662484771,1.5150313308377177,1.1132919731410325,0.6606788444673157,0.939444427380568,0.7989932295953708,0.9725016305673762,1.1966348223529593,0.7979456377200604,0.7742021623133268,0.993597922035911,0.6351456530937861,0.37666543320583945,1.005031532286511,3.678892429074415,5.600556785870929,5.5984715752607785,1.5765092546020418,5.7309088074707395,0.9555053456544363,2.1668369032758754,1.52587256497456,1.3783689464671303,1.0311104671745204,1.829571719102833,3.63603960443049,2.10126460222487,3.0933386169512325,1.7508197537115544,2.260767250784643,0.9615453994859469,0.668159591504017,0.7736085677432651,0.7614320324185143,0.8042390032097531,1.2347944360362928,0.8082381486504018,1.8431851133916242,5.691224224634135,5.229220590460134,5.904484104612013,1.1177374989798057,5.733330755220575,5.635140886150465,1.6721992008186686,1.649011050242214,1.2939857912791097,5.628581962532711,2.328736555269088,0.7091431277903304,0.4293164783312329,1.5881841075682204,1.523721797383498,2.2078459607219223,1.191438004955338,1.4104306853784923,1.4821810422545716,0.7882942249404146,0.7821720818942841,1.2070882894138597,0.354449716574925,0.6348197945138646,0.9795095054073669,1.219666259342246,0.8928658128662652,1.4606335660946412,0.6473331617783971,1.0683547451181823,1.2325178750821735,1.1673132632576975,2.2715386658244423,2.8039615603636165,2.5126671807685357,3.580350021919201,3.570757634630004,3.202709874306389,3.9548284562055422,3.473544129767839,3.1846254826668114,1.29226622329905,0.6385886193832955,0.8057555645147179,1.0787032823472118,2.478732895625568,0.7351124724524518,0.6234555670335773,0.9016587863409135,0.9196104794706536,2.9882750355349508,0.6604278603609087,0.6238848515812483,2.6396993643010576,2.546879981440185,2.6174911540720034,2.5336049623124537,1.2097572302577115,1.7883065778083995,1.3493302033214083,2.0633182014319287,2.6465046656446067,4.223844402444017,0.8532586073201838,3.3514953046824507,0.9158463891453268,0.9740408997326093,1.6933228157260993,1.1380669943864756,1.117957849625339,0.7108807053767716,1.5211944732486622,0.3386056468456024,0.8177703721088543,1.9439210662164386,1.007936854725044,1.564421495837821,0.6504455973608795,1.3815482515377489)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.834541775289008,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,12.762457973341409,17.34412134875883,21.211041052192133,21.868567692284742,10.092919561981976,12.78599643443742,13.509885309719447,13.644381033687072,20.953699984613685,10.92901570011212,17.481163012849535,19.543842461257075,12.690342590081567,15.275304079953862,11.610334918074667,10.928438777046042,19.116662982107215,19.555450852647265,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,12.762457973341409,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.810905393300043,17.601246343925673,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,10.31349648091274,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.109881006140222,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,21.561787314255916,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.579496325537615,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,21.04119030911618,11.566150303520583,10.647178292822375,13.556073343039289,20.792329617276543,21.04119030911618,12.543329772332134,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,10.74007339597134,11.566150303520583,23.096662907295563,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.26749625621469,11.754396453828296,10.15963284744126,12.685450981781905,19.64726903273955,19.336662977971898,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,23.096662907295563,10.647178292822375,14.172329741711991,17.990150182769337,22.62499624949477,21.1276885853318,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,12.89213279607875,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.053674805227923277, -0.06795535597068586,-0.07223634362159513,-0.07222410376589036,0.04611770014005203,0.046252705464794805,0.047350897349912546,0.043974328112720576,0.04652395138819408,0.04621106459740574,0.0473575183621556,0.046548016703086864,0.047326493723150384,0.04744671863489181,-0.06709938192095931,-0.06526202817252388,-0.07250120334763166,-0.07359563026948444,-0.055485516243639454,-0.05493872119641263,-0.05499981231094642,-0.05496543100042107,-0.055081965649557474,-0.0554089365750976,-0.09377571726149468,-0.08360704048815099,-0.08410118870197753,-0.08360391434776913,-0.08381521360428702,-0.08457546185379573,0.1019086032894763,0.09872581089763041,0.10259799870442296,0.10294020370588408,0.10304120225260968,0.09958378166112504,-0.056489247446229754,-0.05198116055609639,-0.081682358970753,-0.08438461969261511,-0.0846996231638336,0.022574285611190827,0.008261429630766695,-0.04794843812590508,0.031991077996996284,0.022640242537572262,0.015661525715865637,0.007384260128928571,0.022489633674198282,0.022595919506895077,0.03465541834112906,0.0386147137347161,0.0272390307939481,0.016222501909695302,0.027374295284629865,0.03156161706494547,-0.055355519842871646,-0.07251277331197742,-0.07203553318855462,-0.07274798824326718,-0.07226400799341909,-0.056349251402106094,0.10032145071336773,0.10626547997882453,0.10544356819600491,0.10022901685309737,0.10626547997882453,0.10236550749817026,-0.06422764296848145,-0.06411581448589038,-0.064128912868281,0.10105010652895814,0.10479832577211819,0.1040770119040479,0.10485467487093565,0.10346262542805952,0.10414637912071942,0.10364330015642628,0.10479519518030966,0.10469599395800795,0.10203192984660903,0.10064407097630096,0.10477622882587351,-0.07548486054384818,-0.07599011481681418,-0.07613034113405176,-0.0618455335236989,-0.06190448107490105,-0.06203371060103502,-0.07262607879517252,-0.0719165596470614,-0.07180056681935969,-0.07205119806129097,-0.07224555444174229,-0.07324471858598845,0.10893072912358298,0.10895042396965125,0.10879268630845783,0.10873489277346814,0.10666620607317338,0.10899688412416209,0.10897014671826828,0.10779429793518315,0.10738206104336624,0.10644443230089695,0.10887719277539913,-0.06589365517918896,0.056856874118712146,0.05695391787024916,0.034869224156327865,-0.06445140028062624,-0.06399161936958225,0.10071722889430447,-0.0670233934372524,-0.06746408013778811,-0.06768740655827625,-0.06781282338908644,0.07622924372787727,-0.0795174635492598,-0.07903359181456646,-0.0791744870138947,-0.060771187571217626,-0.06947346275921566,-0.06945235096731986,-0.06962482588096146,-0.06972408780552533,-0.09135451783432376,-0.09067496236372408,-0.06285950970024272,-0.061687730188226965,-0.09427394525660573,-0.09367345445346388,-0.09360433975166853,-0.09472293110242688,-0.09255160361752031,-0.09355790926081152,-0.09464829510192978,0.08388938884560114,0.05179733278685487,0.05447538447263475,0.054386077929786704,0.05569875815047404,0.054901837902218795,0.05520020680726281,0.05451071347235866,0.05299616729717891,0.05559619770794667,0.05522018552241949,0.05492337258820553,0.055138110503854344,0.054622561636606795,0.05572023745141359,0.05557381731569345,0.0514881080803601,0.04016668289636157,0.04189119112252975,0.042536670518074846,0.04010513032191819,0.04171299159891471,0.041673463180311565,0.09757729231321727,-0.09322180675094789,-0.09326466875096097,-0.09395936574486431,-0.09304977946607608,0.06186758104388432,0.061744364563146956,0.04248756398762119,0.04228424898262684,0.04229086739042656,-0.06812015922801548,-0.06842404972274956,-0.060855423356850284,-0.06123170743438844,-0.06087533233745025)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.01826626642270292, 0.04254197691211043,0.04946174568898022,0.04944192114761769,0.009994774921117859,0.010060041962284142,0.010651455159222252,0.00884885388968656,0.010205280399503639,0.010036934945487639,0.010654964515861778,0.010217871568353874,0.010638015534019387,0.010702511871318673,0.041132172773494534,0.03837056796971888,0.08017714096600154,0.08546480173014714,0.019789050732166996,0.019325613360777878,0.019379586342675396,0.019347914898305844,0.019447548275042793,0.019723603343639137,-0.20514875485540138,0.11896562370940836,0.1206674613717583,0.11897289273657337,0.1196877254133994,0.12228670617204516,-0.02289090771017607,-0.02116929094144017,-0.023261981246956002,-0.02344633206942828,-0.023500712754104095,-0.02162941335305731,0.024575692710801074,0.020536634697956326,-0.1431093927108947,-0.15665663215958167,-0.15805161478224328,0.012045221985237105,0.012420800053017137,0.014101297351798645,0.010919503724016403,0.012128713067730978,0.011975551464612636,0.012367848908458625,0.011937272651417561,0.012072532092052854,0.010853225272970394,0.010421958356950011,0.011377875009486279,0.011962395715838677,0.01151259229128129,0.011054777463968938,0.023257554754842667,0.0499180969220758,0.049134833303930946,0.05030222875792913,0.049512859911195924,0.024418844041622614,-0.02215878182794944,-0.025597605029961442,-0.025129394060564976,-0.02211213097714834,-0.02559760502996152,-0.02334569302873136,0.034002711049184106,0.03386202502117579,0.033878366080196044,-0.02243246091513941,-0.02449969608008276,-0.02409226649984579,-0.024530868918674394,-0.023756603034024302,-0.024130282364808006,-0.02385513308155255,-0.02449791252356783,-0.02444305055891682,-0.022968145141759523,-0.022213412573613412,-0.02448743590668625,-0.1112724028879378,-0.11306130839242813,-0.11355660140709134,0.03102814227236691,0.031098175532568537,0.0312519083319985,0.08030638444438716,0.0784535114353899,0.07815261694082729,0.07880459615344805,0.07942936349197778,0.08215189347585773,-0.027185475916988302,-0.02719707402338945,-0.027104040017372117,-0.02707002217510407,-0.025844514721533048,-0.027224499816031648,-0.027208710938768216,-0.026515342889042247,-0.026270079571693174,-0.025717484026672302,-0.027153812276525843,0.061255453248096926,0.00205762563398442,0.0020659769576430445,0.01101262960093168,0.056354949239341624,0.05540297492143326,-0.022246761293922338,0.041026937475452094,0.04167241400987433,0.041999959293683414,0.04218413774211843,-0.008682981335912917,0.10487560628007321,0.10336707924547384,0.10380517350390768,0.03146511183299932,0.04497324832251847,0.04495495896725136,0.045210450144818996,0.04536291893758592,-0.1924818398912884,-0.18910173418230694,0.034509935116521014,0.030804663497715795,-0.2079750558124732,-0.204836801674273,-0.20446237563349695,-0.21033437627471296,-0.19899559366432795,-0.20422287440403816,-0.20994291646136806,-0.012934047563076354,0.02496904789839159,0.028373006404199447,0.028263204009591227,0.029931631698878594,0.028918196886794596,0.029296795629458066,0.028416530748380363,0.02653101438542709,0.02980061016226799,0.029321847160408993,0.028945100311163242,0.029219105315385057,0.028555090172581662,0.02995893606186045,0.02977229105183508,0.024617034434114397,0.010826424632328002,0.012726066282039185,0.01322099372414855,0.010689953205008132,0.012616617121912598,0.012366189233398186,-0.020550076083960134,-0.2022669485048039,-0.20250527318906908,-0.20609978565832596,-0.20138082765344165,-0.0004031188283016312,-0.0004012207246540335,0.009842011917910894,0.009730606036923481,0.009734169364633555,0.04266386889820632,0.043116943779830864,0.029796452755058038,0.03023699681342723,0.029819506834912763)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(18.205000000000002, 14.895000000000001,9.438,9.438,12.725,6.2895,9.438,9.438,6.2895,3.0900000000000007,6.2895,9.438,1.2905000000000002,6.2895,12.725,21.735000000000003,36.2987775,31.0,9.438,14.895000000000001,18.205000000000002,14.895000000000001,18.205000000000002,9.438,3.0900000000000007,9.438,14.895000000000001,12.725,12.725,9.438,3.0900000000000007,6.2895,2.1900000000000004,1.2905000000000002,1.2905000000000002,4.4665,25.565000000000005,25.565000000000005,14.895000000000001,9.438,9.438,18.205000000000002,18.205000000000002,31.0,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725,18.205000000000002,18.205000000000002,12.725,12.725,25.565000000000005,9.438,9.438,6.2895,9.438,25.565000000000005,6.2895,0.4535,3.0900000000000007,6.2895,0.06885,4.4665,4.4665,9.438,9.438,6.2895,0.4535,1.2905000000000002,0.4535,3.0900000000000007,0.4535,3.0900000000000007,1.2905000000000002,1.2905000000000002,3.0900000000000007,6.2895,1.2905000000000002,14.895000000000001,12.725,9.438,18.205000000000002,18.205000000000002,18.205000000000002,31.0,36.2987775,36.2987775,36.2987775,36.2987775,36.2987775,1.2905000000000002,0.06885,0.4535,1.2905000000000002,1.2905000000000002,0.06885,0.4535,1.2905000000000002,0.4535,2.1900000000000004,0.06885,36.2987775,9.438,6.2895,12.725,25.565000000000005,36.2987775,3.0900000000000007,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,18.205000000000002,25.565000000000005,25.565000000000005,21.735000000000003,14.895000000000001,18.205000000000002,14.895000000000001,14.895000000000001,3.0900000000000007,9.438,12.725,9.438,3.0900000000000007,3.0900000000000007,4.4665,1.2905000000000002,6.2895,4.4665,2.1900000000000004,6.2895,3.0900000000000007,4.4665,4.4665,0.4535,2.1900000000000004,4.4665,4.4665,6.2895,1.2905000000000002,3.0900000000000007,1.2905000000000002,4.4665,1.2905000000000002,0.4535,3.0900000000000007,6.2895,18.205000000000002,14.895000000000001,1.2905000000000002,14.895000000000001,18.205000000000002,9.438,4.4665,2.1900000000000004,4.4665,1.2905000000000002,4.4665,9.438,9.438,9.438,12.725,12.725,9.438,9.438,18.205000000000002,12.725,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(5.0, 2.0,1.0,4.0,0.0,3.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.033178211340078596, 0.06280902415930348,-0.010696562385165951,0.04430386456346867,0.40865944851491376,0.5053496382951899,0.38595888883087753,-0.02325085687868196,0.41582145478513755,0.2622337781658063,-0.0457202328479026,0.5572931750680827,0.6086769661241646,0.25474404511737414,0.15141994451197172,0.03394105516856007,0.2584305748246599,0.06646939413961854,0.012187773738633717,0.0740237176572489,0.0716988599180773,0.11147230259923219,-0.03665869318403184,0.019703375954124094,0.23222386542458623,0.27442120883701604,0.09998721254048525,0.026804851310813334,0.036273659844010375,0.08788223253237953,-0.38139255416150153,-0.026441015564670895,-0.3071697557000364,-0.133453316392008,-0.28528653077526717,-0.16937578064375955,0.01743254730223735,0.19040856941830356,-0.010353017633469918,0.13929578811850987,0.10898227299037079,-0.007827372012421983,0.06846766131447295,0.033025614161540165,-0.002798981112714403,0.036185338860590235,0.028796536632552567,0.05279486472680249,0.12787102163747732,0.03123258160578731,0.016269702487720257,0.018608766327165124,0.05325666462075748,0.04587485665503182,0.026948961144459133,0.05986349163493615,0.13860879127812512,-0.0350323492579395,-0.03802364403930041,-0.056572196509441286,-0.022463999930773956,0.34443821974835,-0.02553000766704789,-0.05790311785925589,-0.37366912700590127,-0.023689737110424297,-0.07983941017092507,-0.03864741884414775,0.19518021805773678,0.13215564288226295,0.0505984825634076,-0.2267147063824852,-0.0362506172340206,-0.143473506704835,-0.13173810412140233,-0.12036499208697808,0.13191426993978655,-0.1690480114014058,-0.20087936999929387,-0.3519624902976027,-0.0947331878075644,-0.026801862701671106,-0.19301639081876434,0.15712895787453815,0.0749287422612739,0.17217291822922337,0.0009051605350420149,-0.0044652646295195485,0.001222435837115103,0.5461939697653506,0.3132735396701709,0.48508711632560986,0.3698491353637269,0.2099440924537808,0.3041746434315935,-0.15562922279768854,0.13129521120149606,-0.05993951594910016,-0.26036404919456446,-0.26552522244822496,0.14624200304384707,-0.18552912816747819,-0.3258638411290136,-0.16652589012891414,-0.4116729171250011,0.18721017549322072,0.6195997047699271,0.03131329873785233,0.05926785885038532,-0.013998534380401228,0.7406981980956105,0.6336617789399717,-0.1855383442131784,-0.005546838070220324,0.03128873344507142,0.04634052341109309,0.005478796775852619,-0.016134078891598305,0.0980877378112779,0.13436485148961055,0.05365927096425791,0.026980400459409422,0.002618181595703183,-0.01283298498963394,0.006439287109117348,-0.005983722262644297,-0.008638622679240326,-0.026093267272301934,0.08632167251116388,0.11527884971596063,0.1532599379467633,0.3678369224819565,0.2547519422096369,0.19475850592971905,0.3321381662343823,0.2485764101268235,0.20227475232729597,-0.035964188580967296,-0.06626782113147096,-0.025203429329848457,-0.015060747170588421,-0.07633811989794916,0.14646394962747306,-0.03925854591582456,0.14778288793001654,-0.0043763984510444024,0.031129071670946796,-0.088280618276645,-0.12006090889776622,-0.013568414544230849,-0.026272498924451743,-0.005801920425954134,0.05685171028935572,-0.047074842574159836,-0.007353190054347649,0.011773556312983284,0.1424266605010993,0.05439018957144397,0.046281636467196165,0.23712385813547546,-0.057873672064777795,-0.04321952512467683,-0.017148023201777864,0.2274052099040825,-0.04617404910633193,-0.05731694592700677,-0.01667923798119325,0.005437181071991018,0.025502028117345657,-0.007533469973703074,0.14876651086648404,0.022364958827040468,0.0025175078564966193,-0.011756591243304134,0.013278362942629681)
shap_list[[2]]=c(0.09850655713904977, 0.24647449172874808,0.25071445820818655,0.4216495985443546,0.42775132502219976,0.5477348273334114,0.3772672099426806,-0.021251498320630134,0.39889636131983924,0.4401106040430081,-0.015939308259363936,0.5646088996963337,0.6193842916319587,0.27724746457731336,0.2801302030236281,0.11231976810929528,-0.12146676738915899,-0.09815065412057196,0.057558247302091324,0.18119747136236075,0.01206103965122227,0.17118111528825583,0.08405807019895664,0.07735722754019543,0.398589215690787,-0.5487869892586683,-0.1478895739297189,-0.060123981898865884,-0.09353188046272114,-0.14101534996854093,-0.06534814244309688,-0.03562104115216636,0.18165543530868244,0.012658126065576036,0.18765642923971232,-0.050724476562345064,-0.10252266276643392,0.2038790023859535,0.28413596630331445,0.3248678914276244,0.3261173932240007,0.07507629494539604,0.1379181341229425,0.10399282907430876,0.057084481582967694,0.10358214328642154,0.08673411935686676,0.1199390753840397,0.15999938328708982,0.09551094369937885,0.24424778394730637,0.13725115905574314,0.16669699053494838,0.10677138500132101,0.1268603007895726,0.12567808193512797,0.1609580362745412,0.17468891782442963,0.1713314287131726,0.3243885977094873,0.12509372061068602,-0.08857066252779228,-0.03431096445746532,0.14990066224325396,-0.029787210822598907,-0.03396094099504388,0.14298900461433003,-0.03201504666926903,-0.41591987491631255,-0.2449852512109873,-0.1273817087789486,-0.03126493797892217,0.10775815602992846,-0.044517773632964656,-0.045858409599046066,-0.056588841911041673,0.1348961098411659,-0.030994384452366883,0.16644295735710896,-0.04287390657727202,-0.0436054615062244,-0.03378770001080495,0.03993680859831511,0.5241149018367902,0.42862886337421263,0.5905557893357853,-0.0859755712711317,-0.06377018818456238,-0.0674881093248976,0.35617167093264746,0.14726939004447034,0.2969008760897256,0.20019696984175328,-0.08812972352675412,-0.12194509679091624,0.11180867492115952,0.21697986443120104,-0.048409367231425374,-0.08407902289649914,0.11725405629533504,0.15921079830879653,0.028381165794144812,-0.004807460835785872,0.1711876597445983,-0.08791602031192042,0.16497067383372052,0.5948209166471997,0.17633141712419192,0.2711795091467981,0.16491594462000148,0.6964294919351751,0.6005436162506841,0.32002455410335395,0.09662139133255616,0.195973362791223,0.2251678643185456,0.13769551058850946,-0.030642844621147112,-0.11685024926276036,-0.16727770253751356,-0.09242040981396725,0.08696553323194502,0.1119200315980195,0.10141385741911407,0.2062815540908346,0.10276783865105195,0.3157336003968121,0.24463066808302328,0.4793365649603583,0.06283121092538965,0.1802110281044541,0.2318261377385857,0.17467386470355614,0.1931923559964656,0.26062406555903916,0.17978999225065614,0.20321662466352575,0.06902501228946337,-0.053122341415938724,-0.047668250363186365,0.0041371435216525,0.010681094998671462,0.23026370632303683,-0.07504927017756655,0.22994809660900575,-0.015455600094002596,0.17244805008103048,-0.0683600258051685,-0.0840156565897399,-0.014516243888115178,0.008399149695865952,0.023643483248262445,0.20713544655561797,-0.07223058046654864,-0.02446122254262347,-0.0034069473730378393,0.18556763175807017,0.045570380640315565,-0.0020864193795779975,0.2136293295874116,0.07061961925969862,0.055108506724537085,0.04991602974699571,0.3585089659540492,-0.021707430985076274,0.2216015109332867,0.1599022163891486,0.26132005162754857,0.1482593487315151,0.09880798506363085,0.5391715848530275,0.26430009700970747,-0.07742593133642024,-0.0762787165131632,-0.08875281245491282)
shap_list[[3]]=c(0.18754509753350562, 0.5892506845990314,-0.21675875969000233,-0.16758593656642387,0.06753812763960115,0.1209910631795937,1.0235606106618063,-0.0395068544281961,1.0434892694264197,2.100976872213033,0.061563076409533346,0.0716643705355479,-0.06162964994791247,0.80189113375896,-0.07341189120189345,-0.12305036154584506,0.21034567112920022,0.09194922664182052,-0.07206133072882263,-0.00033579950310428394,-0.08528742003747079,0.02737770571121273,0.17552296311883794,-0.08955896507889843,-0.04469187600306434,0.5969756221111521,-0.010709064258724862,-0.014438578908047624,-0.031176653237259967,-0.016155290404932233,0.3694841277041589,0.09699845244702761,-0.06839791752017636,0.03174149956793265,-0.0787663424105395,-0.004727955525586986,0.11468704088010272,0.3161415948222998,-0.21384537874917062,-0.06818993840563298,-0.16382035576930218,-0.09406212378044798,0.04483123900085003,0.14821698816064027,-0.006878292292639077,-0.02319471595738186,0.02876792233168511,0.04813067118786489,0.02696714167423036,-0.009334754133758956,-0.25955195142482934,-0.05223942333014422,-0.04929535889982857,0.027682262320798557,-0.050686838491402424,-0.04105393409001974,0.17712377650575903,-0.09852095824743042,-0.1941683882488483,0.5757415728785109,-0.08021692775384262,0.31620827986225064,0.1077377978354211,0.8100615435075927,0.543716978133589,0.11441026930725087,0.8364640714647861,0.13178614962005464,-0.06166196899328507,0.05728867652690885,-0.006961602849280682,0.4242722962818893,-0.11692326115904149,2.164787330095774,1.5955402392313585,-0.07634783919754014,1.0091002773045004,-0.2913941296367087,-1.1068575724810126,-0.14617814696354756,-0.07426222462255191,0.11101470200571124,-0.08569892498459027,0.05280279271881838,-0.09731912003248977,0.07760540890211688,-0.038426531457722755,0.00017782404641531943,-0.12982472039061477,0.7183040783880122,0.31744914840293914,0.6173339419202114,0.46803031742115236,0.15750553929364708,0.23865539877357006,-0.08467541569474388,1.0161068786555618,1.7314309293532715,2.1595492812267345,0.8949819444626717,1.023204517667488,2.1136266538075033,-0.11788478264244269,-0.07586593415522964,0.39230562848215056,1.0151906816310445,0.881170825242329,-0.0520395016564759,-0.02316887625145067,-0.14073136804496159,1.0523129318018443,0.9015691537961256,-0.14493512311191373,-0.06342841314631428,-0.11895408197790522,-0.12556431670105,-0.09699352651245811,0.06653089807896008,-0.04500496118505849,0.16132267137390835,-0.04570477049822408,0.18703438629016328,-0.0753215517437206,-0.08293486640913973,0.2674241953217904,-0.07031002902789385,-0.20126481222627815,-0.23901585408365406,-0.1276859336564572,0.07273851986289259,0.04485070557537023,0.2625192469516029,0.2637619104364951,0.2543050628338369,0.20711701405315971,0.2707922445190139,0.25517716706582344,0.12152369388688437,-0.18240255695414107,-0.06196439982975102,-0.04576285294537432,1.0582018150362014,-0.01701608662947127,-0.2092602507654341,-0.017334215062872634,0.11915872893800837,1.6758966185601314,-0.18985594294556637,-0.171350682924761,0.4164179109976985,1.024860454429408,1.1193264857174092,1.3891672355485438,-0.09262526883458615,-0.001782725388502129,0.026436291123096676,0.1428287579116714,0.09827451105775968,0.8121130866136554,-0.08818265496700538,0.5486082143938189,-0.2122053408584781,-0.2200810352996495,-0.044251176118733894,-0.21313575725692394,0.1480793312331812,-0.08122578288253562,-0.011717785401411553,-0.04900555823032361,-0.045260094051141495,-0.08432702830319713,-0.21578193469154297,0.10336857468542907,-0.025696905155743122,-0.03829672274302976)
shap_list[[4]]=c(-0.14104800568228607, 0.1765740952099282,0.1380164815037924,0.3808760474588074,0.6457673676800846,0.9073120947978153,-0.26948039059615114,0.02107831256485369,-0.15015291784476403,0.4863288845633399,-0.06975768518931286,0.7149297537527047,0.43204285625536937,-0.13400724437557918,0.15833625028363776,-0.0308506358409108,-0.10123045286751763,-0.08067424420124258,0.09241092508212254,0.13643353452835819,0.16057509426312722,0.13513208795327394,-0.19808599523583795,0.10978308170285599,0.03505879961146039,-0.0918633599788068,0.13880791440517634,-0.002716573364810155,0.05263339120762122,0.12597504041606183,-0.20523210545807188,-0.05282084074671768,0.8006058684266224,0.09861947189429407,0.6692459466054923,0.05818210187284626,-0.06730700490215247,-0.15291511078542072,0.2451611624984557,0.09783958781274951,0.14761930224793401,0.011834639836764624,0.08162280244383809,-0.1447754034720145,-0.007740317219360157,0.0668918971726099,0.0077033709406083475,0.05016349349006649,0.11653998902214223,0.054363912715189845,0.2696550514449732,0.10299751509110903,0.12044157246006404,0.04436238698455444,0.08260806827991646,0.1155039279110735,0.1021884558905522,0.1751087110805554,0.05975549203705936,-0.05419813592067207,0.12280718486147013,-0.18036942897037608,-0.05031401664137555,-0.23371045281675032,-0.13730818392626362,-0.03538433570243405,-0.3555953116836364,-0.06718232739103344,0.556749778814163,0.16180768395658782,0.037918725133031905,-0.16705418663640578,1.0553853802434139,0.894651679170032,0.9019028945189316,0.13785112148364004,0.5972615091975854,0.15518108242822573,0.958932614548133,0.40883303110965863,0.09623927780185391,-0.03911195758848837,0.9930021609494062,0.1777208881211016,0.19426404126269659,0.16772478708545357,0.060986745225288665,0.01745469176750982,0.06473614451801851,-0.09946199873840629,-0.1874121053498023,-0.12684624633275934,-0.1298497569853031,-0.10071946135652808,-0.09699294430485138,1.2051383040629913,0.5371219437484692,1.432657131966261,0.8110123990335535,-0.022210477100808267,0.5377366544113199,0.9887379396351236,0.5112255549715269,1.092495940118474,-0.16419871638538583,0.5208292547838443,-0.07711334067231265,0.12898898313337237,0.19485115999623712,0.05536794351751567,-0.09851669128959775,-0.07361596051562456,0.16476997352580167,0.0173432922940313,0.1297873743326233,0.1700501539556153,0.07143226066671562,-0.05158169839435026,0.1053888236042388,-0.07908273678962142,0.011263259528338947,-0.09572094575131618,0.04417182534547258,0.02009352175552422,-0.2504654032895502,0.04312356326624851,0.0161809877518226,0.1131747349196046,0.4487327525330478,0.10315466572775463,-0.37242778482629185,0.56506886715163,0.5025697024336322,0.5948654919203372,0.47829721510799034,0.5995805195619577,0.5894505376441809,-0.10046838202225374,0.4798194930015445,0.0061288692143615575,0.05209404542325601,-0.7274809712339209,0.7774151699131319,0.2739428726202812,0.7761790973433229,-0.06622300627131641,-0.40020250941317426,0.2809247683699698,-0.0016721210317908913,-0.11721811925611104,-0.7473203830092694,-0.7213778739617478,-0.6429342582794371,0.08704398589358675,0.00791237974957307,0.01907091347138193,-0.1593671909612968,0.07224726594899922,0.13162824224720276,0.3120710882333099,-0.16677824860711363,0.49149799075540684,0.4910836862703224,0.00620491238369967,0.11600825079457347,-0.16084370145162805,-0.047255682742368556,0.12082077360294953,0.09875527978685583,0.03075898431396478,0.5418178876845519,0.17594089929070317,-0.047060830938285086,0.027149454269718827,0.08723678317311265)
shap_list[[5]]=c(-0.12169428780945508, -0.18363449554318256,-0.14117114159478222,-0.1851459675962432,1.5190334654515558,2.0586942710931098,2.011031395459929,-0.089542735363738,2.140274023263342,-0.3330620857039462,-0.08628467140801817,1.8712389188091954,1.9077687440048745,1.4804840334039104,-0.15910667820381522,-0.10004888378597286,-0.08519184157037415,-0.07241259760581045,-0.1287424631989641,-0.14802321248233796,-0.12125141557330894,-0.14996618043028978,-0.11377304151385374,-0.14117196760360853,4.133977833039219,1.2528223675584378,-0.09526867809447223,-0.07021731660123737,-0.07604735597576043,-0.09148676039892269,0.780219576965366,-0.07491614628811023,4.303916588344579,0.6539904886858394,4.26076805449259,0.7804125599083505,-0.08663218609591074,-0.1299391816231399,-0.16069143760716037,-0.16302148773835404,-0.16603025868620486,-0.09094215882842428,-0.1262002192606016,-0.09772579529950019,-0.09035210029842247,-0.11770958800173481,-0.10178222997646924,-0.1177115977635481,-0.1362166626379881,-0.11023118534374833,-0.13560862562260287,-0.12109464574393546,-0.13266571508527386,-0.11262494752852341,-0.1193106690556817,-0.13117261940721542,-0.1276200131287611,-0.1408852913786656,-0.11496135693674568,-0.18198724969127522,-0.1275361898164133,-0.10711030578619793,-0.06558071916474852,4.2490075296615615,1.1415208770491692,-0.0951003063129576,4.140889345484661,0.0033934948099008967,4.011844557067004,0.32026926832930697,-0.0965150649821801,0.723207949295485,4.132190456762293,1.8899924147459561,0.5810702317096074,0.18348129079030026,4.623295152708154,0.545735822478747,3.7431208014281507,0.8432878606574423,0.16445498643414883,-0.09604631279569203,3.4030558048662773,-0.19932927207691858,-0.18828254632820302,-0.20706053600194388,-0.0939328934087043,-0.07544929206193367,-0.0752340659825723,-0.15825041973462708,-0.09224585792476686,-0.14485401817410998,-0.1248258037164632,-0.07665834181759809,-0.08714723129718246,4.410106883663677,4.646464102736216,1.6270816611441479,1.7831008652812332,4.163507000819989,4.673609442349447,1.911735211003147,2.10636623839508,4.480676814572843,0.7700824337591448,4.6696639649337515,-0.18681875453654415,-0.13694726932276685,-0.160156464491044,-0.10015730295191351,-0.20556634938944293,-0.18913930586143718,1.0455369715028706,-0.09640757848615444,-0.13471093440706935,-0.1431074175054545,-0.11324755999615115,-0.09280809826630418,-0.08767469426492638,-0.0891046113196732,-0.07573442670670598,-0.11195431720406418,-0.10677935035257277,-0.10709398697024765,-0.1282845267400188,-0.10523521348465546,-0.14506838883860848,-0.14355703051403243,-0.19164573818271374,-0.13782510996698266,1.2206481154864313,-0.19319458164644085,-0.19234061651980677,1.3119828728808458,-0.18337331334991477,-0.19676594099111494,1.32369039011289,-0.10140052377357267,1.0785950062926246,0.11693405831085582,0.4104667537274454,1.323150342520281,4.853575889040444,0.9316402733134875,4.858659971122433,0.009873340971441168,1.6200143197309937,1.2613491300563757,0.6460046142267933,-0.1190239701337877,1.149204547611834,1.5393364321460867,4.360880433443036,0.2505203699449828,-0.07786325743797749,-0.08669508937958434,0.9348708322611189,-0.09343228340021717,-0.19498502995472147,0.9732279393449971,-0.14881609865446987,-0.17288198399818708,-0.171187156884713,4.0788619825440655,-0.11951935259368142,-0.12623968654858406,-0.09252037647086425,-0.13097565878939196,-0.12694269605019895,-0.10001931828740465,-0.21005071592019794,-0.148734451075375,-0.08511242600499312,-0.08252725368439534,-0.10070734838332808)
shap_list[[6]]=c(0.0942558793428983, 0.3396510139712874,0.17311626302275265,0.3047572870883554,0.08212806382323651,0.1367132573809401,-0.0026252696386456637,-0.07135117659739204,0.006319867678233029,-0.012762732978098032,-0.08180701979626596,0.10750840292128903,0.1350644755283111,-0.01818251479639694,0.21416449583798447,0.11356215978338176,0.08553233312464342,0.05323297548980787,0.10429755539978429,0.1904193213656489,0.0814192657425121,0.18256097355267573,0.09918721217087641,0.1116553295555288,0.2903209248840776,0.2497798563834225,0.10212284043806251,0.05955850046685955,0.06945691729991388,0.09602673116183118,-0.28327199214780385,-0.06128088891801438,-0.29297405379291397,-0.13827585923524735,-0.3201162288204402,-0.25396759165500554,0.052429963870629356,0.15107157752843361,0.1792243152112933,0.1747169425152386,0.17073406527189608,-0.050840386468066774,0.042972280648688854,0.05774566711154506,-0.05562118826045874,-0.015359785435715883,-0.012398295911040745,0.02802398300826387,0.05645031071249025,-0.018494950294097905,-0.09926785849432684,-0.06677364573822264,-0.030779235826604776,0.0029984025923115256,-0.040347829539856744,-0.028057151764666836,0.1818693557561019,0.13939191600164416,0.12279621319942642,0.293139616692431,0.13589748076460467,0.10947310480171414,-0.05931435125718819,-0.3003897551765865,-0.36031512119480413,-0.05752161456276693,-0.315980876020555,-0.07395015903615643,0.10950490792363246,0.17929607466457953,0.07731563725424664,-0.2830548444549883,-0.1072735038192391,-0.3062555563234426,-0.10495865109034329,-0.13915932698669697,-0.06248474558568728,-0.1662496561974084,-0.21659152353339825,-0.3281234877055507,-0.12955798817912156,-0.060875018128568194,-0.16769531423005127,0.3156863638451844,0.25678884120626905,0.3374401734313198,0.06232054151653786,0.05335175424776609,0.04778144315880848,0.2581778047686227,0.12209959809656258,0.22114736059385837,0.17197258150309874,0.06932530361136752,0.09418109070168507,-0.16539845219240062,-0.1119865726864222,-0.09237699171948024,-0.3721635934401882,-0.3196266426492021,-0.09658064628797464,-0.3272897705679495,-0.2444624569198834,-0.20757753909773208,-0.3033156653755224,-0.08222883687130875,0.3800518644075551,-0.09884448477481914,-0.08395912214459345,-0.07314043904005814,0.45110404431725737,0.38188598815540337,-0.38628122802625103,0.0799354029015166,0.1239547953808178,0.1394997380187282,0.09900353614705434,-0.053006887722403355,0.08329598327746487,0.0782141355133796,0.06115448473403716,0.12177743578563387,0.0992399637667144,0.09037994025560556,0.15019650502008475,0.0968058372350527,0.10807311671914957,0.12231947603420956,0.337507197573924,0.212214538216101,0.2874886932028342,0.3989007522361409,0.3426278823654184,0.33245826198878087,0.3977261736062688,0.3559994061195026,0.3220299839547559,-0.07760229172845064,-0.022615091349590413,-0.07033179139809911,-0.043263504127313834,-0.07214260591200818,0.1002058302447913,-0.08556866484911742,0.10182896604515985,-0.04726058700777633,-0.06947466136926436,-0.07415895810352965,-0.10379816541814597,-0.0440460517404395,-0.05699435582586621,-0.04954813291099601,0.01040093645295939,-0.06090905744419442,-0.052032915675378086,-0.04056104365880498,0.06133568105789882,0.001823776362656707,-0.0357715464014203,0.0910687632070886,-0.06487565954458838,0.17580592832947012,0.1778369585477149,0.3016585870440756,0.1003211309817151,-0.09242164125524686,-0.052544316083612506,-0.011522039458304474,-0.07562473045788529,-0.07515492381305865,0.4305203877789979,0.19017783021986664,0.06348557397541733,0.050565872807545396,0.06983685712095744)
shap_list[[7]]=c(0.034882214364014556, 0.08827939247977429,-0.040554373455021914,0.018753756562067837,0.20897997701937843,0.25451313469362186,0.2877617258116347,0.007462460394802648,0.30310882635450387,0.25507943643500725,0.01335214150556484,0.2621191435537083,0.2905186969166183,0.2206703172415229,0.08239688928468658,0.007241353595593302,-0.07093756027306027,-0.06270845533252557,0.011076743939285925,0.08442450833225683,0.018564691018741995,0.09307292133572045,0.03467660804843175,0.009310213561285198,0.03543067244221156,-0.2671389166587968,-0.15553564050314775,-0.05655186035376503,-0.08937740028538377,-0.15052724609415113,0.13590832468694333,0.05043366515480816,0.5719554136783639,0.13728188897358562,0.5694836360815528,0.14921338313939908,0.020564895755643513,0.09890305119753483,0.10348976105415582,0.32431755239682175,0.22021369224058238,0.016442571589358402,0.061487513055963595,0.045124064594992845,0.02010188404120332,0.03363914489657688,0.03707102006951659,0.054289279043829936,0.0689246809673317,0.032181647322314495,0.04215706592960505,0.028012117767676134,0.04156182336522772,0.04483768916413415,0.028464680301645173,0.038943861990954905,0.11272656711139864,-0.03679282758207217,-0.04180155123393334,-0.0023413365795013604,-0.01584224156182013,0.08863088348368377,0.056291155656143524,0.41600248964985653,0.20870593929740608,0.052181206253699826,0.41938619893078294,0.0746330925089799,0.12531411083400207,0.024580341288580873,-2.247391644588075e-05,0.16601742949469,0.4128336572542978,0.4556074303627235,0.3026129404856536,0.09615261298837459,0.37522467361916856,0.10700103251875737,0.5218551207667321,0.23151957970367054,0.08688831280363987,0.05235077653778543,0.39956310699060843,0.5230936095445086,0.34978095125149855,0.5831214499314118,-0.010373527169849532,0.0023573033761122896,0.0003867484494053248,-0.007980879610637686,-0.05053599550383721,-0.01586149871292132,-0.04194915679473862,-0.05880994851757849,-0.07277920263759814,0.4858477545795112,0.3829596806723247,0.39329612192377206,0.45253217311749777,0.43269968172284207,0.3854490662590806,0.46894117843845656,0.30152089779940794,0.5313491662092986,0.1429035887294767,0.3756913364031216,0.14900782121608436,0.054603025453573456,0.08780754805449913,0.03431539385790828,0.18261007503039328,0.1676295688216951,0.22916615393758577,-0.011205279750555347,-0.02237519241730197,-0.019892760023763296,-0.02169671003267501,0.03493061062393796,-0.14550646668263056,-0.18175756181836036,-0.09818619144453185,0.023497011373469916,-0.013307150580643213,-0.019702863127902835,-0.021393766075887617,-0.013320602308637965,0.1485881641965927,-0.027378293101291234,0.11783214363817543,0.0674711127838237,0.12566042563807162,0.8139470777011002,0.6431277718410812,0.01067038813138085,0.7976772289391888,0.6746018623961046,-0.014021823117842672,0.054388751350786496,-0.03743197540679254,-0.007073648560765273,0.026348436084220595,0.045891826808439354,0.1851962781810107,-0.07799930941035729,0.189005435899049,0.022400210121043998,0.07805772919723628,-0.057163143166737866,-0.0447083460050235,0.03138018952639923,0.05970661838400795,0.06996462918010539,0.13913342376560187,-0.017390194889793084,0.014663598587179232,0.02845672997160511,0.16579219000241538,0.06482009554048887,0.07818539916254061,0.136619807672196,0.12724144351756564,0.10650062748311091,0.12627453483505635,0.0710208793793084,0.03081182010564652,0.05865999449097297,0.03532778072322089,0.06189921208464866,0.04274872823369726,0.019296426481538093,0.15037979615909694,0.013440212915754484,0.015119673549207903,-0.00524065419058954,-0.008401194005750824)
shap_list[[8]]=c(0.02201021145512918, -0.030691923422961766,0.12408636530106307,0.14207085714533602,0.3448487641743075,0.4351709344761526,0.47621595443889736,0.018287091296880813,0.46572759123577995,0.381633093005647,0.030558547532301767,0.4107953219754084,0.48591713331798975,0.3709821161003452,-0.04768656784806887,-0.004440288040450312,-0.20145789933024114,-0.08743480003572603,-0.0028789598792637525,-0.025646232065941778,0.045071646772750586,-0.023247972123631964,0.08080462915550883,0.05703685499201396,0.2242941742062671,0.30536402285577374,0.08402292801859487,-0.013864038397457493,-0.01706424662666779,0.0611082728443651,0.16166009445723142,0.0610149729916588,0.4889837582522381,0.10240511125150324,0.49257662068699687,0.1586245113145127,-0.05448223760226833,-0.25980437427264447,0.039236484828195445,0.032859591704269164,0.030695170883966998,0.02159732883733682,-0.04205803129076534,-0.17435053255058716,-0.019518794987448657,-0.017660913815018803,-0.03909530612122118,-0.03984201027986362,-0.04573553746293286,-0.03927960541913665,0.016306371773084735,0.0011451894564872523,0.004618801751342312,-0.040506381718449884,-0.009394963149415809,0.031463941127194625,-0.05271146524427853,0.05707211359349144,0.055854464720637584,0.16305713783309056,-0.0058031623983318854,-0.2159220538233794,0.06451467262098116,0.3640520877792632,0.24831673377185548,0.046266554110909346,0.37070331109520505,0.07637831059629219,0.28491719093405277,0.17152466203715536,0.06827905577397181,0.1889794875739729,0.33103045849683704,0.4184603386690897,0.3324889764756891,0.08334056067809797,0.2795254951928588,0.11656413327417926,0.4450093989808969,0.22009513979833348,0.07704840374492022,0.052362731898336436,0.3430592808857676,-0.00291181823173001,-0.014616964952159901,0.06667403885356925,0.025649707599568704,-0.03629662797512389,0.004567931352417947,-0.42546469565555595,-0.5798106921964485,-0.4791301115660984,-0.4543715253249925,-0.18933601005124245,-0.19132384948016154,0.38760015040656015,0.2743834706329764,0.3390798980362185,0.3724437626191864,0.38343724289078024,0.2807798201531718,0.40787905421059584,0.259583519875058,0.4229763597151498,0.16813366677531202,0.27739047253512245,-0.484746066474605,0.06965131173071178,0.12440199275954741,0.01000533204450723,-0.33183835828643965,-0.48896813715981297,0.25644116610019324,-0.06397584657053797,0.002962552410673821,-0.006770306092775362,-0.04599028074154463,0.0387752434614643,0.024155844698944395,0.017108092176119707,0.010182297267879862,-0.10331991542341454,-0.047255665106978796,-0.0026177221496759434,0.004871539829167786,-0.04441348477277373,0.17307134198197655,0.187103677760169,0.047955979039721805,0.013744276835742843,0.2460476270499685,0.19718572925514743,0.15756490278221846,0.2701507488999492,0.11867697297331145,0.15813735546050633,0.2719487471786742,0.06573824833390214,0.2958962033174159,0.0563199660606567,0.08457864143407591,0.28609179059718054,0.41866222650793516,0.22037676934006029,0.41747825555903406,0.07282857946825434,0.41243486119719514,0.22043981289632936,0.11060386303702391,0.08242062847671881,0.25843635517929014,0.29861292345024804,0.34852585210822457,0.08219799517657544,-0.017985064546253433,0.0044853375213845205,0.1578135269366909,-0.009958545037882433,-0.10867563653337892,0.2916039946880354,0.0980757012620827,0.20920175387852996,0.19073601131743237,0.23961044664924347,0.09758073878723988,0.09818729502433744,0.04869315392141214,0.022687313408300217,0.11126992026795526,-0.007118397356296309,0.07355623442630824,0.0893980951372715,-0.05267880487127148,-0.011361303833070779,0.041851745776069)
shap = do.call('cbind', shap_list)
baseline = 0.3316044251940513
rate=c(0.47288388019682864, 1.62031670837598,0.6083571561048734,1.2912839323937741,4.036310964519327,5.298083646443887,4.6212945501050795,0.13352916786195007,4.955088901412543,3.912142274937853,0.1375692731405876,4.891762411506322,4.749347939025429,3.5854337762214996,0.9378470708821826,0.34027859263770277,0.3056284828422026,0.14187527016942153,0.4054529168489183,0.8240977343885406,0.514456186949703,0.8791873790805003,0.45733617795293874,0.4857195758175478,5.636808034489587,2.103178237043584,0.3471423638103059,0.2000554274475404,0.18277085695780368,0.30341205528214177,0.8436317547972767,0.2889715831178663,6.010179762191419,1.0965718360055257,5.82716601029415,0.9992411770424632,0.22577478163589842,0.7493495538653719,0.7979622810996646,1.194290353025277,1.0061157075972955,0.21288321931354595,0.6006458052294403,0.3028578569749766,0.22588111664717872,0.3979779462003984,0.3674015625165496,0.5273921839915069,0.7064047523938922,0.36755301534597995,0.42581196523498194,0.3795114580799293,0.5054399681146841,0.45100007866522923,0.37674613547328806,0.5027740245314359,1.02474792963749,0.5666346572280646,0.3523870834055194,1.3928324316066816,0.46354028996963004,0.5983824619823043,0.32509799211877155,5.7286254121829865,1.572785310496502,0.29880552018228423,5.4906207589086975,0.4060005207886719,5.137533344915045,1.1335415236684452,0.3348354753918538,1.1259929123872863,6.110355151768523,5.6608567815763875,3.762664542804497,0.4399690109522071,7.420337167411586,0.5984003142060701,4.64263685226137,1.1662020049191837,0.4140765438631516,0.2907097844106596,5.063810957451018,1.8799108488263436,1.3357772332371505,2.119838454960987,0.25275805676308016,0.22496462578071505,0.1777522328117317,1.5192939553094562,0.32169145043334013,1.1853818453375675,0.790657186502286,0.25472587528314494,0.39842723359018967,6.526403102143111,7.424929004585876,5.654424292717721,5.193636240941005,5.7161220091874405,7.44125608109923,5.738086729347593,2.8172820947079975,6.580321002172539,0.837926423742306,7.460322147936567,2.2075773957936855,0.5046612056196911,0.8018280311144306,0.26818139481664927,2.8188377674088536,2.265171127621058,1.6307885490125131,0.2849405556983729,0.5395310347521841,0.6173279045749903,0.3672864520893547,0.2276675694626102,0.24749644319060107,0.2053915632819,0.15581793922513584,0.4668640139558777,0.34689070971604546,0.31830932097769515,0.5666738104595896,0.3350386124897989,0.7382798124962776,0.5627885370197777,1.5299590636112719,0.8412124892947329,2.2173431733716544,2.9756945770637744,2.478341785446282,3.493988113775366,2.7404879483174764,2.6223162746375,3.485370805023353,0.37976325034119107,1.8240753415477011,0.2987457992982747,0.8051423411414252,2.179659598110946,7.026371388402405,1.2704282993495795,7.035152920639193,0.42254969286865923,3.8519079048491465,1.6164994482190789,0.5626070215906421,0.5534503546321827,2.001624312734872,2.605760451637462,6.200765205077954,0.46113683199991407,0.17270202788572112,0.2911641731830756,1.9628725146617185,0.5653398158776153,1.0582941574155476,2.4987665510955592,0.7378057247562676,0.9414123823837646,0.9590354305254325,5.570624232933836,0.2757897759212126,0.42131058169336366,0.28530218006725855,0.6495534733403809,0.5065667455930123,0.2453816175715805,1.9214390827391237,0.7227101328274762,0.25381776210963214,0.19645832765104898,0.3076500966197983)
rate_lwr=c(0.05919369680350914, 0.02995533656106064,0.0924298898988653,0.16497816728101447,0.007188355252614631,0.023531193016341878,0.6202534689400692,0.013545726855101803,1.5480359954261351,0.36559257337007145,0.004942798398085924,0.04178590382288233,1.1017593416703604,0.01593595416803667,0.06700068837110357,0.011258230031498895,0.04059031186964773,0.004919187322718149,0.05172759053410941,0.06968266582887714,0.033826937631795034,0.059537408236962686,0.009874753590416896,0.06691318705397387,2.0431955493859424,0.08266972698725039,0.050559757526062066,0.013618474969705086,0.034150031872256875,0.04730323324044819,0.18109141360823594,0.06445302347006104,2.7131919182329707,0.061885338624980246,1.9791121483554073,0.039080214634028665,0.01499980928063327,0.03229285174152477,0.04060692023147228,0.016649867082303926,0.042296704996255596,0.005643500734791945,0.11960158271212593,0.023295516501709745,0.038473350926351124,0.11856848935496053,0.07732431348993635,0.11094842253315573,0.03327842350523896,0.12238674483304676,0.007951576578132447,0.1067352114529152,0.1195466234621026,0.10665512394335486,0.12336274651284415,0.1200221433822019,0.01374570286594401,0.04161767829823604,0.040669966220700376,0.015580741162586509,0.04440743504789446,0.014034788824692224,0.04691057761477058,1.6759747148124888,0.12485100693758866,0.05061765040426899,1.465006387902686,0.04590705405866968,1.3682208400005793,0.03820201228933523,0.026560101316954188,0.0915485274590892,2.00612996112517,2.4906116486333154,0.2074745127293779,0.0029696105592303956,4.361698726691287,0.022157698703633044,0.26009646945108084,0.11764181024961562,0.004039442731259113,0.0635608944170663,0.1456947008967113,0.1244726067771125,0.11515646316022227,0.13983983422115412,0.05472668002157752,0.01079769387546936,0.0025489742899094114,0.0846534643034959,0.05285802194283523,0.08180018977790443,0.07353557080753018,0.029411880533408763,0.02119061953631951,3.6242995884110645,4.410156447593402,2.453023432945101,1.2368210828116921,1.7361831226480957,4.275678566614859,2.5202459689867585,0.056979299874496264,3.9917105006637876,0.16176627132556387,4.393092756389313,0.14874340690281984,0.07292302402439121,0.06383222611246783,0.0076724894369335495,0.3072949588845804,0.20193420217077726,0.18820132372407797,0.03905854402006692,0.12214923529691049,0.1412933642123572,0.13428554707534268,0.05727288535077396,0.026970576233862342,0.008531734937293478,0.015433998177031755,0.03816853108525736,0.08959186065525454,0.07207156631313794,0.03047623272097008,0.11002850881306075,0.05434934896145821,0.04990545472398894,0.12884939584776964,0.007020052082847117,0.06318003911979053,0.7251353694814207,0.33151741773831295,0.7513688867190906,0.19999229744691574,0.5275221086308226,0.9796432473103622,0.017060951732444096,0.18365687751934423,0.010082787698093842,0.020625864585320036,0.28264207546238534,3.9482188269692644,0.1886080809326624,3.9717748906887813,0.013061961542885553,0.8759933354285829,0.1979885293407836,0.07348142386191372,0.03357761354379163,0.4178123661721778,0.45563420889345435,2.2147907624614582,0.0033939740310381383,0.014985911384589212,0.032366816948013744,0.09626432938382695,0.005234087622242395,0.02422803726135042,0.02240254709470263,0.018815032120699043,0.06653442935960613,0.05330319463986222,2.2414650385934096,0.007953443908436164,0.02093432191971395,0.02143647158402809,0.033943287152009616,0.02100809584822816,0.03671753086218016,0.24632478740566519,0.09041396861738588,0.01178407561889877,0.03813342377728168,0.03036599300113174)
rate_upr=c(1.254703440457333, 3.8864571955563694,1.3708508310526157,2.882559324395058,8.51087019807323,8.771312612533048,7.499730291041383,0.26661090852693226,8.347552216951998,7.145252109985591,0.3140573918398083,8.767434840629775,8.054648126320284,7.418474770451056,2.773536817902517,1.02407367118053,0.8710708308254325,0.30869725117914304,0.8441916577229288,2.194232002888129,1.472380678805079,2.3577978508225934,1.2812096517491134,1.11815673580942,9.474233113054204,4.922250493027355,0.9601515829456807,0.504021436031979,0.36187767760644657,0.7060005747073912,1.7619691088182057,0.512786314080548,9.834753267692925,2.9876151307487246,9.598864610937657,2.8573103708195964,0.5585237164612711,2.188385554470482,1.857147567920121,3.2258932706048573,2.722182691013856,0.5269136073893997,1.4858154432251207,0.7731927668558276,0.48511988795237637,0.8223815584527212,0.880130735861402,1.2819393252181923,2.068045984680884,0.7256152618939649,1.0902708899194768,0.7473083390054013,1.123939752409312,1.0440150273898254,0.7257260466941526,1.206279734368692,2.8074991437146193,1.3221659763784808,0.7817671272815181,3.5432836929249607,0.9297201851792924,1.732201928727525,0.6469870397832523,9.27437281401919,5.093365466641564,0.5868016307537917,8.999768474690024,1.1836531125063416,8.705515305554545,4.911470937785636,1.026380562424253,2.603823214299322,9.784115224058233,9.309386597033036,8.58214685045689,1.522054558837044,10.692970557805932,1.903557599904992,8.273859789860989,2.8643665785104027,1.413478783738834,0.5694699837157375,9.310184887108822,4.164718049513544,3.250514882343846,4.567340674559134,0.5324335742021917,0.5417774810735005,0.44065889325243457,3.4125720590269495,0.6582499192813198,2.8148687006163144,1.9114760717693553,0.6474294317471194,1.2653623724084007,9.99631303871081,10.622742219729059,9.197494927245412,8.48295698322507,9.17358208474323,10.534197156698866,9.250002229921803,8.594758441121883,10.411666897556225,1.71491940998196,10.645618926775738,4.523881959333978,1.223356846412484,2.147627063984127,0.7413732873995359,5.339782766198345,4.590682231647069,3.9199942315954313,0.5323648708828432,1.1255952095989135,1.312812747815994,0.6571331366125093,0.44113032574521305,0.5750588264503865,0.46476800004499047,0.327142046501118,1.3345059162728174,0.6447155598931881,0.6178248585746662,1.4301037555659937,0.6453298379958037,2.1073753257198615,1.4384071810535697,3.6973588704460454,2.5331921206232475,5.056489871967975,5.273792561387747,4.477834692605194,5.995124792982283,5.142852892222415,4.823765128677094,6.253841633483907,0.945436463868823,3.795659067577249,0.9982107861045206,2.720044409727394,4.873348288929897,10.410630565092141,2.711551605310523,10.41329651740587,1.5516685900662055,6.9579593027723385,7.59483216431874,1.1639525139864662,1.3780002675389562,4.0451319342725345,6.621448674981173,9.606453138054894,1.49197949465571,0.3873109379008564,0.6450120642493646,4.662988579796523,1.6383213873341331,2.8494882167831443,6.4938339992226926,2.1260292127416496,2.2155744930071943,2.2596833187429364,9.613231679466548,0.6495331114750436,1.1431967600395265,0.75264567296839,2.0306785356713504,1.6214002101790086,0.49095504609812274,4.305779408481066,1.5984102630266315,0.7366574421817662,0.38563235651746336,0.7390867833534895)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,8.193996520752748,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.539329847594917,11.45516312611962,18.316996330471802,12.762457973341409,16.687957899554206,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.230905385405343,10.270132845364204,17.06367135403042,18.771662988592148,9.812860126686786,15.275304079953862,11.610334918074667,9.991905577866738,18.464662994362794,19.037996316919237,9.630996493741618,22.26749625621469,10.683496473957888,12.585271438210423,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,11.566150303520583,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.9299963377462,4.448396591158399,14.141457947420491,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,16.211996370039262,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.15963284744126,12.8613425868673,20.792329617276543,20.39513914855202,10.70649647352556,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.676359941283643,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.915536450799365,9.062465735197444,11.566150303520583,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,8.672663178421974,19.709996304287746,6.680496549201861,11.754396453828296,15.453496384296702,22.26749625621469,9.45499649704987,7.690746530212313,9.45499649704987,19.634996305697506,19.336662977971898,8.396996516936989,11.45516312611962,22.72199624767148,22.62499624949477,22.26749625621469,21.779996265378173,9.026196505109999,13.644381033687072,17.899611722932722,22.62499624949477,21.1276885853318,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,6.758613214400147,17.61049634375181,11.251996463271851,19.87726902841626,17.020450900297373,11.566150303520583,12.589966135091872,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,11.566150303520583,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,2.0,1.0,2.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.053674805227923277, -0.06795535597068586,-0.07223634362159513,-0.07222410376589036,0.04611770014005203,0.046252705464794805,0.047350897349912546,0.043974328112720576,0.04652395138819408,0.04621106459740574,0.0473575183621556,0.046548016703086864,0.047326493723150384,0.04744671863489181,-0.06709938192095931,-0.06526202817252388,-0.07250120334763166,-0.07359563026948444,-0.055485516243639454,-0.05493872119641263,-0.05499981231094642,-0.05496543100042107,-0.055081965649557474,-0.0554089365750976,-0.09377571726149468,-0.08360704048815099,-0.08410118870197753,-0.08360391434776913,-0.08381521360428702,-0.08457546185379573,0.1019086032894763,0.09872581089763041,0.10259799870442296,0.10294020370588408,0.10304120225260968,0.09958378166112504,-0.056489247446229754,-0.05198116055609639,-0.081682358970753,-0.08438461969261511,-0.0846996231638336,0.022574285611190827,0.008261429630766695,-0.04794843812590508,0.031991077996996284,0.022640242537572262,0.015661525715865637,0.007384260128928571,0.022489633674198282,0.022595919506895077,0.03465541834112906,0.0386147137347161,0.0272390307939481,0.016222501909695302,0.027374295284629865,0.03156161706494547,-0.055355519842871646,-0.07251277331197742,-0.07203553318855462,-0.07274798824326718,-0.07226400799341909,-0.056349251402106094,0.10032145071336773,0.10626547997882453,0.10544356819600491,0.10022901685309737,0.10626547997882453,0.10236550749817026,-0.06422764296848145,-0.06411581448589038,-0.064128912868281,0.10105010652895814,0.10479832577211819,0.1040770119040479,0.10485467487093565,0.10346262542805952,0.10414637912071942,0.10364330015642628,0.10479519518030966,0.10469599395800795,0.10203192984660903,0.10064407097630096,0.10477622882587351,-0.07548486054384818,-0.07599011481681418,-0.07613034113405176,-0.0618455335236989,-0.06190448107490105,-0.06203371060103502,-0.07262607879517252,-0.0719165596470614,-0.07180056681935969,-0.07205119806129097,-0.07224555444174229,-0.07324471858598845,0.10893072912358298,0.10895042396965125,0.10879268630845783,0.10873489277346814,0.10666620607317338,0.10899688412416209,0.10897014671826828,0.10779429793518315,0.10738206104336624,0.10644443230089695,0.10887719277539913,-0.06589365517918896,0.056856874118712146,0.05695391787024916,0.034869224156327865,-0.06445140028062624,-0.06399161936958225,0.10071722889430447,-0.0670233934372524,-0.06746408013778811,-0.06768740655827625,-0.06781282338908644,0.07622924372787727,-0.0795174635492598,-0.07903359181456646,-0.0791744870138947,-0.060771187571217626,-0.06947346275921566,-0.06945235096731986,-0.06962482588096146,-0.06972408780552533,-0.09135451783432376,-0.09067496236372408,-0.06285950970024272,-0.061687730188226965,-0.09427394525660573,-0.09367345445346388,-0.09360433975166853,-0.09472293110242688,-0.09255160361752031,-0.09355790926081152,-0.09464829510192978,0.08388938884560114,0.05179733278685487,0.05447538447263475,0.054386077929786704,0.05569875815047404,0.054901837902218795,0.05520020680726281,0.05451071347235866,0.05299616729717891,0.05559619770794667,0.05522018552241949,0.05492337258820553,0.055138110503854344,0.054622561636606795,0.05572023745141359,0.05557381731569345,0.0514881080803601,0.04016668289636157,0.04189119112252975,0.042536670518074846,0.04010513032191819,0.04171299159891471,0.041673463180311565,0.09757729231321727,-0.09322180675094789,-0.09326466875096097,-0.09395936574486431,-0.09304977946607608,0.06186758104388432,0.061744364563146956,0.04248756398762119,0.04228424898262684,0.04229086739042656,-0.06812015922801548,-0.06842404972274956,-0.060855423356850284,-0.06123170743438844,-0.06087533233745025)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.01826626642270292, 0.04254197691211043,0.04946174568898022,0.04944192114761769,0.009994774921117859,0.010060041962284142,0.010651455159222252,0.00884885388968656,0.010205280399503639,0.010036934945487639,0.010654964515861778,0.010217871568353874,0.010638015534019387,0.010702511871318673,0.041132172773494534,0.03837056796971888,0.08017714096600154,0.08546480173014714,0.019789050732166996,0.019325613360777878,0.019379586342675396,0.019347914898305844,0.019447548275042793,0.019723603343639137,-0.20514875485540138,0.11896562370940836,0.1206674613717583,0.11897289273657337,0.1196877254133994,0.12228670617204516,-0.02289090771017607,-0.02116929094144017,-0.023261981246956002,-0.02344633206942828,-0.023500712754104095,-0.02162941335305731,0.024575692710801074,0.020536634697956326,-0.1431093927108947,-0.15665663215958167,-0.15805161478224328,0.012045221985237105,0.012420800053017137,0.014101297351798645,0.010919503724016403,0.012128713067730978,0.011975551464612636,0.012367848908458625,0.011937272651417561,0.012072532092052854,0.010853225272970394,0.010421958356950011,0.011377875009486279,0.011962395715838677,0.01151259229128129,0.011054777463968938,0.023257554754842667,0.0499180969220758,0.049134833303930946,0.05030222875792913,0.049512859911195924,0.024418844041622614,-0.02215878182794944,-0.025597605029961442,-0.025129394060564976,-0.02211213097714834,-0.02559760502996152,-0.02334569302873136,0.034002711049184106,0.03386202502117579,0.033878366080196044,-0.02243246091513941,-0.02449969608008276,-0.02409226649984579,-0.024530868918674394,-0.023756603034024302,-0.024130282364808006,-0.02385513308155255,-0.02449791252356783,-0.02444305055891682,-0.022968145141759523,-0.022213412573613412,-0.02448743590668625,-0.1112724028879378,-0.11306130839242813,-0.11355660140709134,0.03102814227236691,0.031098175532568537,0.0312519083319985,0.08030638444438716,0.0784535114353899,0.07815261694082729,0.07880459615344805,0.07942936349197778,0.08215189347585773,-0.027185475916988302,-0.02719707402338945,-0.027104040017372117,-0.02707002217510407,-0.025844514721533048,-0.027224499816031648,-0.027208710938768216,-0.026515342889042247,-0.026270079571693174,-0.025717484026672302,-0.027153812276525843,0.061255453248096926,0.00205762563398442,0.0020659769576430445,0.01101262960093168,0.056354949239341624,0.05540297492143326,-0.022246761293922338,0.041026937475452094,0.04167241400987433,0.041999959293683414,0.04218413774211843,-0.008682981335912917,0.10487560628007321,0.10336707924547384,0.10380517350390768,0.03146511183299932,0.04497324832251847,0.04495495896725136,0.045210450144818996,0.04536291893758592,-0.1924818398912884,-0.18910173418230694,0.034509935116521014,0.030804663497715795,-0.2079750558124732,-0.204836801674273,-0.20446237563349695,-0.21033437627471296,-0.19899559366432795,-0.20422287440403816,-0.20994291646136806,-0.012934047563076354,0.02496904789839159,0.028373006404199447,0.028263204009591227,0.029931631698878594,0.028918196886794596,0.029296795629458066,0.028416530748380363,0.02653101438542709,0.02980061016226799,0.029321847160408993,0.028945100311163242,0.029219105315385057,0.028555090172581662,0.02995893606186045,0.02977229105183508,0.024617034434114397,0.010826424632328002,0.012726066282039185,0.01322099372414855,0.010689953205008132,0.012616617121912598,0.012366189233398186,-0.020550076083960134,-0.2022669485048039,-0.20250527318906908,-0.20609978565832596,-0.20138082765344165,-0.0004031188283016312,-0.0004012207246540335,0.009842011917910894,0.009730606036923481,0.009734169364633555,0.04266386889820632,0.043116943779830864,0.029796452755058038,0.03023699681342723,0.029819506834912763)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.438, 14.895000000000001,4.4665,6.2895,2.1900000000000004,1.2905000000000002,1.2905000000000002,6.2895,1.2905000000000002,3.0900000000000007,6.2895,1.2905000000000002,1.2905000000000002,2.1900000000000004,12.725,12.725,31.0,25.565000000000005,9.438,14.895000000000001,9.438,14.895000000000001,6.2895,6.2895,0.00585,1.2905000000000002,4.4665,12.725,12.725,6.2895,1.2905000000000002,2.1900000000000004,0.06885,0.4535,0.00585,0.4535,18.205000000000002,25.565000000000005,9.438,9.438,9.438,9.438,18.205000000000002,21.735000000000003,12.725,9.438,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,9.438,9.438,18.205000000000002,9.438,6.2895,25.565000000000005,6.2895,6.2895,6.2895,9.438,25.565000000000005,2.1900000000000004,0.00585,0.4535,4.4665,0.00585,2.1900000000000004,0.00585,2.1900000000000004,4.4665,1.2905000000000002,0.00585,0.4535,0.06885,2.1900000000000004,0.06885,0.4535,0.00585,0.4535,2.1900000000000004,3.0900000000000007,0.06885,12.725,12.725,9.438,6.2895,18.205000000000002,9.438,31.0,36.2987775,31.0,31.0,36.2987775,31.0,0.06885,0.06885,0.4535,1.2905000000000002,0.06885,0.06885,0.4535,0.4535,0.06885,0.4535,0.06885,31.0,6.2895,4.4665,9.438,25.565000000000005,31.0,0.4535,18.205000000000002,9.438,9.438,12.725,4.4665,9.438,9.438,9.438,18.205000000000002,14.895000000000001,9.438,12.725,14.895000000000001,2.1900000000000004,2.1900000000000004,9.438,9.438,1.2905000000000002,3.0900000000000007,4.4665,1.2905000000000002,6.2895,4.4665,1.2905000000000002,4.4665,0.4535,2.1900000000000004,1.2905000000000002,0.4535,0.06885,0.4535,0.06885,3.0900000000000007,1.2905000000000002,0.4535,1.2905000000000002,2.1900000000000004,1.2905000000000002,0.4535,0.06885,2.1900000000000004,14.895000000000001,9.438,1.2905000000000002,14.895000000000001,14.895000000000001,2.1900000000000004,3.0900000000000007,0.4535,1.2905000000000002,0.00585,2.1900000000000004,4.4665,6.2895,9.438,4.4665,9.438,9.438,6.2895,18.205000000000002,9.438,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()