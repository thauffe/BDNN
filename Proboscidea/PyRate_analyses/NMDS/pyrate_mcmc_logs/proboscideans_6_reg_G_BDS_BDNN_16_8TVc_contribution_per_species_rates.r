pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_6_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 5.0,2.0,4.0,3.0,6.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.0237253625144992, 0.11013049593391759,0.11652013346015606,0.13621684269179177,0.14831391695778876,0.06609060032870283,0.09007199098005297,0.05530039958326248,0.09070131773086912,0.3028914329252044,0.05161262073394925,0.0743530442835345,0.05476966446793318,0.08069439954724253,-0.09670547782482412,-0.06823147144404934,-0.48605493826907936,-0.33106392705288507,-0.024076689696220805,0.19289321670046497,-0.19131447837128468,0.07758226641214798,0.01912042903282104,-0.056619504040291084,0.24725105669804087,-0.2178517172830055,-0.28208864582947185,-0.29129250663496475,-0.2573100156949309,-0.23909398354112402,0.56618905058281,0.42839473558457436,0.64677448271382,0.6678858914490463,0.596528127425158,0.3079221212483094,-0.1818127598320494,-0.1268140774630069,0.11627922707523135,0.3223672017378283,0.28118004843983646,-0.04239392600306778,0.04273376914942002,-0.09242228977007465,-0.0002741855856841912,-0.03891631661407893,-0.009374678709841872,0.0525955184782372,-0.10103363660216581,0.01759581172240374,0.06893892852549886,-0.05955452799530867,-0.027037576875945775,0.0022851400904267457,-0.0749795754774041,-0.03904326132406426,0.2560261196535076,0.0944369841512696,0.14027017997334104,0.16062966363434572,0.1074230921272438,-0.31715208657633365,0.412637332240444,0.3771811565093302,0.5094744902309285,0.3761411396983704,0.3674797693276376,0.3780931944625905,-0.018077187425526855,-0.07317435724488652,-0.11133559163115829,0.4699391414177752,0.7073209740923644,0.98586800216085,1.0322500324194983,0.5540072833521358,1.0520140820978237,0.3571430542317753,0.4624693375375428,0.49813410845065836,0.5243438857336433,0.3853142351862165,0.5989257331721085,0.16968935013393668,0.06592792285394958,0.11121927338863598,-0.09103353774191222,0.00954159504171931,-0.05437302283662885,-0.3758915184739674,-0.43179660616691373,-0.43217260529469065,-0.41949686257208746,-0.4755842097244669,-0.4651187691637369,0.6745208342366301,0.9938336984995405,0.9825826936879374,1.0395263436882458,0.5602534951744927,0.996726126616315,1.0586831632605953,0.6716971785835069,0.629008811150923,0.5841271799710414,0.9415182932491623,-0.25731506904131296,-0.046626510704843374,-0.045823053442358194,0.11387521990557181,-0.23917507071876684,-0.26328668563467345,0.4025165880101873,0.04939483223723081,0.051745515081631735,0.04934082640447211,-0.02126444141806071,0.34204336958546944,-0.3327262177916304,-0.34511327113000567,-0.40680965629172317,-0.038851195229917986,-0.004625088637082186,0.07559307966883781,-0.03857736866211502,0.027032116860043642,0.01801341884023511,0.0683895505031322,0.17906721129249206,0.2620564593272767,0.19073561321959995,0.024249122735161808,0.10860567542509544,0.18178364767797547,0.06929501831823055,0.12340645573275245,0.167551251215378,0.4226226608302801,0.3047213591025373,0.3104318692795653,0.36533391735554943,0.5204777311038814,0.32636245030979216,0.27938328242460525,0.3501777581390667,0.30051079500647404,0.5325086359239124,0.3270464765757711,0.2941634102174676,0.5029333124860513,0.4951707116346734,0.4953751696841138,0.5314445329705213,0.42942700016978885,0.34758170843115993,0.2178538574435748,0.290827362855773,0.2632658858599227,0.40675938704617876,0.2406281866137042,0.7074332742318348,0.2740031604288706,0.22847866659596192,0.32327755409089376,0.27906954938193174,0.1705928550542976,0.1205383527359634,0.08510759240123093,-0.04393148757846971,-0.03324604169646268,0.09511056457970528,0.08255590208298515,-0.08283923956182838,-0.10579709523257795,-0.1007962406765872)
shap_list[[2]]=c(-0.04622064416601646, 0.0008879205944582473,-0.1095746374668029,-0.10966076969077981,-0.03294420125750253,-0.0315449459754953,-0.0018788365131427163,-0.034104479739191125,0.001331254023141065,0.08586026142460813,-0.004719511875743506,-0.03493149308063405,-0.028317182201935416,-0.008587129155562393,0.009040065395797695,-0.03453853729532724,0.02799820853680573,0.04145000315097994,0.027397033175327823,0.042320409234194334,0.010084037263317733,0.08692593237553846,-0.043056745271223065,0.015576578781261528,-0.0032680474168133677,0.05886358215224215,0.11136735063721666,0.14708067928650326,0.07338196798681268,0.0693896261206294,-0.004140908604171361,-0.010565509234633803,0.04884914488304777,0.05283321418073521,0.052953944019483085,0.025279585103388253,0.04790612396717538,0.011615430508670073,-0.0355671531028499,-0.00838411202721376,-0.03358397209405035,-0.023741239289523867,0.054624847467992156,-0.026712691387553802,-0.004213956241805208,-0.00392771369124047,0.01231986430650052,0.056553746221258284,-0.0026426094751457172,0.03303185956908027,-0.07471442731425187,-0.013820597162703264,0.006797668855139303,0.02819157188504364,-0.018702410428570914,-0.004128829281299701,0.076088575832047,-0.09751774086214873,-0.09848120767253349,-0.013404368135630106,-0.06395479656696479,0.009473098431228018,0.00036413717389576465,-0.0018792589525043954,-0.004138165798319499,0.0019207320702583704,-0.0001468975057929739,-0.007530165526322254,0.08154834833541459,0.08205814634690639,0.05539223659081964,-0.006727689430681275,0.18678109051015365,0.1710519689934967,0.2226037176113404,0.0740194517291368,0.19344865855948637,0.03996585058765832,0.09567658327046984,0.06108496880439916,0.04932085017527737,-0.0032975691148535284,0.09493293627958739,-0.00910437709420497,-0.04574168075837084,-0.017503660532731617,0.03092507119165392,0.02676838646477526,0.03962393795976196,-0.011140205561741811,-0.009690993688201107,-0.009705931755876782,-0.013573905507485683,0.08235773985221156,0.06083218338570176,0.09373273787555154,0.17646794471058727,0.22630657757202172,0.16524658003825096,0.0013113124709830779,0.18219549773643856,0.19418339417656333,0.07900680685280753,0.07339675231218548,0.003773028406733489,0.18359961806904526,0.05370347185039885,-0.0142353932568364,-0.012781154740135163,-0.056009912178179445,0.025506614777719983,0.0460899174190977,-0.018028939204506194,-0.09041874843008628,-0.08596949200499666,-0.09131547757801049,-0.09715277679985744,-0.012799236509200715,0.0267014193429633,0.031199983433524342,0.05021684531165786,-0.01347619890822848,-0.08373760270812686,-0.09797086848182383,-0.035723204497101084,-0.08814335447701294,-0.04436964083070923,-0.05179212000143549,-0.09316433068029745,0.12085082696402098,0.08213298841022938,0.08443498655952672,0.08622873184358233,0.07189663471424705,0.12188533867957371,0.08855117977754182,0.06655797396970264,0.0769654452972197,0.026963078065720545,0.020079730063297867,0.020066827527488926,0.035146956756602836,0.018753890433455146,0.018983715757678668,0.020388066170086618,-0.0036426211157899583,0.04808984837658225,0.025639251842470887,0.015386472752053315,0.03596231912991769,0.040807907362377376,0.040812883263526105,0.03187791097511525,0.05631769529213473,-0.014100914712662308,-0.0008288769349396731,0.06513029310596048,0.06022158035398339,0.02225056316770061,-0.030384633655024054,0.08552623149867197,-0.0010062570050292613,0.004907444829838728,0.013944216441043449,0.0067088525619196145,0.015302581930906528,-0.0046458870408765136,0.028166199994008375,-0.020267398869423515,-0.009524579235144824,-0.04980632739038733,-0.0891625492602732,0.11199348981297338,0.03161103485338672,0.016180404309785443)
shap_list[[3]]=c(-0.0959850232513781, -0.04921124495377705,0.14059794255769145,0.15494910184343094,0.035961681451051726,0.010569265454619349,-0.07101961657522177,0.019955495176627053,-0.0632999281878544,1.401791845157567,-0.059917743959470075,0.01665377212655625,0.010111996438277187,-0.0722932213769839,0.08043537402970825,-0.22024483955765292,-0.04352569517155454,-0.04965727582809032,0.06577745355491446,0.22111249425604823,0.07312594870043856,0.2009458094585939,-0.0854019357536406,0.04785262135232084,0.08913737512984941,-0.029845518203119436,0.07320750271357696,0.10427206557538346,0.0504667989972756,0.0381594611974276,-0.08464474558262142,-0.09792420952925424,0.06464407521139794,0.1705301586084111,0.0527008293825089,-0.25691698513157746,-0.0806774127300363,-0.06625748740276231,0.14353314247475732,0.19752101674574948,0.10406586880811079,-0.18812016138176846,0.16607211058482474,-0.10621460016575256,0.08538082734180331,0.06807997026759863,0.11137561668256245,0.17860446368872,0.05807664338121636,0.13242410821826436,0.13984525759988609,0.04162344685090591,0.1099461800430167,0.12576311635222975,0.0394723039441003,0.06889525054758035,0.2919322138208516,0.049133435237585496,0.15317223383619877,0.01100214212647538,0.07130750864094619,-0.02387738126525702,-0.09626875866769498,-0.09729028544532808,-0.0909131571186329,-0.08287678567084267,-0.09292058737569955,-0.10494286037997241,0.14022263671548166,-0.10687184836027978,-0.08781576896437052,-0.08965148660201316,0.36075175185853287,1.377150204720107,1.3505373198858697,0.0548644024875657,1.4093616904865616,-0.3009268610176531,-0.04604144299746675,0.0442100574500573,0.04913351942836849,-0.08523980690694916,0.06086241162534103,0.2428183422234968,0.09179164265208946,0.21661507402508293,0.0726871957417037,0.10675977567860637,-0.08117294846184447,-0.027317462882554083,-0.042251000527532716,-0.04212597940011955,-0.04625591582731178,-0.029354830047596595,-0.03212051538197839,0.07072504340781817,1.4676188016926057,1.306784024641045,1.3257166902866684,-0.08385806948526836,1.426894423920938,1.4222557756415066,0.06655996055588004,0.060948664995888545,-0.07640296525167346,1.4566028353520997,-0.003188383584461254,0.03671099854716426,0.03605699860940059,0.17194971230521455,-0.012120104989778311,-0.011996322163810826,0.04193851454321479,0.15695515164329873,0.1591496707403936,0.15645312306277878,0.07139356406659454,-0.10038496311887027,0.042107611376554985,-0.04623782130267403,0.08099611147444427,-0.097302263728906,0.0814192097555291,0.15414599498680223,-0.05175453738118135,0.09558186380313266,0.06106565236663709,0.06415328873755659,0.23040589836786815,0.19010885564845617,0.224082059493919,0.18639940510636077,0.24168720672516256,0.24618746300459077,0.19328115390603004,0.23897067319174647,0.24873373885958566,-0.028945781159625192,0.019339822617585777,0.027132811035456235,0.05825455898908018,0.904441703297722,0.026499908403348236,0.014589484546759544,0.03261244052762974,-0.09069461579426764,1.058453918019438,0.021018271832243984,0.017235299421689585,0.8781562851083317,0.8978913691473954,0.9125504103450712,0.8856785541066765,0.05049139932020792,0.09030817125449818,0.07017257925992865,0.16264650126462707,0.15530596869189642,0.8862630650491166,0.0284669158781351,0.9277955714958529,0.025573798326139176,0.018721386391716995,0.10689695278792041,0.03619020807351236,-0.040481864679203616,-0.20516022188268473,0.07897304592068582,-0.14337904463424647,0.05280357437005778,0.1837005286737694,0.13707461529180065,-0.06202841775028503,0.017186380178009643,0.05475602789266024)
shap_list[[4]]=c(-0.005048917992179466, 0.06360699309288262,0.02479698470014584,0.0004978459729336723,-0.005112698498146001,-0.05885562623644388,0.04771242111793545,-0.012626386999909431,0.046984283501131485,0.10644683787944209,0.03930689780942101,-0.027450320021693436,-0.02161553723881671,0.03682539318706408,0.04506322170272058,0.025295237733761272,0.05199659150722247,0.0689758949843991,-0.002495021900057499,0.10841586398056692,0.03354910453957749,0.10940672382454097,0.005156261400878052,-0.004479313925935063,0.1511977036214515,0.036760575782046806,0.00767460193463541,0.07212023916364654,-0.019610051091543613,-0.032976729620042014,0.013249432860770924,0.007682883044202485,0.006338224206323749,0.1677136827118865,-0.00897160520758387,0.029599491084643926,0.05384756997924572,0.029521379306181973,-0.008528918905646514,0.13474458374836126,-0.051237768379504514,0.022853568564376498,0.08455287306839011,-0.02305218393729123,0.04949272851329315,0.04084353217944737,0.06576516131634039,0.10005965525209284,0.008084656811989369,0.07288109958520779,-0.0718864260784546,0.0015624420900286168,0.06465647323039522,0.07175172818980119,0.011512810016807876,0.04163310752011075,0.13492093291394675,0.0016305922365975525,0.032915401165291826,0.05863178849369104,0.0198387311710707,0.05252686139179539,0.005853645065866722,0.019762566738002207,0.016796758525811667,0.0253436772046721,0.024562490669437772,0.007900927818294332,-0.07773809795238133,0.01673205344927221,0.012654127510237728,0.012490293542858634,-0.049477569735807136,0.20238091703471509,0.16007683250755145,-0.01391240533530753,0.22111248326669353,0.013722201349756482,-0.0350982498132127,-0.04250559005315357,-0.006573639283430347,0.023786320169581373,-0.02665139090132956,0.1082812203211267,-0.05387810110898432,0.13932305445203877,0.06471863467143722,0.061875851810119224,-0.018408712746480305,0.04111298134105327,0.046800918417937556,0.046637590377552086,0.04719741692249577,0.06993939742010503,0.05273525395440092,-0.012501483006826011,0.2059776746693209,0.127013468760928,0.20084904492927,0.018482253410980348,0.21186991599979374,0.2216496111342392,-0.007617242428525213,-0.019685642223996186,0.01970463696635024,0.2113338371164727,0.08679381261066942,-0.003821558519557838,-0.009059167538988323,0.07937834185649766,0.06559652877403889,0.0753521670203356,0.012251016187129713,0.08524616262485056,0.085712496483003,0.08505921177363654,0.03779465183472602,0.010967712346843565,-0.0016255382978590726,0.04099400959310493,0.044712577058447056,0.010099417353684418,0.04488321006162703,0.06901578233813017,0.012177868801496194,0.052613158685664074,0.08166044959614543,0.06388135449858295,0.01488051899693062,0.04649816151174802,0.20049284982055987,-0.013923199959230111,-0.011956005051693823,-0.03913309492856281,-0.0014288988300713821,-0.0352927204281789,-0.03347324417627642,0.09264942744172856,-0.06717856068457,0.008484337818018333,0.06618985368155697,-0.06324032197822184,-0.0007413634826248726,-0.04842526778771048,0.009629067642470446,0.021600038498449624,-0.01652909983171045,-0.03404933906766836,-0.019706882587813345,-0.06971743993476888,-0.05761688062044167,-0.054183940340059265,-0.07465137711416606,-0.01281223864915936,0.03984005282862354,0.07609591048470435,0.28330870717545104,0.2134466190437981,0.06355011961446841,0.0036703295600231255,-0.055496411434429405,-0.06606752393937146,-0.05781977329173503,0.16973189585463536,0.021752454291022304,0.07571219588957201,0.0420492296557306,0.015181058895240547,0.01113441342797421,0.03755115101765952,0.00014790229228610701,0.015292122954524656,0.07073714646347744,-0.023376710646721224,0.026600363817856416)
shap_list[[5]]=c(-0.03188473591424869, 0.024231577835840953,0.015223503104428455,0.03666732427984354,-0.05832637358415401,-0.030970763529450357,0.024886244720662573,-0.03871763093012712,0.029896928424653954,0.10141735496874295,0.025338528503018282,-0.03640720183708022,-0.017327928177887763,0.013868737671206628,0.030108448165085958,0.0002911964036322995,0.00788706721468462,0.017100127324753547,0.033479885353090856,0.09434851225462056,0.016774773852314805,0.1051050926563783,-0.031636120575465214,0.01868287313165493,0.05249528536906576,0.006944720759605369,0.033996912581505695,0.048538774729874216,0.022080639274201407,0.015759924327752303,0.005990054608914816,0.005890809019121038,0.01248030006665919,0.02695938448368727,0.018487336886721474,0.018460985518864347,0.006668846712166473,0.012366873420610927,0.06653994837823564,0.092601130482333,0.061864874836052804,-0.014182080427899639,0.0027933884350828096,-0.028591554417906298,-0.04873636402344572,-0.045824218358358926,-0.03048194510943767,0.01867665937131224,-0.03523543180504387,-0.025810727680933475,-0.02742350988841542,-0.029605316403521213,-0.030123997104838478,-0.026914802549421378,-0.04102533963229045,-0.04769895851091993,0.1883724804871452,-0.0021142337806848996,0.018550226231984223,0.029368543572321246,0.013005499398550384,0.005297068573728715,0.00702292564785615,0.017445845699863252,0.010583572863632859,0.02118181735890215,0.01931737413627482,0.010885837626041362,0.003825038422289876,0.011527584493158667,0.006681192172889429,0.012998410313323515,0.15603587761553508,0.2169020885536803,0.2643459446160287,0.03118786903049545,0.24164408924733327,0.037929978689189556,0.07337024062163776,0.04210323411829223,0.01659726791300215,0.020790403036637952,0.048146620024708854,0.10092913026409023,0.044439174039252974,0.08820110155624952,0.030394283839762632,0.05591683753636905,0.011003836928559737,0.00776376224817114,0.010367290506855205,0.010385057298197666,0.010934377209168875,0.013772904930891196,0.007944535039055067,0.04979431201991014,0.21861661755715328,0.26490117070615715,0.21857068839899962,0.009136918643284838,0.2236001079773718,0.24284142373525505,0.03516335339704892,0.0402249858708675,0.010695391924762552,0.2211453375419627,0.05645465339657683,0.01908476406308779,0.025082627727485644,0.013865009773310613,0.02633644595485926,0.039452541785613394,0.008430598686401867,0.03571782307107358,0.03668067359874795,0.03610132305440669,-0.0006476818032345009,0.0016465615990120792,0.011805559127883525,0.007389224961621281,0.022982861293325715,-0.01684159395798731,0.005789650739032713,0.04282877962423135,-0.014985015651408131,0.01128328909664488,0.02669040879199098,0.034784081965690654,0.06206473126839335,0.1672157847472212,0.13778361773324588,0.0878652568090693,0.11459164639300981,0.11978070845402419,0.10467493002372832,0.11498167951086313,0.11804199930450912,0.05882264842916027,-0.044077207699680446,-0.04709500631208411,-0.035262358488212533,0.029859248170710364,-0.04431960001290537,-0.04872668099960411,-0.04682820960954035,-0.01551718648058536,0.04869119991242648,-0.046874869061445494,-0.04253056481530291,0.030496585387477414,0.030275967541214224,0.030575391225121113,0.03120635491205169,-0.045504808272280255,-0.0681005993695262,-0.05429438384290375,0.04280713054919845,0.010382178595880524,0.02288296235833677,-0.0791504370151841,0.08409301197233013,0.03240489608524172,0.030994547879368867,0.06335300832939682,0.04050743422803698,0.05534144027956689,0.047613319902538656,0.026326699267159463,-0.005757216025268464,-0.02278420424400759,0.07126821037053292,0.018754348383782326,0.019833236658892164,-0.001036956047185033,0.017047729618138913)
shap_list[[6]]=c(-0.019851524631703747, -9.325526138746013e-05,-0.005683269958543066,0.008061540158127892,-0.006730343493466375,-0.01773550790202857,-0.0020791357967091945,-0.016576502454396708,0.0029433517981281554,0.12088699911054704,-0.0028681978943534813,-0.016641251061706323,-0.019416167074596785,-0.006207221045943453,-0.016681632504327772,-0.021486794180737255,-0.027476111684858803,0.012227827354268375,-0.02015463694170189,0.012160926245407341,-0.023169621746238718,0.003482451301314406,-0.023392403248601486,-0.022629267547986692,0.17439258387477896,0.009415058345212779,0.07719464021060014,0.09332122725323472,0.050900368714304894,0.03996937051512301,0.02029028085968155,0.013047101851528629,0.03134534350188341,0.04369141149546698,0.02921357652586429,-0.00035372494601303546,-0.010186140440139248,0.021503678873316955,0.13303441143716283,0.21459133131487373,0.11880644902656862,-0.016092390584756266,0.015565440378915503,-0.02151700677686623,-0.009525632880207304,-0.014618416652604084,-0.0037941124323681553,0.01604101353342859,-0.013894369156215317,0.0071048051499809865,0.032248261799546915,-0.016592028174281636,0.00015857624732848816,0.004059892436434221,-0.020603635697664702,-0.012894383610309505,0.023967196836282356,-0.025098993222202062,-0.003703291584845407,0.0010665767943087798,-0.02094192257275293,-0.008931530493283298,0.01259041034098146,0.007479044317092712,0.017678726579164337,0.016879438044247,0.006846472787953494,0.007739646297289027,-0.01103582306367714,-0.018995101705895853,-0.019031067188311445,0.018951644120818283,0.1261288415899283,0.18270450266546973,0.19720279572303764,0.0339254412988571,0.1937060501949698,0.01063157838577949,0.051332820391696184,0.02992105028178536,0.025580595602289664,0.016991728458052874,0.04319539924505995,0.21106950479348957,0.1037485264492211,0.22658967698450266,-0.016020261902836536,-0.0006823803177602075,-0.01845293952800601,-0.022468740506340536,-0.022178240763939698,-0.022292394715777576,-0.021585277160503354,-0.01125337395153897,-0.02111966533002975,0.04989897080938064,0.19068357515443154,0.18942645021010576,0.178831242849441,0.019141569096006523,0.18855042984725384,0.19489347202145707,0.04240179241605396,0.039439431564568625,0.023105412143710865,0.19000757553190725,0.05314104712353373,-0.012403843112151338,-0.012332715274855561,0.038585916638308335,0.02071105273290949,0.032665756576671916,0.008762385664036339,-0.0031825304282054974,-0.0017422762033793195,-0.0034562502641238475,-0.023172419820863467,0.006699603909193658,0.003201149038778258,-0.010741050259318716,0.015259504378311427,-0.01799771721642714,-0.020942561430898586,-0.009878687455988602,-0.022230910827916457,-0.01872856565249668,0.17436305143240827,0.16737978846834592,0.03176439862200383,0.00624330412002355,0.41394290569076286,0.3518742659921444,0.3588549557841356,0.3470541874053932,0.37988919749812,0.35743480461259675,0.3499559168642366,0.04090132617466944,-0.00673583539806963,-0.008277576062609399,-0.004457313808882354,0.06345163089414982,-0.007349332448444819,-0.009863081567213414,-0.005776906618536233,0.003598883944713515,0.08210754210883689,-0.00719584483348852,-0.01039221880460585,0.06412878934822007,0.06235811386286645,0.062487779415029074,0.06585197387508386,0.005205270692832171,0.002178495256120979,-0.014993797561732018,0.022359502459544645,0.00821016182224248,0.08505519867335132,-0.01500700023149698,0.09182247101691887,0.07905110891623815,0.0784436145477038,0.1766744449691233,0.09464914896185617,0.018259973574199447,-0.002565692235851272,0.002994420531374662,-0.015533704478770267,-0.013734620526566035,0.027643673654529438,-0.0023316252038550686,-0.001550251752510268,-0.03429507693726239,-0.025288431373188557)
shap_list[[7]]=c(0.21610529899089387, 0.24184303070083574,-0.020897586105929972,-0.017867260760442462,0.08344575831941635,-0.08445445813528711,-0.07040661166051154,-0.03646513712414761,-0.022549402507758158,-0.2392704247587099,-0.06241641620774186,-0.050988217946626356,-0.17034603946440424,-0.11933809321374621,0.09885812270375739,0.1974822818044365,0.4638555046881932,0.32709998062894646,0.017305225681539353,0.2925504257837441,0.17953781209533223,0.23202461033674412,0.061382380838573745,-0.009904484774825808,-0.24641525670501996,-0.07769053285527686,0.03848855354984468,0.049194996278319914,-0.017859123493979823,-0.07464233593088661,-0.19455042983061993,-0.10119759304321829,-0.22734146797718655,-0.23619324004256287,-0.2529064840992108,-0.11308994697081265,0.35131176818025334,0.39109545515480454,0.20613761550788084,0.01864529738710988,0.005943925463882741,0.10021383847417689,0.32576572224362577,0.5498204216037013,0.23796834832388256,0.12284041789559183,0.2677997854431139,0.3363916691444433,0.094785539256844,0.29572101613905805,0.2474997623707362,0.02783249474420061,0.2540099320426618,0.28420369813902974,0.02596586893387507,0.13033391875690245,0.7769659667627885,-0.031036069186913567,-0.016654187326892927,-0.07948110209179164,0.010453128621369446,0.2486629195533274,-0.10503857789899948,-0.23549466359035004,-0.19825209178144054,-0.09167867216203986,-0.25990098174486415,-0.14875695654317164,-0.13193917591346477,-0.05052259918938008,-0.06033732184989978,-0.10299255782441376,-0.2772040031579463,-0.2749475780269324,-0.30444651692938,-0.202662708393339,-0.2843558948865041,-0.12879101076608168,-0.21351244709809603,-0.2759934203593531,-0.1923880726762136,-0.09715842899738378,-0.2639256841124906,0.2466276522930346,0.08226079306931897,0.12683304164560297,0.20618706833627976,0.26331091013137525,0.09819167260900977,0.3244908730571769,0.4948257621786433,0.49487736288699213,0.5012809516042491,0.4957270529642268,0.3472064188018505,-0.26982125302534,-0.3027267860196826,-0.28778004098094834,-0.25594591018909923,-0.25905347873889334,-0.2955084481763951,-0.2865695668821497,-0.26519997408900764,-0.27736995398724384,-0.22697518718692744,-0.2989547546792249,0.5192901658510238,-0.04293175199228637,-0.0612742734257514,0.10266066839254327,0.3459160874113616,0.5096874181910853,-0.16629811237189113,0.30149247822011005,0.3044742555532283,0.3006923694309936,0.11588772860117698,-0.08795061371769357,0.06829033045027819,0.23642897458435996,0.22971278539701803,0.2963273505238529,0.12852985904956152,0.3002159660555414,0.04324864658931088,0.147445143542039,-0.199828124159728,-0.020293629790969783,0.12071899999959743,0.014345990430410847,-0.22690853632133867,-0.14262132693865567,-0.16506216069932228,-0.251085121673387,-0.11778980765890996,-0.1633438995194131,-0.2279141291825537,-0.12232061917262847,-0.18871211401386417,-0.16601619436041748,-0.16230376689061626,-0.2620185047987763,-0.19195646951326342,-0.16942887547463945,-0.15981554401851733,-0.07539484519996043,-0.2341917495390777,-0.18458550281408032,-0.2261618082202369,-0.19732882874269084,-0.24171596753353225,-0.2615782562080544,-0.22169576296599092,-0.07099465375101849,0.3383736512201356,0.09665144241082745,-0.22212638038815774,0.06657157851769849,0.17178658611984501,0.007432692259970926,-0.20327814130759558,-0.2253420526727663,-0.16227112313994063,-0.2974148827047248,-0.1316706198524043,-0.08086437725694648,-0.03715391266117089,-0.02107495315576838,-0.0066032280600718165,0.04891132422144931,-0.01898629588857435,-0.022358305105012025,0.15486287640086197,-0.044427848665711415,0.18959258067705523)
shap = do.call('cbind', shap_list)
baseline = 0.34922148715433554
rate=c(0.39309567886084734, 0.7373554842162595,0.5117176231141375,0.5581697219194435,0.5161166580113506,0.20537885032332748,0.36838709973395056,0.28874578342922413,0.43625135516064084,2.2097932811299947,0.3372759893917657,0.2767498677592106,0.15926181684328947,0.2769846085364831,0.4941385806232644,0.22917367870249075,0.34551373158507875,0.4349709664590316,0.4423896597485697,1.295813215706734,0.4450269123085391,1.1471320812182226,0.25453454369679807,0.3354448643772002,0.8140647150281907,0.13788052655782143,0.40660683783121465,0.5674636903067342,0.25142256111224703,0.16744509000921998,0.676252777097134,0.5992083271478867,0.9332988156657077,1.238015504523071,0.8386936847186426,0.36121864673065157,0.5371948404883292,0.6196917050903044,0.9667351062019939,1.312129296869673,0.8352403135712737,0.18973857894040408,1.0300892864402904,0.6034467280605552,0.6581734375358471,0.4762827170787498,0.7582842436352075,1.095597600554178,0.35645540380779045,0.8748601746048927,0.6647716153787802,0.3010469185474785,0.7229161367166849,0.8319526830605278,0.2715934845796845,0.48495559918224057,2.0767336766773736,0.3400018133132819,0.5760728134699101,0.5141918364165099,0.48501992095049,0.3146811030739921,0.590928157147127,0.4408978105823712,0.615097975778913,0.6196376224333635,0.4186378394670304,0.4975816843536468,0.33732620280052256,0.21140561525533688,0.14719123915791413,0.6684345836582002,1.55041523321394,3.1890929105843235,3.2479418651436265,0.8810280655450454,3.351963724918295,0.37937274396246473,0.7353811023146872,0.7071696713302258,0.8164565563467854,0.6141577176589585,0.9044822763989212,1.4068004567541583,0.6384620040364666,1.2294523782076099,0.6436834668069185,0.866429241869247,0.3261196514366245,0.2864244371484425,0.3964204921855487,0.3959552553057276,0.40891529703099944,0.4942757058349231,0.3006954794455245,1.0048077016759454,3.274629934460662,3.1363404047801695,3.2028483225284874,0.619438189194212,3.2594865699140896,3.3724572017109553,0.9715291827762329,0.8955537627041116,0.6916252779046979,3.229509576242589,0.8500992226981371,0.28532370436227467,0.26943845668313465,0.810376592234814,0.5769974115390187,0.7704341869859609,0.6400587683003086,0.8773527420545273,0.8918017214477004,0.8750722808370169,0.43154937266107674,0.5142818369926364,0.16848265028708634,0.2642943154469038,0.38558193779116184,0.47279391649515373,0.49880240674029924,0.8774873384718558,0.2430643955291018,0.5737118125013364,0.46687433768910214,0.6748653650402319,0.8897893284780959,1.1430866799701291,1.3634744553110163,0.9223986812752772,1.0745861599306008,1.0196966367056293,1.0918608069193112,1.0667463243075088,1.0322487733265697,0.8867320873447968,0.39724198298133656,0.49673343408982645,0.658362235928429,1.583224643623196,0.4793073441816592,0.3894242761336386,0.5522021921391715,0.49376416040751664,1.868673506388495,0.4536726992257842,0.38055092043963135,1.601802006489585,1.5825465709053936,1.5804936367613809,1.6065012811425123,0.7627971455242067,1.0846442612989173,0.7418996615030036,0.9866243697330819,1.1213341053823276,2.0192573405792693,0.5079815668907789,1.988892093138012,0.4732328650110267,0.4961536957747754,0.9053847126608615,0.7005897792347405,0.5624314539430476,0.3114863481969495,0.5604404040435943,0.12737426165270238,0.4084315269698621,0.653997290462815,0.48995121250273505,0.5595163004179766,0.19067973292267784,0.5262972297432945)
rate_lwr=c(0.055221544663511035, 0.06344213502368357,0.13247193186457223,0.08512004361908188,0.11973550618124806,0.021818640226496044,0.06377342159002453,0.07541965208370596,0.07630248469783793,0.24441477613657592,0.042927290649031946,0.07350506365678672,0.011736746604030845,0.05179353728769759,0.051359784229661865,0.011685456877693234,0.07735430581207825,0.06423369095154591,0.04835935214196341,0.24984026678924395,0.0372269805979899,0.20580346055655813,0.025461531965128903,0.01882890159536771,0.18582455837343906,0.007168044765253845,0.05209346448761251,0.030390449560975863,0.040137329061118804,0.0133853708580014,0.2507518891584444,0.2565042898526934,0.2739111890920633,0.17830811553312248,0.29471274632831806,0.021087373589972924,0.08072807911444319,0.0932680080575547,0.21905937368500708,0.3136177722529876,0.12100486357274115,0.018649523076266272,0.23818569662303216,0.10663565580464673,0.13106498475788686,0.18365753011844638,0.24549291593588876,0.2936712677416785,0.04522104315080461,0.27052146117952286,0.05119062643378569,0.07176358242674957,0.24391859150342815,0.23972655051022534,0.08324508381713086,0.14820944504441091,0.4690800900496014,0.053677483642682405,0.13066322266568453,0.022005729082676728,0.06700142251282609,0.016754794214377866,0.20244878939458053,0.11902914356955907,0.26943451773972943,0.19594583531980794,0.0969599242918231,0.20036569720381384,0.011984314286563658,0.006525139501581706,0.0039998697475515654,0.2726343913698954,0.044066721917357665,1.269742600436218,1.1429606922765405,0.32860260231263844,1.280532070401284,0.022701958317759785,0.018808801360117283,0.10935086246278555,0.33347986559624154,0.2365052487878867,0.2680037257992567,0.2839034904526087,0.08765532753745475,0.16838881068545783,0.11355469825286196,0.1502897929650347,0.008008892984832428,0.03885187395011541,0.11287101408943051,0.09823099220347883,0.12597748409893011,0.06528295048235244,0.04663782255159088,0.2662825619712559,1.3341025831119757,1.099993441180993,1.1705009716372121,0.2306058655442122,1.3867527310918697,1.3353529689667534,0.3550371210981842,0.30653385937396094,0.24154052444038532,1.3086197780664794,0.08135390897034153,0.03669309404282878,0.035144322709978415,0.01365708380009592,0.08595357086003175,0.1107821390543875,0.10354469671694005,0.20752042943864688,0.3270193889094154,0.20849841670767638,0.10842383015762463,0.16569364457865304,0.016122653104801488,0.042892074406715774,0.053711468122244005,0.10884164527888723,0.19147899920731176,0.1832907435348714,0.020473379148934434,0.23262647012626267,0.04163264673791292,0.1296556023208512,0.16917110251280315,0.03453201721586732,0.05475267336493744,0.21640033083053117,0.26445876478345115,0.19509197645619883,0.09034400944894394,0.2574687086363498,0.21480231273374606,0.11785632743727098,0.05884783430990198,0.1776155325914231,0.12742359415264481,0.5872156076099906,0.1792223338470495,0.11058050904561251,0.20540717363011587,0.09739061888751044,0.5738597710218818,0.15095599767214313,0.1272070202713775,0.5554496998182877,0.5178911692079087,0.4907300676504779,0.528724101415748,0.2008938869628918,0.16247014883754035,0.2128051881028497,0.06272207456365941,0.10819428618586041,0.48707136435721926,0.11684748097273684,0.32900889409367307,0.05454701728813249,0.07182415813213516,0.15791995105105938,0.12436961827812054,0.07442468045595563,0.02203124527581679,0.03948921635584923,0.007246248793734866,0.10209659056280182,0.04074556322183143,0.13277135625953346,0.06359299754438097,0.022767942419769677,0.10793474176960535)
rate_upr=c(0.8184294014242923, 1.8999876817085162,1.0246597420822705,1.1656777187624705,0.998983235818238,0.42699410535865,0.831552706915816,0.5395528365147132,0.9385054671535362,4.376893810710113,0.7355154741026158,0.5191249728203612,0.34512915888232565,0.5557504636250087,1.2589591047026587,0.6533896518897235,0.6816040523543525,1.0505864764073223,1.2403515640917706,2.5206964201603337,1.036832242832826,2.3755630321519376,0.5241271729565957,1.0051542739015864,1.70770601561119,0.3376286436141796,1.0488853691605298,1.5360182629288357,0.6177904118396869,0.36583976994468437,1.1664939624334727,1.0184751095939604,1.7363629639010316,2.810622298375295,1.4435381718742304,0.7989435129274813,1.1648371916819642,1.4830709947242449,1.9281079447153837,2.744106223026695,1.801099471960245,0.45880066520743357,1.9167038773660299,1.4131653444768288,1.3125563983159707,0.8440968406708087,1.417868721098232,2.0786528413223357,0.9301180156238136,1.5771232567118587,1.7088828374773861,0.5800587710767373,1.3072721097980042,1.4663876338925275,0.5292417726180361,0.8553972304031032,4.223748589936029,0.7699381190365367,1.1881889220466815,1.5454031069960004,1.0752829272258793,0.7804870703176239,1.0643977659812198,0.761407714737003,1.0351087715974574,1.1234816386490343,0.7723569373406205,0.844574787716655,0.9468323857717117,0.5354610856575768,0.3990049809369193,1.181867547010869,3.4258530685399555,5.29681853203948,5.64751618988657,1.5931479197545242,5.404098488936535,0.9563177064395987,1.7807083751934125,1.4513992291458024,1.4893669560904115,1.1142297112806776,1.7700178456788838,2.8281174397679854,1.3656793777678677,2.585060718918862,1.4400987117600517,1.9477235157867412,0.91865795119162,0.6064181277936556,0.7149806383553587,0.7008584506496467,0.7308555936593065,1.2054163989446733,0.7135804997136352,1.8526375739119478,5.294405912413879,5.706453731952852,5.169476409189109,1.1151770909432797,5.390906288976311,5.4438558622958615,1.7480921036770545,1.6972766950092204,1.25539893276285,5.268704135968697,2.1835169127186385,0.6111108967992334,0.59397048915392,1.9325086097186612,1.5097283995999513,1.917198511489867,1.3414759386792847,1.5832163452022348,1.7454746128182024,1.574509135533443,0.7736971559080077,0.8852507771414071,0.36842881871459043,0.5902352685874097,0.8862529291948005,1.0445012278154446,0.8934578957623557,1.7772019226718474,0.5651994319326923,1.0487141814825474,1.1687169408357398,1.3160409814575575,1.9404439916445746,2.8715378787703907,3.1396724536145255,1.9522955170102119,2.1180886506967758,2.0547683626595434,2.2793338047797214,2.108940467110545,2.103098584658113,1.95469780076587,0.7941964187289067,0.9073505625977974,1.343847554311752,2.747100287263052,0.8900321422294533,0.6977889159776711,1.0349646398852141,1.0217708319013703,3.3036469071514203,0.7802210725675593,0.6832587053620244,2.7300012050306433,2.734474486410121,2.731112407931077,2.710494205291761,1.603615628918467,2.2872694418696087,1.5539138549293694,2.48343520586086,2.4413720247158546,3.7157030368955004,0.983203225598185,3.5979164005783844,0.9906506488883745,1.0083783875739631,1.995934180156097,1.4102023399594088,1.3331651928438308,0.7144101274304259,1.4079480856467523,0.29874382439337044,0.852544045383121,1.6521531294342402,0.9415793930454923,1.328343529431839,0.4319417636856566,1.1283142980592191)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.14999629601708, 17.637774121016847,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.709087213395712,11.763688761345936,18.88884247356902,12.543329772332134,18.39999632891166,11.389842614526929,11.45516312611962,18.757996322182372,13.644381033687072,17.34412134875883,21.211041052192133,21.868567692284742,10.092919561981976,12.78599643443742,13.509885309719447,13.644381033687072,20.783073207194157,10.92901570011212,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,11.610334918074667,10.928438777046042,19.116662982107215,19.555450852647265,11.892196451238082,22.26749625621469,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.810905393300043,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,10.31349648091274,3.2289966140793247,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,6.680496549201861,10.955496468845132,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.579496325537615,9.341546499182357,8.275121519227847,9.351663165658888,8.672663178421974,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,20.39513914855202,12.685450981781905,14.172329741711991,13.876163080612338,14.172329741711991,13.644381033687072,19.709087213395712,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,10.74007339597134,11.566150303520583,22.72199624767148,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.26749625621469,12.543329772332134,10.058496485705948,12.685450981781905,19.64726903273955,19.555996307182443,10.704829806890222,11.45516312611962,23.096662907295563,22.62499624949477,22.26749625621469,22.72199624767148,10.647178292822375,14.172329741711991,17.990150182769337,22.62499624949477,21.2476885830762,13.580403826912434,12.518304131776894,23.096662907295563,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,19.967269026724537,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,11.566150303520583,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.05323819697981823, -0.06350938097319869,-0.06821133952541808,-0.06829244780652816,0.06241910607506946,0.06253597377096629,0.06364128815737735,0.061210155193154946,0.06278831390594253,0.06256213603432888,0.06356379474970719,0.06272294589371964,0.06383092777257231,0.06381414059037516,-0.06376047634842781,-0.05991323016887898,-0.08537678306209712,-0.08586793008374678,-0.05407304530628782,-0.053422644544120775,-0.053503473855117854,-0.05184987795293249,-0.05378000363770501,-0.05402369360940483,-0.08097069452522437,-0.09483809761302936,-0.09498353427309635,-0.0944112066142321,-0.09480082339540732,-0.09553065016187737,0.10075948952025426,0.09590306789820413,0.10181150277418194,0.10205525923590084,0.10215952067600878,0.09870269920322747,-0.06454928352007473,-0.05748226980270169,-0.07201868518026489,-0.07606387789183161,-0.07636616004003606,0.014767939182680481,0.003046202389410919,-0.041295217795578654,0.032180127460151475,0.014791099090805563,0.013329454901258458,-0.003183342680415133,0.014704050700407754,0.014692680119606599,0.03307410507201758,0.03395864729866072,0.014822798942218739,0.014235283429280265,0.014896695142166703,0.018694044906362523,-0.05718141198395227,-0.06823770325232464,-0.06795159108633106,-0.06847527680873586,-0.06775032876827128,-0.05976933584425584,0.09793160671182559,0.10516191359220813,0.1044202663696722,0.0994860638032539,0.10516191359220813,0.1026600083283123,-0.07150742724090348,-0.07117486120658634,-0.07117281577480121,0.10111001884286162,0.10344280532150639,0.10361579023726131,0.10350811960057779,0.10293088605175647,0.10368049160267433,0.10302904340372913,0.10389774724314195,0.10382024332733175,0.1016679964027535,0.10019638468633084,0.10385294163839673,-0.07065376246557843,-0.07094868422937115,-0.0710122712380128,-0.06834011364690235,-0.06835237913900004,-0.06850319745369675,-0.07811808504928162,-0.07750095346799979,-0.07755700059338066,-0.07749019260029151,-0.07898244603704237,-0.08593990013939004,0.1064832756784362,0.1064961558504192,0.10611177179494781,0.1060040144099257,0.10461881537112884,0.10655036673027979,0.10654268190784658,0.10569568250947202,0.1054576153214404,0.10448069089813754,0.1061250278271703,-0.07344186106124903,0.06845704671825006,0.06851359772729732,0.03322055973665042,-0.06443745806979911,-0.06392526678840345,0.09914266609577208,-0.0634701296384351,-0.06389847868756535,-0.06416507103591107,-0.06423196801266785,0.08813163783827677,-0.09033851206990655,-0.08940005678767553,-0.09001740992291041,-0.05689185130399007,-0.06413291901865187,-0.06557877167092496,-0.06490925217263008,-0.06496711529612025,-0.07961794436897464,-0.07898497883474756,-0.05920667015056623,-0.06904255339591792,-0.08247151778171079,-0.08213812669011092,-0.08137551603814837,-0.08264763977484625,-0.0803663633913242,-0.08138623495925063,-0.0825577344430567,0.08978566671686071,0.04725853369828407,0.04847187738789317,0.048523491829447964,0.049846721048603534,0.049120507003070225,0.049156056523983,0.04847861419224197,0.04757793852831488,0.04962743683587711,0.049157877379766304,0.049178799389758096,0.04945314386396147,0.048654453459068984,0.04986321023719214,0.049613418719598366,0.04701262917309644,0.036562605797708606,0.03743433544630445,0.03830507957360154,0.03607184506145634,0.037549739505915496,0.037328284730778226,0.09724540345601028,-0.08141127851517362,-0.08105915691416918,-0.08117111305714529,-0.08134099021231876,0.08540989939739237,0.08537293542730966,0.038134509293818,0.03802081345769494,0.03798175058128244,-0.06438064882613574,-0.0647902980234755,-0.06832693662596705,-0.06892815541622425,-0.068417453247639)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.008889318997796481, 0.009365179818196625,0.01106147617402941,0.01109082753451625,0.0002525035601603172,0.0002535201119334716,0.0002638734104850256,0.00024130983036392778,0.0002558544691737414,0.0002537479449021909,0.00026315111651219685,0.00025525724626790955,0.00026564256712866647,0.000265477236060121,0.009439943577915253,0.008126222265096735,0.11330102199168343,0.11921785556231025,0.009205918278023872,0.0089580343284391,0.008989765657495442,0.008355902407733104,0.00909397745561061,0.009186947015516617,-0.1897014861514474,0.15080041063801877,0.15135647313449802,0.14928710674144685,0.15070145249084976,0.15331239968880678,0.0023323556097517924,0.0020761470482755762,0.002387577342188352,0.002400351666498543,0.002405817475084013,0.0022234960197598814,0.03435553271203848,0.027979518814045336,-0.14300730904277098,-0.16394646330342152,-0.16540464946483338,-0.001365761962979942,-0.0014853398107662781,-0.002019669161992637,-0.0009903094249984062,-0.0013705412193144079,-0.0013302142010859078,-0.0015685042396661102,-0.0013525221975131104,-0.0013502286126701203,-0.0009924243617059354,-0.0009752841345997295,-0.001316208835365389,-0.0013180736834300358,-0.0013310139670619915,-0.001254586562968247,0.02477478753167864,0.011071279351670063,0.01096680669981941,0.01115749807052703,0.010894567848429388,0.028160605663715744,0.00219471353142033,0.002593852988634563,0.0025531127876939085,0.0022810663879838135,0.00259385298863454,0.0024561212431765643,0.043600540665768225,0.043149127674827314,0.04314601011723823,0.0023517948120461924,0.0024763256984896274,0.002485523160935993,0.0024798134095662615,0.002448934235261308,0.0024889816236369966,0.002454156376956639,0.0025008731579391607,0.0024967192383621687,0.0023812907074259823,0.0023033031960763783,0.0024984722644799326,-0.1356314121111706,-0.13690023080399777,-0.1371739561003306,0.03930446026439007,0.03932017050150095,0.03951439602189976,0.09095914116622074,0.08935839065679631,0.08950181184912238,0.08933015246951595,0.09383256610288504,0.11498232417530724,0.0026684509634320864,0.0026691685829470335,0.002647668084774771,0.002641592477474967,0.0025638756903205184,0.002672200299377506,0.0026717703956157172,0.0026244279998159643,0.002611026984707748,0.002556331905694912,0.0026483167419854305,0.07698544454698629,0.0006204709591744066,0.0006216178261291387,-0.001002285068972479,0.04879737844895155,0.04793370314946801,0.002246754048178685,0.009344263499444932,0.009486409245594652,0.009575045007020935,0.009597327758584793,0.0016636283817339777,0.13452324935531115,0.13141169181439485,0.13345737418573583,0.00709209903787622,0.009587062437114683,0.0101115455912259,0.009867003777692809,0.009886671902774202,-0.18249860402209236,-0.1792672741973862,0.007848437020868038,0.040213731033140424,-0.1980419065297002,-0.19625554662078276,-0.19215880419391348,-0.19898726155482357,-0.1867859375114209,-0.19221524350526153,-0.19850492460769303,0.0017505835791118477,-0.0021835598781544735,-0.0023163665598504566,-0.0023219089690349375,-0.002469184409873931,-0.002388871420958501,-0.0023929546043508763,-0.00231708448605395,-0.0022207581759745875,-0.00244497450864321,-0.002393152145892956,-0.002395195496180153,-0.0024257985428767937,-0.002335918773617208,-0.0024710062745924403,-0.002443417597230878,-0.0021582433063447827,-0.0010420342057148875,-0.0011234313443652443,-0.0011953132743599887,-0.0009864010743266753,-0.001142843215116738,-0.0011060163831012938,0.002155510408345407,-0.19202467343461627,-0.19017242261551268,-0.1907564937024752,-0.19165513955968708,0.0015156638899669482,0.0015142005952978052,-0.0008804789840539778,-0.0008746035658336471,-0.0008725886469298855,0.009649926198742343,0.009788118846734365,0.03928339201662158,0.04006111005320465,0.03940008237774262)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(21.735, 18.205000000000002,9.438,9.438,12.725000000000001,6.2895,6.2895,9.438,9.438,3.09,9.438,9.438,1.2905000000000002,4.4665,14.895000000000001,21.735,36.414415,31.000000000000004,9.438,14.895000000000001,18.205000000000002,14.895000000000001,14.895000000000001,9.438,3.09,9.438,14.895000000000001,14.895000000000001,12.725000000000001,9.438,3.09,6.2895,2.1900000000000004,0.45350000000000007,1.2905000000000002,4.4665,25.565,25.565,14.895000000000001,9.438,9.438,18.205000000000002,18.205000000000002,31.000000000000004,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,25.565,9.438,9.438,6.2895,9.438,25.565,6.2895,1.2905000000000002,3.09,6.2895,0.06885,4.4665,4.4665,9.438,9.438,6.2895,0.45350000000000007,1.2905000000000002,0.06885,3.09,0.45350000000000007,3.09,1.2905000000000002,0.45350000000000007,3.09,6.2895,1.2905000000000002,14.895000000000001,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,18.205000000000002,31.000000000000004,36.414415,36.414415,36.414415,36.414415,31.000000000000004,1.2905000000000002,0.06885,0.45350000000000007,1.2905000000000002,1.2905000000000002,0.06885,0.45350000000000007,1.2905000000000002,1.2905000000000002,2.1900000000000004,0.06885,31.000000000000004,9.438,9.438,12.725000000000001,25.565,31.000000000000004,4.4665,18.205000000000002,18.205000000000002,18.205000000000002,14.895000000000001,6.2895,18.205000000000002,25.565,25.565,21.735,14.895000000000001,18.205000000000002,14.895000000000001,14.895000000000001,3.09,9.438,12.725000000000001,9.438,2.1900000000000004,4.4665,4.4665,1.2905000000000002,6.2895,4.4665,2.1900000000000004,6.2895,3.09,4.4665,4.4665,0.45350000000000007,3.09,3.09,4.4665,6.2895,2.1900000000000004,3.09,1.2905000000000002,3.09,1.2905000000000002,0.45350000000000007,2.1900000000000004,6.2895,18.205000000000002,14.895000000000001,1.2905000000000002,12.725000000000001,18.205000000000002,9.438,3.09,2.1900000000000004,4.4665,1.2905000000000002,6.2895,6.2895,9.438,9.438,12.725000000000001,12.725000000000001,9.438,9.438,18.205000000000002,9.438,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(4.0, 2.0,1.0,3.0,0.0,5.0,7.0,6.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.04899425915834601, -0.00032633815766618915,-0.02006845248511587,0.008332953019960383,0.27247303993660216,0.2704603493506422,0.21794012336307958,-0.012295345713933606,0.23330929717078955,0.17474026091576622,-0.03254331488747211,0.24891868529857875,0.35090855700664475,0.06290467773980295,0.010109585986522973,-0.007916094572528001,0.14312941098825416,0.01433831817756621,-0.006740936011430786,0.00792455686617358,-0.004647949464017411,0.010188874304580276,-0.05518544276919465,-0.008911056836080075,0.16551114698433245,0.12914257058321696,0.0005353850656311445,-0.016554108474473004,-0.025791182102796354,-0.007464200558912301,-0.14417285752420872,0.02975375787482432,-0.14935739383357877,0.011808233664029647,-0.1372677238737139,-0.060678401283694,-0.0025420927689315752,0.07217407697098836,0.030111515715070165,0.034223492256546605,0.05469239980923615,-0.01885332733864816,0.0024537922941686822,-0.0033105572446807344,-0.012254232697373014,-0.0034311794392556725,-0.007295402979864127,0.002633378988507792,0.0111638916314332,0.0005267107573890032,-0.007248708474616422,-0.002101043463622314,0.0021751100013960157,-0.0036261752760406818,-0.008577967431728546,0.017063057017324305,0.03423380267768997,-0.01915959711412837,-0.031294307702354376,-0.03329859943664703,-0.015942227559883396,0.2721109638660947,0.02023811472035531,0.04508015927954208,-0.13972698086062135,0.02397110480669226,0.03128251805551737,0.019328962796322062,0.16416335823989284,0.02752285491366495,0.0015228057083980773,-0.015182638285310614,0.10722532914530468,-0.05000590865830087,0.04464898371902477,-0.04278643633266784,0.1248528216303736,-0.047241935579399194,-0.044084198992003235,-0.2037794653406744,0.0016548932363587923,0.025541678462612537,-0.215823779056847,0.010569260348824322,0.00933040253498296,0.014889319325908437,-0.012581176709058877,-0.013425823659396883,-0.004211278632449964,0.3407340873502493,0.17074733399124342,0.2403271782973215,0.1801669485529269,0.1637966328623546,0.1834480902621188,-0.057862020123488324,0.1472398337979058,0.09979064333580219,-0.1229683530479403,-0.059671523073659284,0.13411655222477287,-0.03860407423528632,-0.19161407665700042,-0.05966017496289603,-0.164639201947539,0.1630365195268331,0.2703123014883135,0.005800356187590814,0.01133014798851144,-0.008778572628081661,0.3612579943090214,0.31120663052511965,-0.04503226990367481,-0.019162479569900207,-0.009077743716646956,-0.002365433271363034,-0.015160139880299583,0.026654462531866898,-0.007883830530395382,0.041627008502223735,-0.016955823326286538,-0.016943834152734875,-0.01840122992254441,-0.023906220871357214,-0.010011911663672466,-0.01918379714139608,-0.003556149708042668,0.0013680746237566862,-0.002528825014712045,0.12040135173867125,0.17672864492042178,0.08695233585161316,0.06171818370478616,0.16354462064282932,0.071406893349221,0.07367209833162723,0.16585197205278934,0.0904103153900343,-0.020475394931101926,0.01238833833120146,0.03301683774641902,0.013785620695605568,0.14428249600570414,-0.0109642691393893,0.1441377012539935,0.02686571833582365,0.0517621519242175,-0.042385521203180516,-0.06350127645584289,0.024058635870588943,0.030359440388333048,0.04182301302964563,0.07810970323509402,0.019993163476626108,0.019910126230374536,0.02732399639981741,0.16562985855199586,0.06257539504103757,0.04088799938777247,0.13643392414486763,0.11217570883151065,0.06385103352352484,0.04770317166614925,0.17046924812026265,0.016702763344749166,-0.016786885718061743,0.012356899197643125,0.010301818785025046,-0.010117134474076809,-0.011775558240723943,0.04457737747856657,-0.01231833800960367,-0.003420496985585692,-0.015345562966012702,-0.002655541517770059)
shap_list[[2]]=c(0.09378853499915842, 0.136173655081332,0.2594086441198997,0.35477410394570874,0.3685197361599085,0.37054331274978936,0.34284223174619544,-0.03595630924277861,0.3687775077734904,0.315939956598411,-0.033249217905539814,0.35736514740995484,0.533736815699735,0.10447933584767062,0.15748868680274952,0.10384290007484062,-0.09714901990513809,-0.08661107017884134,0.047584235067754145,0.11977133104127437,0.0044013943659145785,0.07964889237944231,0.05631017353881901,0.05774568166862425,0.31365882499147724,-0.3248024241825614,-0.1321031149560616,-0.05439816682627394,-0.09579718211398495,-0.12769435963840808,-0.10381257413158959,-0.05384448519126913,0.12622119118504213,-0.028388370510234236,0.12734039129839114,-0.0886763073704398,-0.07775214550331856,0.13768727768199485,0.300683061304679,0.17462969319731436,0.24337224787291778,0.0765940591855877,0.10204055938758924,0.09316732640126547,0.06903363238471807,0.09623664274164972,0.08038891552911447,0.10267017809228672,0.08762953235365989,0.10019863020495834,0.20939426294688826,0.14587556044389888,0.158443480066798,0.08598123938256473,0.12679080466359802,0.12449253237147946,0.06785210361161474,0.1595249988936811,0.20621509542884167,0.33890328982528617,0.12575822422060148,-0.06884282377256688,-0.050099126731542445,0.046305865053368506,-0.07399901184178595,-0.047111351111478926,0.039844865466493844,-0.05431143096255833,-0.18642291335012967,-0.08300793047607993,-0.05656957153891558,-0.0568425127576184,0.05351156148585199,-0.16651419357333508,-0.05182953364565979,-0.06993272845418187,0.04668176383981012,-0.0562059831975199,0.08585870889759255,-0.07115881343962918,-0.051996854731869414,-0.050062466840194234,-0.13406719994525765,0.2257925757430329,0.2553517171921278,0.24856835609274008,-0.0696459330932743,-0.056130594663414704,-0.05297551804380616,0.26035115026161926,0.09087373799975215,0.15718190933278275,0.09896649196845352,-0.048714526176297374,-0.08324501279468324,0.04794756723073242,0.14547525592441254,-0.08034344147181244,-0.1975250246908193,0.012749370820974182,0.06760656924433374,-0.05551005443422009,-0.0845206108070775,0.11868350933904546,-0.13628224445384754,0.08041656435640188,0.3663318430310121,0.15411943520986174,0.19787642336531788,0.20353002085562338,0.38681902146219677,0.342071681217084,0.44291236673740336,0.14471894513416222,0.18018008644639785,0.19148978462347044,0.16315977335721238,-0.04934034006502684,-0.10498401367455928,-0.14232539936888566,-0.08832711065977851,0.04314471325463149,0.14407333128820235,0.13431865590556147,0.248767959056126,0.14206879772722958,0.25861140271932637,0.2649338275793797,0.29340011496236806,0.0522335987857147,0.1922750739953296,0.012048588524192242,0.00790720481766679,0.13535642325272243,0.020006227612231267,0.014896047593860467,0.15716237175197362,0.12555411067658984,-0.10032076738310662,-0.06081052117790763,-0.03944979827353019,-0.09497434660403895,0.16326543767730803,-0.11335658292280575,0.16305115835071737,-0.04851091877723224,0.030804150020014187,-0.11765190768606336,-0.12464914573081047,-0.09275380018433921,-0.11692325301533545,-0.09746054697865017,0.08307940670098315,-0.049138528543176914,-0.040097573500869683,-0.027845240539237932,0.16972068188547126,0.0107997784388195,-0.057236098464310284,0.15447755556839504,0.18160149681939572,0.05457832639335504,0.02624021134428681,0.2849022687929415,-0.020428642017898395,0.26138134368580523,0.16579046787019389,0.24816291642729302,0.1040561164264148,0.13266470238448239,0.38038723228848853,0.24326397352868562,-0.04786576421369068,-0.0688150620900967,-0.07109052557563038)
shap_list[[3]]=c(0.15457583698142724, 0.37116827904661026,-0.15891996092388067,-0.10660175907453705,0.10716982490510234,0.13071979102854386,0.6643272582835306,-0.033602386399867526,0.7075571913214618,1.746304411847069,0.06419255657324356,0.08387787200186875,0.0394782958420387,0.29485963301510065,-0.04413335191528447,-0.13233291160292593,0.14028507507598098,0.07744558563872705,-0.044530639980396754,-0.0032142874833089247,-0.05435447234512559,0.005194888155818061,0.10808473267672666,-0.05637209054343901,0.03578683062733654,0.5216238521146274,-0.0077177997807867,-9.995523167931465e-05,-0.020929314681533633,-0.012183245562349553,0.2710286004413112,0.08685073983671991,-0.004276437873294443,0.09636520532593847,-0.011572763075723762,-0.06150570796281358,0.11213033858594998,0.22085590555552986,-0.11009843256760057,-0.12978449838031736,-0.1407631060379813,-0.12401653768858734,0.009028016201173602,0.11747755909609625,-0.0009139019665195058,-0.011876501282600309,0.011575694494707519,0.018767958884200932,-0.014295026764059459,-0.013574514593817984,-0.16831976278209881,-0.03245115628550257,-0.03817034082436111,0.006027371969855001,-0.022629436889005036,-0.02934065789529633,0.07952720610788672,-0.07786763861111894,-0.15469619505846577,0.5051108220132,-0.061544330990567477,0.2608084364676409,0.11459169470863462,0.6021872679665234,0.37075999488284717,0.12489774022860345,0.5863079333647924,0.1173891433338969,0.035411468434398415,-0.040456997922826414,-0.048295827978157034,0.1971851169198396,0.05607372023873439,1.6903151870503343,1.4042199145417096,-0.06552169579800492,0.9564044553394738,-0.30294438855726,-0.8270719024722593,-0.11936644174141658,-0.04378075916374336,0.11470868202612014,-0.09449427435359176,-0.10377005816435336,-0.13346473850903476,-0.09652195993514685,-0.025332643726090318,-0.008093289721354877,-0.13755229013996803,0.5225061430440118,0.22385744603206661,0.34002880897350213,0.27074917742588717,0.15544202316310085,0.1662408769328744,0.00422219806350191,0.9101302383656559,1.3999199058862084,1.6403682164521596,0.6573131851242228,0.9550055368408292,1.7106409944129775,-0.08925791294069482,0.005921816210883424,0.28203805748231653,0.9449412380854432,0.49218777995467233,-0.03249082008437069,-0.027579592420145734,-0.07976337052813026,0.5897879459055894,0.5227266038515986,-0.05503290749292322,-0.05124935258932561,-0.08593974746154275,-0.08794658047772157,-0.07399867759326767,0.07936292433990026,-0.028239238849499037,0.13155341294098571,-0.0293191291539278,0.1260434837582674,-0.0583119867912989,-0.058557365264944226,0.2600736056281321,-0.06096746079308487,-0.16592764266573468,-0.1724105494830914,-0.11843573641958315,0.06081913207747163,0.1276756871691493,0.08345210157373885,0.0752683902597351,0.12060690353167612,0.06351231979789887,0.08530264043793542,0.1296142627487795,0.14578786117166168,-0.11723180755274525,-0.037328632824947985,-0.012969299411311589,0.9355604525215753,0.018471669163922073,-0.1555757305945567,0.018162815468053584,0.10381931396450535,0.8115242563215473,-0.1470605111812007,-0.14746219177490133,0.9134133458298864,0.9243965049115469,0.978307215442142,0.9359899358445061,-0.02934978974253663,0.008138662512940553,0.0350101166342097,0.17214481781595334,0.1129990246997444,0.8123755603128099,-0.023904882488891062,0.7693106854140247,-0.14657185305233086,-0.15057656773836184,0.03786237245821028,-0.15533792764886542,0.15992032560367625,-0.11198572622641713,-0.0036685259132924644,-0.11375891908723484,-0.02700344617351608,-0.06553143390278757,-0.15366351917710003,0.1198447682306181,-0.022505718352973353,-0.02236466760027776)
shap_list[[4]]=c(-0.12667417971323494, 0.07355208224213276,0.07795805551827203,0.22958152992133718,0.4167466195048295,0.47295447417826286,-0.15424052296937374,0.007915392114220932,-0.07566334579326195,0.2703281190848453,-0.05726663954989961,0.32813108922034695,0.2082263891861013,-0.06796856806265411,0.037688067007928344,-0.03146858433422548,-0.060400816862880805,-0.05315876932015708,0.07877349672964133,0.05044528634598884,0.10967588322261985,0.044563812059825465,-0.15939709266260282,0.0817974160474188,0.0471638202251627,-0.05417594367590137,0.10440507015774313,-0.004314735692719354,0.0330776530929918,0.08958108957823017,-0.15246755557979597,-0.04683445508132273,0.46344784109710646,0.2216574997139666,0.36849959934829324,0.025028578780694394,-0.046576774902620105,-0.10918822981679589,0.2301567492778426,0.001912984499468088,0.13777446967271845,-0.0003335043886868177,0.03533533846429003,-0.11285341943547801,-0.007842315810893829,0.030947785277794734,0.001247580622398554,0.02568171216588641,0.047585252145242576,0.04751708909174833,0.19596832911831638,0.06346835500649756,0.06544645504563555,0.018061267540809996,0.02832855873825585,0.08723798194767562,0.027173764998993325,0.09162617630649358,0.031166348952112535,-0.05115572347484195,0.05769846101578814,-0.07060127980139741,-0.04758004518092049,-0.15773124732642882,-0.11269732383836359,-0.031953077686440595,-0.24552376928011385,-0.052254530238014435,0.45959123848336164,0.06452613025891603,0.010579939531772971,-0.07793909654730839,0.812882599213216,0.6103412365565122,0.8262521137761051,0.10932514934830857,0.5391854235811852,0.10582998701310613,0.6106131721826409,0.32472893158880567,0.04107443832421234,-0.03522411364187524,0.4619118651334954,0.03140464337942852,0.13130288770657755,0.018080042026490523,0.04505569726139198,0.001761135835981564,0.06180809770316731,-0.02595707632339529,-0.12096160008994757,-0.09047906731104426,-0.09174320743049565,-0.0460654851058245,-0.05149478680901393,0.8085207310089784,0.45770787730275525,1.1628301011726536,0.541296621067802,-0.01173103679596658,0.4744948875794596,0.7037331634859295,0.2434556661614372,0.7039154723688004,-0.12821939841148397,0.46689422433755434,-0.07495500222722729,0.06956436778461698,0.08505982679084466,0.05645675157812644,-0.08731122285838828,-0.07128171282172599,0.08605415770211534,0.002209061929119287,0.05049980268853295,0.07332674837381697,0.03066781764193065,-0.049455824423110466,0.07956191948378857,-0.05923234138487064,-0.00391954605398737,-0.08707027456810486,0.01327428275865969,-0.005468365031591408,-0.1971623120336098,0.022841025381494882,-0.012629464563274672,0.10852750899276652,0.17606620106854745,0.12094501928237057,-0.010725619338762208,0.20709614347344776,0.14868474498905715,0.2442501288346157,0.12991013928276532,0.20697391749468524,0.2996188355981222,-0.049682238940393884,0.37514743105389436,-0.005391777204998646,0.038520908005540117,-0.48352993249652304,0.46787011901051984,0.19633144658040294,0.46665949430327625,-0.06061211858249864,-0.11280059698484098,0.21236358259719867,-0.04221443438877173,-0.5038213822767722,-0.4838561546025984,-0.4716439513750826,-0.46768390266189513,0.024062587169282924,0.0018202970380836964,0.01889871921543562,-0.009526420984239382,0.08707251671144856,0.10811088900644106,0.1552714576270238,-0.08776889625278744,0.3501920599443347,0.3234978660807656,0.02886619275936202,0.0827032425598746,-0.10474007709413047,-0.024912463774812953,0.06507614340715336,0.03436438150562195,0.023137170873968525,0.31115152223851306,0.08863608155684953,-0.031344028313060636,0.026841032296013107,0.07155680728551837)
shap_list[[5]]=c(-0.10035736077451582, -0.12947301280104065,-0.119077991081704,-0.13941928088795688,1.2773601066440246,1.30399030638228,1.6318485903101854,-0.07492092995254207,1.7188344060645484,-0.23279646341369686,-0.07669794325065599,1.13249303670417,1.5572613954543493,0.5173951758398515,-0.09714870132779581,-0.06721113622917703,-0.0683633475194862,-0.061058088054364856,-0.10084503613321476,-0.09969697394460653,-0.0948796920318269,-0.09408552198705625,-0.09060060330234168,-0.10608757975693969,3.1695223823513503,1.0893408543306895,-0.08179378332490661,-0.06144884696773437,-0.06553590846938767,-0.07792487378895468,0.7365331418816916,-0.08650622188099531,3.248897488856821,0.6379683073113763,3.215403963872702,0.6129213806636016,-0.07372993421313272,-0.09424062523759064,-0.13340441974797132,-0.1064739332678317,-0.12408407184190065,-0.0698558702056417,-0.08974606795547783,-0.07980308497154863,-0.07951155202071639,-0.09179487632644505,-0.08039132046499807,-0.08865380156466417,-0.0899784031794802,-0.09398568531668054,-0.11053388072993892,-0.10108613120584582,-0.10428133522275791,-0.0833848988632096,-0.09229083215657705,-0.09612200357372264,-0.08164176171300379,-0.11389635552850629,-0.1046993727001052,-0.15907251551104096,-0.10424657709243729,-0.08766592123776332,-0.061205832825583575,3.1810976861755194,0.921100177796701,-0.08209659979140178,3.1045254516584895,-0.036702956527164626,3.153541463104154,0.00022666509858928468,-0.06814279480003797,0.24608469434542918,2.004224589200528,1.3239769346238743,0.07370883706979946,0.14587909698663096,3.350310479975081,0.46572098880839663,2.786311305117993,0.7444536726714791,0.03220278249286718,-0.0893539805708274,1.093936724999316,-0.1097459773721309,-0.12029614702029989,-0.11331796612273617,-0.072055417833387,-0.06323378658799086,-0.061795277875245476,-0.1258726920235891,-0.07680051153788219,-0.10077971678536787,-0.08972673634575899,-0.0699645541581994,-0.07240265758737767,3.2998984937222837,3.4030519410102693,1.1754434227434414,1.2607291110686223,3.1416420294793785,3.405142014100768,1.3898602560446882,1.2158595015379032,3.3786428448682786,0.7057456495430074,3.4079565672949994,-0.12324346236103972,-0.10576951363729903,-0.1110157767429874,-0.0978924941307713,-0.13653247049074835,-0.12556632019617558,1.0888166643067965,-0.0868211088542126,-0.10463064785500971,-0.10808719484929712,-0.09658047138966742,-0.08461546847952567,-0.0752140755198462,-0.07522855072643139,-0.06271755678901937,-0.08446132912436369,-0.09167669905694917,-0.09198450011436772,-0.11813876885511965,-0.09402774293175349,-0.11591019005630676,-0.12540345866704525,-0.11929454897938523,-0.1173238540662189,1.0436029781166434,0.04614055653668644,-0.11772339390487656,1.0080102404960618,-0.11065891189828299,-0.12198702347947593,1.0276428355838747,-0.111451696996262,0.9280465051488747,0.03916588372373338,0.2919978514506911,1.1438963234536121,3.712284716897683,0.8435179043961102,3.7122418413458815,-0.08354047481561065,-0.1161140138866136,0.9878717956550999,0.638958132359145,1.103226634083387,1.1015158252280703,1.4262636622085898,3.2348489846760176,-0.0671416432295019,-0.06672099119100235,-0.07539558238683065,0.9611704718281906,-0.08442601517842403,-0.1588191878053728,0.726002361940395,-0.13556793779030304,-0.1338967304446605,-0.12813117737138074,3.136430620186711,-0.09963622104878248,-0.11757978504935726,-0.08103557768547008,-0.11057852914916616,-0.08237770220793385,-0.09328420489921956,-0.14412006323797283,-0.11565294140291775,-0.07582508880305898,-0.07271297248365909,-0.0821633028553148)
shap_list[[6]]=c(0.068788934925365, 0.20170667050651325,0.08516391186035623,0.1524691649780199,0.022591431172952505,0.03175651363565526,-0.04592575895164427,-0.06630086073216455,-0.04423995404814622,-0.005723474510911143,-0.05831170755245279,0.023819788062881056,0.05582485996198288,-0.050695109348194156,0.09170062527215064,0.06516221247163537,0.04120587685100029,0.03977805259578826,0.08449057953848534,0.09535171616147256,0.052102580556597285,0.09338250615016273,0.05482915879110355,0.08027666347141259,0.2354089718200666,0.19032676231487947,0.0747435288259876,0.04095859092694797,0.051947162746688196,0.0687062077757476,-0.18994181784668904,-0.03267836641782689,-0.06624396501231716,-0.07382122280876578,-0.0837639699722473,-0.11554832802411368,0.04091567668323619,0.10199347622701163,0.13831334514084934,0.07852799408112844,0.1106035933930887,-0.03192074538011912,0.011864952880197822,0.025609012784599813,-0.03656577864481442,-0.008694854595714605,-0.012324191361995456,0.019081706413921075,-0.0033658971068655247,-0.0062372570512042175,-0.07803331652737791,-0.03462713935029319,-0.01212084421091652,-0.010042535867176964,-0.012896059276692762,-0.010371937398029296,0.1003961131368605,0.07222262913070197,0.06717131911531463,0.214266756599395,0.08084341792740717,0.06828172160450899,-0.031187377717578468,-0.17813194271740193,-0.22674477026999834,-0.029207601323384194,-0.18589778726093453,-0.03324403151122757,0.11537035498338036,0.06973494879666044,0.0415934406701534,-0.09784177518502478,0.013757412484801527,-0.18354939381452823,0.010644399274005149,-0.07401347432479352,-0.04644684992342684,-0.08029438980580249,-0.03305634326874722,-0.14928133590125872,-0.0626561198268102,-0.029618301315308966,-0.11408403932677988,0.09615888403229451,0.11073402539565183,0.1028001954975506,0.04918125639064724,0.042923192221329357,0.04363564745744708,0.17853041667646985,0.08382314595823508,0.11884103190710593,0.09746720467240896,0.04452233889277664,0.04385577527587766,-0.01317390604976949,-0.05390436917533382,-0.0016300845929589946,-0.20333328803328793,-0.16816913283631413,-0.07048820317666159,-0.16760043176679004,-0.12456240880830267,-0.019712490458688406,-0.1942368625769246,-0.06558070370836211,0.21529880623047576,-0.06258072060295361,-0.052440086488203495,-0.022292391636283923,0.23055725076106798,0.20385186060213428,-0.12898779141201658,0.05221739648126609,0.056612468062521765,0.06228662241142086,0.05506628123759901,-0.032009311503497756,0.064273666197274,0.04783707461810871,0.04339694017728513,0.07050086853216926,0.05804046223433558,0.05492703229629466,0.11361232853221513,0.060624812531086786,0.07414883088670134,0.09322555541734255,0.10885305308474517,0.2281895658758324,0.22341808066771188,0.14497530248936602,0.13741299835075174,0.18843616996289256,0.12671320565568012,0.1519604945473495,0.1794098725616422,-0.023497536580413706,-0.05424645185684112,-0.05159288568779756,-0.018148648063353777,-0.030866948359866322,0.10508009425830396,-0.07517319383599647,0.1061686274094953,-0.03925412303802045,-0.020135682347435912,-0.06951656616846921,-0.0805767530932207,-0.028484705844936856,-0.021434192351452625,-0.015107138836865139,0.01751941377920383,-0.050372172205083846,-0.038420763319221965,-0.027823034232566542,0.09807697484612601,0.01104844640823436,-0.01925981507992851,0.029333477697913456,0.007359144945091132,0.11754343183127604,0.10794564649483476,0.244785473380155,0.06845840633235357,-0.05366239379433368,-0.0324605297424413,0.008074987603234206,-0.04969633595359395,-0.03779655675405445,0.21052494530932675,0.08610138771872855,0.05275824792274137,0.04821097734613189,0.05590108470584723)
shap_list[[7]]=c(0.01261488075461578, 0.056898394067116526,0.016897224564809528,0.0405600888677216,0.15079583505666982,0.14908291354974018,0.1714883824211084,-0.0036892746192880785,0.1857568125874363,0.15395765453607782,0.004099503774012012,0.13058951234523425,0.17224241877382973,0.06592223171766508,0.020882957398752032,0.008959444898283797,-0.05047276446589333,-0.03691458355430615,0.0070096585979555264,0.018853782777657112,0.010026396568449928,0.020430255723992305,0.010022939353563456,0.00843935250784852,0.0521396436423324,-0.08309376437212339,-0.010948067414483441,0.007208997296813856,-0.003617546501838606,-0.011580388691866618,0.03865888739659474,0.014189682342060302,0.1945442351520845,0.0741395716333671,0.18779232582160688,0.03340638885614208,0.009898115374665529,0.04978463273581164,0.12714506246082774,0.13582773046812488,0.13622355095048982,0.00169399798682534,0.012650909373997703,0.00648645189550503,0.004283432169405849,0.008456526300226584,0.008338117914499529,0.013858427648016675,0.010875926775222896,0.00876463526208605,0.015810324462968414,0.007092445953556364,0.010011395199538316,0.008577326355564442,0.008576092335797552,0.012494037636526623,0.035712808028859934,0.002930505313749995,0.00796417768221967,0.0598643365991665,0.004502801303635623,0.08276501979345897,0.01855081588297265,0.16000635528685386,0.048384122399823724,0.01723774251730933,0.15477851913359938,0.01895033491594934,0.14953490693542842,0.010209880958983567,-0.0034400204793011563,0.02669119442849665,0.1620273181284514,0.157708492156022,0.14381535603183257,0.011830614899276833,0.20141796773809825,0.028761880431470706,0.20163033397077218,0.03876667054484068,0.006086900698862237,0.015062562764463478,0.06953380778902728,0.1626155855878036,0.1268993458059404,0.17730334495032676,-0.006506559311151947,-0.001321631313483479,0.0005027014644067649,0.07771831753498114,0.005228274531181977,0.0288485309494273,0.00795937359070038,-0.00975213029225333,-0.04547264241108782,0.20794857371809078,0.20131358912330555,0.19035044839219267,0.13963667880355116,0.15417294453030658,0.20078654297180984,0.17235414443613464,0.06558011254467072,0.21649631531395272,0.03600382003591694,0.20413710331093762,0.12987982053524633,0.007534142827928427,0.012041819190882472,0.022835887833541853,0.15345465131549682,0.13376659834412233,0.08288835703725284,0.0025819365348655685,0.00335190135731037,0.005400032627302241,0.0021460557212426945,0.013336637911725771,-0.024114609017437713,-0.09706592016766566,-0.02070644807242696,0.010633044333571096,0.0034973093840376486,0.002767797146797765,0.025017884942932216,0.0031804686849384476,0.12053984487697914,0.06589820870708657,0.029321662825970495,0.07026890172621779,0.21187711051536,0.21577257961661636,0.2007609542541098,-0.10744097988562429,0.2630508592115443,0.21222302271500285,-0.11750790756642189,0.03800641956371122,0.04429124302812196,0.002810472746338477,0.02481500901269082,0.11260045788888717,0.22809897418675962,0.02783506697888245,0.22810384967506664,0.0182853561297649,0.055531426274954936,0.035216500863439325,0.006503833209435128,0.11054344478613971,0.11112649403282526,0.12531618296712588,0.16811951157610114,0.0004116758263009689,0.002637352726849583,0.010230002180584579,0.14346732863432698,0.037731445331189974,0.043457715529842456,0.07071046218256924,0.08132173677190191,0.08372780507749146,0.08669833665318927,0.052524615864973354,0.043765354902864886,0.02826073390631344,0.010393209112710472,0.02110228911429737,0.0053976405957107815,0.00577673786252284,0.06712391603721823,0.02218711901297376,0.012868504635843759,-0.00586357609575878,-0.004583436569218393)
shap_list[[8]]=c(0.010475988537623099, -0.0575995407727154,0.08738016299726438,0.07569163526232808,0.28654203687054436,0.2944384051882842,0.32649860958423127,0.018372918752673967,0.329957680427631,0.27508111089529796,0.034803899374793675,0.26236578191803983,0.37112220432825815,0.16691689715126087,-0.04206532055596611,-0.004122200909295121,-0.15449445729482242,-0.0814370808416586,0.0007077964127018519,-0.028062482699297227,0.026647958452182846,-0.02609023688783057,0.02488029010695881,0.0357798033231906,0.1942414485094232,0.24151897546454987,0.07142880642448571,-0.024634524524741023,-0.016534680273411012,0.04576445852515424,0.15191299273277337,0.058724172071672846,0.36357132100879097,0.12032210889531146,0.36035943469493675,0.1261136802079211,-0.05723847741688003,-0.2021252667503534,0.010191879384590936,0.006060287998622086,0.008017845060138883,0.0041813869379175705,-0.0459208469302985,-0.12426673542731141,-0.01456795999399266,-0.018182334764933125,-0.041318556981082964,-0.044208556736652714,-0.03545630551480796,-0.02460674966367929,0.009190172251177109,-0.00032416080665957295,0.0020136533134356904,-0.04672357855624116,-0.024092412885295917,0.045833074237351966,-0.06247445333629922,0.040170065140044744,0.04250413249121242,0.132811588982182,-0.0025478250665113356,-0.1656257257387404,0.07146947514668611,0.2706525071080405,0.1992440970694863,0.05223145183012415,0.27146575599814965,0.0756645028153472,0.22283150183044687,0.08125095883465322,0.030047947455822115,0.11422163607355106,0.2312617909561404,0.3132693149269681,0.2641891622388252,0.07802377865673979,0.23435681789827245,0.09673515840862991,0.3163878025737289,0.19638314211492838,0.0554835855982127,0.05074521757666445,0.20455859414798372,-0.04012005804005056,-0.030678846200104457,-0.01610440020742638,0.021281284676156306,-0.040302611353423404,0.0046630317375851,-0.2528164246233192,-0.3977325997338834,-0.34981976303867474,-0.32753231115897014,-0.17173557576408804,-0.1528399364790465,0.30801419973816196,0.2305763627608819,0.25278252683101393,0.27766736997887265,0.27670980037994225,0.23554115651642954,0.3089634034534043,0.1742455287165053,0.33156753840946834,0.15069815129289277,0.23431854916565392,-0.34349922708549074,0.04451564249882387,0.05584769286461016,0.00911872542277967,-0.26136387506959186,-0.35590877580103264,0.2465495604058104,-0.0571537140800143,-0.0012650116457019933,-0.005185222709681753,-0.03190797232760612,0.04885169839265333,0.026065455886048337,0.018833032387941696,-0.0008774110834135194,-0.08881726546138356,-0.03990957707015983,-0.011700173958223802,-0.014057081025071512,-0.0333709660763957,0.09697806794670219,0.12195802803142149,-0.026599486530713798,0.04967329480035881,0.18204679526035825,0.11238114274325342,0.06773408796459604,0.19862507613597807,0.043282271525947456,0.07415437672817753,0.22407231136645112,0.08474475908242651,0.2509376416764722,0.050266394060033394,0.08964448050056859,0.26286004967128673,0.3128718850215696,0.2054062480706574,0.3126613427539095,0.07374782793593743,0.1685434240526714,0.21491996321074444,0.12437473780132302,0.2373961411640965,0.243508223441558,0.2732760635179644,0.25414458058026396,0.030003981463460564,-0.02808958557555874,0.003990123308315307,0.18175164340115452,-0.002828007689197354,-0.09663686120734692,0.21514938171911782,0.1289842935726964,0.1349114367390025,0.11661421955756644,0.20030129676793929,0.07462316057242234,0.0980979052498461,0.03633182249896086,0.005780971642071252,0.038773212814944835,0.0002020940792130029,0.021521405936371855,0.04818696882535908,-0.05890801609662446,0.0015813528963513953,0.035129442326139)
shap = do.call('cbind', shap_list)
baseline = 0.32645381234897725
rate=c(0.39067218890106914, 0.9785540015612583,0.5551954069188769,0.9418422483815577,3.2286524425996133,3.3503998784121745,3.4812327261362896,0.1259770165552968,3.750743407852928,3.024285388301836,0.17148094892500507,2.8940147253100497,3.6152547486019175,1.4202680862494785,0.46097636101803324,0.26136744214558427,0.2201937692159906,0.1388361768117295,0.392902966570472,0.4878267414143304,0.3754259116737707,0.4596872822479107,0.27539796808200856,0.4191220022310121,4.539886881500459,2.0363346949263534,0.3450038373465857,0.213171062855117,0.18327281404570397,0.2936584999876171,0.9341926297190637,0.2961086359028394,4.503258092929633,1.3865051455739654,4.353245070463225,0.7975150962162747,0.2315585181879449,0.5033950597155725,0.9195525733172638,0.5213775632020315,0.7522907412276838,0.16394327145762333,0.36416046606461683,0.24896036544742392,0.24811513576879038,0.3281150202596986,0.2866746491217556,0.37628481624047894,0.3406127826893216,0.3450566710397758,0.3926812326142942,0.37230054264100537,0.40997138571774383,0.301323829035102,0.32966255944732814,0.47773989669228617,0.5272333958615781,0.48200459587989436,0.39078501055775144,1.3338837679456752,0.41097575610700904,0.6176842035302118,0.36123153035199973,4.295920463174998,1.312774117687066,0.354423221819,4.083237299484971,0.3812738069715267,4.440475191009911,0.45646032281153726,0.23374973091871104,0.6628304313410308,3.7674181332020056,4.02199548161652,3.0421030453546165,0.4192581173302841,5.733216692427839,0.5368151298705978,3.4230426903586992,1.0872001728460505,0.30452267897706664,0.3282530908106308,1.5979255117363214,0.5993586678638254,0.6756324592548179,0.6621507439766836,0.2558503200042093,0.1886304031072228,0.18052892602011297,1.301647734246004,0.30548903949974254,0.6706027246740284,0.47276075362412795,0.3439825357705453,0.31454351873863784,4.931969649657469,5.768044541458833,4.525597334645516,3.6623251439479363,4.329469449977867,5.7286588686507205,4.350291213745817,1.5356396120964173,5.002308643437818,0.8775617833133146,5.762573874718435,1.2587666719149393,0.4071467025331748,0.4975742668978063,0.40966836911578025,1.5631231076836192,1.2873203780701004,2.044621949729739,0.31379449733493664,0.41618492022483783,0.45537256907692325,0.3598464791161201,0.2792385910539618,0.2559190863243497,0.1924521291503824,0.14702772738742126,0.2994832189210283,0.33703970517325915,0.3268506724571455,0.6345555169309084,0.34761894973109575,0.5787085117853261,0.6845510075505924,0.667236247346213,0.9116608225693942,2.4733525636551876,1.2352725631578905,0.9082169827848027,2.2778423953201274,0.9336768168859816,1.0236493867181382,2.392318366446185,0.62632580571633,1.632602211532544,0.2759610843146309,0.7338811533166897,2.1857854891195156,5.478679204570744,1.2444747018822808,5.477640642909373,0.3727314865806927,1.1955689277234929,1.4002111484365456,0.637886714275332,2.0900321257770273,2.115146700381926,2.5872283123238478,4.63058144607925,0.2049230865643474,0.1856313372705718,0.29084291292870357,2.208889168327956,0.5614263961118291,0.9993340140288836,1.7899275507403667,1.3838700446605061,0.8507893223609692,0.7564455190360259,4.482595900679527,0.33730394934569446,0.5813449791387341,0.3009319135993433,0.5707058842655918,0.253095071968829,0.31837475148164857,1.1520887144967011,0.5331945444019509,0.29456193872615893,0.21784428289897198,0.3061836725482695)
rate_lwr=c(0.05982178440534072, 0.07964451024136873,0.1345178987891469,0.19969308451118098,0.05352639822720545,0.010167467405786168,0.45667224136005174,0.007107534445893626,1.034717539089936,0.25468541694478675,0.015065373699366225,0.027965929967038783,0.8034910715282513,0.0392751926888078,0.09024583012848267,0.01874859662444167,0.03583755295625912,0.011138836599174307,0.07735910960514747,0.07788379489821792,0.02043931729918186,0.04737516241555639,0.019256916059440576,0.07823727134783937,1.8404442886283023,0.11527922726232287,0.04497735564909841,0.021794535422447858,0.045294501700777645,0.0448168303802812,0.13674975893302532,0.09501772016160942,1.6729381505767225,0.07767548136270708,1.7343146964909515,0.032420538919328,0.028988582310041977,0.021453576166686417,0.1113309162269776,0.06211238299444563,0.09014897592242482,0.011673301499655786,0.1073997139908408,0.023807807963841743,0.050888868873021964,0.12846709143072269,0.045120821503809666,0.10039214967670373,0.05325597271948035,0.123866675645734,0.014614665560068685,0.11869692188824929,0.10976891148939832,0.0976869427069541,0.1236410694344188,0.13547897584724836,0.014047988098991993,0.11028703334058088,0.09488188087248783,0.06643300914680844,0.12268350470623021,0.015889193069854368,0.09157556839875677,0.9641663857103273,0.18117002502138557,0.08633487540381643,0.9647502146079419,0.08754748686936825,1.5175154718208228,0.00834032013548136,0.025283809855042305,0.08976161049239453,0.07569018059872235,1.3591965174098175,0.1679851385605965,0.020812841937297544,3.0020336928675704,0.034614864459719896,0.2241644078554319,0.19661877973512096,0.0034543067083776524,0.08424266512479053,0.10577287267981716,0.08742742822413418,0.08300983948047191,0.09635582518731611,0.03908229367294569,0.018553662680561134,0.004543427912775011,0.14830812592428005,0.06469310564113895,0.07950428232447015,0.09201266942086447,0.03908840537925318,0.02552128470465001,2.5316759720169077,3.223335479439489,1.8070901029389455,1.1000639224129736,1.0067106665893717,3.1911413036386542,1.9149178989964981,0.07951435669698731,2.451805145410725,0.15293430281725104,3.1172480593706173,0.03523212612488419,0.059942331202152255,0.10146775298510624,0.004373921947505993,0.11944032485799341,0.1450374435774461,0.12291838429277124,0.10544596383701685,0.1381417834496085,0.10115208794349467,0.13510144388062545,0.0772656001623323,0.03285640443194743,0.020793367615429104,0.02548354422108573,0.02852639760607964,0.13411037956667546,0.10180338527637062,0.06861328018941376,0.1289070387958057,0.06589922979800106,0.09005181959978975,0.12240780412164506,0.029492663424463494,0.13445920706980655,0.18207828072669743,0.1747365734511545,0.3966268532948307,0.06011653372484632,0.20191487130631577,0.4284458493438458,0.014208174266981566,0.3378253285833298,0.01800966612124766,0.025923012685972163,0.5231617984001368,2.5156971856319803,0.2864398138228694,2.794105065749055,0.01571914195842805,0.11238311663778164,0.24628534099082405,0.11548029851939504,0.513768618086814,0.41751085860632303,0.5066783961208943,1.4867573582453018,0.02225531067252956,0.014446239250758441,0.03869140963557022,0.22804806416522888,0.01136899246082379,0.008060534815091724,0.00943441756541627,0.09979837062603139,0.10395204424805043,0.09987040108888728,1.5121512170756515,0.029379079850606005,0.025925058108032778,0.012669126451960527,0.05715932271391283,0.013736122671443446,0.09270705559482961,0.1036131911941402,0.10579229393117112,0.020450777952530086,0.040799437035655084,0.04152368356366576)
rate_upr=c(0.8507689760856164, 2.760864588404064,1.1614410620192162,2.127811091065723,6.516373763446428,6.519967580522507,6.29834052241482,0.26850382794104743,6.722101661177091,5.782477425431854,0.3965683457329652,6.541884361262408,6.300922818393843,5.27718136608657,1.1340048079563547,0.6203025472707081,0.5478583436188675,0.3149909546738937,0.7859557947399978,1.1571713135249948,0.9425685191318885,1.0855317528900978,0.6264639664771731,0.81842657867884,7.675214877499151,4.637974362243367,0.9296096632191512,0.5837257488814074,0.3659494556825849,0.7089898885277706,1.862659686942132,0.5371325681771285,7.07085734411204,3.3395783571650752,7.424636261365932,2.1234869154214877,0.5544986765508266,1.4325434491730338,2.2826817177274368,1.4903688160643862,1.8568751478711276,0.3437545079515809,0.676716058754113,0.5996220292247301,0.5050103716686156,0.5469715132590846,0.5328479949209849,0.7852162092065247,0.7226786223549928,0.6087399362029899,0.9311916034013022,0.6847491510963859,0.7404956768072819,0.5624305267319705,0.5507525033462363,0.9531373285194975,1.5302516088332982,0.9882341851152142,0.8184771109243631,3.3844568189943898,0.8260735462131359,1.9299162724517667,0.7547781563653789,7.031844209968563,2.892374940648827,0.7873914625975045,6.923506594975892,0.7620189216805209,7.741557462107468,1.3705931770799278,0.6123106336522215,1.8649216717961967,7.162928489815618,6.390692399906241,6.0301805913913835,1.1898653566483288,8.477800612473784,1.530045535908811,6.393195908023561,2.515084978804273,0.8682749152413309,0.6834153354399528,5.726392913245201,1.4899802715419967,1.4827299456623975,1.7528314163736254,0.5295506449811938,0.4098135245791217,0.44649432296644703,3.124739630504568,0.6050453398687803,1.4914488786577198,1.015412518537079,1.0852361845529146,0.9972280920018066,7.390133060675246,8.748714885344135,7.3696571066052,6.40693649915028,6.858143349557942,8.682058042156136,6.87297488820677,6.107367675337215,7.47833990381969,1.773064428814382,8.672275855657587,3.0103380434609353,0.8876819130544584,1.1949924844928292,1.1589400745251928,3.5814674419054797,3.0660708964430037,4.231117928960931,0.5446987045396993,0.788303984979194,0.8912874295148301,0.6172145589965028,0.5177275655006603,0.6335444636711076,0.4116167182492837,0.3072760661307078,0.6951872190971431,0.5817724421148848,0.5742105637366419,1.5063517770736272,0.5736716090230963,1.30104015745383,1.5126565356511008,1.6352893590047346,2.8627170784554368,5.195680880837443,3.191636745224445,2.076646329071151,4.326216948892716,2.356180596722089,2.365771355504124,4.497243243189377,1.941983923616397,3.3340287855823822,0.8881195281451664,2.657508280854203,4.049364684277498,7.990637401283616,2.3220048018840216,8.281714402437267,0.8015927646282677,2.871594957138454,4.322585605828247,1.244555610429268,3.807394450435419,3.8484031291510576,5.523152045238928,7.391300571309867,0.4193030724721563,0.4080532033892331,0.6629064375112257,4.651229084641081,1.6117150010602492,2.469698413441368,4.872562908592379,3.338644953269845,1.891850190028252,1.663415087271109,7.35073397578437,0.7123871785131753,1.4180357539151152,0.7818818811422197,1.5346729866432145,0.6124170961746167,0.5667213574786814,2.832263257061282,1.0957958081744836,0.8508532158197926,0.44319386127971294,0.7343412328288332)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,11.45516312611962,18.316996330471802,13.644381033687072,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.505765520098972,10.270132845364204,17.06367135403042,18.771662988592148,9.812860126686786,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,11.438227229002063,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,12.762457973341409,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.604602479656231,18.318996330434206,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.197688715594296,10.74007339597134,15.251534849631417,10.647178292822375,13.509885309719447,9.014881120707269,19.256329646148583,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,16.211996370039262,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,18.08099633490787,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.676359941283643,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,12.762457973341409,15.03049639224779,11.451546459520934,10.74007339597134,10.647178292822375,22.62499624949477,9.026196505109999,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.709996304287746,6.680496549201861,12.543329772332134,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.555996307182443,8.396996516936989,11.45516312611962,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.15963284744126,14.172329741711991,17.899611722932722,22.62499624949477,21.185380891939687,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,6.758613214400147,17.61049634375181,11.251996463271851,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,11.566150303520583,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.05323819697981823, -0.06350938097319869,-0.06821133952541808,-0.06829244780652816,0.06241910607506946,0.06253597377096629,0.06364128815737735,0.061210155193154946,0.06278831390594253,0.06256213603432888,0.06356379474970719,0.06272294589371964,0.06383092777257231,0.06381414059037516,-0.06376047634842781,-0.05991323016887898,-0.08537678306209712,-0.08586793008374678,-0.05407304530628782,-0.053422644544120775,-0.053503473855117854,-0.05184987795293249,-0.05378000363770501,-0.05402369360940483,-0.08097069452522437,-0.09483809761302936,-0.09498353427309635,-0.0944112066142321,-0.09480082339540732,-0.09553065016187737,0.10075948952025426,0.09590306789820413,0.10181150277418194,0.10205525923590084,0.10215952067600878,0.09870269920322747,-0.06454928352007473,-0.05748226980270169,-0.07201868518026489,-0.07606387789183161,-0.07636616004003606,0.014767939182680481,0.003046202389410919,-0.041295217795578654,0.032180127460151475,0.014791099090805563,0.013329454901258458,-0.003183342680415133,0.014704050700407754,0.014692680119606599,0.03307410507201758,0.03395864729866072,0.014822798942218739,0.014235283429280265,0.014896695142166703,0.018694044906362523,-0.05718141198395227,-0.06823770325232464,-0.06795159108633106,-0.06847527680873586,-0.06775032876827128,-0.05976933584425584,0.09793160671182559,0.10516191359220813,0.1044202663696722,0.0994860638032539,0.10516191359220813,0.1026600083283123,-0.07150742724090348,-0.07117486120658634,-0.07117281577480121,0.10111001884286162,0.10344280532150639,0.10361579023726131,0.10350811960057779,0.10293088605175647,0.10368049160267433,0.10302904340372913,0.10389774724314195,0.10382024332733175,0.1016679964027535,0.10019638468633084,0.10385294163839673,-0.07065376246557843,-0.07094868422937115,-0.0710122712380128,-0.06834011364690235,-0.06835237913900004,-0.06850319745369675,-0.07811808504928162,-0.07750095346799979,-0.07755700059338066,-0.07749019260029151,-0.07898244603704237,-0.08593990013939004,0.1064832756784362,0.1064961558504192,0.10611177179494781,0.1060040144099257,0.10461881537112884,0.10655036673027979,0.10654268190784658,0.10569568250947202,0.1054576153214404,0.10448069089813754,0.1061250278271703,-0.07344186106124903,0.06845704671825006,0.06851359772729732,0.03322055973665042,-0.06443745806979911,-0.06392526678840345,0.09914266609577208,-0.0634701296384351,-0.06389847868756535,-0.06416507103591107,-0.06423196801266785,0.08813163783827677,-0.09033851206990655,-0.08940005678767553,-0.09001740992291041,-0.05689185130399007,-0.06413291901865187,-0.06557877167092496,-0.06490925217263008,-0.06496711529612025,-0.07961794436897464,-0.07898497883474756,-0.05920667015056623,-0.06904255339591792,-0.08247151778171079,-0.08213812669011092,-0.08137551603814837,-0.08264763977484625,-0.0803663633913242,-0.08138623495925063,-0.0825577344430567,0.08978566671686071,0.04725853369828407,0.04847187738789317,0.048523491829447964,0.049846721048603534,0.049120507003070225,0.049156056523983,0.04847861419224197,0.04757793852831488,0.04962743683587711,0.049157877379766304,0.049178799389758096,0.04945314386396147,0.048654453459068984,0.04986321023719214,0.049613418719598366,0.04701262917309644,0.036562605797708606,0.03743433544630445,0.03830507957360154,0.03607184506145634,0.037549739505915496,0.037328284730778226,0.09724540345601028,-0.08141127851517362,-0.08105915691416918,-0.08117111305714529,-0.08134099021231876,0.08540989939739237,0.08537293542730966,0.038134509293818,0.03802081345769494,0.03798175058128244,-0.06438064882613574,-0.0647902980234755,-0.06832693662596705,-0.06892815541622425,-0.068417453247639)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.008889318997796481, 0.009365179818196625,0.01106147617402941,0.01109082753451625,0.0002525035601603172,0.0002535201119334716,0.0002638734104850256,0.00024130983036392778,0.0002558544691737414,0.0002537479449021909,0.00026315111651219685,0.00025525724626790955,0.00026564256712866647,0.000265477236060121,0.009439943577915253,0.008126222265096735,0.11330102199168343,0.11921785556231025,0.009205918278023872,0.0089580343284391,0.008989765657495442,0.008355902407733104,0.00909397745561061,0.009186947015516617,-0.1897014861514474,0.15080041063801877,0.15135647313449802,0.14928710674144685,0.15070145249084976,0.15331239968880678,0.0023323556097517924,0.0020761470482755762,0.002387577342188352,0.002400351666498543,0.002405817475084013,0.0022234960197598814,0.03435553271203848,0.027979518814045336,-0.14300730904277098,-0.16394646330342152,-0.16540464946483338,-0.001365761962979942,-0.0014853398107662781,-0.002019669161992637,-0.0009903094249984062,-0.0013705412193144079,-0.0013302142010859078,-0.0015685042396661102,-0.0013525221975131104,-0.0013502286126701203,-0.0009924243617059354,-0.0009752841345997295,-0.001316208835365389,-0.0013180736834300358,-0.0013310139670619915,-0.001254586562968247,0.02477478753167864,0.011071279351670063,0.01096680669981941,0.01115749807052703,0.010894567848429388,0.028160605663715744,0.00219471353142033,0.002593852988634563,0.0025531127876939085,0.0022810663879838135,0.00259385298863454,0.0024561212431765643,0.043600540665768225,0.043149127674827314,0.04314601011723823,0.0023517948120461924,0.0024763256984896274,0.002485523160935993,0.0024798134095662615,0.002448934235261308,0.0024889816236369966,0.002454156376956639,0.0025008731579391607,0.0024967192383621687,0.0023812907074259823,0.0023033031960763783,0.0024984722644799326,-0.1356314121111706,-0.13690023080399777,-0.1371739561003306,0.03930446026439007,0.03932017050150095,0.03951439602189976,0.09095914116622074,0.08935839065679631,0.08950181184912238,0.08933015246951595,0.09383256610288504,0.11498232417530724,0.0026684509634320864,0.0026691685829470335,0.002647668084774771,0.002641592477474967,0.0025638756903205184,0.002672200299377506,0.0026717703956157172,0.0026244279998159643,0.002611026984707748,0.002556331905694912,0.0026483167419854305,0.07698544454698629,0.0006204709591744066,0.0006216178261291387,-0.001002285068972479,0.04879737844895155,0.04793370314946801,0.002246754048178685,0.009344263499444932,0.009486409245594652,0.009575045007020935,0.009597327758584793,0.0016636283817339777,0.13452324935531115,0.13141169181439485,0.13345737418573583,0.00709209903787622,0.009587062437114683,0.0101115455912259,0.009867003777692809,0.009886671902774202,-0.18249860402209236,-0.1792672741973862,0.007848437020868038,0.040213731033140424,-0.1980419065297002,-0.19625554662078276,-0.19215880419391348,-0.19898726155482357,-0.1867859375114209,-0.19221524350526153,-0.19850492460769303,0.0017505835791118477,-0.0021835598781544735,-0.0023163665598504566,-0.0023219089690349375,-0.002469184409873931,-0.002388871420958501,-0.0023929546043508763,-0.00231708448605395,-0.0022207581759745875,-0.00244497450864321,-0.002393152145892956,-0.002395195496180153,-0.0024257985428767937,-0.002335918773617208,-0.0024710062745924403,-0.002443417597230878,-0.0021582433063447827,-0.0010420342057148875,-0.0011234313443652443,-0.0011953132743599887,-0.0009864010743266753,-0.001142843215116738,-0.0011060163831012938,0.002155510408345407,-0.19202467343461627,-0.19017242261551268,-0.1907564937024752,-0.19165513955968708,0.0015156638899669482,0.0015142005952978052,-0.0008804789840539778,-0.0008746035658336471,-0.0008725886469298855,0.009649926198742343,0.009788118846734365,0.03928339201662158,0.04006111005320465,0.03940008237774262)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.438, 14.895000000000001,4.4665,6.2895,1.2905000000000002,1.2905000000000002,1.2905000000000002,6.2895,1.2905000000000002,3.09,6.2895,2.1900000000000004,1.2905000000000002,2.1900000000000004,14.895000000000001,9.438,31.000000000000004,25.565,9.438,14.895000000000001,9.438,14.895000000000001,9.438,6.2895,0.00585,1.2905000000000002,4.4665,14.895000000000001,12.725000000000001,6.2895,1.2905000000000002,3.09,0.06885,0.45350000000000007,0.00585,1.2905000000000002,18.205000000000002,25.565,9.438,9.438,9.438,9.438,18.205000000000002,21.735,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,14.895000000000001,12.725000000000001,9.438,9.438,9.438,18.205000000000002,12.725000000000001,6.2895,25.565,6.2895,6.2895,6.2895,9.438,25.565,2.1900000000000004,0.00585,0.45350000000000007,4.4665,0.00585,2.1900000000000004,0.00585,2.1900000000000004,6.2895,2.1900000000000004,0.00585,0.45350000000000007,0.06885,2.1900000000000004,0.06885,0.45350000000000007,0.00585,0.45350000000000007,2.1900000000000004,4.4665,0.45350000000000007,14.895000000000001,12.725000000000001,12.725000000000001,6.2895,18.205000000000002,9.438,25.565,36.414415,31.000000000000004,31.000000000000004,36.414415,31.000000000000004,0.06885,0.06885,0.45350000000000007,1.2905000000000002,0.06885,0.06885,0.45350000000000007,0.45350000000000007,0.06885,1.2905000000000002,0.06885,31.000000000000004,6.2895,6.2895,9.438,25.565,31.000000000000004,1.2905000000000002,18.205000000000002,9.438,9.438,12.725000000000001,4.4665,9.438,9.438,9.438,18.205000000000002,14.895000000000001,9.438,12.725000000000001,12.725000000000001,1.2905000000000002,1.2905000000000002,12.725000000000001,6.2895,1.2905000000000002,2.1900000000000004,4.4665,1.2905000000000002,6.2895,4.4665,0.45350000000000007,4.4665,0.45350000000000007,3.09,2.1900000000000004,0.45350000000000007,0.06885,1.2905000000000002,0.06885,3.09,2.1900000000000004,0.45350000000000007,1.2905000000000002,1.2905000000000002,1.2905000000000002,0.45350000000000007,0.06885,4.4665,18.205000000000002,9.438,1.2905000000000002,9.438,14.895000000000001,2.1900000000000004,3.09,0.45350000000000007,1.2905000000000002,0.00585,2.1900000000000004,4.4665,6.2895,9.438,6.2895,9.438,9.438,6.2895,18.205000000000002,9.438,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()