pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_1_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 5.0,2.0,6.0,3.0,4.0,1.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.017556580689344622, 0.12224886641329642,0.14662410678992013,0.1713633500819271,0.14552320363914387,0.061372602011115704,0.07703963762592475,0.06057036453806222,0.06228357607990721,0.24642737848738938,0.04185381021838141,0.08767702326322895,0.05037861340133874,0.0816301828198313,-0.09024245142687216,-0.07317417485243313,-0.4758271298716196,-0.3349226976548012,-0.046014218546245905,0.2520332815262329,-0.18567630671061205,0.10852124661176998,0.015899441224078874,-0.007745225195901494,0.24736994958201397,-0.2251998638702916,-0.26582356936685436,-0.28044524343406413,-0.2745747552539483,-0.22986332103162158,0.5354638582662254,0.3594029785894938,0.6647471345704521,0.6696390163081308,0.6228472830623029,0.30175171874338097,-0.18094322937420293,-0.13083142722741406,0.13385342835240596,0.36085842800210355,0.30333352699916466,-0.03630930435482366,0.032296112288406974,-0.0891445709556204,-0.012382654286338288,-0.04053369428643511,-0.01718110449413612,0.07481926062841225,-0.10401987777814019,-0.006085017104336473,0.06714970153572665,-0.05347557637117176,-0.038543797947973434,-0.019908583244951858,-0.056842623007191395,-0.05693538603756182,0.30485051959939297,0.13900702647200508,0.17265882766860313,0.18195931599013584,0.13915864165899997,-0.30636211454766316,0.35643639220662865,0.345344383672995,0.4709531536894702,0.32537842048459814,0.336397529448884,0.34710329216535807,-0.023017410449306386,-0.07713792382916768,-0.11610157586540296,0.41378386670189576,0.7543338480962465,1.003954212781487,1.0430451093744855,0.5918578339387126,1.0640893353492817,0.3620853643157165,0.5261035100730372,0.596584084757756,0.5394492249082206,0.34007348027992945,0.7094145788014855,0.1673871058273016,0.08882620138761448,0.15267968728603903,-0.09712309449939285,0.00342153866642643,-0.05386162435110983,-0.38006694674931485,-0.41907094740154904,-0.4194886055877453,-0.40804750576107157,-0.47283450862852905,-0.4557423445336059,0.7905038335555905,0.9879322570800352,0.9467019398730558,1.0660948649038975,0.5502551165923221,1.0030971389197259,1.0687879242349887,0.7417841780465563,0.7290989083382653,0.5735861079333417,0.9361841538213453,-0.2500117355322519,-0.03672919900531396,-0.04128271322887797,0.09189049902855512,-0.2244012319410534,-0.24804944342275423,0.3918272357966306,0.08722263024772248,0.07986805436367404,0.012064749212665994,0.006855341955459204,0.29516510731872575,-0.3346734688934077,-0.34986367219274,-0.4111242934884887,-0.03132923575636722,0.025686364206066795,0.10991307458820862,-0.027135802363956768,0.06370697308713706,0.01579411928696289,0.07248894262990903,0.16326430718531487,0.3094124879291163,0.20342112518626113,0.08306815320562701,0.17221850831483002,0.21996669586738604,0.1531252764537128,0.18568278313360975,0.2052731218971272,0.32158400654250896,0.3083720996712056,0.30969831602173703,0.36548407980768133,0.4657036420007293,0.32543458666990493,0.26757664938382403,0.3468351096576841,0.2685092129154335,0.44232052436494845,0.3103143156883211,0.2823207796017047,0.45327286936714606,0.442798704057109,0.43960585298360483,0.4738012619949055,0.42286976002941745,0.2988624590394835,0.19620416411319547,0.2760818517080903,0.24086646629776068,0.3328073736565051,0.23495706014833503,0.6038561848852401,0.2729972517946331,0.23535841749638875,0.3294474005547218,0.27097460603522155,0.14828233906686195,0.12273890338546849,0.09793702854752372,-0.04079660163160531,-0.02715253124695769,0.19192366621050375,0.09463261347900882,-0.09099823851192221,-0.1037132761567091,-0.10488713951266702)
shap_list[[2]]=c(-0.0594245346817435, -0.002768068987089678,-0.12108738080074366,-0.11173164263106392,-0.029123375547801932,-0.0312271057537811,-0.008951253353096374,-0.031339681183726535,-0.010918382096743546,0.06219070056290982,-0.011828964300976142,-0.0323837125176757,-0.030662341592816743,-0.011653613208180782,-0.015106750718840814,-0.046478373288714576,0.0444702490658927,0.055006127426476974,-0.0004971411175709257,0.043625474177949465,-0.01220564364536951,0.07267209355897201,-0.05419481115710623,0.03236535553351261,-0.02891414603467037,0.07301234733309298,0.11333218294479334,0.1486890953249717,0.11438543278048006,0.0746159266739157,0.025092868240279325,0.0072208056498964555,0.060003642353456406,0.05680255484265888,0.06615669777680401,0.025391922783310008,0.07283202103964792,-0.027058529549082815,-0.05819702117394629,-0.025725400194850645,-0.05210874203472047,-0.03098274043038539,0.02664726508049849,-0.03999926041976964,-0.017821136910245422,-0.02206685709346717,-0.009603608335108463,0.04759818778654299,-0.022791027586512243,-0.002948424803230238,-0.06829997827735618,-0.023031994207712726,-0.01012155940827906,-0.007701426038328054,-0.02473147728057675,-0.02518544012165267,0.06926091172806154,-0.11033056527800647,-0.10911112839841619,-0.015585789889565022,-0.0725443989697432,0.015814923008648892,0.03366091086607448,0.01520235226876738,0.013485727854286013,0.01201187800504181,0.014055820460425361,0.01816586364368367,0.07027596952815676,0.09120395886352003,0.06214816492822948,0.007174789529079873,0.2025317920934265,0.18610745864944167,0.21353906624787536,0.09139908378289224,0.19866493792111634,0.046344392012284054,0.12255267326998366,0.09682967425570523,0.05595075079170707,0.004762782657071354,0.13836591386533906,-0.029660459737846277,-0.05635379789071076,-0.023332082957490903,0.04628700545939617,0.02433750046394761,0.03999995866740031,-0.022996022413824407,-0.022165601418858153,-0.022175498815838055,-0.02478304975901438,0.10369269987815204,0.07909516864162892,0.13469711331783235,0.16394664184677538,0.2162921958976915,0.1767910565121499,0.040281529614616784,0.18425338215693904,0.1938242714359351,0.1020571609614328,0.11614035114704077,0.043398685098355004,0.18299544681846533,0.02537043465543628,-0.020968788167995765,-0.02310931278291634,-0.06911258916566676,-0.004348120599434032,0.024289022774817856,-0.029761260032282664,-0.11711640790546111,-0.11447667240569422,-0.12085754183255658,-0.1227720232614664,0.003285407345755363,0.035280478034739354,0.04491309777065873,0.06033574362478372,-0.031148786061250988,-0.10805275614178715,-0.11526185055319502,-0.045181459954747885,-0.11115994463631186,-0.053741405284739564,-0.07195935769729506,-0.05959619620499288,0.1302493450547395,0.06328890008012207,0.1571717460740451,0.13758495630709353,0.09073032417541341,0.22271670382434702,0.13890258667535782,0.08016924375415707,0.009448217703417005,0.023782347765169166,0.01472962705255247,0.025325303191172353,0.038725667586911955,0.015406506862482782,0.008718095682198569,0.015985578197795607,0.015522158782418773,0.01853313196515587,0.014673936182853077,0.009222844846803423,0.03587066302611579,0.04654256706855552,0.04691463612366685,0.025682815686629973,0.03446028577474763,-0.03624320962662006,-0.013651200736147928,0.040754040145829645,0.025404718894286464,-0.006515984204159626,-0.03426379631140367,0.02263519202578684,-0.014109585409841278,-0.0015782975839231804,-0.0058378794347335805,-0.0019488891142595314,-0.009024749077886387,-0.016232571771994452,0.027234688726674453,-0.030264357636322153,-0.01824635649486845,-0.06468026386697506,-0.0853349998112749,0.1366169476457759,0.0401042842593148,0.029337658649232396)
shap_list[[3]]=c(-0.11054469976689503, -0.02105794272278381,0.12283943220673478,0.1468173580623755,0.04324988121681419,0.01625049665535505,-0.07361748309706266,0.03131699511517277,-0.06660548244752378,1.0410799657291276,-0.05898017325795058,0.02973170455092867,0.01925322945759981,-0.06993120382612025,0.07953720856613472,-0.17655653152528217,-0.03165781999387615,-0.041661580527974446,0.037825655229015584,0.24299642179533287,0.06792421196287282,0.20724327755730299,-0.10020389357119007,0.09243598110887581,0.0162791236910197,-0.03106604027293392,0.06647654063502177,0.09446164063982242,0.07723346980609247,0.03591887434482111,-0.09782122967067539,-0.11455530647722287,0.08663050496814546,0.18171539767648529,0.08253329876137071,-0.22292743427818956,-0.07828620193216929,-0.07782504468940964,0.10623289689399122,0.1710921682745054,0.07405141832436873,-0.14969226293375698,0.12585072026641558,-0.11187347259366791,0.05973872685123896,0.05957462325043085,0.08344658515439406,0.17150082986253143,0.04584620658976308,0.08600218483020386,0.09156050749149651,0.050354535029735324,0.08105441600916216,0.08120786705565741,0.05739253066104262,0.04868370778598266,0.30238730061843744,0.07258778081182583,0.13318390508186195,0.03358898610741385,0.08406237610770123,-0.011247638349511153,-0.11110972932239459,-0.10274617988180944,-0.10634189367659772,-0.1002811993763408,-0.10180541251350643,-0.11234740384279454,0.12144511735097092,-0.09619282360967014,-0.07815622726166697,-0.10743605223923688,0.32552560167533895,1.183318228499886,1.0946818213537903,0.09536344682897568,1.1873210258022708,-0.27950328249769485,-0.043908555418421764,0.11247306407163894,0.07720650159674178,-0.09804121728087602,0.13909238122250217,0.18979270997472303,0.08219774076252312,0.22518901432245134,0.06914652813784639,0.106497379731575,-0.07032506767397324,-0.026356940593335713,-0.033757787730180004,-0.033626807483852134,-0.03703870984553617,-0.020079546445590603,-0.02153387569694174,0.15111857699379502,1.2311334354687768,1.0088141383643954,1.1394372270431028,-0.08851075740534828,1.2146859800767116,1.1912787082538459,0.11404976112095803,0.13745355786547214,-0.08477826465921921,1.2363747183428027,0.00978117441108174,0.050530177827402545,0.046536414090438155,0.07763172485995046,-0.004103315920884186,0.00898193454726129,0.05983048780174025,0.16018876378143732,0.15274426880922778,0.0862107544813877,0.08144570097055902,-0.10757899569303253,0.03995482394610192,-0.04058519736979293,0.07457862678735581,-0.09697493492323715,0.09309848233345158,0.15644124615647723,-0.05116892424642265,0.1090524498942354,0.012627192251874654,0.008449403495237026,0.18689871771278305,0.21677137609733454,0.2686235930501825,0.34701217480266405,0.3977091331302268,0.36878399531997236,0.3446903965806814,0.3948585089244524,0.3727048718024694,-0.08923867602845842,0.03358006758521347,0.044510570183326145,0.08672501348645313,0.6347669125162416,0.04388091934428295,0.02311659976305182,0.04908207013089968,-0.10485710897024512,0.7335252216316582,0.029316803006676634,0.0282708103934499,0.6127484646895042,0.6314866699108976,0.639523960642299,0.6153693386387237,0.060298606433058406,0.07381937314879641,0.06518705907612526,0.16676880732293248,0.13976577358866965,0.620433703038788,0.03777991177218224,0.6527373867988806,-0.03439770255218868,-0.046568467453894945,0.03182867713341816,-0.04328930807574713,-0.07026978521085488,-0.16621566798112725,0.10663897204695766,-0.1211232847653478,0.061423277162548244,0.21478548589166774,0.11838467455015893,-0.06659664756897589,0.024220367153744402,0.05705094564162275)
shap_list[[4]]=c(-0.008355167054554734, 0.0984169090823288,0.033217703486264336,0.01132426391569329,-0.011275262806805063,-0.07496841445635995,0.0577040298608027,-0.01819626605448735,0.05476367878538937,0.09848788255100262,0.053357245135757445,-0.028643443187922744,-0.03110739091843687,0.051761860551523625,0.03757662959257138,0.02540295695242833,0.06507108383848613,0.07773114310629578,-0.04495133881105348,0.11856121788433033,0.042264561337574016,0.11306469952267073,0.002111397782994893,0.014175401501320909,0.1886510141377527,0.04740999954766027,-0.005492602268420742,0.07278135377675707,0.014302098279701836,-0.0441084716063008,0.008880421734576599,0.007292908448693994,-0.010117318689997205,0.13442127188100414,-0.016214160671799913,0.03517902558839959,0.06430265500919945,0.024922104468300368,-0.016364908947264244,0.17248151079805435,-0.07167212455623886,0.03432199308879291,0.06301084725557915,-0.008757992627758263,0.05190791192675411,0.032092187873710654,0.05192407810670429,0.09869242236377249,-0.012856323443413685,0.04464622185661489,-0.06563430469171506,-0.009206321506522114,0.047239090927439095,0.044477041215440424,0.022301459659491023,0.01042738333330892,0.15233051489900487,0.0058772632365714965,0.043174819630061194,0.0720830938184366,0.013973228880437545,0.06573953576487594,0.009446855443521909,0.019328289805800973,0.0103550623627771,0.020227656568793047,0.02180006533384782,0.007772748972347127,-0.08717199816734628,0.020536454051889152,0.013107721536094788,0.006940422458766565,-0.021479555267354608,0.2421585923707147,0.22435430468191767,-0.0018979078622582775,0.2612355408888285,0.009201253380479965,0.01126933664109136,0.021494596790661773,-0.014738530151326285,0.018730040184137,0.047148900205479495,0.12457348218877115,-0.07081788225534569,0.18261979830860794,0.07757593505623897,0.07288020877495129,-0.024103976351071348,0.04815380839862439,0.05507985867347273,0.0548500655197774,0.0563394385564385,0.0830318042250581,0.06577221004013131,0.06116274189570773,0.25082485876197874,0.1460819654772837,0.2332066003097684,0.02157567339714991,0.24938253395840695,0.26264997004584645,0.009107692166261542,0.04622439110948932,0.020763858931059993,0.2469690708829771,0.08755309163473536,-0.006379062883892942,-0.01698668022635132,0.0596778150701074,0.07079563457365433,0.0873706458184323,0.004449390062008145,0.08997425393589724,0.0836596648710788,0.04443926920703742,0.04146271531538532,0.012200827906675857,0.00044335239747190353,0.05077473828968927,0.05112318708376354,0.01600427294495199,0.048544335977477086,0.07556134519681804,0.017470830583758826,0.05841470179455066,0.082844114619485,0.07660178989050687,0.009489725551227256,0.053554905193933626,0.20778111375064165,-0.006441633567781073,-0.007908153491697033,-0.0541105306741338,0.01788215653013025,-0.03889708174137486,-0.04602109855395395,0.05025985737462403,-0.07777882168475699,0.004444388753803263,0.09496687452368006,-0.01017448358345293,-0.005118845951518328,-0.0731314593713297,0.004705056941144528,0.03436803170555099,0.014892068988628944,-0.06066262962512047,-0.039618608900627,-0.009720080509048738,-0.003157559240199638,-0.0017423211644040679,-0.016015081475469334,-0.03439229425688619,0.027854766659277153,0.0880894022469809,0.27494144033145784,0.17931313138067498,0.03475967039602183,-0.0023432094941204466,-0.07188636375416847,-0.08117906433694538,-0.07589939745044093,0.21197515536558437,0.015273529591957153,0.07119175020267943,0.05702238805929894,0.00807597636012066,0.013367135625442615,0.036936623357497235,0.034869016306731004,0.015658313155395568,0.08931933533508087,-0.005740640317873891,0.03617427812851892)
shap_list[[5]]=c(-0.006308475348307093, 0.08598497287855543,0.0988623956829015,0.12506686926941438,-0.08003031767316512,-0.0492339032266925,0.0005631600318185276,-0.05765110575776063,-0.0018544675503871112,-0.0005496084199575951,0.00048266103444690123,-0.06296623386909071,-0.038269137876851975,-0.00883998571116907,0.05193191255561398,0.013493054189115354,0.04605488663960802,0.04395096115086119,0.03985773870611819,0.16875156811085051,0.03963282170024827,0.14708052062956228,-0.010300652514332303,0.07064615315204274,0.10919917681953274,0.026148278260852937,0.05237302075028554,0.06353959644079876,0.05866604081798594,0.03482825565226716,-0.09495676652663336,-0.07588888249710353,-0.09161077011942435,-0.08023861590930405,-0.07947210507154014,-0.03622469401051601,0.04220612015549458,0.0251711009446092,0.1252278633309068,0.18070499669284734,0.11436566391087342,-0.01517258530114178,-0.01879786999930192,0.01480940782380998,-0.06271615477827808,-0.06348596235906649,-0.0548705484109847,0.04451731482127048,-0.047174019358632295,-0.06416279633551204,-0.04746629933055864,-0.04374260839965146,-0.05633535535866233,-0.06370810758324492,-0.05203362004403312,-0.05667750488073097,0.2948703813149325,0.05888320192622782,0.1080252373301655,0.08881184927316177,0.07369629643340057,0.030377777072706048,-0.0745484778300844,-0.06641665558570362,-0.08944272044554272,-0.06774140860981176,-0.0644755309002181,-0.07488431295094079,0.03724426465535344,0.0252685713039034,0.01942847052427705,-0.08703232344628598,0.08746555413151633,0.07753046073623802,0.13991217875991033,-0.05703518126862623,0.10322440009083965,-0.0203823611522609,0.027370468034459652,-0.03240948327651687,-0.07544016233683182,-0.07104141382507613,-0.014993976764033756,0.16910480318873147,0.10382415640615039,0.18598644294375588,0.07082735708693304,0.10179089433834923,0.03740250491787373,0.03669311534703439,0.043820258439964455,0.04385503439392462,0.04452467068349553,0.05845076219327943,0.04380342061992233,-0.014555745197658577,0.07226943648167503,0.14438384129680362,0.07210161615482431,-0.08848755558143864,0.07937973786763555,0.10268274259212874,-0.06169853506438254,-0.024236261556163104,-0.09081238481218872,0.07632248192747107,0.08950914767157392,-0.016643140572090268,-0.010091303127067597,-0.03397591931470397,0.048677897421236446,0.08802381994913981,-0.08448301349454307,0.08535999142226916,0.08077697321345634,0.04164906881751673,0.038779840888730675,-0.06321964145765792,0.032924513843713824,0.03375959253165861,0.04797214341114394,0.029452783672244954,0.04711590458641378,0.08872763235375895,0.01352643255373481,0.058293491765052975,0.07145387539906167,0.08639674608202638,0.15045454881047696,0.24221736003240113,0.2452403100475994,0.2028759517536138,0.219270532450855,0.182767201250032,0.2590995094525051,0.2106862268611232,0.18369032149451975,-0.02803202940362897,-0.053496777703789716,-0.06326055896631844,-0.04354875830445882,-0.027960399386710126,-0.06286356970113231,-0.0657572868494073,-0.06278419450906242,-0.034152194500269954,-0.026208347971014054,-0.06568565029746824,-0.06199978510455499,-0.02694473857863665,-0.025314379965636232,-0.028123973688162867,-0.02685712264623689,-0.06494486622309578,-0.08852572139541429,-0.05936770114184166,0.027910123264658204,-0.007409167058519296,-0.05323580442930859,-0.08412888433637633,-0.09037907162754133,0.061328101754027746,0.061097182050180845,0.1231919699686244,0.07601318779915182,0.009313537957348144,0.014804316204823795,0.0001530728968796872,-0.009992243139294633,-0.035861172872921655,0.1691864327455164,0.09376364272535341,0.05679646562411264,0.026917228038240697,0.05395565807633095)
shap_list[[6]]=c(-0.02816831857127259, 0.011140221989994028,-0.027452654712498758,-0.005398433372589978,-0.005281921813687165,-0.012913223663889977,-0.0033176301187079656,-0.012019837026817744,-0.0030002248909258788,0.10302017283533334,-0.003960740930909604,-0.011129564161340177,-0.01581811040257806,-0.0030227132294461077,-0.03278765794705025,-0.02589453438604089,-0.053351244389514545,-0.030309092804280815,-0.028349465612931557,0.009706430589985946,-0.03531508265297444,-0.000909088952956844,-0.03087484118495922,-0.01962230840638349,0.24282816685536732,-0.02276101098315521,0.03316224702083546,0.04024906057178145,0.04173278979012747,0.0044935835720556466,0.04779978043679811,0.022944651314412073,0.07693512893111344,0.06989919576194226,0.08307990674009867,0.014852391873438685,-0.03254330893681946,-0.0085617172595612,0.2559747843162044,0.338340507605686,0.20386703837482328,-0.015282766966177221,-0.0047502755615460345,-0.022266560976830684,-0.020815004681499466,-0.021045885264677017,-0.02032962652183757,0.0027955923163949566,-0.019887069247320987,-0.013469727860164628,0.02929276003210611,-0.01511819091320951,-0.012188344554766356,-0.016308027663870645,-0.01806926518903254,-0.020268635392276434,0.005940620743758923,-0.04343761010632531,-0.0275914026232325,0.003778162163583901,-0.04154309822905538,-0.016056121118718653,0.025128329995815192,0.025073553955593603,0.03792836258732944,0.027953053145487784,0.02334464590174905,0.023560011016430956,-0.028214804444705713,-0.03103921815653829,-0.029565001520718993,0.034586979152128335,0.18159719173138592,0.29330259187287533,0.2769930138647487,0.10234047927306139,0.30179685267799194,0.03149753374583648,0.12027205497784418,0.12457514747095617,0.07209293304363104,0.030667006938659477,0.1541637951049797,0.3544336780286254,0.22609184903933285,0.3989824200797996,-0.034532032405413526,-0.023924009692513466,-0.03405352255709036,-0.037841705269903186,-0.03923024347619646,-0.03933923641525256,-0.038376364584421105,-0.04069860321711532,-0.049333577272401986,0.16207994084011246,0.2972123922500198,0.24036444346419664,0.28665385066446747,0.05109343910274599,0.29726787589146014,0.30253627459243704,0.1193678466529028,0.14568307248729614,0.056094123220197994,0.29341976393175556,0.023869174749763054,-0.003881487166057687,-0.004220361267073168,0.02995744102910919,0.004635989404575214,0.022540175955956608,0.028873317915534,-0.027692746167681147,-0.028310242144494558,-0.041074793523120164,-0.04185720113289092,0.01810576449721928,-0.023264576903339062,-0.042440426667403025,-0.014452107715101683,-0.010810589014021965,-0.040213919357345224,-0.03756924774174883,-0.017473216098856194,-0.038767225924486726,0.2532807584280965,0.2509106178658206,0.026155343598962193,-0.012084909288961408,0.603168193127047,0.6023017267124565,0.5853468644716925,0.5182390306726942,0.666950680614243,0.5753617576849509,0.5229286719340123,0.028076639885860847,-0.013458747907658861,-0.0185070717422838,-0.007975844938172123,0.031530712756658384,-0.018210668913682074,-0.025415252789267304,-0.015931581158797926,-0.008298062044251134,0.03985263197805024,-0.023406961461344175,-0.023519534605499912,0.030882751171155274,0.0321110299016949,0.03052147649784004,0.03190334978291924,-0.00865183108821298,-0.015116155161596524,-0.019794678618040698,0.015181200425826743,0.0026379392159099567,0.04885649722617885,-0.021519544707079317,0.09815275361844002,0.12458874548786919,0.13026631084592788,0.24601853882404426,0.14301925323223463,0.013059739380068405,0.004215843597970138,0.014518542686320121,-0.011788705250104869,-0.009894550449465106,0.025073784049856572,-0.015992532374064186,-0.02442504205145555,-0.049044082186128726,-0.04258922880107887)
shap_list[[7]]=c(0.1945247666705734, 0.12483298638819831,-0.01851397171828883,-0.013530024443579987,0.08127704866397653,-0.07917640708204889,-0.0697790961774778,-0.0247245410998007,-0.07882731312963723,-0.20204022499381813,-0.09002110716051676,-0.015971935380315213,-0.1603099699078562,-0.09257510401428569,0.08574021416588698,0.13428930985000398,0.4371739076982346,0.3083121081853104,-0.03953143838541794,0.3066337663613572,0.21426747397413162,0.23685115946307916,0.06386638131850068,0.07843852650357627,-0.25700803392495203,-0.0753643638544948,0.009936404580356457,-0.0018835106879660326,0.03891313254763897,-0.07345720384259109,-0.16322583338126373,-0.12046129317211386,-0.21153047388502377,-0.20162590206785352,-0.23623884491533603,-0.10746988260605289,0.2862246978016641,0.32964509435932976,0.22759164792019945,0.02915809646549732,0.013557646242672666,0.10537474160214945,0.2732700632657835,0.49569649997915827,0.18974061376278664,0.1037972081029084,0.2591981413523542,0.318592277117091,0.060812433435833486,0.2274080678833588,0.22276645525685557,0.03153600058239065,0.20356206963649004,0.21754477369302155,0.06990193444349793,0.040623890976402864,0.7386577472009326,-0.015726282374330693,-0.013033117077181437,-0.10161898990817567,0.002540411437699141,0.22127365354214237,-0.12946239889676417,-0.20634109289827654,-0.16463410785634683,-0.0781386079156633,-0.21825567154501307,-0.11263456066100114,-0.12867949281938224,-0.05072205612722794,-0.0666542384069341,-0.08298824646161108,-0.26618352333687306,-0.2444357997983125,-0.2657344435711847,-0.19080210915053522,-0.25053620424592316,-0.12329262457977141,-0.2127046419961544,-0.24921128038277537,-0.16512706328751453,-0.05773498235068348,-0.2531514378054704,0.1597819474142922,0.09994402406706791,0.14437153482032083,0.20045248474502353,0.2554280885898628,0.10965355714205821,0.32753988288043306,0.45533850336813547,0.45536938573362784,0.4632530444389996,0.46542212642053915,0.3301447496162106,-0.2639423040061893,-0.2606414967701233,-0.27116337407973856,-0.22284180451233324,-0.2353792738813073,-0.2562626898335621,-0.2514320625992649,-0.24240651355667978,-0.28271248255993886,-0.19677676913634723,-0.26002655138242486,0.5755699518406608,-0.015541906769685187,-0.03840533042835621,0.08799532303658693,0.3155262720577319,0.5735007032298982,-0.13854447949288962,0.29977207205388173,0.2808949864963818,0.13459526698737803,0.12382712741338554,-0.06977795855840725,0.06261009398709304,0.22395986936988524,0.2061646305845425,0.27640145446193765,0.1357458710665799,0.2941821045574529,0.048358918872520244,0.1581579983363441,-0.222764647936724,-0.0173573942662067,-0.013539096562065865,0.032192771536957716,-0.23797090821089417,-0.20876045060812107,-0.18685689144758466,-0.28729368569575425,-0.1345832292172661,-0.1831991846683416,-0.25734177997218133,-0.07515430121094195,-0.18027388770860667,-0.14141815309315572,-0.16280718168240696,-0.22173146637664218,-0.16619668626597442,-0.14857490269175888,-0.14005428818013238,-0.05647197074688417,-0.21600019247855998,-0.1676815352726495,-0.20521110172284807,-0.1531194381412274,-0.20907277814224756,-0.2249068165925309,-0.18824038008461616,-0.04420176539123104,0.24869643697018717,0.07090936742700304,-0.20279899178999972,0.15203472176858066,0.14968452463151455,0.0006590837524406849,-0.15486810814351742,-0.2306708084023167,-0.1468003050353677,-0.31439894307098154,-0.1478564275507244,-0.035886669106284165,-0.029859868492064214,-0.00621901754966629,0.0018142396237671033,0.0415665838995763,0.11575244284368633,-0.06548699217230267,0.15420915522652356,0.007966238454586412,0.18623458172981663)
shap = do.call('cbind', shap_list)
baseline = 0.3506269088199507
rate=c(0.3537485074211116, 0.7636931757162827,0.5856569256740342,0.6728869490594479,0.49675295915046436,0.18355168871557054,0.33246158356526884,0.3008604672814059,0.3085508712247719,1.682823254777144,0.28349607472403,0.31947811709781154,0.14636899996913325,0.3004261657441367,0.4623057499610753,0.20358651957075424,0.38384753547432365,0.4288319728088762,0.268246951839423,1.4723731049243178,0.47805561912142586,1.2159066301981474,0.2409127595681685,0.6038378360970094,0.8715493263270829,0.14497642034759448,0.35236429931069246,0.4835843355802552,0.417792505322024,0.15431323448188178,0.6161805164985947,0.4416225917805954,0.9269996483136812,1.1793218594470987,0.874272876420317,0.36271127263705555,0.5251093294590929,0.48607155033039384,1.122395453380111,1.5674371690389421,0.9368619058915625,0.24451717533329845,0.8401165306827189,0.5916905465482999,0.5390394182196249,0.3988665325030957,0.6414561851674909,1.0955147233362046,0.2509037094860812,0.6194238566347392,0.5807795817322687,0.28806515592975196,0.563271660784271,0.5841923123414775,0.34835212017564365,0.2918601679977877,2.1936004002788647,0.45810087674161315,0.6575051148129121,0.6092605380017602,0.5482951608981325,0.34878476051628277,0.4649142946165342,0.38435893319903813,0.5277305432753683,0.4943921693696544,0.3658403216414023,0.4523484740686922,0.314117668447416,0.23307097836834115,0.15601363411390004,0.5404245012091875,1.6045060665142417,3.065832794362379,3.052939903657617,0.9801873184951269,3.188191694310777,0.37740500766856505,0.8972425734819213,1.0173052734490453,0.840846173601813,0.5223391601522629,1.2642918219758812,1.474477917830187,0.8254266404203171,1.6025849604200408,0.6788606928060542,0.8840362924355475,0.3554592165104954,0.29668979715577626,0.3919194264455132,0.3913596847146498,0.40782224759050906,0.5267190416895405,0.3434575395646189,1.3647738786938861,3.0642477028475774,2.762109108979258,3.0776902724342086,0.6053197994417187,3.0937775632748794,3.1925029965220864,1.1306191743106482,1.2130084829326673,0.6756297122706801,3.0335963455891384,0.9045916301352886,0.30094642505834585,0.26330885649718444,0.5947595399430999,0.5529780137805783,0.8996290727926921,0.5854185929663657,0.9204621399560422,0.8784451197809285,0.5060991387460324,0.4773090792065451,0.44358510884487634,0.1650703328050645,0.2727070130851353,0.3645688670847091,0.5033655722227836,0.5501087833273813,0.9165806700928237,0.2904658728938989,0.644769190342804,0.5115688374761438,0.7570663632925662,0.8074844051564309,1.3064796454457943,1.6963295499663154,1.515941500909592,1.6549436398958917,1.3825339861748358,1.8649352613381789,1.621966767134852,1.4042129257104046,0.5693138645207082,0.3945332526773844,0.5031080720907838,0.7086510303827163,1.2657455264902604,0.4854106137411629,0.340996811957797,0.5505867239296306,0.4690439361163078,1.357521240822389,0.3912520538343689,0.34357907083605077,1.2995717312008646,1.2704164646817937,1.2562076707045071,1.2719085532173653,0.7175047665455176,0.8617449196020821,0.6807573182004945,0.94310442270586,1.0799186284061402,1.4865177822996785,0.4850240024715306,1.4162869480660698,0.45716866021285074,0.5148886156757941,0.9753567243710426,0.6702035294469781,0.4782042712437592,0.3383572511028182,0.5933631059891075,0.1542439660773554,0.3985102228451556,1.0285619892702602,0.5061879988763572,0.6041065723443804,0.29162923027531007,0.5637053100800322)
rate_lwr=c(0.07616614378816988, 0.04968917535927325,0.12422844852467663,0.16232519031385556,0.11235728110434615,0.02328270020940454,0.0693255254420273,0.0868941207424393,0.0691506835920197,0.041430373894472405,0.060352891172062384,0.08248953681901797,0.00956865661522277,0.06575535742776017,0.013560213375512997,0.008540247876077434,0.08453126988775217,0.05945281225571347,0.016768786305717986,0.3740653925428686,0.01917790399048358,0.1594646857743474,0.041994646435425664,0.07529963510317084,0.14519172504175415,0.0018331259591318483,0.03483274501882669,0.0187562340420383,0.033347607625926035,0.01409237288093318,0.24556433824609936,0.19084992466259568,0.31353541682546093,0.12638811879695622,0.29344740846107054,0.027390418517319437,0.08575652696322839,0.07975288437097294,0.2682124514804262,0.27878462222108435,0.16774665675079772,0.022257971027707935,0.1370613633264403,0.1121985450227459,0.16563373053912844,0.13268795061171262,0.15347159858286988,0.16134499377736422,0.02718494334954702,0.16253949324468453,0.023034179985288672,0.08061110789986276,0.18749425555029037,0.19722634350270946,0.0944283557603543,0.08536929595095438,0.4151838877030709,0.041240949373788915,0.12223394203884455,0.02718915716442588,0.04788804887287007,0.015100160015431463,0.17316936368707125,0.12857755609212665,0.2126281966854117,0.17615340204996388,0.10783157758073467,0.19721766842424684,0.0061510344164449615,0.013381154069276313,0.007064804992989643,0.23058363719416322,0.08201245098617627,1.3394682406672456,1.1153217021831936,0.33378034949516067,1.2482857587033351,0.012799333846172822,0.033289355941552634,0.2444660573754503,0.3033429502318982,0.16295272986194212,0.30568942549438505,0.330192816029363,0.1655763831066362,0.2369099915564663,0.13181259079230595,0.11129251957744243,0.012803271961100038,0.04876276895033532,0.11493363505610266,0.1205946583642834,0.14719479043930872,0.0773826305193322,0.04149010487008453,0.2907684080588567,1.1284840622593009,0.670604578694683,1.335089398234863,0.16704126495795724,1.4382742991762307,1.3849414151162098,0.35919537564449217,0.23240615576428517,0.188235209762354,1.1718079560285655,0.1524735702965608,0.047664781185096705,0.03227252125586427,0.008485139271736719,0.05593791071684079,0.11566704885599782,0.08830112370458265,0.23634667141647925,0.18984237713155716,0.1523495627917664,0.14218034458232717,0.15826030775676445,0.01889546830874167,0.039135905467526044,0.034028145352932415,0.09169440626574912,0.18558181717615702,0.16279897947585042,0.011433586551972574,0.23018393180401905,0.04875540825944363,0.19123964701217183,0.08597847323027918,0.07658968724764656,0.0913424888511663,0.20792407367837062,0.49352676957571345,0.2524057089088227,0.2689534073821436,0.5056967816779644,0.32053796373003085,0.030950304997253764,0.05186801304122013,0.1827616483759898,0.14259474762825383,0.40974358988930726,0.16279558448994158,0.07001351017247359,0.15174764153665277,0.06869773270487756,0.2921879532642073,0.11829694524977313,0.09784100889745084,0.4594292058101382,0.4030355196740852,0.3947256483101695,0.3891034740282988,0.17756318970960303,0.20065324160001552,0.15376966008478749,0.03431890924068365,0.13733378321028333,0.21775880293514593,0.1398052684188204,0.2946499769628649,0.06003851135649646,0.08272002238325327,0.16367421969663293,0.12725129929366163,0.015360086712118914,0.01672070003760645,0.019409846485750115,0.010968269751838733,0.11854471173930353,0.2688206931597723,0.07919333851484345,0.06467686073984791,0.0641848644120041,0.12337181479869458)
rate_upr=c(0.7566181390919147, 2.1362202137511046,1.1920343318655675,1.2863321992429855,1.0277940901487164,0.4104947852012117,0.6531784813019956,0.5890289540778141,0.5923995301173113,3.6961382264289293,0.5598290917870287,0.5923346115201165,0.3283257317030835,0.5528139392604969,1.2142335775986364,0.5179630163182402,0.7593644836034168,0.9961715676348661,0.6307112990205497,3.006406640651682,1.2432305622510074,2.4802690305867663,0.4901532817006816,1.2860694331853686,1.841019314219595,0.34182390328140205,1.002393285964319,1.3850938426217587,1.1040364814626509,0.3746818034841072,1.1943299248308934,0.7321767300663922,1.7399448491773557,2.643304919564171,1.563329446697529,0.7974886286857062,1.118551276266036,1.131546859168366,2.3843850651634395,3.0766004140038836,2.2793341167278496,0.5423084573118871,1.7553696558892053,1.423541280121729,1.0706522968774705,0.7091006140336464,1.1310650540638016,2.314943601003936,0.5461255369182209,1.1429119739513576,1.5147792366327728,0.5477104794998677,1.0681117591473965,1.0890368120660348,0.6653776122656143,0.5428973017644513,4.462370528018218,0.9998786988938564,1.3827490134685014,1.7004484400557458,1.217482663624633,0.9139590005747295,0.7994873711669994,0.6933250831094386,0.8747680683826555,0.9084719487014794,0.6702241229741905,0.7641479840655554,0.8442173268879709,0.6311563478963582,0.39361443497008053,0.9632085526064643,3.3845204206087804,5.052587947587408,5.073964915223835,1.8516222620539944,5.042304045451175,0.9107952710611869,2.246765451638834,1.9828312162597235,1.6007423081098962,0.9792714212560465,2.4666508187957414,2.9401067214050833,1.7851080495949527,3.1758452394363266,1.403937618132506,1.9350883740330258,1.0155697523706295,0.6092676179907305,0.7357117283857697,0.7382418964264797,0.7698967306297494,1.2428839970541397,0.7639747114898626,2.6214640053416725,4.99602120834206,4.970381062527626,5.127839580605786,1.1755438230713111,5.214218915653715,5.134166176613701,2.069455605635779,2.44272737439824,1.3007998480721163,4.908416139790842,2.2711106884100296,0.6678740299070448,0.5744137040390872,1.4706945650687602,1.474245029548581,2.16181346737155,1.2398166010740987,1.7033578532155924,1.6947195448309968,0.9653680637639048,0.8473259612214434,0.798250363299498,0.3636893143110753,0.5733153516624092,0.844463906194302,1.217897871677783,0.9311888520642304,1.8035756729063215,0.7004457797618645,1.1395579399370797,1.2503114771631274,1.518331083490255,1.8805054715213405,3.1217263963002733,3.7380025750136174,2.931102559642032,3.0348426258826597,2.610984178514068,3.761711290679415,3.0476186046769698,2.693198463006414,1.2478170727585605,0.826138384540704,0.9809777937475244,1.60235554377414,2.2476946994613747,0.9328765752367136,0.6141571865267016,1.0251138028413171,0.9964590610322345,2.7708498972841396,0.6742339499046224,0.6224392361729449,2.3495954413288365,2.2625225329789393,2.2871847165004726,2.2094108393716714,1.4600984757656432,1.9130806574415344,1.2850954513383854,2.333774887364356,2.5159421046784334,2.9934593984569116,0.944561835985829,2.862855400253345,0.9615280661294114,1.0861722472929272,2.0757053283786964,1.422328283921566,1.0967705854872134,0.8014215882433553,1.6111934523146987,0.33878911092838715,0.7689585884274612,2.4271136831727094,1.0245585529583123,1.6319001683138799,0.5650804471155905,1.125570708077926)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.14999629601708, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.709087213395712,11.763688761345936,18.834541775289008,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,21.868567692284742,10.092919561981976,12.78599643443742,14.521871401808362,13.644381033687072,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.275304079953862,12.763996434850949,10.928438777046042,19.116662982107215,19.495450853775065,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,13.644381033687072,12.762457973341409,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.709087213395712,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,11.108996465959809,17.9825347982971,6.999079876546806,14.141457947420491,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,21.04119030911618,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,21.04119030911618,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.709087213395712,13.538644568438118,19.47116297544374,16.129371371592356,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,15.307996387031654,14.445304095555281,9.062465735197444,11.566150303520583,22.72199624767148,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.338496367661453,22.26749625621469,12.543329772332134,10.15963284744126,12.685450981781905,19.776150149198095,19.336662977971898,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,17.990150182769337,22.62499624949477,20.759218506787857,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,12.89213279607875,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,10.74007339597134,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.053424851966007256, -0.06541891819450675,-0.06882717538086526,-0.06881758941401477,0.06184704876767367,0.06213922537317749,0.06317683667485297,0.061593669997931096,0.06228123907445018,0.06215861010763304,0.06309339857943097,0.06205381052918577,0.06309228346976878,0.06332277541238725,-0.06542906641259275,-0.06380780173175847,-0.07639787937608312,-0.07501566145963276,-0.05408468415316071,-0.05401840347941113,-0.05354381872532466,-0.054086005975865374,-0.053422207755340484,-0.05392355503384596,-0.09287552673841214,-0.08554619154931008,-0.08562028766659814,-0.08456645754016923,-0.08546783471145518,-0.0861142116842385,0.10006360548728134,0.09574587788691034,0.10078059190904087,0.10094334607402784,0.10106688533438188,0.09690601451246188,-0.06063440473094777,-0.05727653378686303,-0.08375014019240926,-0.08505920373305866,-0.0853889533282205,0.025352297192148248,0.005186491149899954,-0.04516968804932981,0.03649853336383207,0.02544026056006884,0.014605463730914117,-0.014481222192958604,0.025271744171769906,0.02531201253082821,0.03672211268922482,0.03912324831824421,0.029825652957222254,0.022713604037283737,0.029979996932429902,0.0311543697007329,-0.054533955690351424,-0.06956424973658283,-0.06951454370085976,-0.06990062205476612,-0.06948875856595829,-0.055952028535415164,0.09543721086876807,0.09930788746859136,0.09861547479276815,0.09632283859361819,0.09930788746859136,0.09700453958384718,-0.06657964521639101,-0.06608667011017592,-0.06633734690455463,0.10046361259512344,0.10318442486229469,0.10271269083915424,0.10323459137243875,0.10201944065767475,0.10277262378426867,0.10222922299550753,0.10324747125446851,0.10311985879401464,0.10169511037732433,0.09930377531894177,0.10320589951627995,-0.08120239417652395,-0.08126224690463577,-0.08128155543107535,-0.06376680448446659,-0.06360225226189246,-0.06381125342644796,-0.07583918743578763,-0.07504450973603446,-0.07503721649389859,-0.07500283430575243,-0.07605022707020508,-0.07690022042157331,0.10202904240042443,0.10203892545078751,0.10195105570367635,0.10071919925221993,0.09872688353856875,0.1020942397599172,0.10209706993823776,0.1002189367054628,0.09977936289292084,0.09861305180265391,0.10086504246050793,-0.06755421067002779,0.06832333294003212,0.06850639972384794,0.03690709568500246,-0.06721874457866547,-0.06663635479030904,0.09761446999469901,-0.06511105449504377,-0.06560846107275166,-0.06568424701171137,-0.0658515981157297,0.0929422659958499,-0.08129884069391388,-0.08090618047938712,-0.08110898615236635,-0.06294590528621295,-0.06600209937723375,-0.06684941590277438,-0.06685140927940376,-0.0669715027517645,-0.09124588235119728,-0.09063067035323402,-0.06430153447533499,-0.06438407152673853,-0.09318312993138342,-0.09273219864115319,-0.09173150250523729,-0.09342865135392528,-0.09114571071571685,-0.09170726338613547,-0.09333906864630848,0.09342829637328139,0.04926462521649896,0.05112806133314146,0.05120574140773908,0.0526239205634775,0.05168880696937026,0.0520490295125954,0.05115010222846144,0.04975775050277302,0.052172571551561145,0.052072881844010474,0.05172039973723329,0.052019713470861026,0.051344132749282116,0.05262830427760028,0.05230759724604733,0.048960017004379595,0.03954010310419659,0.04009751576337509,0.04070147353506274,0.03950396788720205,0.039914964441339656,0.04025983450592996,0.09543115828105805,-0.09257592039834284,-0.0922931882399409,-0.09306052393250956,-0.09237269150204284,0.07225687240564325,0.07219065835115705,0.04751288880228042,0.04732399790250755,0.04729350360796998,-0.06596268338436509,-0.06641456907634424,-0.06350332079244707,-0.06404824284816572,-0.06371815389448988)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.017708487845298042, 0.03465852860239183,0.039248716983010454,0.0392358374107826,-0.0009703969953347829,-0.0009811110058029237,-0.0010209522663281443,-0.0009606629854214218,-0.0009865381237832338,-0.000981802948235129,-0.0010177831673895978,-0.0009780420876105494,-0.0010176822815092872,-0.0010265024876470283,0.034603017930080325,0.03255926391742477,0.09250220699708296,0.0900835721275881,0.018230847122048963,0.01817824083164947,0.01780127226472098,0.0182317248314806,0.01770269217282865,0.018101306723344215,-0.19991234450493695,0.12605010258259045,0.126314151038114,0.12264134492648311,0.12578509085478587,0.128037771817772,-0.013003284321345463,-0.011653907188907416,-0.013224848473236475,-0.013275140451780769,-0.01331334431031578,-0.012012608543825902,0.037069791063920894,0.03423262413250826,-0.15418079184421019,-0.16048572105682424,-0.16195407560476743,0.006261660377633003,0.008183319759467015,0.012663487080516773,0.00478160502768351,0.0063128819797588906,0.007214487687821801,0.01007518109243814,0.006214466793043853,0.006238192719517174,0.004813925641221041,0.004515818587231758,0.005598484047833356,0.006356930815272795,0.00566713529194074,0.005506041194860594,0.02644237306497136,0.04027206692140434,0.04020371804485958,0.04073301397929653,0.04016924350163233,0.02969977767284997,-0.011548734282550493,-0.012724321208721384,-0.012516068302890997,-0.011822471284293737,-0.012724321208721384,-0.012029060047424241,0.04668578672976291,0.0458741721495925,0.04628693689781544,-0.013135821839617381,-0.014000188280870546,-0.013847969194866298,-0.014016168471580931,-0.01362860637803237,-0.013866943123600695,-0.013695027844312757,-0.014020262428577245,-0.013979592628297491,-0.013525744616114561,-0.012770549590820931,-0.014007017826816914,-0.14144987384826777,-0.1416950342487622,-0.14177473767713616,0.04202506455467592,0.041769022718962545,0.04209417474268436,0.09048811587340529,0.08825671612411994,0.08823659329110134,0.08814172948888126,0.09145231416787633,0.0939440373510946,-0.013590777082185411,-0.013593851801137948,-0.013566372948212826,-0.013179224672626125,-0.012549633697573268,-0.013611167247946657,-0.013612050501942552,-0.013023407158695897,-0.012884642757686002,-0.012515660868586305,-0.013224169036725473,0.06578221646526534,-0.0032635598601496365,-0.003284218454940706,0.0048712071462738505,0.06421723608550152,0.0629117768367177,-0.012235317347855202,0.03420832251929177,0.034829465035587114,0.034924161370752715,0.03513370381346157,-0.010791224187507715,0.1112430786736206,0.10998315647031083,0.1106326192143751,0.031457358270527765,0.03542871356400397,0.036583344146601776,0.036571886580336964,0.03672665209207523,-0.19161318795796528,-0.18857691256035988,0.0331369203009048,0.04294823016734375,-0.2015468038648262,-0.19924475487160154,-0.19410840635423468,-0.20279961642365568,-0.19117409269363778,-0.19398779631102536,-0.2023428657091039,-0.010936259631886784,0.008824481783874029,0.009681324951508894,0.009716455947734117,0.01037426962899326,0.009939961982660192,0.01010798487051478,0.009691137832628175,0.009061528994520666,0.010165167409506973,0.010118855644411017,0.009954225688100957,0.010094827497411666,0.00977834956411529,0.010376297145145263,0.010227988564326591,0.008696337711080901,0.004495152410126566,0.004701819534883956,0.004876599458700118,0.004464473681866879,0.004655552046094504,0.004737030280051903,-0.011547868750702336,-0.19837840793510483,-0.1969572370410459,-0.20085070366393634,-0.1973646222148023,-0.004367135469262287,-0.0043577460267938736,0.002659588199982883,0.002634741464566443,0.002630710059205261,0.03528489459505642,0.03585899799004981,0.0415674023100244,0.04241363180650312,0.04190041370467317)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(21.735000000000003, 14.895000000000001,9.438,9.438,12.725000000000001,6.289499999999999,6.289499999999999,9.438,6.289499999999999,3.0900000000000003,6.289499999999999,9.438,1.2905,6.289499999999999,14.895000000000001,21.735000000000003,36.435540499999995,31.0,9.438,14.895000000000001,21.735000000000003,14.895000000000001,14.895000000000001,12.725000000000001,3.0900000000000003,9.438,14.895000000000001,12.725000000000001,14.895000000000001,9.438,3.0900000000000003,4.466500000000001,2.19,1.2905,1.2905,4.466500000000001,25.565,25.565,14.895000000000001,9.438,9.438,18.205,18.205,31.0,18.205,14.895000000000001,18.205,18.205,14.895000000000001,18.205,18.205,12.725000000000001,18.205,18.205,14.895000000000001,12.725000000000001,25.565,9.438,9.438,6.289499999999999,9.438,25.565,4.466500000000001,1.2905,3.0900000000000003,6.289499999999999,0.06885,6.289499999999999,4.466500000000001,9.438,9.438,6.289499999999999,0.45349999999999996,0.45349999999999996,0.45349999999999996,3.0900000000000003,0.45349999999999996,3.0900000000000003,1.2905,1.2905,4.466500000000001,9.438,1.2905,12.725000000000001,12.725000000000001,12.725000000000001,18.205,18.205,18.205,31.0,36.435540499999995,36.435540499999995,36.435540499999995,36.435540499999995,31.0,1.2905,0.06885,0.45349999999999996,1.2905,0.45349999999999996,0.06885,0.45349999999999996,1.2905,0.45349999999999996,2.19,0.06885,36.435540499999995,9.438,9.438,12.725000000000001,25.565,36.435540499999995,4.466500000000001,18.205,18.205,14.895000000000001,14.895000000000001,6.289499999999999,18.205,25.565,21.735000000000003,21.735000000000003,14.895000000000001,18.205,14.895000000000001,14.895000000000001,2.19,9.438,9.438,9.438,2.19,3.0900000000000003,4.466500000000001,1.2905,6.289499999999999,4.466500000000001,2.19,6.289499999999999,3.0900000000000003,4.466500000000001,3.0900000000000003,0.45349999999999996,3.0900000000000003,4.466500000000001,4.466500000000001,9.438,1.2905,3.0900000000000003,1.2905,4.466500000000001,1.2905,0.45349999999999996,2.19,9.438,18.205,14.895000000000001,1.2905,18.205,18.205,9.438,4.466500000000001,2.19,4.466500000000001,1.2905,4.466500000000001,9.438,9.438,9.438,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205,12.725000000000001,18.205)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(2.0, 3.0,1.0,5.0,0.0,4.0,6.0,5.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.01793790942827681, 0.04170373967184194,-0.0011659617626406543,0.049177250332757605,0.40787108045502934,0.4536904280478073,0.3640498170959561,-0.01569979100337553,0.383783012880957,0.21757179272186378,-0.036904006709175645,0.41962896758772467,0.532504679525846,0.14050908645870294,0.04689072549007714,0.004795311097607725,0.3628966508666292,0.0796355117060007,-0.009667449896928748,0.03147640175026488,0.03408832856217266,0.028109331895225506,-0.01802644280452743,0.002425868192610158,0.1463261302846071,0.40899049709088076,0.062852661518693,0.030531710821748576,0.019510677083964298,0.05991374828011655,-0.3289659719170523,-0.02226309265358988,-0.4376494434022253,-0.09100869409886661,-0.40830719874808913,-0.17200661699287265,0.020614393394874447,0.10960197251554624,0.026396082709329857,0.07013575372573647,0.07881912473906101,-0.017687082753646038,0.013341236664683521,0.03421034374861193,-0.016496333746264406,0.00629779311518747,-0.010822063172700146,0.03225832206059167,0.019834791679458157,-0.00012183079118666099,0.016124185683861,0.011842739941105308,0.026535084893499622,-0.010544714112208229,0.00922317819852524,0.04011633105963659,0.07773226131237865,-0.014198110646932,-0.02878753955397341,-0.02968126521118221,-0.006018601712604706,0.6460050465523385,-0.022975890983262727,-0.05343716286709282,-0.11464337714003886,-0.0242263494940618,-0.06867685397430694,-0.04535037668609854,0.1983472075976379,0.11063541306778489,0.033808287396410196,-0.21731711774238793,-0.08234860865412122,-0.2762343860545159,-0.09524840749437706,-0.013342987049564702,0.013476981724482202,-0.13833837414608877,-0.2606721843028207,-0.3284196237229326,-0.04249612757030591,-0.02491871678886877,-0.4144162995188508,0.048056320584432176,0.03294074358155627,0.068432434025995,-0.014737551738986691,-0.013731626105026946,-0.006500289457429165,0.5493722690842668,0.3348800214376568,0.511444418390228,0.3859659141437527,0.3073495821118753,0.4618637610819255,-0.30249161399109104,0.0533344756874143,-0.1895856070478538,-0.3846649326840509,-0.3366349816552167,0.03772873061866735,-0.30247824695896347,-0.35816027352294827,-0.3307069959412586,-0.35945368493564045,0.0789270709538716,0.4944960533222422,0.030368817908807497,0.034921646899952766,-0.012172403983179725,0.6053151988231593,0.5033400999337316,-0.18051076611558778,-0.016412767801121008,0.00998524565071741,0.01660492696772555,-0.0070348552030796985,-0.021121899630708738,0.07502469902092379,0.16734822233384805,0.04673786694711228,0.0049758777062023744,-0.012210237182992616,-0.01706539612071439,0.036919132722806114,-0.012630373691491038,0.0018532421909604755,-0.012460588143694818,0.10055107975514421,0.12553565571283848,0.20426072858670208,0.20938329957547788,0.1503593767525214,0.16060803668821308,0.1998636802577433,0.1527723436771489,0.1655890596249124,-0.020549293959653107,-0.14455884978604275,-0.00694627567837005,0.0241253476558137,-0.04128446072443585,0.022408676450595355,-0.09930846590336515,0.02288709594289083,-0.012026563898958781,0.07507076590145233,0.024755374702564233,-0.14629299012769015,-0.030229287572267026,-0.014776598466412955,-0.008422295479224514,0.025092425096593006,-0.029379356250690082,0.013830977872526873,0.02430173302375243,0.13205283926706216,0.05038535986881111,0.002667837500381863,0.1260647053617005,-0.015754510489250244,0.006540838593281992,0.009706915623460838,0.1394438826756056,-0.027055894264021708,-0.05007920425849204,0.00031340926961111046,0.025828432699367264,0.00406186501006802,-0.014099524134459465,0.12758810441982216,0.02446263895390549,0.0050853943916216535,-0.02111536834156558,-0.009566063310641177)
shap_list[[2]]=c(0.09328298267229941, 0.17728979536269976,0.26984680473260036,0.41376386728480324,0.4473767924057539,0.5158917248526848,0.4018469650273965,-0.04207479369440781,0.41876058479582434,0.3073762535177243,-0.03586113863882968,0.4751503915284822,0.6080797015903181,0.18054332477718846,0.19077906019288804,0.10774937295788971,-0.11676930184658689,-0.08660282294115038,0.03529094544556941,0.12770052177005164,-0.0075517218939508725,0.08223500300717225,0.07528810738979741,0.06814680492486791,0.2981455096743943,-0.3867894522273273,-0.09946070423090397,-0.028491492124918603,-0.06023836693445146,-0.10046657765757629,-0.08660653815337904,-0.040502655471647296,0.1467623036099777,0.0035214420421942603,0.14680183109778658,-0.07439157788433523,-0.08245664450296099,0.12701047894031922,0.33845376462375776,0.2550686214141934,0.3366300121642229,0.06489469163139448,0.0909295322560428,0.09230671033724987,0.037330235429491605,0.08336189605785967,0.05154028702504604,0.1171997467313855,0.062235056813790296,0.06851776494961297,0.21916769173279857,0.14395200324728424,0.1663909771174245,0.049099277418497,0.1308674179119453,0.12479606187099414,0.08848671810934584,0.1808927730876036,0.1953192022552744,0.34264361245922237,0.13304532853600795,-0.05894537785891892,-0.031212799913121043,0.0699290311471605,0.1085780898977611,-0.037849847654987306,0.06387732542051372,-0.04265432686451904,-0.17914204733383216,-0.15463568062403754,-0.07565618629596751,-0.06403767520946799,0.08841561372516869,-0.15623476476977233,0.011440677302067024,-0.02903749412963832,0.09001650414533606,-0.04795331465609957,0.11457946088602051,-0.0683952456050486,-0.0363233485443266,-0.041114778789084545,-0.12177035551093102,0.34722454215015436,0.35575297001915807,0.3936081876962666,-0.07448927472644705,-0.052829507737358804,-0.0527658900264452,0.33024969124815096,0.13245220714898598,0.29011869277218183,0.1879865987452684,-0.0450065585266126,-0.0904365849414844,0.06884836794329917,0.18704263350381173,-0.07398163131160938,-0.18432142553222788,-0.07491093059703062,0.11375637403945207,-0.04127543808851632,-0.0907318816166208,0.1464259978676799,-0.1077559737497915,0.12566644473662764,0.4781334428147928,0.15840741028009891,0.20547626454736068,0.1584148895329387,0.5696161575666786,0.4787325715098403,0.3129095164926875,0.1164763178547261,0.1982607310500789,0.21791245426966688,0.15827449851640182,-0.037808314017326886,-0.09914048773559263,-0.16655000499870432,-0.07979792234802092,0.04449574932503076,0.1281634445673973,0.11827398375799779,0.2559213401891436,0.13162759368889357,0.3200523966793383,0.27792508366702556,0.4927852915544194,0.05723072739104845,0.2218618442923496,0.12280637933127449,0.08687424941335116,0.1500055823711394,0.17243189425297,0.088800535961598,0.1634762355654188,0.0799913655495321,-0.11959088210571456,-0.0533911661242902,-0.02661730508470669,-0.03201978684742504,0.20262911218326957,-0.11163509399597371,0.20234889984362187,-0.03308644832048455,0.20270295365122215,0.15941897884890882,-0.11733604626031245,-0.04395166785707827,-0.059970803758569446,-0.052895222491075755,0.13453359249499286,-0.06701767817443915,-0.03596281468376486,-0.014989434758806262,0.18843892030053006,0.019307930394412167,-0.04643037256517482,0.13206288740742617,0.05725071759630898,0.029239470531144902,0.010965562711730008,0.26702962083946574,-0.04110917976928375,0.2262866913412047,0.15636494660301187,0.2657189067421048,0.11263131251210386,0.09696659494019891,0.49052614699160485,0.27313130850548617,-0.037698591982397646,-0.06289031190892261,-0.07601850532638522)
shap_list[[3]]=c(0.2078288742512951, 0.5000728704330332,-0.21830096146211986,-0.1770580034238186,0.11966879528638544,0.17177667528073964,0.9789014642644613,-0.028725588361794,1.001241029801403,1.4812188461170444,0.07194892305685685,0.09640347938090685,0.01191719279456792,0.5371958947249632,-0.05211677215573574,-0.11816837110624587,0.2724152065150999,0.10993387990235179,-0.05050890202807504,0.01952273042333983,-0.06618159323178416,0.020707945478832514,0.20224189350991204,-0.06684291894204072,-0.05008039015792849,0.7074872220159995,-0.014854605809844287,0.004303284764426286,-0.015624422404741966,-0.014773212144983497,0.3413456320144479,0.07665092159595455,-0.04325453873381415,0.07787111261300704,-0.05521530872169946,-0.08054854237761191,0.15066887979859564,0.2454279524223534,-0.1365432781545164,-0.09772227017216387,-0.12224860642778476,-0.09222207628281849,0.035801950021396904,0.1624829567065601,-0.004782794507355707,-0.019917986969645782,0.010966799499127813,0.06750000160200076,-0.011920943632444364,-0.011017134368688368,-0.24384237885145038,-0.027235123463748425,-0.025429949749638164,-0.0016289018156339546,-0.027427377153701426,-0.020408017329373293,0.1635966562804265,-0.08164048916706522,-0.19728301158884634,0.5816736093888075,-0.058942638677505696,0.607523463787777,0.08321655060168462,0.7949199970409526,0.7734480331343091,0.09354018500589442,0.8027632572925026,0.121624704799805,-0.028275328656105738,-0.003500506469588264,-0.028109189575670664,0.3703727862497288,0.0070744594906155854,1.6211580253031386,1.0574808020284083,-0.011767361160116632,0.8520128415971433,-0.30934220215902003,-0.9951408617658923,-0.13816555646189466,-0.022012734450294485,0.08488841110684088,-0.11146639835703501,-0.06310290377848424,-0.11845395718316824,-0.010951163668077853,-0.02606576555899602,0.003321286017392539,-0.13228673135216143,0.7053935211050983,0.3391154787396778,0.6425130748895141,0.48607910470393034,0.21038007346256993,0.3446654344264326,-0.031830358348878145,0.8009180823570221,1.4366410136750885,1.5593815709469525,0.48166679652172495,0.8572005146457238,1.6695591302699542,-0.11826901428616987,-0.02991177048278775,0.3623526889056984,0.8300228027184732,0.7945444746234491,-0.0335461823110609,-0.028050160539273335,-0.1417446331011852,0.9455625499766904,0.8060590269406704,-0.13399462518548738,-0.051391371589841646,-0.10238779414878485,-0.10595200069611434,-0.08415468032385381,0.0784981246290364,-0.042770869244759535,0.2013391810343333,-0.03657187107963681,0.16078360769678368,-0.06413300764881717,-0.07040682030490401,0.3281588901038587,-0.06877259160742843,-0.1646973250822456,-0.20166407003691197,-0.11882571426074219,0.12194039914161892,0.16659134929443262,0.19841842851129712,0.20793883449241066,0.18523066695015572,0.1715252258604305,0.20799645399569286,0.18612664513244648,0.13455523877627046,-0.18669257199269856,-0.02268131840894255,0.024306784572094946,0.8993322700889439,0.013764818199874412,-0.19311715844455304,0.013764035409677846,0.0797896428783923,1.3741484608863002,0.017590426566578554,-0.1710516364941934,0.7960462345523406,0.8551005818374244,0.9100713600296606,1.0196518997359578,-0.04078286374600639,0.02117680754651958,0.06066831246544569,0.16210235320024882,0.12217831201933999,0.460013602860562,-0.05338993239057927,0.3659179911821525,-0.1960633401763216,-0.20680175572139672,-0.04728137276831686,-0.20355626913155256,0.16653983542252884,-0.07105647026510055,0.025644636204087506,-0.06346037062890142,-0.030857402346120028,-0.10317709155836065,-0.21697318270282914,0.1389683670264515,-0.012241352504823652,-0.027527916579078892)
shap_list[[4]]=c(-0.1314302815404236, 0.15190674146250743,0.12086248463816765,0.33016253514133365,0.5861377971298539,0.7530157965525283,-0.1997867513568863,0.016723386761251638,-0.10805604649934263,0.32713868411812935,-0.06012302841145384,0.5157854281622548,0.38812518335791873,-0.09311964281204597,0.08493285250441736,-0.030836095219948952,-0.09369832569709936,-0.0739209804508087,0.08483422483033819,0.09380388307442787,0.15346361262950756,0.07440243585296649,-0.18748443869500023,0.11810376166630582,0.032423151539381356,-0.07995309692484277,0.09024338301624199,0.008055075780475622,0.030253862995799484,0.0903185004630145,-0.16872800676378197,-0.049659639152773,0.6576494116570807,0.11696351856434058,0.5289790806641351,0.06049113103684383,-0.05694234825185134,-0.1379710227483758,0.2402352630359266,0.02553790284878348,0.16511354094955588,0.003013002073608199,0.05722015223747623,-0.1267281646972535,-0.01067152422599114,0.06760895270682007,-0.0021327040517798586,0.06512298691364116,0.06215510179472271,0.052987048929370256,0.2340547193574866,0.10087373127024314,0.11225226859528845,0.014294873959579468,0.08224039874594562,0.12690705360749358,0.06299206545662407,0.1581313561280461,0.05311510671653856,-0.04774553881020579,0.11242329190101982,-0.13251227623321815,-0.04670798898734388,-0.20481873244588225,0.006682998877087433,-0.036092509930857074,-0.30516936951573514,-0.06404294348190487,0.4797450193560673,0.11832602752085154,0.033784397871795636,-0.14952839458939393,0.8640557585511487,0.6753872324583611,0.5999440841494782,0.04416382021084039,0.5093558271090121,0.1330512228472821,0.8271946585473585,0.247645119172495,0.059199343059042404,-0.037495168895918626,0.37922812182145416,0.05293392805563081,0.17314263713461092,0.05111493012193484,0.043717623842279445,0.01284417005172012,0.056511264285563204,-0.09619602387385015,-0.1719395117784392,-0.11438318143210381,-0.11641559068350538,-0.08578591303308297,-0.08206276327746147,1.0585527592738586,0.4277867194218611,1.274319752251398,0.6118037869563528,-0.1266987748597907,0.44674508904775806,0.7885193770420156,0.1743941120868976,0.8882719738067816,-0.13976482117924516,0.43093594973219174,-0.10803469239840745,0.11375174936092543,0.12849108861001737,0.04812897187558529,-0.1314654574197645,-0.10686511181108155,0.1702538356650497,0.015587149793488792,0.10455543235556276,0.13379240908022294,0.06654833531165501,-0.05417144991734102,0.08168482093797574,-0.07126170303415096,0.008280460271051735,-0.0855546529141366,0.03990165420297698,0.018244435897048397,-0.24627447820407636,0.058024508741831037,0.0018969223216528219,0.10572189532586422,0.44292407717145404,0.10466004237134599,-0.016166234386740194,0.32356732334580307,0.2799109163299045,0.31915491944507346,0.2696556768639901,0.350277175607767,0.3679551203207361,-0.07715758234590821,0.29427688856528067,0.0048038838591429305,0.023582757306314615,-0.5904155237575875,0.625574812177987,0.23293071823146522,0.6243183820271677,-0.05513806694989787,-0.3543293178785526,0.7397901151026764,0.002402030107452353,-0.59418596050266,-0.605116039375378,-0.5896494079659819,-0.5478748136600083,0.0524387882521239,0.009366668455508896,0.02385473395708964,-0.05541778067817496,0.05964883701422395,0.09224784573597469,0.18871496946345254,-0.08409499284858139,0.4169836089315691,0.40512337524154074,0.011852205970696538,0.08908769795389876,-0.12970331054236334,-0.03533220579551315,0.11300155751607781,0.060127779389797936,0.023868208707207687,0.451762345639464,0.15221985122490775,-0.032922078227278474,0.01754003977917468,0.06123748258740181)
shap_list[[5]]=c(-0.12497721410142583, -0.1672321154209964,-0.13945766163190473,-0.17387578246002203,1.6065872374736476,1.9651392582905787,2.0493865626493664,-0.08193327567468543,2.1496019751581317,-0.2733872935242272,-0.08669114816334535,1.5668674328869994,1.8649737155987074,0.945905712472349,-0.1248809709039121,-0.0902430023639711,-0.09090481964855851,-0.06944064772518983,-0.11316419850811701,-0.12402305097916642,-0.10858570028810983,-0.11427615033983436,-0.12437486765886231,-0.13265393360841232,3.9593291078119153,1.5087608989837706,-0.08704984196709492,-0.07210451225924107,-0.07139859612678942,-0.08631298345442531,0.8242218513544531,-0.07620260613118189,4.040508639824336,0.6679425505460662,3.9960762806040973,0.8196266915687075,-0.086721004101582,-0.1035533379552644,-0.1650470038522065,-0.1465694485680197,-0.16493724297297274,-0.07876412628600515,-0.10146893613802299,-0.09456838007061677,-0.079809695012903,-0.10762469762975994,-0.08251937714031529,-0.11069240986428935,-0.09509412146351663,-0.0961267239295345,-0.12451806317749177,-0.1177822925584175,-0.12546597238588855,-0.08225110212288803,-0.11471688179409013,-0.13169840352166304,-0.10350578028145857,-0.13780267319504316,-0.11612320803820615,-0.1887433827033446,-0.12473366656175117,-0.13629671118103226,-0.0897336827294751,4.165897753370128,4.181820644684601,-0.08588166193283972,4.077332290550998,0.03647685499272965,4.113913454346223,0.2507503237342512,-0.07160531033000818,0.7622674770165166,4.016488367241666,1.6521546095846722,2.3251090674754655,-0.0664285671305358,4.574600044701171,0.5424531463246034,3.5697646101180416,0.7454960756478114,0.04391796707021654,-0.09097367604869858,0.7896982813560695,-0.15947408654154313,-0.16676546758530497,-0.16396276014297134,-0.07925908474296776,-0.07102295047204892,-0.06761183418273034,-0.15285352238140065,-0.08840460711865868,-0.1443621123739791,-0.12246101760963318,-0.08210320539494372,-0.1006089847343476,4.2024900676290935,4.6615756978687735,1.6612931515397293,1.5403428312348213,1.3897857810466734,4.633826456632384,1.78951758849915,0.8117748939665325,4.229034834719907,0.8157720192634558,4.656724937114533,-0.1668597658714565,-0.1282754581855167,-0.13549243171400271,-0.09656326032599571,-0.18606740004122804,-0.16820554781436595,1.1441953872467372,-0.0937193030469597,-0.12678529770066402,-0.13181739558913844,-0.11099346755938665,-0.07867563381684033,-0.08175513593797956,-0.09029901493698934,-0.06839826310230786,-0.09959698030213852,-0.10354057762037278,-0.10576489285057039,-0.1414091431879351,-0.10816826730031005,-0.14548153571124187,-0.14742707767965238,-0.18539619053401887,-0.1286127543548776,1.3956495311483268,-0.13780331968983234,-0.16741539315131113,1.2545610682665806,-0.1637054553272731,-0.17158416852513245,1.2694608882470408,-0.04309162610464178,0.9012141091351392,0.023080645877621143,0.02977758404020909,1.6374198832356273,4.688526533118015,0.8958725769013149,4.690939749752171,-0.052853692849882096,1.7523404013559651,4.711002569929409,0.6867611057712043,1.1553366394116604,1.2545197199326312,1.4375525207726327,4.3358410597661825,0.07925759477673969,-0.07240516142262231,-0.08278727441091019,1.0124365308333634,-0.08498645969650125,-0.14430699786462947,0.6923751128039928,-0.1324261371999788,-0.16093596858634154,-0.15707201136036741,3.9199375924867947,-0.11369031793012657,-0.12698326908826502,-0.09172913390337778,-0.1328908557698024,-0.10295079053380929,-0.09499096698264337,-0.18838905589880925,-0.14306123992810293,-0.08794660683923643,-0.07553985918865488,-0.09022118152602802)
shap_list[[6]]=c(0.08998046691871427, 0.26422364266860177,0.15457948354924583,0.26736999018589225,0.004208505911594831,0.018887527557035325,-0.07421851012799546,-0.07224301173500124,-0.06137575352237773,-0.049233737289279975,-0.06311978986783025,0.003342954241162789,-0.010842366913507968,-0.0570486356736438,0.14436832006556458,0.08745131545146088,0.08087711562770622,0.04683346233558041,0.09100308003210208,0.14212553983478943,0.06231147703155906,0.12403002157920634,0.09431520473437713,0.10284863532544848,0.24625906867326097,0.31598408378547965,0.06558390357579315,0.05247581660866194,0.05219998499482164,0.06596125383411894,-0.24627899187999738,-0.04971627415766327,-0.20195966500179327,-0.1272157171503656,-0.22788288781892277,-0.1662979421425431,0.057991361771273515,0.10520344567240825,0.18650033329001944,0.14430569433247922,0.17967535742347232,-0.04782002414947744,0.025200788691796556,0.04304692623986332,-0.05452964521225513,-0.020359956669156697,-0.022422416760800912,0.07255097817908274,-0.01596065440647235,-0.02426122204488771,-0.10435116519418569,-0.044375977919040015,-0.022047914905923716,-0.033181618564851155,-0.02946269047037304,-0.015120085584471307,0.13786678552937726,0.11949153106098895,0.11275087765064151,0.2572043012887902,0.11874963678480428,0.1844634807722913,-0.04197818157612609,-0.23269136155996237,-0.19611557178628136,-0.04537744578547641,-0.2464098435721666,-0.06704771661565859,0.1402923162154913,0.15662083613637492,0.0633264094711962,-0.24498495270566295,-0.08134863622793902,-0.2926381926425277,-0.08348866500992096,-0.05257054336104932,-0.045318272105111364,-0.102236736710037,-0.15197954372446823,-0.1852362356219846,-0.07361908006559557,-0.045172040680954546,-0.17805341750293038,0.183891646387404,0.19532401953719292,0.20324986667686706,0.04675950330792819,0.044503397361102384,0.038439258699605086,0.24748208208744182,0.125675865156109,0.22562277997798363,0.1735179746965751,0.06741203260220605,0.09807736307541991,-0.08708714934110769,-0.03284674769955881,-0.09780973453399974,-0.2928062784262182,-0.23730765792891467,-0.0495385205116931,-0.26524009275351135,-0.15167829649007933,-0.1223604090937496,-0.2393190255058926,-0.03837397812007873,0.3115407340534578,-0.0944450652314679,-0.08972103235019618,-0.0724353170699901,0.3699572278905019,0.3131219453096384,-0.28871443073081227,0.07092454529517003,0.09673253213426938,0.10555934203232781,0.0839363743299488,-0.04417968694118327,0.06030082652717359,0.06653443724887075,0.0473763255418307,0.09702844095148365,0.08280991761425721,0.0789241918462607,0.15013008361517852,0.08866899899614443,0.11644998992553345,0.11763024307108111,0.3329455460244941,0.21353857754730157,0.37141699679971263,0.23592068340887448,0.20565092393334486,0.2421511608175256,0.250586336235633,0.22026346251822515,0.22918040116561383,-0.04357555942176661,-0.07862325216347235,-0.06297948600058893,-0.03987910063380436,-0.0468265629782719,0.08896189417598645,-0.0998610174348688,0.09039722380959064,-0.042318513984421206,-0.019687626347353316,0.09391605738903903,-0.1086970248745693,-0.050645980205962955,-0.044731822136172696,-0.046786373985581456,0.009237055301519758,-0.06171558867040524,-0.045976951701769304,-0.03297253345837639,0.06616939785349392,-0.004057005164495933,-0.04804939724793285,0.019087876399076074,-0.044696614377689195,0.1428630476455889,0.14234144801056603,0.2626529700978401,0.07326302301308939,-0.07702021204187058,-0.04030813114084475,-0.00518135037270157,-0.06569630101829385,-0.06829973151547616,0.35928703426958264,0.16996387277208627,0.0660264003283285,0.04298185056296351,0.051400067289792024)
shap_list[[7]]=c(0.021982926936565922, 0.09122889709922297,-0.01879798154675787,0.021224728479495816,0.2779336352125279,0.31848550175531487,0.28264641491008924,0.0009662931194346687,0.2960473929893521,0.19415967099514775,0.012873215515113987,0.2684484375874164,0.3153128540680219,0.14586689721528795,0.03506434262055341,0.009669112990776479,-0.11249174065021438,-0.0851714436752577,0.004584695522457401,0.0415143266394084,0.01618505760086957,0.03990438962719642,0.02589261792863339,0.00715793053430242,0.02665513021528185,-0.2894314201171932,-0.14288153930492312,-0.06989441993144563,-0.07215080045020228,-0.14064551985405224,0.08700343194793889,0.025636237327115285,0.45306586305852076,0.10371526577957643,0.44244404816912153,0.09144634183783804,0.004996581758843129,0.03165764253886478,0.2605697211602641,0.322161123379602,0.3080757850131506,0.005682114152202164,0.025507773832354277,0.023357106410679545,0.0068531414682744245,0.014424249939086848,0.010880784774770258,0.042780024162624934,0.01532773647626984,0.011137034194358417,0.030528889557904747,0.019951084288439298,0.029441328470997057,0.00804567882845026,0.019389266219833466,0.0270266893487987,0.06331895586226617,-0.010184125905529695,-0.025597336339090265,0.05025731081174118,0.0016369867127507675,0.25694013076213734,0.028526871343905223,0.34403479803865195,0.33718468671962026,0.026279390810516567,0.3415757496753063,0.04035130648421976,0.08636436625333098,0.0016305309250940776,-0.022180019292660107,0.10347210040681509,0.3553518573115299,0.2921439356874622,0.28547378589777933,0.027567607463362762,0.346505948501128,0.0671639674290936,0.42914899806579304,0.11725396683187699,0.03885333983732471,0.024208574274962574,0.13178045408415381,0.3897901880188539,0.32692105013476597,0.43715877583188456,-0.01919411990612316,-0.002859967475991058,-0.0056406171796357886,-0.026782715885701115,-0.07049094664241524,-0.02998822823031319,-0.05959813804217525,-0.09899273294578871,-0.10850022273549532,0.4129764429430912,0.3474142821643692,0.31895387683643117,0.25894241614259667,0.13808583466072796,0.35309285999114104,0.30572399562449104,0.09716047983363849,0.4554425163433745,0.08625081740062926,0.3478601282601674,0.12432029041404252,0.03497644842529212,0.044097943420763626,0.023815192034607892,0.15352715414255452,0.13195017602083675,0.1560718092270033,-0.004792750645799392,-0.01225788146864584,-0.009740512206218988,-0.011592481665356934,0.026678583062350228,-0.13495011950598113,-0.2342426227017148,-0.10271103792022665,0.013856071360760284,-0.004694860013030889,-0.00929989049183953,0.010043814211886302,-0.00560899716810542,0.20053152920335182,0.06706949793084024,0.08038582498396424,0.07572087081538184,0.4102610705899765,0.6313206092728538,0.524748208678263,0.03072406887674008,0.6651766434923228,0.5502378936629805,0.00711999434244577,0.03758081845495869,0.02400834031964272,0.004288341532249711,0.022857419480077686,0.144396787377168,0.316652597353343,0.01449151757384254,0.31759734757768626,0.013445520688557235,0.21251110419288527,0.3037911702180767,-0.008155229846599398,0.12068501764339677,0.1335123478374273,0.1412801394659793,0.2504423304271159,0.005848795154055788,0.008259791524267677,0.019396852892952707,0.15580919560601855,0.03941803249104832,0.03717095717571772,0.09397882456373312,0.06402582084338472,0.15942186074404013,0.16615921881561416,0.05270132785071986,0.09530420093165956,0.045386783339779926,0.020452230382731404,0.044892148303529986,0.017511981989625006,0.010439639595155654,0.09986927222580871,0.011712050807176761,0.002414962471820376,-0.010220561263811814,-0.021930567282005698)
shap_list[[8]]=c(0.059076833895046095, -0.023830819603738538,0.12018883375325694,0.12679211219503952,0.3834478404822971,0.43529332426587874,0.4391103994193322,0.022611015276122696,0.426960799894939,0.313553100709735,0.037868750208035686,0.3776207720294625,0.5386349632988262,0.24826577694645016,-0.0372430015768321,0.004607207992430293,-0.27822815478190366,-0.10573698389957206,0.004453817245251415,-0.026938490112201265,0.07599350614184136,-0.021893502306282328,0.1274735569069957,0.08963830003975969,0.192558715243,0.31270437274356483,0.06335658215784591,-0.009006719395164934,-0.02316364159537387,0.05782411282472968,0.156781036175442,0.057262480444653235,0.494175870290987,0.11228596347154508,0.4910587966638193,0.15987965009344215,-0.05943255322642635,-0.22905156383500194,0.008857873727069355,0.019646134775519287,0.022405812706627882,0.00810962746154706,-0.057310011397257506,-0.13596997244042658,-0.014223677006454551,0.004121170266398932,-0.045814314353169704,-0.04978472288804108,-0.045202467045484564,-0.034909545688286754,0.015606027992614171,0.00794632733646649,0.022468050810225623,-0.05253581865101397,0.010301238149748577,0.06736574651282291,-0.06513331299280761,0.05067944952994416,0.058355744214742704,0.1668483760318552,0.00236069042372554,-0.2533033343620781,0.0618803463084236,0.3507754826795645,0.346444573606047,0.04579405370485895,0.35609522077828487,0.08090546060882638,0.22831408283791407,0.14221377748032804,0.06673002845591763,0.17852279093564444,0.2954875847778467,0.39546524095174584,0.2847273848880016,0.046093770643673655,0.2764674919222756,0.10677086668855067,0.40965625238528275,0.15507682086707025,0.06363700255427192,0.04349784917902235,0.18114647342939894,-0.020133923287640097,-0.02517077506416143,-0.01634362958338819,0.02515549798886324,-0.03895315892346498,0.008117438413950276,-0.4380199156899262,-0.6001109877922407,-0.4800725703259421,-0.45756657242380927,-0.2740356154670597,-0.27338887846399734,0.399997367801762,0.2642303338778042,0.34108025451945023,0.3408681969636389,0.2133394511981367,0.2760979084795359,0.4068476192126625,0.13739622630737652,0.46250561666282736,0.16541097095419202,0.26651343779556175,-0.4617336931718916,0.07596164944439314,0.08059291024732346,0.014710189392814424,-0.3109647329972447,-0.46406696880010795,0.28288708024944126,-0.06657703198747628,0.010212084144243105,0.002058885082160888,-0.03504802642258941,0.05851576357390593,0.03113963223483394,0.03997216155897471,0.01115967254657876,-0.08815586808835403,-0.044250168165474155,0.002686327891293156,0.02236411662015564,-0.03472641080432712,0.14025560468388815,0.15728538820422838,0.06419363981842481,0.01483721970865225,0.2125923522060216,0.1315321506525594,0.10092103939555926,0.21892531386596817,0.07316192150104404,0.1014130743228388,0.2381896819358187,0.07712957653215999,0.21078455732019993,0.05425538591519464,0.05873032359689585,0.29713552989774655,0.4062637843343379,0.2152611346401386,0.40532579501439175,0.06235984383389697,0.4014445016702311,0.3633779619334471,0.14103385432585108,0.2524457889654937,0.2732216870056511,0.305840937374034,0.3146033738182167,0.062009131028922554,-0.028297251420365925,0.005350932093353458,0.19189337605425416,-0.022929323831825058,-0.07637892708840638,0.23723413713190497,0.0872133600635962,0.16166253619390988,0.1486059248422009,0.20221750947273046,0.08377421940594579,0.10062428635222465,0.04220506113453834,0.018486194355003954,0.062293791603715676,-0.0008685970291321845,0.0668681916882727,0.09118679429965039,-0.06015613174259458,-0.012266746284477449,0.037602072722020076)
shap = do.call('cbind', shap_list)
baseline = 0.3281058170152143
rate=c(0.5259124966190093, 1.363468568688387,0.6158608572850626,1.1856625147506954,4.161337501372303,4.9602860536177795,4.570042178896934,0.12773005170275953,4.8350688125141,2.8465031343813516,0.1680975940045861,4.051353680419623,4.576811740335915,2.3762242311244672,0.615900373252235,0.3031306688152136,0.35220244740028694,0.14363579226716883,0.37493202965781264,0.6332876794161291,0.4878287835673197,0.5613252918096971,0.5234314483265402,0.5169302651480557,5.179722240299129,2.8258589223655455,0.2658956559710225,0.24397456127975678,0.18749451457824087,0.2599251393061569,0.9068782597932841,0.2493111888160824,5.4374042583182876,1.192181258782712,5.2420604589254625,0.9663049521546825,0.27682448365598045,0.4764313845660644,1.0875285735548585,0.9206693287513449,1.1316396006105476,0.17331194286201923,0.41732830318368436,0.3262433432498818,0.19177552420175678,0.35601723783200534,0.23778281283539268,0.5650407439122108,0.31948031723153764,0.2943112082659721,0.37087572411675174,0.42327830915754716,0.5122496898611996,0.21940349195514608,0.4085203668230483,0.5470911929794527,0.7534601662913669,0.5934755279072269,0.3798556523322958,1.4605628402708983,0.5066268444216615,1.4419802392545111,0.2691210410798992,5.562715622418735,5.77150589500832,0.2642916317382623,5.349493593670615,0.3883687802526145,5.367664887631938,0.9501465387862739,0.3282042347162278,1.0668728313770064,5.791282213231129,4.239307517533776,4.713544546252122,0.2727840625021868,6.945223184610659,0.5796743926334986,4.270657207224524,0.8733611381226084,0.35926217890554785,0.24102627037251514,0.9842526768165428,1.107291528604022,1.101797037589864,1.2904124579737264,0.229992645480765,0.2093774597315388,0.16636841621593118,1.4467512027092937,0.32928333616589045,1.2289986906827841,0.8056140905456175,0.3273234798243776,0.5777149414462065,6.0495617009252385,7.037561294196711,4.999016892943844,3.777651982617081,1.775431335401522,6.997015229958178,4.679279749862493,0.8299920632938416,6.026807580897993,0.9115988081686205,7.0263826102065705,1.7945126608014428,0.4853051867066861,0.5684220461371606,0.25025944537081,2.3435865149565616,1.8221720083043769,1.7912036238642461,0.2982006048874018,0.5064208690319911,0.5565239259558469,0.38804151399895354,0.25584130395710686,0.21763918331180884,0.2409464735196816,0.15418104787159564,0.37593806275084635,0.3501519827691587,0.3436977566397864,0.7439595730862318,0.3765202778704212,0.7989666412264513,0.6921861893539951,1.5376693715283545,0.9129565553485245,3.2945734555459985,2.043251371423523,1.7170939728592576,2.8894666342966118,1.966801740152076,1.8282825882363332,2.955203843349646,0.4729887544961665,1.2289241563075493,0.2685358279872311,0.4449896279481092,2.595843953306982,6.692888045008621,1.1827400285832164,6.695684346392407,0.2882775384124166,3.9723070604473634,6.741748471705917,0.6067698796163582,1.9336066014501363,2.1198648898918155,2.4250974747356566,5.869632739995781,0.3287646393855157,0.19809788318551508,0.3309291388197155,2.18159064945201,0.5070715001102281,0.6050403655217071,1.7642343977559214,0.6255414517851574,0.8878178708920867,0.8471344951785634,5.136659553640747,0.28412329722482377,0.4831574175399619,0.30901552330027054,0.683605486692882,0.3526250853395204,0.25026403824994553,1.6324407647926016,0.690747910947496,0.3218775324419297,0.19435350786509661,0.25308120559028957)
rate_lwr=c(0.061576448824097296, 0.05389290054391038,0.14906557966252254,0.225839480499035,0.03799490157584362,0.04840295770943073,1.2672453021888612,0.012162226828112993,1.4459654138722353,0.08268937193749354,0.009410637551760803,0.005829709615830958,1.4373515690447525,0.01492693069140269,0.044919296893899785,0.010803577598910985,0.02309301585908885,0.020757056688976344,0.05503184937331479,0.08828973413058816,0.008585511240828486,0.04930518868836417,0.03637715198803665,0.053360291527841885,1.9663381812979617,0.101072791533453,0.04286869257050385,0.011874231742593055,0.013918409663091269,0.04422107350808202,0.17074847588295827,0.060929026206367004,2.213081068726999,0.06762106539722168,1.8622332027080988,0.06270622682770849,0.025608264540096626,0.028928999271362055,0.14508603234222456,0.029774520085118023,0.08307071999356391,0.014485690737559842,0.07214325024331669,0.019381485312857882,0.03464891653932756,0.08853166612892516,0.037950278803484144,0.07217290953509445,0.03490667790139734,0.07931173057115964,0.009106053605648756,0.10767255993169345,0.10074463743215745,0.04665054705045504,0.11517847763042105,0.11199158057455341,0.013434232626635567,0.07300945079909504,0.045571971185540516,0.05666699586874749,0.11031128007613289,0.04752525575971994,0.06643305596766463,2.2356456016625463,1.3588582512279561,0.03934632871345714,1.8429367869372433,0.0629862321676058,1.578815475588247,0.02218838022122599,0.003845740349736948,0.0880976651466055,1.8853315827188046,1.330505690166694,0.16312135548662177,0.018658790515653945,4.189911693596533,0.02263733030078996,0.3529113477832397,0.1736100868477669,0.008315169250892096,0.050879207757835915,0.11156391210450578,0.0996125198546314,0.1580256919640307,0.09726702905631529,0.04556492147768407,0.014474133980529741,0.0020459367076052504,0.1179110501556033,0.05479591317894761,0.17526022241609618,0.0894059972538965,0.023334331641667816,0.022341403649621394,2.6102248127356305,4.2276269672124025,1.4438076620082045,0.8767577993721276,0.21992811908459398,4.094875663957624,1.330421429001366,0.07638878507058297,2.7420275487363597,0.20153820725259797,4.221388812135853,0.17955651708214995,0.0598844364249102,0.1063162601228329,0.008885332745918934,0.4276463720395623,0.28319608179665307,0.1705113239615126,0.08364379058642396,0.16474471011189348,0.15280110851865833,0.1490067329433122,0.05818549020408509,0.02232691135056669,0.016993705447896468,0.01592853822035467,0.022753053238808857,0.11966266211340465,0.10425719487376278,0.08420835204657143,0.1508220735015089,0.09582713180092076,0.06515842574179212,0.21252229299770944,0.024149917882673566,0.1121409610940367,0.39707207785841675,0.17431629802412169,0.7037958512018492,0.22678650865542346,0.17141040070657754,0.47182259214164185,0.015158295272445221,0.19367297136582828,0.04161054050895091,0.02621527082938302,0.5180372234896937,3.6453376948539393,0.26008310419624137,3.6461467626424264,0.020200604748390638,0.9760104850091863,3.763097539775139,0.1682225612106361,0.09815432979168431,0.4254203681922235,0.32950874083446946,2.4365358592056623,0.01712448632564692,0.011702439414139898,0.056941247083590996,0.15523877433719696,0.023190503848090405,0.01756725598505504,0.025486625413731007,0.013425765161208303,0.03862596645431507,0.05809942285783551,1.5996855702441524,0.02617570283451076,0.012036742054798766,0.014100192305676662,0.03768347584316062,0.018903026255482708,0.054206419038381304,0.2061977008388216,0.0882319918550371,0.021740954366898935,0.03758544813524878,0.02694735485644123)
rate_upr=c(1.2868241887701775, 3.448373517892276,1.2904117252175475,2.6842618593416825,7.924620846989231,8.083849298204484,7.856800501560926,0.26467645000203305,8.176119484024053,5.826354388701447,0.39611963448714976,7.938841684590306,7.778652669248055,6.982413972214248,1.8463947261943208,0.8059701533621837,1.0048878795880358,0.31021502480909957,0.7809077622666589,1.5257183106583063,1.4369626554788382,1.4571178336419577,1.406188703574145,1.1667889435194638,9.135330094682338,5.984217560305739,0.6006848654450159,0.6651712400846241,0.39378991344015557,0.5845004016447153,1.8603920115126713,0.4380946964365984,8.4846480197191,3.265622505970512,8.5646434793949,2.818619775662425,0.6884218219987573,1.3992307956570504,2.550881259768073,2.500440719649271,2.8706262539553586,0.38268694486551424,1.0211798995528172,0.8630420623532966,0.41150617334144535,0.6700993126261412,0.4882956631857868,1.4325210503593215,0.8545911404546092,0.5767498714147804,0.9526003001024966,0.8150035741751445,1.0308362156444184,0.431566690461257,0.7611696142985622,1.2125611910743253,2.1508731679352144,1.3048044432945272,0.8050513957493092,3.826426993914551,1.0339784716382099,3.7811384558641707,0.5124751373927778,9.364518472203063,8.835236582699686,0.49518092125329716,9.128316617667172,1.3275697647432754,8.942277154006186,4.589708591781216,0.9440222009055524,2.4201473747503996,9.993541665148747,7.211439640156758,9.202446090664687,0.671511863514515,10.260942948058837,1.663602473375139,7.638354425716709,2.203369618242733,1.0925772907209728,0.4719878678715586,2.4123589080627275,2.745521985038354,2.4389918940559365,3.121692709746347,0.4674342501905627,0.4563233144459124,0.4353935937416531,3.2134662297138603,0.702379084331161,2.7004212031238164,1.8083984222825027,0.9583020426430112,1.851561458930439,9.213660354934344,10.243049377946543,8.536631616354054,6.8316013347711655,6.6649346381310846,10.098726017135427,7.3480312312012375,4.707448877717375,8.94331214573794,1.9331631161599183,10.263701386364971,3.881646325127402,1.1477195254458508,1.338672438407553,0.6697991044145566,4.66640997123546,3.947605114015403,4.315926527683568,0.5785962204760495,1.0131500045040456,1.097518553820639,0.6915432097181866,0.45340630702227475,0.50419221523258,0.592028106335919,0.3290099255858641,0.9265185856697319,0.5906594251501999,0.6301286250762488,1.7201121123158227,0.6599840669648862,2.029328002080607,1.63431568378765,3.4387896522381887,2.8299743511113267,6.53088809987442,4.218321791298868,3.585442733062675,5.506110365942053,4.266676091672824,3.6709778096555823,5.37525918118558,1.1814568043520568,2.565155002133425,0.7589887174778003,1.3743218048675292,6.547382595423778,9.411404476177887,2.461301172756733,9.391757295224245,0.5475116357493938,6.774138930905416,9.588130052850904,1.2199987530755116,3.798360204067648,4.11808079498373,4.979193428974247,9.092448982589605,1.0442748032139515,0.4478174939931615,0.7528467503685861,5.2908471244343005,1.5654596613316447,1.76068146580411,5.4539446019687405,1.688863189324145,2.176161271179812,2.116207880557873,8.86994553687937,0.6690054388399258,1.2982466498837848,0.8307957946293159,2.068197512025763,0.9398828485960333,0.4788346045685141,3.6775933499254645,1.3958955813523781,0.9425083430594134,0.37959853114347175,0.5581667914326905)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,10.70649647352556,18.316996330471802,12.762457973341409,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.043360141150975,13.644381033687072,20.230905385405343,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.275304079953862,12.763996434850949,9.991905577866738,18.464662994362794,19.037996316919237,9.630996493741618,22.26749625621469,10.683496473957888,12.585271438210423,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,11.566150303520583,14.53068870933493,13.78444086011421,11.841227221426918,11.438227229002063,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,15.70349637959748,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,4.058996598477934,9.179446502229375,3.2289966140793247,9.560413161735033,8.13719652182041,9.24823400093636,5.8691632311190585,7.629996531354187,9.222796501414518,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.251534849631417,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,10.70649647352556,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,12.762457973341409,15.307996387031654,11.451546459520934,9.062465735197444,11.566150303520583,22.62499624949477,9.026196505109999,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.709996304287746,7.629996531354187,12.543329772332134,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.336662977971898,7.305996537444376,10.70649647352556,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.058496485705948,14.172329741711991,17.899611722932722,22.62499624949477,21.1276885853318,12.586611822800617,9.906796488557434,22.72199624767148,6.560946551449007,6.758613214400147,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.053424851966007256, -0.06541891819450675,-0.06882717538086526,-0.06881758941401477,0.06184704876767367,0.06213922537317749,0.06317683667485297,0.061593669997931096,0.06228123907445018,0.06215861010763304,0.06309339857943097,0.06205381052918577,0.06309228346976878,0.06332277541238725,-0.06542906641259275,-0.06380780173175847,-0.07639787937608312,-0.07501566145963276,-0.05408468415316071,-0.05401840347941113,-0.05354381872532466,-0.054086005975865374,-0.053422207755340484,-0.05392355503384596,-0.09287552673841214,-0.08554619154931008,-0.08562028766659814,-0.08456645754016923,-0.08546783471145518,-0.0861142116842385,0.10006360548728134,0.09574587788691034,0.10078059190904087,0.10094334607402784,0.10106688533438188,0.09690601451246188,-0.06063440473094777,-0.05727653378686303,-0.08375014019240926,-0.08505920373305866,-0.0853889533282205,0.025352297192148248,0.005186491149899954,-0.04516968804932981,0.03649853336383207,0.02544026056006884,0.014605463730914117,-0.014481222192958604,0.025271744171769906,0.02531201253082821,0.03672211268922482,0.03912324831824421,0.029825652957222254,0.022713604037283737,0.029979996932429902,0.0311543697007329,-0.054533955690351424,-0.06956424973658283,-0.06951454370085976,-0.06990062205476612,-0.06948875856595829,-0.055952028535415164,0.09543721086876807,0.09930788746859136,0.09861547479276815,0.09632283859361819,0.09930788746859136,0.09700453958384718,-0.06657964521639101,-0.06608667011017592,-0.06633734690455463,0.10046361259512344,0.10318442486229469,0.10271269083915424,0.10323459137243875,0.10201944065767475,0.10277262378426867,0.10222922299550753,0.10324747125446851,0.10311985879401464,0.10169511037732433,0.09930377531894177,0.10320589951627995,-0.08120239417652395,-0.08126224690463577,-0.08128155543107535,-0.06376680448446659,-0.06360225226189246,-0.06381125342644796,-0.07583918743578763,-0.07504450973603446,-0.07503721649389859,-0.07500283430575243,-0.07605022707020508,-0.07690022042157331,0.10202904240042443,0.10203892545078751,0.10195105570367635,0.10071919925221993,0.09872688353856875,0.1020942397599172,0.10209706993823776,0.1002189367054628,0.09977936289292084,0.09861305180265391,0.10086504246050793,-0.06755421067002779,0.06832333294003212,0.06850639972384794,0.03690709568500246,-0.06721874457866547,-0.06663635479030904,0.09761446999469901,-0.06511105449504377,-0.06560846107275166,-0.06568424701171137,-0.0658515981157297,0.0929422659958499,-0.08129884069391388,-0.08090618047938712,-0.08110898615236635,-0.06294590528621295,-0.06600209937723375,-0.06684941590277438,-0.06685140927940376,-0.0669715027517645,-0.09124588235119728,-0.09063067035323402,-0.06430153447533499,-0.06438407152673853,-0.09318312993138342,-0.09273219864115319,-0.09173150250523729,-0.09342865135392528,-0.09114571071571685,-0.09170726338613547,-0.09333906864630848,0.09342829637328139,0.04926462521649896,0.05112806133314146,0.05120574140773908,0.0526239205634775,0.05168880696937026,0.0520490295125954,0.05115010222846144,0.04975775050277302,0.052172571551561145,0.052072881844010474,0.05172039973723329,0.052019713470861026,0.051344132749282116,0.05262830427760028,0.05230759724604733,0.048960017004379595,0.03954010310419659,0.04009751576337509,0.04070147353506274,0.03950396788720205,0.039914964441339656,0.04025983450592996,0.09543115828105805,-0.09257592039834284,-0.0922931882399409,-0.09306052393250956,-0.09237269150204284,0.07225687240564325,0.07219065835115705,0.04751288880228042,0.04732399790250755,0.04729350360796998,-0.06596268338436509,-0.06641456907634424,-0.06350332079244707,-0.06404824284816572,-0.06371815389448988)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.017708487845298042, 0.03465852860239183,0.039248716983010454,0.0392358374107826,-0.0009703969953347829,-0.0009811110058029237,-0.0010209522663281443,-0.0009606629854214218,-0.0009865381237832338,-0.000981802948235129,-0.0010177831673895978,-0.0009780420876105494,-0.0010176822815092872,-0.0010265024876470283,0.034603017930080325,0.03255926391742477,0.09250220699708296,0.0900835721275881,0.018230847122048963,0.01817824083164947,0.01780127226472098,0.0182317248314806,0.01770269217282865,0.018101306723344215,-0.19991234450493695,0.12605010258259045,0.126314151038114,0.12264134492648311,0.12578509085478587,0.128037771817772,-0.013003284321345463,-0.011653907188907416,-0.013224848473236475,-0.013275140451780769,-0.01331334431031578,-0.012012608543825902,0.037069791063920894,0.03423262413250826,-0.15418079184421019,-0.16048572105682424,-0.16195407560476743,0.006261660377633003,0.008183319759467015,0.012663487080516773,0.00478160502768351,0.0063128819797588906,0.007214487687821801,0.01007518109243814,0.006214466793043853,0.006238192719517174,0.004813925641221041,0.004515818587231758,0.005598484047833356,0.006356930815272795,0.00566713529194074,0.005506041194860594,0.02644237306497136,0.04027206692140434,0.04020371804485958,0.04073301397929653,0.04016924350163233,0.02969977767284997,-0.011548734282550493,-0.012724321208721384,-0.012516068302890997,-0.011822471284293737,-0.012724321208721384,-0.012029060047424241,0.04668578672976291,0.0458741721495925,0.04628693689781544,-0.013135821839617381,-0.014000188280870546,-0.013847969194866298,-0.014016168471580931,-0.01362860637803237,-0.013866943123600695,-0.013695027844312757,-0.014020262428577245,-0.013979592628297491,-0.013525744616114561,-0.012770549590820931,-0.014007017826816914,-0.14144987384826777,-0.1416950342487622,-0.14177473767713616,0.04202506455467592,0.041769022718962545,0.04209417474268436,0.09048811587340529,0.08825671612411994,0.08823659329110134,0.08814172948888126,0.09145231416787633,0.0939440373510946,-0.013590777082185411,-0.013593851801137948,-0.013566372948212826,-0.013179224672626125,-0.012549633697573268,-0.013611167247946657,-0.013612050501942552,-0.013023407158695897,-0.012884642757686002,-0.012515660868586305,-0.013224169036725473,0.06578221646526534,-0.0032635598601496365,-0.003284218454940706,0.0048712071462738505,0.06421723608550152,0.0629117768367177,-0.012235317347855202,0.03420832251929177,0.034829465035587114,0.034924161370752715,0.03513370381346157,-0.010791224187507715,0.1112430786736206,0.10998315647031083,0.1106326192143751,0.031457358270527765,0.03542871356400397,0.036583344146601776,0.036571886580336964,0.03672665209207523,-0.19161318795796528,-0.18857691256035988,0.0331369203009048,0.04294823016734375,-0.2015468038648262,-0.19924475487160154,-0.19410840635423468,-0.20279961642365568,-0.19117409269363778,-0.19398779631102536,-0.2023428657091039,-0.010936259631886784,0.008824481783874029,0.009681324951508894,0.009716455947734117,0.01037426962899326,0.009939961982660192,0.01010798487051478,0.009691137832628175,0.009061528994520666,0.010165167409506973,0.010118855644411017,0.009954225688100957,0.010094827497411666,0.00977834956411529,0.010376297145145263,0.010227988564326591,0.008696337711080901,0.004495152410126566,0.004701819534883956,0.004876599458700118,0.004464473681866879,0.004655552046094504,0.004737030280051903,-0.011547868750702336,-0.19837840793510483,-0.1969572370410459,-0.20085070366393634,-0.1973646222148023,-0.004367135469262287,-0.0043577460267938736,0.002659588199982883,0.002634741464566443,0.002630710059205261,0.03528489459505642,0.03585899799004981,0.0415674023100244,0.04241363180650312,0.04190041370467317)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.438, 14.895000000000001,4.466500000000001,6.289499999999999,1.2905,1.2905,1.2905,6.289499999999999,1.2905,3.0900000000000003,6.289499999999999,2.19,0.45349999999999996,2.19,12.725000000000001,9.438,31.0,25.565,9.438,14.895000000000001,6.289499999999999,14.895000000000001,6.289499999999999,4.466500000000001,0.00585,1.2905,6.289499999999999,12.725000000000001,14.895000000000001,6.289499999999999,1.2905,2.19,0.06885,0.45349999999999996,0.00585,0.45349999999999996,18.205,25.565,9.438,9.438,9.438,9.438,18.205,21.735000000000003,12.725000000000001,9.438,14.895000000000001,18.205,14.895000000000001,12.725000000000001,9.438,9.438,9.438,18.205,9.438,6.289499999999999,25.565,6.289499999999999,6.289499999999999,6.289499999999999,9.438,25.565,2.19,0.00585,0.06885,4.466500000000001,0.00585,2.19,0.00585,2.19,4.466500000000001,1.2905,0.00585,0.45349999999999996,0.06885,3.0900000000000003,0.06885,0.45349999999999996,0.00585,1.2905,2.19,4.466500000000001,0.45349999999999996,12.725000000000001,12.725000000000001,12.725000000000001,6.289499999999999,18.205,9.438,31.0,36.435540499999995,31.0,31.0,36.435540499999995,31.0,0.06885,0.06885,0.45349999999999996,1.2905,0.45349999999999996,0.06885,0.45349999999999996,0.45349999999999996,0.06885,0.45349999999999996,0.06885,31.0,6.289499999999999,6.289499999999999,9.438,25.565,31.0,0.45349999999999996,18.205,9.438,9.438,12.725000000000001,3.0900000000000003,9.438,9.438,9.438,18.205,14.895000000000001,9.438,12.725000000000001,12.725000000000001,2.19,1.2905,9.438,9.438,1.2905,2.19,4.466500000000001,1.2905,6.289499999999999,4.466500000000001,0.45349999999999996,4.466500000000001,1.2905,3.0900000000000003,2.19,0.45349999999999996,0.06885,1.2905,0.06885,3.0900000000000003,1.2905,0.06885,0.45349999999999996,1.2905,1.2905,0.45349999999999996,0.06885,3.0900000000000003,18.205,9.438,1.2905,14.895000000000001,14.895000000000001,2.19,2.19,0.45349999999999996,1.2905,0.00585,1.2905,4.466500000000001,6.289499999999999,9.438,6.289499999999999,9.438,9.438,6.289499999999999,18.205,12.725000000000001,6.289499999999999)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()