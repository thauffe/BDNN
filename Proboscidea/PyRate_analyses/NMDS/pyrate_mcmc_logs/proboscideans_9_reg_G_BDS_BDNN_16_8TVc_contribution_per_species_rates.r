pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_9_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 6.0,2.0,4.0,3.0,5.0,1.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.021589467377392507, 0.13081432446536778,0.1321517944724362,0.16145962743128608,0.1676960309142734,0.0592632753328241,0.09312318311759492,0.06720716078455372,0.07695106863230533,0.29281703670441595,0.04025930162755447,0.08102654731763395,0.05570006078647233,0.0845679931043188,-0.07328404160601877,-0.05767734856613755,-0.44610004025889316,-0.2981082164160193,-0.01280042750867171,0.2777863009546947,-0.15518501864510617,0.12241511761081598,0.02123875873275829,-0.015198577733419665,0.2413101208540952,-0.20530052381592984,-0.2570598749232082,-0.2722499141244915,-0.23612843508606235,-0.2073052637914821,0.5281734171486917,0.39391027843021653,0.6312457480020714,0.5823966139119933,0.5783300785114092,0.3393673131695091,-0.11698606024578932,-0.04251369798768048,0.11056565448760894,0.45687005552003745,0.2889428308239264,-0.024414179705588256,0.05510975985284234,-0.056524563429255575,0.017790148017619276,-0.023648153448664957,0.012483252998562833,0.06416705015906389,-0.05231096493185,0.02666589890579719,0.0847815843936904,-0.05749869002377728,-0.009082857329704363,0.021945018585414408,-0.04673300493086955,-0.03509627264836989,0.31206813458982197,0.10810434970640168,0.1572044857257636,0.13202120824781863,0.10808079775073132,-0.31924078735165173,0.38849570854614185,0.3973058290361039,0.49500034715990193,0.3871025100434264,0.3811040171414068,0.3805505749956239,-0.037596787185856746,-0.07290605616511973,-0.10843403631164937,0.43276850623738716,0.6415327623725365,0.9793593746707054,0.9820735538160247,0.5258665883693395,1.0307783217004418,0.39076622842162106,0.454999120285557,0.4863021241629991,0.5130973658855797,0.38667305242919087,0.5470826134442347,0.2913281574048482,0.11937435735459309,0.22013547834307542,-0.08899161415064197,-0.010873433334638765,-0.05107149276783366,-0.35391616656201486,-0.38424911246797644,-0.38468182386099803,-0.37014450896705875,-0.43037213536110547,-0.42597622436084814,0.6247279648354506,0.977069794978,0.8565571887303504,1.0289971740123562,0.5434761301933906,0.9845251534164958,1.0375480549823068,0.6297266893672021,0.5933120772735951,0.5630480114253597,0.9275248368335869,-0.1535066181954355,-0.0371459671199349,-0.03773794290810983,0.11085202480195387,-0.15507684773653388,-0.15398211870686562,0.4514669154542544,0.07582052473936046,0.0816919214103571,0.0056391548267448405,-0.00690217130349162,0.3394183311947352,-0.31623503712194656,-0.32528289547367795,-0.3891885384546398,0.005484943897023,0.01623458671043329,0.08333428842416149,-0.026321623697785335,0.051397631061352825,-0.004166168119775451,0.043711217606431076,0.23212379856924267,0.194035812442896,0.12109550554905686,0.08965610846905207,0.1529685322775942,0.18564752014852742,0.1435040672725674,0.16681029683564105,0.1710186224287736,0.3278478371898264,0.2534138898133583,0.3108114964158373,0.36440954698468825,0.3913478136156633,0.3274012796131029,0.24210154705461023,0.3492419477876912,0.27348716881950424,0.4264597524041056,0.2927630953179138,0.30027725950464496,0.3785767958856897,0.3737535809428048,0.37546616976905783,0.3951998666739319,0.3849634653112262,0.2762230395370119,0.1940832295853222,0.2741405867653365,0.23132662588630867,0.3427961125899886,0.2542144029188663,0.5586845163733072,0.24327284140728822,0.20714547176999595,0.3148790395169934,0.2507309770666249,0.14711589128431896,0.13576751425062414,0.11431234531706864,-0.04165792937749029,-0.0067439255636711085,0.15119807859712453,0.10704857636906989,-0.046809060171487143,-0.10807962626292515,-0.1074014532884786)
shap_list[[2]]=c(-0.051237561045876116, 0.00017516709376066798,-0.1146201665375281,-0.09940191231869291,0.0003470343852563208,-0.02257985107139538,-0.009114243984102145,-0.015080455926101992,-0.012142843672022768,0.09335850190536946,-0.017728143544680934,-0.014048466421951133,-0.017270327154903373,-0.014405930975056819,0.01088274878804347,-0.040169587010433175,0.02658498385809937,0.037827160187257576,0.03277749837233199,0.08778287993484848,-0.006665757931387719,0.10352250419978741,-0.049388580847851984,0.041688437702828186,-0.01902815409365701,0.055258743243679284,0.08876331483704765,0.1210132094290693,0.05981595264469669,0.050579561962602014,0.03564922467649741,0.023547108634965824,0.03125218349867986,0.046119683245016384,0.026264661336913686,0.027430119063334375,0.042598634486571973,0.01923577108857802,-0.07517942395338523,-0.003468987135273345,-0.05345481785771688,-0.01778384928240952,0.043195067016274694,-0.02950718858951731,-0.008234913220551057,-0.004818751260441282,-0.0006409251764376913,0.037321311339555636,0.00983987527813102,0.021446508391659312,-0.04588113166197616,-0.01229810749883787,0.004499080334162982,0.019141735908260304,-0.01025780498046447,-0.008025794870194928,0.09754631947982359,-0.09860640869128266,-0.1021275282426871,-0.021650887415635787,-0.05384364036692477,-0.007607438668041266,0.04269208066123551,0.03185020636687086,0.032136737922515125,0.03419743017333501,0.029275182052434824,0.03241996923807572,0.053175419339461655,0.07636296031770216,0.0488784607145873,0.024626282011566445,0.16569601990490906,0.18321827878246605,0.20845300132149286,0.028613940157232357,0.20054344482146516,0.04065629161676194,0.08412382231195126,0.039304290914183096,0.021456856146114103,0.025597131177309263,0.04957230966275266,0.02491350511704555,-0.036841943895659285,0.02103667234203596,0.011115245271486125,-0.01440773724383752,0.018026473574883396,-0.02310688966941492,-0.017938487021141113,-0.01808130480600959,-0.021129989542729672,0.08210729839854164,0.05534289805430102,0.060201702518429906,0.17995162406262208,0.20701328390488843,0.17647125282852807,0.04709179089266268,0.191159730909173,0.20165535683919616,0.03792126988396802,0.0474767770778793,0.05026098452836605,0.19025837687448746,0.07237310087039564,-0.0018258570002958742,0.0009979274967890478,-0.03406170128023346,0.036964253365722864,0.07260962786437088,0.024412418794664333,-0.08915099961641336,-0.08237630935877348,-0.09839961554695247,-0.10085188670167575,0.016786633095718977,0.02194510476135684,0.03118468416985565,0.043071530364972965,-0.012198176359250015,-0.08303688426036698,-0.10189943621507645,-0.043473464740166334,-0.08506096104995053,-0.04704817954321239,-0.0761364597100453,-0.0591922110096829,0.1179033371968438,0.035483192245332064,0.2043022994352265,0.17394278417491457,0.11810116966673039,0.27211347624370774,0.17981992933212407,0.10457103362548781,-0.009420875320812708,0.001469453391373537,0.004481948364781189,0.021308661690052258,0.03643399074615795,0.005221449198891093,-0.007250724851077441,0.008789012048105756,0.015818950063856325,0.035925794717857326,-0.003278303163160328,5.0926542370684544e-05,0.03686043468628075,0.04588937342960258,0.0460466238645875,0.025394898540322352,0.004737980189871113,-0.027401923635169533,-0.008960659733354985,0.05543453949453023,0.044726288750960436,0.008293661410224747,-0.012708734265265049,0.04576675978574341,-0.007560465588821161,0.00875075924374719,0.0032549176127113326,0.006573085935450575,0.0049660924013350425,-0.00034379333682720714,0.06477262210294171,-0.018200876525455684,0.008897575914337487,-0.02546598922105056,-0.0845604432764666,0.10226788134628323,0.019609533905701935,-0.009506057908592089)
shap_list[[3]]=c(-0.09122389378568113, -0.05224889409307594,0.17388092026764995,0.21563739076583782,0.04434383989602647,0.01845657968463417,-0.06891819265314325,0.03444413029940227,-0.06324488098907466,1.1546120194105054,-0.0589195301202581,0.02959233147744037,0.023195745445296814,-0.06804445006339081,0.08259248694128493,-0.17373786341898784,-0.03616641150496419,-0.04244411978838435,0.06719293972764692,0.23170821469634573,0.06415128813677885,0.1960578712730296,-0.08707657759863831,0.07925656199278623,0.1080400377838577,-0.03204986991069115,0.0579742184345286,0.0785269943880328,0.04065436935620165,0.028902156661609762,-0.08809591513890197,-0.10189228899144169,0.049002964814211986,0.12152632315374545,0.04075723689499041,-0.21782377455952415,-0.06691468825029115,-0.04367434843441742,0.12024129329508723,0.3114018388485428,0.1035615321683696,-0.14973472700459178,0.11575407461071292,-0.08955190539854561,0.05994204902468527,0.06456912385018883,0.07736096829024412,0.11918415882936136,0.08248791377233293,0.09149948774369945,0.160258000564637,0.041697676130417825,0.08058012619398629,0.09182392366855119,0.057197206192019054,0.058208055563431706,0.19698028037406545,0.0649486180500889,0.18302228513949179,-0.004911464842907704,0.0766691532376117,-0.037785797715898316,-0.09371022126136647,-0.08674640749451967,-0.08784313407228324,-0.07843393223946071,-0.08686560935952004,-0.09612664387103236,0.14178612726163897,-0.08774130454742315,-0.07650263669109099,-0.09655629102685075,0.34163326576268915,1.3086438338445427,1.221475173962438,0.03430736382221511,1.3229213912181752,-0.2599067003619433,0.01660989703228551,0.03903933369178187,0.037048256784354215,-0.08526269005497089,0.04504296712269191,0.4147795461137058,0.19214195588984573,0.39680432021299566,0.06720026110393063,0.08986995564691695,-0.023709253670935248,-0.03299444282709404,-0.0360179281899616,-0.035796001396583024,-0.03840986871735474,-0.022833010683816993,-0.028963788608375656,0.05956546425453689,1.3417287673850056,1.0863180624376454,1.2623434558965634,-0.07895813229909941,1.34082213631281,1.3267827210390575,0.04395119639308279,0.050995621230492165,-0.07560024336167831,1.3642250818540191,0.019927168221522677,0.05047648936367438,0.048920678954339485,0.16645091388231353,0.0028106178943601927,0.01940981540256196,0.07216545689833737,0.13932202502497126,0.14490964147991767,0.07917781393806286,0.07085300338481879,-0.09789859174629656,0.03533157333719631,-0.04136378171166194,0.06209999378533505,-0.08709594664287743,0.08622801215610532,0.11992307989458156,-0.04953942640366137,0.10185917457966391,0.06511156183204941,0.05070380887693033,0.3170997949480424,0.1423719870780134,0.16152501007538916,0.3073570640407075,0.35511298357528376,0.3349882120417216,0.2855327915520175,0.3612851207412482,0.3359692388297111,-0.09121902783387377,0.0131611853756633,0.038439722296490585,0.06704014950200651,0.5652846363414864,0.03597831774759743,0.012889199909928591,0.042900809058462955,-0.09142890631474118,0.7608389408261885,0.017453294888617348,0.025974191354494105,0.5537513937141398,0.5722203067295205,0.5833108508276458,0.551103583014997,0.030723380430915253,0.03566013207118445,0.055749607266120514,0.16788415052723024,0.12868583957794283,0.7003723970098948,0.038393577728831986,0.6612238466820158,0.0020708667668053946,-0.007931414779281273,0.12483271158762474,0.007562280101248268,-0.057537202521720766,-0.1706356522821856,0.10699592319395149,-0.1277747664042903,0.0717247803259775,0.27832186024384925,0.18857197604121095,-0.052551365402173845,0.0250113006026216,0.049818387137015946)
shap_list[[4]]=c(-0.01496863309549298, 0.079323345367099,0.05244975410568877,0.03953272400368133,0.012505816715002898,-0.07524499677210744,0.04883061891051851,-0.001763523456806397,0.04810180907733423,0.16198149825516117,0.04348682261274249,-0.024190281736088105,-0.008731423907708412,0.044679302346444315,0.059737720699176246,0.026807468643146825,0.04266336897359697,0.05966377541867876,0.00089720772610975,0.17229753807888792,0.047418314863318364,0.14289580974351782,-0.011456970843164778,0.026658791523687456,0.1812244324625184,0.031014256971561367,0.014947364204780551,0.0735987030291733,-0.015050690213820555,-0.03446512432574789,0.023506270631893037,0.022064391843857077,0.021525182027768014,0.09121047826167987,-0.012186887721195677,0.06603000061263258,0.0690055101686471,0.042083173587434616,-0.006751515398036369,0.21465889972100133,-0.05911426741793607,0.04153829455509806,0.09471012773031631,-0.04592513752002031,0.05862748636044311,0.054986942212466194,0.07231116090159129,0.10720018552986887,0.05445963980051404,0.07895504618884308,-0.053610674070537684,-0.004589142636449065,0.07407380351386804,0.08287571823887466,0.03996415788769645,0.04307420688541854,0.15813456407262833,0.017410108804233982,0.06146837704978118,0.05491081330443885,0.028103662976232333,0.039392258271441875,0.021708518017820172,0.050149362780992704,0.03846499399800498,0.052537294582127594,0.04885039906999115,0.023442718369022144,-0.08553563681812433,0.025141302251555427,0.015427780663518667,0.030680659866369052,-0.10232248652662217,0.26851424630173054,0.20527347472458515,-0.043105858324553534,0.2778619784091067,0.030698092905715447,-0.06976900246781606,-0.06309384277472269,-0.011340488510176236,0.04874593148502525,-0.05775795328831007,0.191032930391617,-0.047662789276982837,0.22518876609470923,0.08317144220942493,0.07989212864589168,-0.010191378854750924,0.029448899530194333,0.03933425721156119,0.039017502925849594,0.04275834539334132,0.06417160009914961,0.039538813940433806,-0.032074459105679604,0.2692000172755827,0.08972978498768257,0.2677599698696319,0.04510656622259319,0.273491580355088,0.28014913466999575,-0.0278427189676449,-0.03903149818499397,0.042059387784418485,0.2676415568694821,0.10553370007074502,0.003771588179588099,-0.0017104111532648186,0.08885842100198958,0.08004361245251734,0.10363522039502583,0.05443279544846964,0.10651143171911456,0.11026540260125157,0.06130689449068632,0.053227933515284896,0.019217962608563094,0.005995199589256349,0.034707094596447476,0.048153865073953354,0.015658049466766723,0.06603001551832705,0.06807134795578576,0.008268970819132263,0.07747172925698158,0.08117708604218629,0.0702090646484834,0.07688944174546813,0.02290615773342216,0.07327489781502221,0.08787287030549795,0.09118289882693438,0.05000766542058489,0.09678268238586607,0.0760399470603082,0.052815843013170195,0.03328306360680924,-0.10001036554897348,0.038114158287720315,0.10547266210950909,-0.10358712539050631,0.02285998223274707,-0.07169579045014235,0.04184830410469582,0.025573394156583207,-0.015561239642597362,-0.04896613328484905,-0.002300168093411592,-0.1048920742143682,-0.09102352350628327,-0.08554433287774259,-0.1177983628648787,-0.015190841082800135,0.05229871372591059,0.08482402043441613,0.247948237071082,0.18534408164376684,0.08993192940511961,0.033737467031743,-0.1339395853982779,-0.062388832629550965,-0.05594075877844103,0.19242527095467438,0.02738760283337139,0.05897554553736852,0.06029447790014212,0.038666787177123504,0.02059594931889421,0.06491617565659391,0.046221002286245524,0.04978950415208535,0.08583478158633114,0.0025404371118791283,0.03949150296942505)
shap_list[[5]]=c(-0.012802542962870332, 0.05716205655771239,0.06103688253617919,0.08919449658413643,-0.08117786536961746,-0.05376187994856672,-0.0028907401658379273,-0.061401832418589056,-0.005221959656407695,0.016354391836111797,-0.008423250104719001,-0.05908492490985632,-0.040727980469013936,-0.012789047966346098,0.045258422972983756,0.004219875420367986,0.03274727652284005,0.03457011307219897,0.05634614579532108,0.13488557651744762,0.02551972980208743,0.12855464805285036,-0.014273798545230462,0.059485515905914,0.09505240571498089,0.020806829823749446,0.05286174982769768,0.05973568836974572,0.04129887820301638,0.03255726563952871,-0.04068121684558799,-0.0349259105083685,-0.050818080685800994,-0.03826715777876815,-0.05118220432607628,-0.013244855586931422,0.02869662427984502,0.05000308851538502,0.10594887428694372,0.19471790250747395,0.10430680414171675,-0.022092001877313982,-0.0485542055907261,-0.011115737113531279,-0.07594495824333,-0.07393607942361478,-0.0733097984008237,-0.034476066854782966,-0.056129148759815346,-0.07769158633699715,-0.05672497526843105,-0.04568109444144417,-0.07078863411000418,-0.06989220662521077,-0.06188963116704222,-0.06751189178790439,0.23341153348459026,0.023388484084857313,0.06839437544244248,0.04297654220071938,0.037115891682897875,0.01186517860689644,-0.0357399412330567,-0.024219908302732046,-0.03374131933096941,-0.025463467009274553,-0.022252818247688145,-0.03045712623984646,0.030395398830510668,0.0305160164027825,0.021378079351744707,-0.03361281064745339,0.054619699882628936,0.09443654450004839,0.1324406268062153,-0.04832206191661011,0.11391181388479235,-0.004428999379812261,0.006369580245450163,-0.03540079538921355,-0.05074477356439253,-0.026568652378100552,-0.03399886067211775,0.2303895585277536,0.1350103997988592,0.2150302444583849,0.06105986163148153,0.08073285563766693,0.04236757343236302,0.026161499569037825,0.03582593943114958,0.03565464336076719,0.03727895757259804,0.04493480368810067,0.028601766441149677,-0.030018204397260616,0.08394697026574356,0.11838268130398319,0.08847997253514461,-0.03503014767357607,0.09374236273190475,0.11146811796858706,-0.04695426114166138,-0.03750943819793605,-0.036261294702568364,0.09149153399757283,0.08990516225403623,-0.015000423613572832,-0.00653692457304367,-0.03236576290403751,0.0564258944587172,0.08649127087709006,-0.04293924250964331,0.05036354364471069,0.05424658105338952,0.017123962531823883,0.011251973399608943,-0.04130972061797502,0.0270974042423994,0.026105151863786483,0.042768494106971734,0.016753560964038426,0.019964207193538197,0.04997011274323139,0.002389527203971362,0.029315750702229693,0.0519222073649038,0.06046795977415437,0.13290572908931286,0.17839470133923566,0.12736432366155093,0.2318244384271989,0.2427114587609739,0.21115485482824053,0.2522152542887531,0.24392424999438145,0.2075880934575123,-0.02099130771890716,-0.0591032347573398,-0.06502991423454195,-0.05486825410604358,-0.05067460438537264,-0.06484181920536426,-0.06714408766932671,-0.06466944698913583,-0.048133455001723,-0.04165400571898926,-0.06820839194541374,-0.06554920147847049,-0.049824500022819275,-0.047791268481628076,-0.04816106695821145,-0.05195917483948511,-0.07147831747891867,-0.10567835729840572,-0.07183174309723807,0.01709705589379718,-0.017276260817411054,-0.0666535221192166,-0.09158759504370835,-0.03509664624189423,0.057002791180899556,0.06192216236845116,0.1073935826044423,0.07101393325385115,0.0019770642176858374,0.01309765308190884,0.020470250039037928,-0.013438877775770066,-0.025491693729677505,0.1316457008089583,0.06674068440243135,0.045043944375840514,0.02633642493776512,0.04444622156470725)
shap_list[[6]]=c(-0.028474774536060544, 0.009151009332330769,-0.017225155673303263,0.016719963798310703,0.0014527499872465694,-0.014187086331987966,0.008916529413233199,-0.009417943306969464,0.007796168889672935,0.13851514509373294,0.0012644462783402784,-0.009676820591499583,-0.012697694881352216,0.00294099303759309,-0.009344758327206187,-0.017155820924471203,-0.021618470634725277,0.0006725510864611748,-0.019729847176849002,0.02490598092305509,-0.031938600651760386,0.014308635423500148,-0.030153269096968978,-0.015657512612415717,0.09991625300831553,-0.0037545118597944616,0.033591633079808954,0.043726721156518024,0.016264720681253907,0.003814068881886788,0.05288093165874675,0.03704948843111746,0.054646303508863264,0.04706732694583666,0.05115063658216924,0.019959580515069426,-0.020111308010172906,0.026152994483157894,0.09209045329663683,0.25868813403632124,0.07407205008228263,-0.009775288665641526,0.00531147137143868,-0.021118985317653775,-0.00902272792921339,-0.012360238640739315,-0.011876593666882302,0.00325563342594443,-0.005130171376194789,0.0014321551638605116,0.056010113746652934,-0.014035672977192633,-7.806856712578578e-05,-0.0034011383987924276,-0.012789189294992894,-0.013169471457095943,0.01747578878556247,-0.029772085791573713,-0.017142274719808868,-0.012603608458878727,-0.023565098491108615,-0.02816281226491062,0.03837727275521316,0.04746124964602985,0.05684470390499708,0.05153098870872451,0.04348213446703385,0.04101737093464435,-0.02905776212743948,-0.01826661130371476,-0.02005071888860491,0.045817943616174375,0.1475213279289551,0.2655029671798579,0.25325179216910226,0.057254333695534024,0.27381781673811467,0.03395389093529599,0.0874965077847198,0.06819791237966037,0.04499607554246031,0.04867189071080219,0.07955660747325094,0.3516700195688869,0.18041982187496167,0.36403994937053946,-0.01316319005485602,-0.006271496682317473,-0.022485513265463435,-0.021188897687327558,-0.01928088361816623,-0.01960292342143737,-0.017057581253356595,-0.008733911480654076,-0.02310155197935688,0.09783636966170625,0.2796461411203008,0.21991244075787691,0.2684969858470394,0.06094710064970316,0.2795746959038439,0.2833928098771254,0.07101078422794802,0.08208786298506099,0.064956971054185,0.2780798212896668,0.042846489028762896,-0.00011594711511350947,0.0008043202378013961,0.06578892880167148,0.02208314226178968,0.040157749363328256,0.04960153069196908,-0.004681737007100326,-0.0015283880927885521,-0.021711332735671298,-0.024219794203007475,0.022155375953845566,-0.011154706631922534,-0.009318580790399341,0.006335318871349207,-0.009802560927001061,-0.01869799457257583,-0.021243561693922018,-0.021095909056802805,-0.01531835904625977,0.12539316926785052,0.08241073281946094,0.0626487635052757,0.02378169552197815,0.2932039731356609,0.5274333223578078,0.4864669461759694,0.408903037577343,0.5922756031620896,0.4924719129428758,0.4043189913366957,0.03206460584513832,-0.02027919412617927,-0.01035546137954383,-0.0024672076161344845,0.022599462026872748,-0.009831318370387086,-0.02295824636211361,-0.006171436269067803,-0.007795578240524198,0.047745420051062214,-0.018548430411239596,-0.013866204719719654,0.02259685340454541,0.023701353164180122,0.02390608375719246,0.02246334801531494,-0.010011012798502349,-0.014611586740176376,-0.018912106618738246,0.027455631491941333,0.007437808925987993,0.04743083979412077,-0.013342571752242972,0.11055130993807599,0.010663847306146486,0.004856169631313803,0.103995714047338,-0.00555775083682443,0.02680318475522773,0.01413621698119387,0.036194828442681765,-0.010244524749448798,0.007275591795746949,0.05975057951313894,0.004647811109432976,-0.00500311086702714,-0.03424291952580244,-0.030205793339023717)
shap_list[[7]]=c(0.18014549145898828, 0.22679667050746424,-0.013169838456439521,-0.0019947666531166456,0.09695215523958933,-0.05607703262906023,-0.04497180809305156,-0.011121341236254283,-0.04981223889227237,-0.20273230267436504,-0.08695178712202707,-0.02910124303998724,-0.1540901206730665,-0.09287143749081467,0.0911397021942831,0.12856516877913307,0.3849039122595721,0.2732980020017602,0.03101028253199734,0.38435461595874754,0.18262207245071208,0.24322405534283975,0.08073761294970257,0.07081175102718038,-0.23166271474813768,-0.07855991702137395,0.021888348157448265,0.02906059492799878,-0.02221570181499511,-0.07268289401682916,-0.15791211641346006,-0.12970948353821107,-0.18088277137875577,-0.17066895147321556,-0.19496713198164287,-0.1151634236838033,0.2890481434285696,0.37282670531746276,0.21208714457388309,0.2058295055422725,0.021450965881917097,0.10432643080698871,0.2729585315862839,0.4770576801635853,0.19438837663861916,0.10967016819039392,0.2423455147662811,0.27941145667451256,0.1851068031926524,0.2415158518195985,0.23483686433544546,0.009903989464046092,0.2084903514597139,0.2402635936413424,0.07144426965897079,0.08331451591132683,0.688837228430707,-0.014064866720861104,-0.0065369307707575965,-0.09894277698327841,0.00017423138772093726,0.24703840924552956,-0.13068734273787683,-0.20487800193041777,-0.16646014275351473,-0.08531151883559907,-0.2200265601229492,-0.13052486620214868,-0.12123786088199748,-0.05094327278041988,-0.07432270934827669,-0.1323833604889491,-0.23943776793754704,-0.21439727419671212,-0.2449848082285577,-0.13743862533463624,-0.22630358523189206,-0.12510775372453994,-0.18896256462122857,-0.20662371354627873,-0.14789863312423082,-0.09718814626410877,-0.2086727905985584,0.3000100654934075,0.12465182889026705,0.16018020309198228,0.17146950072941344,0.21421301443393062,0.11741039847430931,0.2917258712009513,0.4212679009019099,0.4210667698090519,0.43118286780658555,0.4184357372585226,0.27808386388421946,-0.21657545295728983,-0.24048207699907176,-0.25373120857916076,-0.19804175847953343,-0.21595450726849694,-0.23255219567726493,-0.22945446144998408,-0.1998171912035214,-0.22089226040713592,-0.18166140822391721,-0.23813664243420185,0.4919405513189136,-0.018414820815196024,-0.03044931424005044,0.04335737162439801,0.30964844954984366,0.48666919321106106,-0.15449058931367848,0.2820482651538917,0.28904228198267384,0.13300756488940313,0.10742379323852227,-0.05350889473361721,0.04640209584934206,0.19323117281016505,0.2029946884712724,0.2741603716356327,0.12957325154363625,0.26233926362983423,0.047721500955908276,0.15282013423751406,-0.1958207354160268,-0.022773120306402484,0.15098472173484742,-0.0801737488519383,-0.19927172673657267,-0.1658532124776917,-0.1714005042101647,-0.26718040885852606,-0.12196460093854958,-0.16933529268124875,-0.23970102651463504,-0.0747480426694155,-0.15385660797423995,-0.1424255189015755,-0.14305588447711878,-0.1904501788826871,-0.1580643918223823,-0.13539885485178166,-0.14035522160196598,-0.057480115708988276,-0.21319516302098962,-0.15009789417880837,-0.1747415106077971,-0.14487918893589868,-0.18806613162485278,-0.20190692053891307,-0.16183089000079687,-0.041624778797498395,0.19096306551403255,0.0488801860486559,-0.16907380512026624,0.03719955997453055,0.10806216901518821,0.00020468764730548143,-0.15975994042330666,-0.21433872170185814,-0.1338343885863727,-0.3033438241018049,-0.1248195130073907,-0.07600599879779228,-0.029051306902303668,-0.000276082216700427,-0.001263063112235436,0.053809060586817246,0.04776250683343853,-0.009468676435543288,0.14291242978030588,-0.002741410703339035,0.14922289755675697)
shap = do.call('cbind', shap_list)
baseline = 0.3438738284470381
rate=c(0.35100470186067284, 0.7907199224279814,0.6190901806234003,0.7621428089581078,0.586813113949767,0.2032346713623904,0.3704820138046746,0.3485096411825319,0.34779850795627554,1.9776963552143438,0.2590870219259367,0.3206691358666887,0.191697328965425,0.2902999579806407,0.544004266132539,0.21685680630083204,0.32857498001063074,0.40948711313321573,0.494698645847603,1.634153050309339,0.4662536459359519,1.2739499170573683,0.25764084624773426,0.5838066684772015,0.8203509957994746,0.13383929689726398,0.3553922197371322,0.4741508244642023,0.22933603460882204,0.14752530732562497,0.6999784189680084,0.5571007034068661,0.9012443964057868,1.0219640386000537,0.7843419864354164,0.4512751652613807,0.5693008597656385,0.7628518729175301,0.9039936476880728,1.966546229253476,0.8259868747923867,0.2671672363393464,0.8733473268216335,0.5709875561033032,0.5811026727093043,0.4568002462352447,0.6596722321102864,0.9104929796103186,0.557947142958728,0.7226912756643855,0.7230954501768856,0.26172768859908946,0.6280042151430173,0.7212700705653396,0.3798413467456272,0.4036681991342247,2.0261915970134834,0.41629446997350295,0.688009195338225,0.4348605824654514,0.5149560452928847,0.250199352628062,0.5780461223173161,0.5571369266337092,0.6805407971349556,0.6816590769204535,0.5198088916143024,0.5672152487173814,0.29836194730589866,0.24708429697471085,0.1522281657606077,0.6178838357010998,1.3478565856540419,3.1994628347324814,3.0751627224147917,0.7631719709862218,3.306129170569702,0.4516167638394575,0.7334681796826358,0.6732531728905811,0.7525993436796464,0.6465272751299633,0.7660701730325248,2.124490502874445,1.0077298637708882,1.9234613268557714,0.6325152152016614,0.7726717754940022,0.41441266315836145,0.26125399721430004,0.3841022088273791,0.38275456568037236,0.40950839382122245,0.4904334862404493,0.2686932430114356,0.9076865875570177,3.204112854260169,2.6478351218970464,3.210878474708438,0.7125845907968376,3.24322393977157,3.3239634859052605,0.853949591643392,0.8214550465170203,0.772412826484029,3.1930903244985784,1.0006354979010994,0.324791379192547,0.3173360451298169,0.7500658671537066,0.6885442960708696,0.9867241776791272,0.7978235005340266,0.8962565583918851,0.9313163932415093,0.5179363729402531,0.45358116754287403,0.5518901209919718,0.15540770286976138,0.25472031298596715,0.360161936772898,0.5474592726544328,0.5570847432182122,0.8005815216298329,0.2643091417447898,0.6520549249560275,0.4220480071465221,0.5554761204160914,1.2453914202717047,0.9323211463587955,0.9570184564741631,1.6108153819443682,1.6584651839179059,1.375260911885781,1.8471954591112818,1.6785137166251707,1.369913283063438,0.5428403860302601,0.28308321737396047,0.5197912381706815,0.7014483286602151,1.02191897854646,0.5047946066761896,0.29877264294185496,0.5769930948305251,0.4572571182828392,1.3428345266094335,0.36905280920252326,0.41680690932547576,1.0441168767455689,1.039191672338861,1.0429412734608527,1.0145803130111442,0.6286981766686595,0.7553902705826795,0.6308206214524457,0.9570760444045556,0.9580392090501169,1.5816071582626463,0.5553401044233406,1.393702298741283,0.38213199687561133,0.4388679929361688,0.8888733196460668,0.5857692431572354,0.45139582247245447,0.3684544343744082,0.71739320306056,0.15445045214632333,0.5147337883602491,1.022925750011466,0.6650844129403073,0.6138120420259252,0.2736750956023169,0.47962353067159025)
rate_lwr=c(0.0783314801964976, 0.07630321639632354,0.14536869167208763,0.11767476036560831,0.1699115543405968,0.012576907017086192,0.06539790506507404,0.06783764438450629,0.07514459635428838,0.09141935825458525,0.039730481023389885,0.07777535470501362,0.014172035596960342,0.06782917627847734,0.030351313966200444,0.0051364315298732255,0.07020612186730751,0.07253632128842208,0.022086641092377457,0.2739163078650366,0.03683526077376009,0.18672093101425963,0.03929863040769366,0.08215717017090512,0.16163041634544123,0.005503338345388353,0.03635913035044119,0.044105814080402816,0.03537357920481615,0.01287198992504307,0.2706104582707924,0.24882462090670515,0.29795483760060965,0.10912546182466287,0.26565987329376284,0.041609421654754175,0.07939946179238686,0.1095521661442656,0.1338888121413827,0.27911497659502815,0.07187062726136245,0.012919673628589007,0.2293305465527462,0.08986859482410903,0.13161145002797162,0.1810369749725006,0.2010854232361304,0.280788175321686,0.07867997144504635,0.21967924758933516,0.027713349915079066,0.014431440742094126,0.1631683737235741,0.23594390525621284,0.06904512447346797,0.09221040290891908,0.24205915666286848,0.01930617016747349,0.09196739683366079,0.014512563200977047,0.06979461553329985,0.012407482519080804,0.2293782046368228,0.174046793850454,0.2820145282079122,0.22354148177565786,0.13967301497745155,0.19597032366633393,0.008246310005670388,0.007556740529770012,0.003382740326922873,0.27868960421468353,0.06880014506789683,1.110502856070586,1.00662861598249,0.24143779135290172,1.2193213864804402,0.015773728875439347,0.0037742430377532,0.16820704491300498,0.293179082879171,0.24170306500243835,0.1569663998572869,0.3101163243455819,0.06185323780214669,0.26209598478127005,0.15752563948385123,0.14188217278974735,0.019427004933370018,0.036887011601042796,0.09441801743520972,0.0849646265155918,0.12190046453262726,0.06977053832605662,0.031742499612551434,0.16004537300088806,1.3271135933443046,0.513499736441815,1.1952313809811608,0.22197074666200356,1.1932960605170413,1.384640598588985,0.2962480909398703,0.22208047197271713,0.30983737501144726,1.1876319037189424,0.14329557505629875,0.02113118477690401,0.037487281758535884,0.025403832453876174,0.05431246048798555,0.13164606207753182,0.07994729827780472,0.26609995831036526,0.24039551277939053,0.1531748527712089,0.15324641790441978,0.16634574985616765,0.017059690855381338,0.051472512121966574,0.03706130487621334,0.07716782417396459,0.19706172746211065,0.18358851812183025,0.02015702529958502,0.19442103180077203,0.02576552187088632,0.1058967711357309,0.21566614330631712,0.03833832036510615,0.016425575632973366,0.357699628575292,0.35667412463866477,0.1716928671197533,0.2702175879744002,0.30061884123426913,0.25716028615251657,0.05118475976774173,0.015127381134327045,0.129158782149243,0.13785206406923767,0.32501212606095214,0.16786242269308047,0.07515317835890811,0.16770382144234297,0.07897817682402025,0.3029284196263995,0.103128222757155,0.14156594095706626,0.3285062038702572,0.31456919745467316,0.3094395215126613,0.27643964554155437,0.16071129228429673,0.1816386572434298,0.12728598404912295,0.05602096740240875,0.14737936752907344,0.1646870896497297,0.14771135214218403,0.21997570642696115,0.03152448030402011,0.061495777534067986,0.0703066715451533,0.10603164754709438,0.03373411623078315,0.02782993981674442,0.05320704081073929,0.005508235685893814,0.10459349462393422,0.07606930416414609,0.17375940411762206,0.0539659012394903,0.05313480943585869,0.10788299826512882)
rate_upr=c(0.7241123008258237, 2.130267445034013,1.2279469195638024,1.5341195827501357,1.1685272739180437,0.5110710756205646,0.7835869171870684,0.6433701946081265,0.7376181301327187,4.110742695592895,0.5479296390726615,0.6922514553720109,0.4419197721428063,0.5965204278875733,1.5188694294673237,0.5638340001641715,0.6719679327301677,1.0370884993966145,1.383929993221721,3.1433487450070148,1.2488174116256325,2.6933623943770972,0.5708450754808202,1.3106862581693113,1.8141032119634204,0.32187716125482535,0.9324413208675161,1.3285108716594802,0.5486796527081423,0.34313938855291937,1.1903082243015755,0.8846060090182493,1.7700471276811576,2.24158674622374,1.4024807023439518,0.9961136794632068,1.226601232864899,1.8514459592025347,1.9168527975248288,3.8846449447587608,2.025219856511521,0.6203161917223182,1.7938114834076864,1.2226780128102983,1.1543904365205904,0.8381202824760858,1.1900373100553732,1.8348968823784957,1.3398765982807972,1.3416137931938201,1.865827815817278,0.5388449914740261,1.1313004932971569,1.2959593055337981,0.7412037745701047,0.7584142999144694,4.246955073786896,0.9241215797162208,1.4173232695404017,1.2321661745112549,1.1250592692769772,0.6526879642964454,0.9953163074166997,0.9602881648028798,1.1531175069996982,1.2561110840377558,0.9258447088703716,0.9075451920277761,0.8654957479866594,0.6525020983766643,0.429342568894908,1.0269093706784787,3.0843175637601425,5.03642286215598,5.264801489026263,1.350578648778554,5.202111379777842,1.0783926155680312,1.9997093599349836,1.3706219566101265,1.3907651335495608,1.1693760883463455,1.5492554164350247,4.119690173186463,2.3038862667934263,3.8608670231598934,1.3968745710817259,1.7292720765327347,1.1052442467637809,0.552099231700103,0.7076950779777013,0.6948541662519461,0.7846152123959982,1.1665555204013875,0.6660041276893987,1.8143991172081684,5.323181361937104,4.846979092936056,5.312260505289726,1.255486997702875,5.1824001517888,5.396785515764579,1.5765763183607628,1.5721384930939926,1.3702292883965594,5.118892672959155,2.400291317793018,0.7858259216534849,0.6963394047439047,1.9441506349076305,1.7808440845940345,2.3526653711591554,1.7090157549549927,1.6590145807382604,1.7019157014456212,1.0709764745355617,0.8489898290917095,1.0410790813596034,0.3494203346462883,0.5421570036912908,0.9193689767497677,1.164089219169883,1.0037852886458685,1.7372069381269541,0.661146349036737,1.153708397298146,1.086859481008461,1.1615857703002734,2.6794671178937035,2.481132267515015,2.422549293645051,3.149912969138559,3.0695221491468327,2.642716813455223,3.767607717892718,3.1231093763228475,2.6987449421883807,1.1331477289952905,0.579288767814713,0.9698843531209052,1.4486094722323728,1.7984754351176118,0.9457294620046268,0.579092695249794,1.0581552791075368,0.9349539225032557,2.6442029551726915,0.6480782744540703,0.7416969554936701,1.8956438089658656,1.93308541083013,1.9568471657995763,1.7905056682687426,1.289522052031249,1.4631418770134774,1.2662519765845375,2.4309131724645408,2.4300614375532112,3.2375043735902973,1.080355290678583,3.003645875248229,0.8321864152151242,0.9451167563306986,1.9105654626028936,1.304719054629603,1.0314517606808105,0.8335428000341916,1.8285162888358821,0.3999033172645994,1.0087960361683956,2.4867711087520354,1.298249002261418,1.5851426158166446,0.5355580150998906,1.0101711651291936)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.14999629601708, 17.637774121016847,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.88884247356902,12.543329772332134,18.452723600647822,11.389842614526929,11.754396453828296,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,21.868567692284742,11.610334918074667,12.979848282645456,14.521871401808362,13.644381033687072,20.953699984613685,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,11.610334918074667,10.928438777046042,19.116662982107215,19.495450853775065,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.251534849631417,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,12.910033469142949,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,13.644381033687072,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,22.420853396189166,19.736359940155797,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,13.604602479656231,18.834541775289008,0.7889966599437539,9.179446502229375,4.52362158974441,9.474087405781923,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,11.108996465959809,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,20.39513914855202,12.543329772332134,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,10.74007339597134,10.647178292822375,23.096662907295563,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.543329772332134,16.338496367661453,22.62499624949477,12.543329772332134,10.058496485705948,12.685450981781905,19.776150149198095,18.82474632092768,10.704829806890222,11.754396453828296,23.05817805953415,22.62499624949477,22.26749625621469,23.096662907295563,11.566150303520583,14.172329741711991,18.04222710486738,22.72199624767148,21.2476885830762,13.580403826912434,12.518304131776894,23.096662907295563,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,19.967269026724537,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.057042374526325275, -0.06489454420285465,-0.06951695047672113,-0.06951095383686892,0.0631824116922814,0.06354454959531552,0.06463936849098201,0.062134940995066716,0.06356534386643906,0.06347386421013075,0.06465472047509338,0.06350269556601341,0.06494828694636827,0.06475570462137983,-0.065501699979616,-0.06356543974182627,-0.07503187008853211,-0.0753623726049341,-0.05771482872294186,-0.057369215696424496,-0.0571679690214272,-0.0574785220140648,-0.05741312411069879,-0.05762755189748208,-0.09316439867536906,-0.08423535449255672,-0.0840376277360265,-0.0831047809373813,-0.08391776772713043,-0.0844596740316397,0.09647086402494723,0.09311789695403516,0.09724607864956772,0.09748373139912014,0.09755780952775703,0.0939069718616472,-0.061787498176875295,-0.0599594006680594,-0.08449413871162885,-0.08618117303279607,-0.08648831478796559,0.029858241399232724,0.0075917318339688575,-0.04420846062888947,0.034932373223331745,0.02990925295826028,0.011487380715589388,-0.003888073077766561,0.029785849271600072,0.02984284814418925,0.038922176606554844,0.039109194693888495,0.030270009205241113,0.016146936185351027,0.030401691878196968,0.03414909077754296,-0.056729162136774,-0.06993735852656836,-0.06963755279168418,-0.07013207542237776,-0.06962213253681741,-0.0603892061108524,0.09398828302929398,0.10165007590471671,0.10101785581198314,0.09611336586540845,0.10165007590471671,0.098115691873548,-0.07139789895513698,-0.07085454973976191,-0.07104935042379167,0.09589173116034028,0.0989978409211458,0.0979481979822852,0.09902401084248469,0.09732200096492005,0.09801308875963795,0.09766216349278112,0.09914479447042056,0.09906359386404613,0.09627950680241806,0.09538253590469233,0.09910552180655467,-0.07696074060890015,-0.07715562284399258,-0.07730542642023652,-0.06834613034102655,-0.06849050622365421,-0.06862694667065308,-0.07410045221483218,-0.07344819865566117,-0.07331092878671987,-0.07354896576960729,-0.07424985363080253,-0.07550738597356582,0.10295831013596272,0.1030052476094929,0.10283854313497162,0.10245874253062151,0.10149308471336191,0.1030072879116221,0.1030120380078737,0.10229457932125319,0.10153522235698657,0.1013414425947969,0.10263151333636417,-0.0644968079516669,0.06698540454795698,0.06715176971035432,0.03907592915132252,-0.06406770202971844,-0.06362529662293478,0.09402199324726755,-0.06515843506333317,-0.0656990725358895,-0.06576173685184537,-0.06590317933226358,0.07589787423799016,-0.07995038882367383,-0.07942119848066002,-0.07960458329110905,-0.060069916454802995,-0.06563167950479652,-0.06716311995184208,-0.06664514098469755,-0.06674391873488388,-0.09117002710035493,-0.09043128562569241,-0.0639977556339403,-0.06897986286634937,-0.09416962007264096,-0.09377707131155123,-0.09339865360033991,-0.09448143074774297,-0.09205578438387148,-0.09332889008727013,-0.09440657134992954,0.0838151955899039,0.05285950999321034,0.054519811015075186,0.05448738089878252,0.055165938865292086,0.054649216128318,0.05458691752717433,0.05452089338402907,0.053930902189857154,0.054713676947004936,0.05460027018606476,0.054664746762377814,0.05460387733516169,0.05464678281616982,0.0551863518007411,0.05482959292607738,0.05260603049328108,0.0423621328450175,0.04286527586949656,0.04357127106692141,0.04233761628245957,0.04271322293961277,0.04299590233283986,0.09320466312088563,-0.0929729415246472,-0.0924458177790613,-0.09336084341522487,-0.092940166707257,0.07209559213139415,0.07204792000513306,0.05408952672502897,0.05387819506842652,0.05387981683372488,-0.06608434015818827,-0.0664468125826265,-0.06776798028550932,-0.06831543634052493,-0.06785681720130096)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.02437654029019356, 0.035087209323280494,0.041848715054444645,0.041839923176531665,-0.0014239188777528634,-0.0014436763492632438,-0.0015064007179346746,-0.0013647904610674733,-0.0014449827469504282,-0.0014396354516313943,-0.0015072648937249833,-0.0014414966982845905,-0.0015239775571833918,-0.0015129770930542995,0.0358854252638556,0.03326800459259422,0.08597366927124853,0.08923162114356538,0.02508249486354041,0.02471755632343685,0.024507728409750504,0.024831763646561648,0.024763268440942704,0.024989593780211584,-0.20272321866058796,0.11909301196200263,0.11841561800957394,0.11522281825342368,0.11800443331852074,0.11986633321194266,-0.012999811081460626,-0.011884696838889071,-0.01325668486908722,-0.01333537122372849,-0.013359904391113018,-0.012144005759084621,0.04160737466254656,0.04057569278131967,-0.1572633985533179,-0.16594896098194492,-0.1673897320859262,0.006035815696725394,0.008686799460958065,0.014238701605629145,0.00518478642376417,0.006060856534791626,0.008186488825441325,0.010020258496284039,0.006000260558123888,0.0060282794839459026,0.004714366315895461,0.004678894865397762,0.005925183911333962,0.007616521377046023,0.005987906523201475,0.005422298044120839,0.03129407901123058,0.04247041242045045,0.042026966986881464,0.04275798524075395,0.04200686709662402,0.038936807698016995,-0.012221463107462157,-0.014968533642881197,-0.014743403479938048,-0.012986498885235025,-0.014968533642881197,-0.013701983169870924,0.06089569763801395,0.05977557176077636,0.06017628882575928,-0.012811214991658344,-0.013861297964607177,-0.013500168273486341,-0.013870170603828778,-0.013291060274529878,-0.013521901389299545,-0.013404742173635211,-0.01391131657854828,-0.01388375035883007,-0.012939116018396684,-0.01264164469378395,-0.013897992855555595,-0.1170965950603704,-0.1178177165312534,-0.11837375590145109,0.05461551887174231,0.054895684337912934,0.05516103419647348,0.08293326823893704,0.08116764871471294,0.08079882045457054,0.08144030021205302,0.08365753070011,0.08730485069177549,-0.015447639871608118,-0.015464686495073567,-0.01540412112292572,-0.015266072044045507,-0.014914466071790314,-0.015465427252000742,-0.01546714636028357,-0.01520668884780184,-0.014930102857008342,-0.014860479238594505,-0.015328459402283215,0.0544610537434366,-0.002979957499394338,-0.002997933591893181,0.004759647801681458,0.052574319404567714,0.05169658443684574,-0.012182611603870682,0.035430892013965126,0.036151392010915884,0.0362351559725688,0.036424247394095915,-0.006001633982143841,0.10434891042999196,0.10267989130658432,0.10325727270382375,0.02843467739618624,0.036157166866375656,0.03840820335379032,0.03762055577213371,0.03775580543999635,-0.19208680855707919,-0.1883219053080866,0.03379937296215858,0.05584615275430172,-0.20831848497789182,-0.20620252980510592,-0.20417048085803385,-0.2099984458504169,-0.19700226392965398,-0.20380109224411996,-0.20959607918864243,-0.008706984128408143,0.008437081349801067,0.009118682448774918,0.009105547089896051,0.0093864676981348,0.009172203056905217,0.009146784724353966,0.00911912164175426,0.008880073661750596,0.009199159932226308,0.009152205338298974,0.009178515241627331,0.009154319216832714,0.00917039866494518,0.009394875973073908,0.009247555373202493,0.008338996249452155,0.00421766058881194,0.004382532504433706,0.00456972881761577,0.004195605162810138,0.004352147048565568,0.004400562257735946,-0.011932395225476398,-0.20170996805969893,-0.19893193262244543,-0.2037632105855182,-0.20154085381641212,-0.00465308163774705,-0.004645625607809299,0.0010247339661630863,0.0010150345739783366,0.0010151215069598722,0.03668499280418037,0.03717642928671031,0.05342664672618779,0.05448209946015774,0.053596679569272956)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(21.735, 18.205,9.438,9.438,12.725000000000001,6.289500000000001,9.438,9.438,9.438,3.09,6.289500000000001,9.438,2.19,6.289500000000001,14.895000000000001,21.735,36.390609500000004,31.000000000000004,12.725000000000001,18.205,21.735,14.895000000000001,18.205,12.725000000000001,3.09,9.438,14.895000000000001,14.895000000000001,12.725000000000001,9.438,3.09,4.466500000000001,2.19,1.2905,1.2905,4.466500000000001,25.564999999999998,25.564999999999998,14.895000000000001,12.725000000000001,9.438,18.205,18.205,31.000000000000004,18.205,14.895000000000001,18.205,18.205,18.205,18.205,18.205,12.725000000000001,18.205,18.205,14.895000000000001,14.895000000000001,25.564999999999998,9.438,9.438,6.289500000000001,9.438,31.000000000000004,4.466500000000001,1.2905,3.09,6.289500000000001,0.06885,4.466500000000001,4.466500000000001,9.438,6.289500000000001,4.466500000000001,1.2905,0.4535,0.4535,4.466500000000001,0.4535,3.09,1.2905,1.2905,4.466500000000001,6.289500000000001,1.2905,14.895000000000001,12.725000000000001,12.725000000000001,18.205,18.205,18.205,31.000000000000004,36.390609500000004,36.390609500000004,36.390609500000004,36.390609500000004,31.000000000000004,1.2905,0.06885,0.4535,1.2905,0.4535,0.06885,0.4535,1.2905,0.4535,2.19,0.06885,31.000000000000004,9.438,9.438,12.725000000000001,25.564999999999998,31.000000000000004,3.09,18.205,18.205,14.895000000000001,14.895000000000001,9.438,18.205,25.564999999999998,25.564999999999998,21.735,14.895000000000001,18.205,14.895000000000001,14.895000000000001,3.09,9.438,12.725000000000001,6.289500000000001,3.09,4.466500000000001,4.466500000000001,1.2905,6.289500000000001,4.466500000000001,2.19,6.289500000000001,3.09,3.09,3.09,1.2905,3.09,3.09,4.466500000000001,9.438,0.4535,3.09,2.19,4.466500000000001,1.2905,0.4535,3.09,9.438,18.205,12.725000000000001,2.19,12.725000000000001,18.205,9.438,3.09,2.19,4.466500000000001,1.2905,6.289500000000001,6.289500000000001,9.438,9.438,12.725000000000001,12.725000000000001,9.438,9.438,18.205,12.725000000000001,18.205)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(5.0, 2.0,1.0,4.0,0.0,3.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.022999459879966704, 0.03438930374912986,-0.013441946429728919,0.04149238967305237,0.3857060113607466,0.3916075793509941,0.250719752065651,-0.012242172056468074,0.2844600371876794,0.20191488389642398,-0.029576238060502844,0.3725591726629435,0.4614897882521252,0.1524500583446484,0.12175626611836976,0.027010622741430953,0.10296306064250087,0.015169735033648485,-0.0033982868377096177,0.08379104557898728,0.009423717584148561,0.08624731297977883,-0.027182832733074494,-0.009868358903158597,0.28412519467312064,0.020062301952552077,0.018966066295076935,-0.00955039107140561,-0.00991789708541398,0.01955238631304807,-0.1409518122778713,0.01563627098671147,0.036148534529462206,0.014129072450892698,0.04549672580547859,-0.06200408995057575,-0.0013857500658085089,0.1611999248307328,0.00633444671789447,0.11776288231514262,0.12713549444714087,-0.006049765298991539,0.04237857415074271,0.015958630671256874,-0.018180501742102572,-0.0012174338359971248,0.0004447441750469287,0.05034008275049795,0.04541905644763702,0.0030063947502066064,-0.0008278276845378758,0.005664013380348396,0.02182958435895466,0.011828673346409153,0.005312835775588185,0.036313436434124303,0.14674134423942492,-0.02208731209013458,-0.035934322324777654,-0.048584765264015846,-0.007032532840082079,0.14264098771374628,0.017675264943073123,0.11261943367114839,-0.046867331783106266,0.016469538935957474,0.08289790219912069,0.0181417946520244,0.22403379297210402,0.019736601911087684,0.013724247254339631,0.012554319468092795,0.16927710060108214,-0.010926769849659896,0.30921797925275424,-0.13127994560241102,0.34813041022112856,-0.08333691724085668,0.06676213792173101,-0.22312408186785831,-0.07296039654675962,0.015554458457646525,-0.30396055073221834,0.15629580825480024,0.10763016756960661,0.16568192269859403,0.004893355546134522,-0.006758457031034259,0.006830766113762741,0.2533621310800911,0.17351724625318535,0.2515123603502923,0.1850112352602919,0.10685278148863206,0.14118947552295402,0.098383543078254,0.34343307866508416,0.032012611853114804,-0.10000397430311914,-0.12137646832550418,0.3576143195610035,-0.0026111521547146003,0.059360990223605206,0.10540764101175239,-0.1619532995923966,0.3809134934470237,0.4956652358090245,0.014619362404307777,0.005774325317506377,-0.000707169411258779,0.5738109732036726,0.4962705282506967,0.003777064400992794,-0.01493098679099052,0.015067806164509012,0.0264184445402277,-0.005464065713732275,0.01122309799168398,0.0038746571757346197,0.021014203461880925,-0.013677607675198383,0.025027577241896814,-0.00995335761061195,-0.020102826204546346,0.010020150980841176,-0.014103982531063718,-0.006806135002959346,-0.0171844960701784,0.016914644247127894,0.17980401828415607,0.14282191510765993,0.24441084074460787,0.1902212046404584,0.19180645589437798,0.2409709286166923,0.1982899608010387,0.1941694943780032,0.021761142586276733,-0.011005084707950412,-0.03465223661984455,0.051070112023086554,0.004164748996059571,0.32156287119234805,-0.00492062149056697,0.3107694390369758,0.011766520100287205,0.12250067223172112,0.31940093964999705,-0.062055685419846913,0.013375583289812901,0.028585424316210355,0.05815235935579159,0.13705420227111587,-0.0357031674801629,0.004905893003741662,0.028663846134158472,0.11520033899341726,0.07868832341154314,0.02924066389359378,0.2858994147284975,0.05690762534591745,0.033494483372150254,0.06636387917131815,0.2971681684705816,-0.007965963495724432,-0.027346501139578618,0.004015081019676834,0.04754385467998732,-0.005192278244000493,-0.0218359411342954,0.11870579602967078,0.01138486273288378,0.005005445271484123,-0.00970921989473986,0.007344590983923017)
shap_list[[2]]=c(0.09624959391640488, 0.16514320039017857,0.29042839085221617,0.4737189188277176,0.6586604937054228,0.6721849685533317,0.3709007301136468,-0.026618068540772418,0.4227185132732451,0.42874461378218637,-0.028781568409325452,0.6724147887857109,0.8819867932516413,0.2474039405404314,0.2899247145272618,0.1327801976937298,-0.08213505239916132,-0.08040336705203287,0.03995936689661044,0.2313169208906225,-0.008532365187620678,0.1604833065494715,0.07102607610967049,0.05507096107928924,0.4773201357721317,-0.4551561782087716,-0.09743911630547424,-0.04043565467184044,-0.07044453182892921,-0.09949419489393246,-0.06894071020616782,-0.016268051092523553,0.3248999300537195,0.021536913875075055,0.3336479703334478,-0.055020051637662104,-0.07932808209567235,0.18979843884349584,0.26967765816507566,0.2703610776573341,0.30909229553266504,0.10741153659670183,0.1548473682708549,0.09011671423267911,0.07311915423304882,0.1055242008905038,0.0953578301685372,0.16389607116328603,0.11596558194940376,0.1043479513922744,0.2572378211885279,0.18507784592195536,0.2047308161138415,0.11189077184429493,0.16479072909150963,0.16583798718863127,0.17316680343626015,0.2034599493298991,0.2101541141968369,0.30729881304708345,0.17646160075912373,-0.09192725400810352,-0.005636179681701825,0.16884592122103154,0.05010028148410732,-0.0043457930063326555,0.15581540760269336,-0.007994231782810026,-0.3959441679909542,-0.11082766039892795,-0.07098890184298967,-0.015545619318314965,0.11895535205040998,-0.13032796225900029,0.1358870375168585,-0.09623097912746459,0.17431366765270231,-0.06369580235092873,0.22029290548224814,-0.05405966088695353,-0.05622704141711246,-0.00945846158752592,-0.16185003587606964,0.5268524435235437,0.473614857911761,0.5765283661861514,-0.07983097185985344,-0.06195841093882341,-0.06032475569536848,0.17923393343087216,0.09839787844085443,0.17289411855946676,0.10918508219059725,-0.039628466343547046,-0.060684989458217736,0.1206485882416982,0.30120269855791815,-0.16254217944627752,-0.1625432342554552,-0.05205545538791754,0.2123531113910285,4.127440051806208e-06,0.20241897284417573,0.28015454352766694,-0.09165188012852873,0.2208138416833001,0.5030709411816042,0.21806403736377752,0.24243180089067268,0.22927984777312205,0.5690287204241203,0.500324905682454,0.7933561226824868,0.1365972932532801,0.2300635095031443,0.25320726603432636,0.17913539995422895,-0.019607747704320326,-0.08464336309896056,-0.12850252544043678,-0.07559746695238972,0.06387157597005355,0.14934659871117334,0.1349313004086989,0.21980705711298076,0.14546980211446858,0.29885533317824187,0.24431475329320088,0.3657144017626561,0.09528763288544083,0.19761364971069273,0.18869922458063157,0.13838839936627975,0.16651986259238405,0.23990154570001376,0.15080732490973453,0.18379618449827187,0.21065667668665156,-0.10677228215002407,-0.0934911204658015,-0.006276563405662982,-0.01877789117990835,0.3549975326446883,-0.11259835190606515,0.36196446693531403,-0.016482034870573106,0.25324999379840757,0.25916324568268334,-0.0877511138276025,-0.033433268231004426,-0.036059182349806145,-0.0014912516904771566,0.2580918920696385,-0.13235157575687798,-0.033008840432801854,-0.0074363141738806775,0.07571045910390291,0.05096290525671926,-0.04230134339304275,0.46507604848351014,0.09972507733835191,0.04180777706670753,0.07373314178059674,0.4231169438663631,-0.02816892404815695,0.26337930432618906,0.19699809275979072,0.35531095003542895,0.12771056146216284,0.13586284356279046,0.5721821751323557,0.3084574657212488,-0.056745620869603025,-0.07184314151803115,-0.07553163565934382)
shap_list[[3]]=c(0.19187946951147455, 0.4250655415684628,-0.18085108566516975,-0.10353884584182939,0.10309867170863171,0.13010102330243187,0.5964938652236044,-0.03752716037719606,0.6270914457263097,1.4956609434571968,0.05861653500507874,0.11219356039936809,0.05612364573770675,0.44484044314413906,-0.011775345646430787,-0.11968483911298565,0.12520420487113906,0.0810500703600602,-0.05667956888702186,0.045925631522519494,-0.05863048175808289,0.038678228525627745,0.16152164800779348,-0.0685827153154215,-0.04687431819461806,0.42835743447115326,-0.013485981749061706,-0.01671370399343498,-0.026324407157671488,-0.01201941591790371,0.31995656158821384,0.12208739622209741,-0.031849601211855746,0.08275352570519623,-0.02607076112006315,0.16894838401032874,0.1032999647900658,0.28926730508674287,-0.15259746466948484,-0.06423788304618457,-0.11729638606666339,-0.07768662679986992,0.05288942300840071,0.11352923561527078,0.003999884482920317,-0.008933160184133022,0.02476411031258833,0.07499140228033727,0.027201266358473388,-0.004373694371412309,-0.23871828216855168,-0.02752768891962638,-0.02476921152261396,0.02367459160043795,-0.02488638772650942,-0.01649779337314209,0.1870254431691831,-0.0892814154248861,-0.17228953554667686,0.5097170978083495,-0.06077424667126499,0.14897559869251806,0.13755889868674717,0.48213321299205,0.4566105690332203,0.1601759223234201,0.4922648966295316,0.13562344723042255,0.07480797826445933,0.0061847612086696705,-0.004568231248257692,0.15216406026179707,0.013624638282750337,1.7003552387840544,0.9717426685709747,-0.09640667938146079,0.8967506990883087,-0.23596856519994175,-0.9131601388371703,-0.12339978461995449,-0.07544901120453003,0.14201271417504738,-0.09264863331613792,0.08008011099637237,0.0034506170081882,0.09186574851768146,-0.019494674367083874,-0.013868385359391156,-0.13126116145424802,0.36033800397024274,0.21619570660394596,0.35665487808237517,0.27453772231726936,0.1213464049515946,0.15387262168011787,-0.04868462060878418,0.8342859141575582,1.3161268921055036,1.648990637886757,0.39887272427175485,0.8999682369607284,1.667383765916067,-0.044123529734731645,-0.03787587589037896,0.3524063127035571,0.8888039469776822,0.7110615707619193,-0.019444393903486696,-0.017245197144701827,-0.12458166147824526,0.8165633351191675,0.7118083280510337,-0.009779209411100248,-0.057811633548459675,-0.1088687074303944,-0.11038115900071482,-0.08855951286595008,0.08477639988219825,-0.0348482208409873,0.11324276448703571,-0.03715424616476159,0.15909603485318732,-0.06626593956140327,-0.07271483633389478,0.25893462802459066,-0.0647632166559891,-0.17313445702260483,-0.18937454998563888,-0.13075946488787255,0.07391973346023667,0.08257579332195715,0.19941005877990564,0.2080466960729352,0.20347936876960154,0.17216580755977134,0.2210542430448961,0.20658318805743078,0.20610439425535412,-0.13786689853805967,-0.16258987011172057,0.005622578747696441,0.6977402035973581,-0.027003532308221525,-0.17894184482937833,-0.03071143889144143,0.09182494945611715,1.3262356743308998,-0.01784050451585097,-0.16965889130614817,0.6595372224395103,0.6404629318006596,0.7429068520402003,1.1102488139827236,-0.10629637097908651,-0.0019071384295954923,0.04473135219906028,0.19726190744103272,0.14605692960917227,0.476754264790223,-0.08082754280768116,0.3765452474320332,-0.180921904129461,-0.14750337975669514,-0.03979985082449228,-0.17192529494542322,0.14709317808210776,-0.09073789776191163,0.040980912959955824,-0.05440485817238058,-0.02943364381554871,-0.04731246497639932,-0.1723172382654546,0.11569255403506348,-0.023978800169383585,-0.020750081045138674)
shap_list[[4]]=c(-0.13509494363757948, 0.11959891657323371,0.14135960421690616,0.3787673312658649,0.6919456746299623,0.7771229016005565,-0.20183218808573067,0.0035412170037620993,-0.08133294435780687,0.4009120963413524,-0.056461275318712346,0.6143389727643765,0.5278917825483241,-0.07641969045592406,0.1374908721466407,-0.01936860130928721,-0.06816283142121546,-0.06310914674278578,0.06440302535508335,0.15684550412879553,0.11907239131423887,0.13023716479468259,-0.18466714560159406,0.0689171844023784,0.06774841550950218,-0.050485171036393266,0.08813139001628778,-0.005091892450422228,0.04074987603631618,0.09236903696612313,-0.14472941109981793,-0.030195820682237813,0.7311186878333785,0.08040859309862718,0.6395889689617247,0.11014689499565705,-0.05448112149805884,-0.12426549874059634,0.22637639208858823,0.056640399525971726,0.11545409271410947,0.0435810990226532,0.09308025444476402,-0.12464801535325658,0.0002439171767206903,0.05043463014383031,0.016531784077411474,0.08723748969594165,0.07578813658371861,0.05449179439747855,0.21801050302372993,0.1035261359853902,0.1156079045203638,0.04927436174417046,0.08126493737346112,0.12135129105179743,0.13335966807689287,0.16612645884650645,0.06549792994966012,-0.07390326843203597,0.13235446043079152,-0.10640336429488918,-0.023587792145565015,-0.16272848166690507,-0.00423915006553856,-0.00306660659248174,-0.29463343383032214,-0.027692699487700877,0.43198200451945135,0.06435447201121391,0.0216881515247482,-0.020402569303734276,0.907037167924503,0.7176067455192758,0.5560213566775404,0.14430324460518087,0.5745549791161135,0.12778176935421107,0.8465596411242586,0.2666568441705722,0.08056491537197254,-0.008683026499754352,0.37624586069962257,0.1427173752857642,0.17804313813149952,0.1336287900239033,0.060296300928668556,0.00912163365058364,0.051088961783228914,-0.07655292321758593,-0.10758858560813782,-0.07724804653805302,-0.0806799852229712,-0.07066503526616047,-0.06480567066005764,0.9415699106002505,0.5498447883526425,1.1260017918196548,0.6428981996346605,-0.08359491976561259,0.5467081222887156,0.8173582631437364,0.8676421898807455,0.8826358956772727,-0.09889184866437788,0.5273339043476368,-0.02072454856393273,0.12644851638138604,0.11760859924231971,0.06970600390131704,-0.0313679313005274,-0.021252091547100352,0.3250484745731839,0.01262939317876394,0.11632561700529649,0.1476857315699747,0.0645258114204162,-0.045481951434569935,0.07080231367299188,-0.06022385356727142,0.007612142131438977,-0.08555010299641522,0.03440408389048605,0.016448553198118346,-0.23818787180411552,0.04225978398913267,0.006674472702024969,0.10254891516552057,0.2619673857093144,0.16021811047715195,-0.19468482075260377,0.42829739785180715,0.39432098264426435,0.45112770344515224,0.36769980349026626,0.4888930178547902,0.4960909592735817,-0.11562439460049952,0.39923810631898765,0.01113492687622902,0.06731772711251119,-0.7190845292430434,0.6843330950706563,0.18666366904073492,0.6380413666843874,-0.04532690781262292,-0.2645625233632516,0.7267438702964565,-0.009208759580093305,-0.7385227459640974,-0.7234383539790007,-0.696618945449509,-0.6930688470102254,0.08815730409743437,0.009994723858480749,0.03783963909430657,0.14651939251277768,0.09846201899460359,0.10991583649003722,0.4012998350980999,-0.15256681912776615,0.4257280081325471,0.5675893923274522,0.04698201509081418,0.10059902869542764,-0.13546875521829876,-0.0347342240324959,0.13614571385093827,0.0725040142296561,0.034304764427849584,0.5156810151416221,0.182317514138686,-0.031653842030144104,0.02641127503559094,0.06856912401258296)
shap_list[[5]]=c(-0.12372942930962388, -0.1612963581880463,-0.14324018035615138,-0.18285712848715485,1.7386164932796455,1.8460499186354746,1.5777797803750229,-0.08699811690944657,1.7199128393468905,-0.28909044669084893,-0.08598981347127449,1.6217415252131036,1.8957762210009637,1.008732933445576,-0.1508087438010612,-0.1073461187955389,-0.07693697551867318,-0.07311649129160369,-0.11830482285336658,-0.15222759833017385,-0.08990406878701167,-0.14131468780269563,-0.1057410630076418,-0.12691219235300955,3.6862248474649544,0.9901213230782026,-0.08986359660975854,-0.07033815727032079,-0.07729069032971708,-0.09040916890555133,0.7201185426786949,-0.09275895724696244,4.064312812550536,0.7164561519733939,4.034743945939447,0.7309218338415,-0.08466275508623956,-0.12647127520242513,-0.14932658024514503,-0.14109673693043406,-0.15538201422759812,-0.1060316318773638,-0.12373160651975458,-0.0891596518110295,-0.08840850900892425,-0.10743571084627103,-0.09893524237580764,-0.12608615085110983,-0.11036007248220593,-0.10553373025166851,-0.12979102123255729,-0.12785035157540514,-0.13489575267616008,-0.10715435997980491,-0.1220213103055096,-0.1234383746045547,-0.1277356338652306,-0.1421766005913593,-0.12050272610736573,-0.1710192089300258,-0.13520095308663815,-0.08552850770528661,-0.10110131142277187,3.574525404409912,1.876133235781944,-0.10629216809220249,3.471077532707562,-0.09324196974892371,3.5134090052500757,-0.08622946409468739,-0.08838410459479869,-0.05012709615136172,3.000508527290035,1.6253417686899985,4.114154286112009,0.4219950812872645,4.448348199901045,0.5248662459876668,3.493986462427164,0.7305285292697529,0.2574196653995808,-0.10634379935160196,0.7243450566368601,-0.18635625484634472,-0.1889562291512512,-0.18995699878349454,-0.07635797635807431,-0.07612615306774811,-0.07612086830930474,-0.12044138449897704,-0.08780387227342396,-0.11897493283519509,-0.10562418070830805,-0.07269088064665556,-0.07939039572062914,3.993900128411826,4.47772454975306,1.4574819289191814,1.5057862277703318,1.1178977441338482,4.476294988792292,1.7246944008998797,4.023450962133771,4.137939055829224,0.7112495855579483,4.48624161390569,-0.1731202062786654,-0.14195552614052034,-0.1375123578586171,-0.1098138028012456,-0.18754574039532582,-0.17283432566687995,1.3650746764122816,-0.09874968014345298,-0.13166638294361088,-0.14058778119568757,-0.11555537930841855,-0.09895004084962529,-0.08496030446367042,-0.0860182731398431,-0.06933849992221697,-0.10868998785121037,-0.10810989602651816,-0.10806753692643689,-0.1284920316669758,-0.10936850630133714,-0.13344688244425315,-0.13463379285268734,-0.15120371039445768,-0.1579225337145788,1.066235840532191,-0.1476573477162732,-0.15172952167880416,1.0054647224254603,-0.14541962358613106,-0.15466374756897447,1.0160329145483211,0.3066783744042629,0.9916309804003327,0.6858057107219667,0.037416459187032694,1.1948560713172511,4.55661750239886,0.8284072350084268,4.51870236866713,-0.07365187878211653,1.5936283814649064,4.509683511600204,0.6030797594245232,0.9860507362460484,0.9535698883719678,1.3221251568201497,3.957624248040838,0.40071668010821954,-0.07886226628012814,-0.0895155013267222,-0.09887080770156473,-0.09429040438093021,-0.15517997742094441,1.391905289338063,-0.13119326814872762,-0.1545159592817643,-0.16359540273438147,3.6292034780359703,-0.10861198122724924,-0.12718614211597845,-0.10192865890793076,-0.1433330982311349,-0.11196575840683867,-0.1043665975550805,-0.2027367653736686,-0.1521510192062522,-0.08784976646871978,-0.08617389174324827,-0.09776625903619662)
shap_list[[6]]=c(0.11221598752001641, 0.25729333838859136,0.15030471065837042,0.27527285755697506,-0.019974606261572457,-0.012037272907069364,-0.17100497317804472,-0.07474161017161457,-0.16532785922958412,-0.08945059984329136,-0.0813287721732492,-0.029720556410041538,-0.04464534919701911,-0.13979561571776047,0.21938535806251283,0.12291918325251266,0.061985851715758274,0.056772333388012845,0.10679447250376206,0.20866189404103094,0.08434039896575714,0.1827170356815559,0.10604327619057508,0.1101468010305609,0.4180530614353442,0.27612577483617523,0.09129367214334026,0.06533648435851554,0.07338648155111353,0.093369848489383,-0.2745937913815072,-0.057808095704646636,-0.1754600966849745,-0.14188011363675399,-0.1977100687824387,-0.2099379564824282,0.058970248095991454,0.18198439820578471,0.2041509229532938,0.1743206289769203,0.21127668914600672,-0.05026851798584401,0.04367853662602859,0.04705104881897844,-0.06129591228738275,-0.038947697982827115,-0.012084362927470876,0.06907199321313776,-0.0014736572561028596,-0.03601775763261026,-0.10092681253370703,-0.05662976711699094,-0.02609419553030892,-0.0044992137280618575,-0.03712189132892957,-0.019537682408667933,0.20180022464878913,0.11284179489557751,0.11170487057841252,0.24246406211763183,0.12833902639761713,0.057713915788181684,-0.04948139741612482,-0.3963005664243716,-0.33610014991193515,-0.05379927745159953,-0.4044978808918696,-0.05275345567088145,0.26792454825342593,0.09902562707579785,0.07417554519084092,-0.0765310564026742,-0.10783093487763792,-0.30441156857316626,-0.07604594798512385,-0.1579717206099818,-0.05146235353430485,-0.1429067718600568,-0.2035534466459819,-0.2369395349818383,-0.12507923789122105,-0.055855018470373115,-0.22503893532574887,0.3486082496213511,0.32940818864709515,0.3702652485912792,0.08882423327444941,0.06629365529517914,0.06859017719075988,0.16695823794534365,0.11125765623017228,0.1620364706573627,0.13331798721715932,0.06313051164970046,0.07014282247808568,-0.13320357375068284,-0.08622756864275809,-0.1722450379992993,-0.34614901055582514,-0.2953147010990666,-0.08571327976428847,-0.31258965741143846,-0.16719403596910704,-0.14499201285696772,-0.2928540549059031,-0.08131881760938461,0.3609622638594153,-0.11843821577933104,-0.1160832411851726,-0.06691547856087224,0.41224821269675627,0.35770149335151,-0.26098621710287906,0.07373944213200978,0.1014011701056386,0.11519397331225419,0.08518499285481143,-0.05843147214135511,0.07704133089284367,0.06905174903071293,0.06146148033139146,0.1194965058649401,0.08521236499343225,0.07699377852608467,0.13990828285878346,0.08667901070504608,0.13537715210729423,0.15007553408203445,0.19846882818894876,0.3327722661849761,0.32933101102816265,0.3381980186520703,0.3197344747691755,0.3072815762015398,0.3445457752877585,0.34721281076203714,0.2952744690925819,-0.1131797399191186,-0.10677288602064793,-0.11666617111339504,-0.04825248481584087,-0.10614893348731402,0.08212198964006988,-0.13245657803826397,0.07582499289286122,-0.05873073533031682,-0.09189524958325693,0.07804270347231347,-0.1158903384892088,-0.10866085006005081,-0.10124114856408538,-0.09126112888286371,-0.026373187505677454,-0.08351838205691943,-0.05040537420964912,-0.03621729364638845,0.02360764517463177,0.005560820156415729,-0.05878781532030278,0.05752016103005632,-0.05669097771758954,0.20204940734461366,0.24106508489523354,0.42553517435922805,0.11418970927629267,-0.0988200399603661,-0.06377189361072846,-0.024208312043340056,-0.09335988328222683,-0.09411779375419514,0.39938334406482306,0.17479888416363432,0.08488561169364284,0.07357253261595981,0.0865534844979691)
shap_list[[7]]=c(0.022235640111525432, 0.08203299479918204,0.0027430840447275743,0.06184124356698711,0.327661658099446,0.3335171078577548,0.31773748235080124,0.003551669989936406,0.34941973854886815,0.2553371005899525,0.013200771309212362,0.31344787616196146,0.39819983802647124,0.22415396484806085,0.10172452440935953,0.018167780132400068,-0.03734930827508404,-0.02621793000230939,0.003677935119447022,0.09368404554464736,0.005279251120968448,0.08878812635364908,0.020761972434627327,0.004171881782606827,-0.08377335303758643,-0.07922197946281306,-0.07464692736611964,-0.018602513425460813,-0.041245727769419524,-0.07441764330491984,0.11057558097297993,0.044396778613914833,0.4764955157923171,0.14083667528482827,0.4770115360574295,0.12287446982679205,0.0006313741710061399,0.07443324881738356,0.02324892705312901,0.2040650649508871,0.11024185469833331,0.022992053285891385,0.05913224160542569,0.022380176712907096,0.018713192614128113,0.025870140156169428,0.03039683205146329,0.06937476046760589,0.043603308070106615,0.025862096767264357,0.04788002664470206,0.03567041055227109,0.04545031153881591,0.03607919976658524,0.03518292909261079,0.04190712107477453,0.12872493968244425,-0.016264020582305336,-0.009326418326723785,0.030665669669296364,0.0046856959573641065,0.013133194624098505,0.04907968914541182,0.34845724441718035,0.23483713585903293,0.04911639902049688,0.3435953665554,0.0512387699407164,0.1596557435412322,-0.02777012934785771,-0.026741204732942454,0.053130606547340725,0.3314416294599575,0.3373841217256207,0.3970535854019553,0.07999012122849382,0.3954519886918485,0.0869607681698459,0.4388603184464445,0.12563472260619232,0.061093512316289594,0.04531233876421075,0.12895639211908003,0.4688789790477799,0.3535815503544154,0.514544768099597,-0.022976231193449322,-0.002440185027163091,-0.004309243423006329,0.02748377721234797,0.0026440995177155245,0.02527423325234193,0.007474546787990512,-0.02980670430582391,-0.03840458401291005,0.41319006166968075,0.41258191582235615,0.3230698040137673,0.31388445666381115,0.16088136528521654,0.4079809613862291,0.36185419930654483,0.4561262130430105,0.4678240541652523,0.1177227292492522,0.40375446890900657,0.1992726596964929,0.05238223582610056,0.05573682750703901,0.05996840454472683,0.22386947978468727,0.19968918163062685,0.3004529867144358,-0.004133783515153131,-0.0072891062863531505,-0.0015621755791529936,-0.012086851339094401,0.031707661331933104,-0.06421855399781758,-0.08134025895278091,-0.04332383942863308,0.027927864788112922,-0.0033342550438753,-0.011155854454136476,0.010915932282925624,-0.0050004742067924065,0.048657751014902446,-0.10936494586552277,0.06404436761271969,0.11435613791481525,-0.013972325501470602,0.4961221455435299,0.37786012093230137,-0.24635146339520167,0.5545924024063297,0.40984725712933234,-0.25816307986925097,0.12673578288305415,0.06846736932888765,0.019199527238297733,0.04917441000766188,0.14637233560710958,0.4061331694112231,0.025638769450710468,0.413316513771812,0.025147433797431576,0.28513076034442636,0.3833369843944145,0.014167717176231838,0.13536459813793425,0.13404911656390991,0.16893769523922886,0.30432536046653713,0.015602288054788034,0.01006404453698945,0.03021815399557728,0.10410299882453909,0.07341824042121908,0.04637665669133641,0.21934923802976336,0.08521745633282896,-0.04754470430848281,0.03982327351168676,-0.08766893432341735,-0.06034098641387455,0.07207946197236619,0.042417240930343464,0.09769682923501045,0.0299151330756466,0.02296316333997701,0.1750128958472722,0.05138530594891865,0.00907198283491501,-0.014415141020370073,-0.02723581238677743)
shap_list[[8]]=c(0.04553899050313193, -0.049381022437298826,0.1189849591640783,0.12195189908614215,0.40280754584717954,0.4095642800607944,0.4076876322788038,0.02078491666272835,0.4153476488250642,0.3239260137511741,0.037062885572270124,0.3667940091696792,0.4537526332315963,0.30085331861020204,-0.05355189908915284,0.025655890210480658,-0.1316970931686096,-0.07981968228368128,0.0073013712822639154,-0.02879118914566283,0.06277629905614264,-0.026202505658072223,0.0859189586221868,0.05900459907021923,0.20929514368184338,0.23009710262022814,0.05036168443811508,-0.027234534479412292,-0.017102733938119466,0.051529713464654674,0.19209071241652292,0.0818762373440876,0.45908876050241115,0.13426869253578397,0.45932470468518916,0.18625457673763066,-0.04955582863581331,-0.21822283022794425,0.026778809922177915,-0.013974516434898717,0.022534963826345098,0.06915940772619489,-0.054195703820168396,-0.15377277065163347,-0.016631911136509536,-0.023921081289993783,-0.04842034193136844,-0.05030611495256894,-0.049269679961241986,-0.04065028838935376,0.016581470510312737,0.006092583393344151,0.011970757018676264,-0.05178890977799217,-0.004108307403071118,0.048727717202297946,-0.06590102505468072,0.05378424778665654,0.05572230822424468,0.16279848796151034,-0.001256050181889717,-0.12721824324765607,0.08361884151899811,0.3586699950959437,0.28984722949060066,0.06572946754920225,0.3636755200600876,0.08637228541766878,0.2788719099111388,0.08666074003930758,0.03835409360619463,0.09643681224164974,0.29326903883698197,0.3954006190323873,0.29238485128490516,0.12001013501338989,0.27700925312193336,0.13005258013643572,0.44053920342428343,0.1965396878411572,0.09640763326725157,0.06335331049367551,0.20059810131707437,-0.044319843418205114,-0.017029831306817608,-0.0070412762041152524,0.04224273532087036,-0.046299865029813383,0.005207897770917784,-0.35589725168474134,-0.4241262407758787,-0.3593153757566396,-0.3310655724949731,-0.1331838885226364,-0.12517704574286317,0.3970091456984782,0.2716443988417987,0.3267237107843179,0.34525175806219055,0.2346684767388452,0.27700929887170156,0.3895341880120856,0.45615073831902847,0.433116263429216,0.20051003859820954,0.27347810029150565,-0.3944877335310938,0.0913020958964256,0.06626396608290348,0.016765732341897408,-0.2873037737834611,-0.39563490809211427,0.3418976509188989,-0.06602022124971203,0.009026519381998728,-0.00477077919886822,-0.0416548850493696,0.06631343518304106,0.017225602012292354,0.004892620711378595,0.009037597347431725,-0.09232226281349389,-0.048715421938375685,-0.0026221366074363046,-0.00010719824679667656,-0.04353013827891647,0.13471791027232435,0.15645299471544016,-0.03499351069774599,0.10081403462261562,0.19177376400117552,0.13702845810931152,0.11297556653940448,0.23030750466731845,0.082488462124119,0.11902513237673525,0.2504478978277339,0.1683930805619436,0.3025292897698218,0.13773561217858366,0.062284713163091705,0.2750283263595995,0.3903712501572684,0.21887692927800376,0.4008254830609886,0.07348108065720763,0.45181643854637116,0.37229586147126775,0.12968456024846298,0.26687296684065936,0.23806416786308904,0.2879130190851924,0.35188649301280994,0.11238822158539616,-0.023515261850425642,0.006060923207921198,0.06773625570229357,-0.008646544661574723,-0.07256056810296344,0.4083505274861161,0.10095608209668286,0.17055015693211797,0.1840723090778468,0.21868044990127414,0.08599051079794152,0.10868709746820059,0.06297595034199921,0.03946197773998723,0.0722846895972514,0.00046288993486176533,0.04936240094980655,0.08522640657864317,-0.05211629472294642,-0.002576580636195453,0.04186373178361551)
shap = do.call('cbind', shap_list)
baseline = 0.3196878242429725
rate=c(0.5059836729783554, 1.1925337390864053,0.6859753607282205,1.3863364898907276,4.6082097666124335,4.867798330697242,3.468169905386727,0.10943849984390144,3.891977243563637,3.047642429527119,0.14643034869646937,4.363457172990075,4.950263177094783,2.481907177002347,0.9738335709704725,0.39982193905571434,0.21355968068962697,0.15001334565228103,0.363441316822041,0.958894078473739,0.4435129665515128,0.83932180566697,0.44736871426551483,0.4116359850364372,5.331806951547667,1.6795884324933048,0.29300501510537813,0.19705746123919074,0.19149819372113125,0.300168386453874,1.0332134969340205,0.3866535826834129,6.204442367607973,1.3681973355300157,6.085720846123187,1.3118718855842149,0.2131758739184428,0.7474115358561465,0.7743309362285015,0.9235287412577105,0.9427448143133115,0.32279537891234433,0.587766912009266,0.24114319247814472,0.23124713857487111,0.3210617112942536,0.32774317779337253,0.6582073580101002,0.4665617639527609,0.32082059090515147,0.38913370199089115,0.4437110058642592,0.5335180380645411,0.38899293905901094,0.4181013588121225,0.574351526808233,1.0968695885760553,0.5860909264129266,0.4247140448865823,1.2791247122207652,0.5572648250079937,0.2710741518055814,0.42781383787103905,4.8059099879589615,2.8400096441312983,0.44367530692943274,4.529883135275173,0.4293817647934884,4.874428638963904,0.37082277264757596,0.27694741940010736,0.4713672815857675,5.0459703438110575,4.650110017312479,7.020103641074845,0.6040970816559836,7.382784668501746,0.6634411312393486,4.709974907585949,1.001524545774041,0.48545786353844356,0.40558034022429695,0.9663350797654354,1.8124446927080353,1.5594302834074703,1.9752043933725685,0.31728459553463423,0.1876516567347616,0.17938959821971437,0.7541723484805659,0.30218171263140514,0.7325215300149237,0.5118446595900287,0.2650425472480761,0.31643005832945204,6.102501007583692,7.42417759975063,4.566317346292934,4.167802885146324,1.679666590094535,7.411903583730378,4.965315959395184,6.173520324983467,6.443897389136013,1.0562254070607326,7.419708376195435,2.0013880071777357,0.5426659362916315,0.5366625470949218,0.39338970055241373,2.408991099992063,1.995760935903199,3.1785293734312736,0.3010076475592579,0.5437482497432008,0.604891344725332,0.38521333419586395,0.29123720650195806,0.21996128559539901,0.17180425083364806,0.15870738391003478,0.42854502930004335,0.3522720016572791,0.3333982658494232,0.5924867737852062,0.357330103077521,0.6305829690479439,0.5225222367251412,0.9098407657836629,1.2189372243577858,2.121382651690737,2.204196620788562,1.9095057475289878,2.629323554843605,2.1766329258417927,2.1001538235525614,2.7039198520496455,1.131213141100898,1.7191364186443192,0.7661642029472885,0.5380447762625487,1.793838156210084,7.088821702449865,1.1503570307565745,7.008421016401005,0.3277162514583864,3.9957919720131976,6.950514436294456,0.6220550724692905,1.5002720669417848,1.4536806682659158,2.110351580760685,5.719476799570732,0.5786828218157646,0.15695360443958378,0.33403262972700487,0.9509560142940024,0.669900113050141,0.6531455418709091,3.468260795629399,0.6985882477947029,0.8103350893714004,1.1812361225160297,5.232905268819297,0.24345392288220552,0.5221054276576146,0.33492151498171596,0.8692866524698056,0.35717944450224265,0.26352750924933144,1.8999662210584543,0.8087900060552802,0.3059778939866643,0.2109748569125548,0.30273496739360656)
rate_lwr=c(0.07025137728923667, 0.0115952955127471,0.10795682286975397,0.22937357945876202,0.001417887069495194,0.06919228596778365,0.0883928536177147,0.0010479581950602612,0.7656149540452427,0.06315946561951319,0.0029857910489776984,0.0144845531813515,1.6021708893874897,0.03761848791123995,0.04008749913965176,0.009618516902105273,0.031157054701679593,0.008957603940152603,0.04753465472008839,0.08496022633692102,0.01993456100778218,0.07191114827061429,0.028414655568562708,0.05327508892110988,1.6563785199806287,0.04238078375398194,0.07037326586177062,0.016424069870794755,0.039332145923188455,0.06670223624180233,0.2050570637396622,0.08470346232660275,3.140768566323558,0.012204052733258891,2.56099189452157,0.0714809031604795,0.02274219317840634,0.044710406081357734,0.025691491686470724,0.02355652238293593,0.029994299435496974,0.006790827099970503,0.05940518776453038,0.0034334844929092556,0.020733185340689964,0.0804322003832367,0.05703587359664769,0.09003065754048589,0.0014229596878585493,0.051500993916224536,0.014216902611175641,0.1163220893318126,0.13855798946359638,0.06570965971019294,0.10023477603549905,0.05439491145549291,0.00734604084128021,0.0848983039199484,0.056750938315599825,0.028811503907540836,0.1070403068299785,0.01052246048032568,0.07664625242440809,0.8459030973042159,0.3507742401189699,0.08375488832321243,0.7926892170336828,0.10937119085703553,1.0578431813043927,0.013372172576140318,0.02714200375675424,0.03396100833302132,0.10568603284364372,1.7958832210314906,1.9141488477054596,0.006738341405644582,4.573443342836403,0.017063384199671405,1.0082717556410694,0.09897158480512169,0.005648727184731361,0.08201934955594867,0.0639422275679834,0.20612871885464865,0.12408064474337066,0.18904851184256252,0.049543257678604874,0.008009898618836775,0.006084209384946915,0.10296250126353901,0.03923655752963706,0.08382702624226229,0.06976476675323007,0.029300700093681964,0.0223717281268814,3.0936719943813746,4.125771593735889,1.0860961756980874,1.0779018242141059,0.21790666906666967,4.287586081020595,2.0068727697972113,3.0728234050660608,3.4427885012321506,0.21075140076525523,4.25110554146526,0.17224785647094176,0.05033270711703358,0.041272980660354674,0.003636455257298027,0.39362169881736897,0.10496931286761058,0.35617178535521565,0.061489636876122356,0.11322827473313601,0.14051278158202274,0.11681776249499412,0.059747300390634056,0.02735347709179764,0.024897221228836725,0.014861154943895338,0.031719123124071436,0.10187889458380733,0.08140333950840684,0.054169915639892485,0.09787742336765914,0.03584726928636628,0.03982245923467548,0.09641430460605399,0.008422218589684727,0.0973506465253762,0.37075278431365516,0.35834184172391353,0.6041490410640669,0.16496979282618357,0.4254668918321452,0.6080646638793098,0.013882499937590637,0.16050932603814658,0.02049003445535469,0.010243141794232635,0.26443712634304334,3.785435841675831,0.25235524145077204,3.9016318960309184,0.014171555459510987,1.0379295303287617,3.614836127257833,0.05280746397540487,0.4275937579132811,0.2952130440225436,0.19751369859751666,1.7952283500419188,0.0056888025947881005,0.0012274879776890957,0.02363626874703162,0.018702786771480573,0.04163716274223578,0.001955816325121651,0.01017002041556131,0.024388045152889393,0.0677165917890582,0.08131911640102618,1.7978413276001286,0.0035025664738403683,0.006994012590144094,0.001408239961180141,0.022104112755743588,0.00623998914485463,0.03974476323462789,0.1973147020636439,0.1696131184953812,0.01077202418791473,0.034069827985413914,0.04503733990209871)
rate_upr=c(1.3598002597971826, 3.165697372956131,1.4604960377530218,3.0494841799017767,8.18301024815027,8.069471250492056,6.6696075459319735,0.27645886914003004,7.270449035940823,6.02442532855317,0.36855426396167423,8.30557212466558,8.377430635551296,6.392706372328995,2.744007935961904,1.1544496044551182,0.5398165895313847,0.3225485681379418,0.7967785388219824,2.4354983391164455,1.2436042224500616,2.1432495038260373,1.2881640857565684,0.9155900190212727,8.56929709584825,4.552248475835703,0.6698301989653535,0.5267398482165891,0.3866843484183943,0.6922175481468187,2.1040920121170825,0.714570888091407,9.46384266135304,3.846584852991326,9.288032591599132,3.5110184402482276,0.46889520318780253,2.1485284970397975,1.9903108709058421,2.8081388416117314,2.635126796323812,0.9307156106703289,1.3880060935125598,0.6140652966699909,0.5076850630097682,0.6137471309301703,0.6734154145350605,1.6261140047177818,1.538403241961752,0.624354218289592,0.9727436797124183,0.9360860061349334,1.1441023278137237,0.8253188058307266,0.8610584151679797,1.3844216661629223,2.9503644015069317,1.2592041778982617,0.8858642118115647,3.492158383584445,1.2562111389991037,0.7008426520833579,0.9101732666599176,8.219730161588998,7.999394995732852,0.9525379384820398,8.208701473006558,0.8408845086729346,8.804032145419807,1.0018430040932906,0.7327714027913579,1.0303637293822634,9.046887818486063,7.925354538855688,10.687385134392468,1.650309802785517,10.738628090357436,1.937526726650205,8.529525791773782,2.4062681210476655,1.6895193705726763,0.8175212745841955,2.229544328467969,3.9991966325423185,3.5577063598903473,4.308134080902302,0.7342331994936425,0.43299189329908994,0.45626304687376285,1.8356258157926801,0.6277096922609051,1.7682779727999907,1.1221017397998234,0.7759975318881216,0.993248770073248,9.276227655841234,10.291212940764904,7.991848492127369,7.258972341030955,6.644992363298579,10.4558073921877,8.473009544249965,9.091579234270862,9.390609567258256,2.1966176623929727,10.445994835774147,4.3121420576151035,1.343137516928123,1.354596439887807,1.1031880531480194,4.8932484186738785,4.184617749077535,6.5928465903632585,0.5942822290560117,1.0816028985416324,1.2742159386588248,0.6706960541895306,0.5414071900553549,0.5078982842543314,0.36671913758115837,0.3303591508049687,1.0662637654391625,0.6412181362546636,0.6259647058360686,1.5580389255593359,0.6450319209988442,1.6498624182901795,1.3173816540413466,1.9563087683483467,3.4495217202192343,4.922155731636083,4.225289351056309,3.9268928205039066,5.039798092271747,4.304586757972845,4.166507674044817,5.09440783768292,4.998452553559611,3.5258301064266973,1.526657193505304,2.0911008812003073,5.101052955709078,10.067264343191628,2.2836342788374075,10.26482017844581,0.6949926086945208,6.927224148463952,9.882866279635165,1.393977133650397,2.794765966550335,2.7248064613540057,6.081218974386754,8.985610426508389,1.6129333880779355,0.40550243780766726,0.7713478572050447,2.6785466678607164,1.9179896745746534,1.9209498734290307,6.499891211462635,2.0469207419565394,1.9136290273405554,2.7792042022044017,8.761485046216398,0.5965685326285652,1.4242861220363086,0.9202544105454489,2.6086096313513667,1.0072348709091274,0.5688269275375121,4.152067328313649,1.7371247416388202,0.9642360955703776,0.4512089071085375,0.6986486261607958)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,11.45516312611962,18.316996330471802,13.644381033687072,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.230905385405343,10.270132845364204,17.06367135403042,18.771662988592148,10.119360120925535,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.037996316919237,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.251534849631417,10.62649647502931,13.693511568894099,12.910033469142949,20.05366296449453,15.133227159547541,12.762457973341409,14.53068870933493,13.78444086011421,12.910033469142949,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.604602479656231,18.318996330434206,4.058996598477934,9.179446502229375,9.691796492598769,7.7555798623269805,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.197688715594296,10.74007339597134,15.251534849631417,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,7.305996537444376,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,13.644381033687072,15.03049639224779,11.451546459520934,10.74007339597134,10.15963284744126,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.723329637370448,6.680496549201861,11.45516312611962,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,18.82474632092768,7.305996537444376,11.45516312611962,22.26749625621469,22.62499624949477,22.26749625621469,21.779996265378173,9.026196505109999,13.644381033687072,17.899611722932722,22.72199624767148,21.2476885830762,12.586611822800617,9.562663161692738,23.096662907295563,6.560946551449007,4.276046594398034,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,11.566150303520583,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,0.0,2.0,1.0,2.0,1.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,2.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,2.0,1.0,2.0,0.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.057042374526325275, -0.06489454420285465,-0.06951695047672113,-0.06951095383686892,0.0631824116922814,0.06354454959531552,0.06463936849098201,0.062134940995066716,0.06356534386643906,0.06347386421013075,0.06465472047509338,0.06350269556601341,0.06494828694636827,0.06475570462137983,-0.065501699979616,-0.06356543974182627,-0.07503187008853211,-0.0753623726049341,-0.05771482872294186,-0.057369215696424496,-0.0571679690214272,-0.0574785220140648,-0.05741312411069879,-0.05762755189748208,-0.09316439867536906,-0.08423535449255672,-0.0840376277360265,-0.0831047809373813,-0.08391776772713043,-0.0844596740316397,0.09647086402494723,0.09311789695403516,0.09724607864956772,0.09748373139912014,0.09755780952775703,0.0939069718616472,-0.061787498176875295,-0.0599594006680594,-0.08449413871162885,-0.08618117303279607,-0.08648831478796559,0.029858241399232724,0.0075917318339688575,-0.04420846062888947,0.034932373223331745,0.02990925295826028,0.011487380715589388,-0.003888073077766561,0.029785849271600072,0.02984284814418925,0.038922176606554844,0.039109194693888495,0.030270009205241113,0.016146936185351027,0.030401691878196968,0.03414909077754296,-0.056729162136774,-0.06993735852656836,-0.06963755279168418,-0.07013207542237776,-0.06962213253681741,-0.0603892061108524,0.09398828302929398,0.10165007590471671,0.10101785581198314,0.09611336586540845,0.10165007590471671,0.098115691873548,-0.07139789895513698,-0.07085454973976191,-0.07104935042379167,0.09589173116034028,0.0989978409211458,0.0979481979822852,0.09902401084248469,0.09732200096492005,0.09801308875963795,0.09766216349278112,0.09914479447042056,0.09906359386404613,0.09627950680241806,0.09538253590469233,0.09910552180655467,-0.07696074060890015,-0.07715562284399258,-0.07730542642023652,-0.06834613034102655,-0.06849050622365421,-0.06862694667065308,-0.07410045221483218,-0.07344819865566117,-0.07331092878671987,-0.07354896576960729,-0.07424985363080253,-0.07550738597356582,0.10295831013596272,0.1030052476094929,0.10283854313497162,0.10245874253062151,0.10149308471336191,0.1030072879116221,0.1030120380078737,0.10229457932125319,0.10153522235698657,0.1013414425947969,0.10263151333636417,-0.0644968079516669,0.06698540454795698,0.06715176971035432,0.03907592915132252,-0.06406770202971844,-0.06362529662293478,0.09402199324726755,-0.06515843506333317,-0.0656990725358895,-0.06576173685184537,-0.06590317933226358,0.07589787423799016,-0.07995038882367383,-0.07942119848066002,-0.07960458329110905,-0.060069916454802995,-0.06563167950479652,-0.06716311995184208,-0.06664514098469755,-0.06674391873488388,-0.09117002710035493,-0.09043128562569241,-0.0639977556339403,-0.06897986286634937,-0.09416962007264096,-0.09377707131155123,-0.09339865360033991,-0.09448143074774297,-0.09205578438387148,-0.09332889008727013,-0.09440657134992954,0.0838151955899039,0.05285950999321034,0.054519811015075186,0.05448738089878252,0.055165938865292086,0.054649216128318,0.05458691752717433,0.05452089338402907,0.053930902189857154,0.054713676947004936,0.05460027018606476,0.054664746762377814,0.05460387733516169,0.05464678281616982,0.0551863518007411,0.05482959292607738,0.05260603049328108,0.0423621328450175,0.04286527586949656,0.04357127106692141,0.04233761628245957,0.04271322293961277,0.04299590233283986,0.09320466312088563,-0.0929729415246472,-0.0924458177790613,-0.09336084341522487,-0.092940166707257,0.07209559213139415,0.07204792000513306,0.05408952672502897,0.05387819506842652,0.05387981683372488,-0.06608434015818827,-0.0664468125826265,-0.06776798028550932,-0.06831543634052493,-0.06785681720130096)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.02437654029019356, 0.035087209323280494,0.041848715054444645,0.041839923176531665,-0.0014239188777528634,-0.0014436763492632438,-0.0015064007179346746,-0.0013647904610674733,-0.0014449827469504282,-0.0014396354516313943,-0.0015072648937249833,-0.0014414966982845905,-0.0015239775571833918,-0.0015129770930542995,0.0358854252638556,0.03326800459259422,0.08597366927124853,0.08923162114356538,0.02508249486354041,0.02471755632343685,0.024507728409750504,0.024831763646561648,0.024763268440942704,0.024989593780211584,-0.20272321866058796,0.11909301196200263,0.11841561800957394,0.11522281825342368,0.11800443331852074,0.11986633321194266,-0.012999811081460626,-0.011884696838889071,-0.01325668486908722,-0.01333537122372849,-0.013359904391113018,-0.012144005759084621,0.04160737466254656,0.04057569278131967,-0.1572633985533179,-0.16594896098194492,-0.1673897320859262,0.006035815696725394,0.008686799460958065,0.014238701605629145,0.00518478642376417,0.006060856534791626,0.008186488825441325,0.010020258496284039,0.006000260558123888,0.0060282794839459026,0.004714366315895461,0.004678894865397762,0.005925183911333962,0.007616521377046023,0.005987906523201475,0.005422298044120839,0.03129407901123058,0.04247041242045045,0.042026966986881464,0.04275798524075395,0.04200686709662402,0.038936807698016995,-0.012221463107462157,-0.014968533642881197,-0.014743403479938048,-0.012986498885235025,-0.014968533642881197,-0.013701983169870924,0.06089569763801395,0.05977557176077636,0.06017628882575928,-0.012811214991658344,-0.013861297964607177,-0.013500168273486341,-0.013870170603828778,-0.013291060274529878,-0.013521901389299545,-0.013404742173635211,-0.01391131657854828,-0.01388375035883007,-0.012939116018396684,-0.01264164469378395,-0.013897992855555595,-0.1170965950603704,-0.1178177165312534,-0.11837375590145109,0.05461551887174231,0.054895684337912934,0.05516103419647348,0.08293326823893704,0.08116764871471294,0.08079882045457054,0.08144030021205302,0.08365753070011,0.08730485069177549,-0.015447639871608118,-0.015464686495073567,-0.01540412112292572,-0.015266072044045507,-0.014914466071790314,-0.015465427252000742,-0.01546714636028357,-0.01520668884780184,-0.014930102857008342,-0.014860479238594505,-0.015328459402283215,0.0544610537434366,-0.002979957499394338,-0.002997933591893181,0.004759647801681458,0.052574319404567714,0.05169658443684574,-0.012182611603870682,0.035430892013965126,0.036151392010915884,0.0362351559725688,0.036424247394095915,-0.006001633982143841,0.10434891042999196,0.10267989130658432,0.10325727270382375,0.02843467739618624,0.036157166866375656,0.03840820335379032,0.03762055577213371,0.03775580543999635,-0.19208680855707919,-0.1883219053080866,0.03379937296215858,0.05584615275430172,-0.20831848497789182,-0.20620252980510592,-0.20417048085803385,-0.2099984458504169,-0.19700226392965398,-0.20380109224411996,-0.20959607918864243,-0.008706984128408143,0.008437081349801067,0.009118682448774918,0.009105547089896051,0.0093864676981348,0.009172203056905217,0.009146784724353966,0.00911912164175426,0.008880073661750596,0.009199159932226308,0.009152205338298974,0.009178515241627331,0.009154319216832714,0.00917039866494518,0.009394875973073908,0.009247555373202493,0.008338996249452155,0.00421766058881194,0.004382532504433706,0.00456972881761577,0.004195605162810138,0.004352147048565568,0.004400562257735946,-0.011932395225476398,-0.20170996805969893,-0.19893193262244543,-0.2037632105855182,-0.20154085381641212,-0.00465308163774705,-0.004645625607809299,0.0010247339661630863,0.0010150345739783366,0.0010151215069598722,0.03668499280418037,0.03717642928671031,0.05342664672618779,0.05448209946015774,0.053596679569272956)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.438, 14.895000000000001,4.466500000000001,6.289500000000001,1.2905,1.2905,1.2905,6.289500000000001,1.2905,3.09,6.289500000000001,2.19,1.2905,2.19,14.895000000000001,9.438,31.000000000000004,25.564999999999998,9.438,14.895000000000001,9.438,14.895000000000001,6.289500000000001,6.289500000000001,0.00585,1.2905,6.289500000000001,14.895000000000001,12.725000000000001,6.289500000000001,1.2905,2.19,0.06885,0.4535,0.00585,1.2905,18.205,25.564999999999998,9.438,12.725000000000001,9.438,6.289500000000001,18.205,25.564999999999998,12.725000000000001,12.725000000000001,14.895000000000001,18.205,18.205,14.895000000000001,9.438,9.438,9.438,18.205,9.438,6.289500000000001,25.564999999999998,6.289500000000001,6.289500000000001,6.289500000000001,9.438,25.564999999999998,2.19,0.00585,0.4535,4.466500000000001,0.00585,2.19,0.00585,2.19,6.289500000000001,2.19,0.00585,0.4535,0.00585,1.2905,0.06885,0.4535,0.00585,0.4535,2.19,4.466500000000001,0.4535,14.895000000000001,12.725000000000001,12.725000000000001,6.289500000000001,18.205,9.438,31.000000000000004,36.390609500000004,31.000000000000004,31.000000000000004,36.390609500000004,31.000000000000004,0.06885,0.06885,0.4535,1.2905,0.4535,0.06885,0.4535,0.06885,0.06885,0.4535,0.06885,31.000000000000004,6.289500000000001,6.289500000000001,9.438,25.564999999999998,31.000000000000004,1.2905,18.205,9.438,9.438,12.725000000000001,3.09,9.438,9.438,9.438,18.205,14.895000000000001,9.438,12.725000000000001,14.895000000000001,1.2905,1.2905,12.725000000000001,4.466500000000001,1.2905,3.09,4.466500000000001,1.2905,6.289500000000001,4.466500000000001,0.4535,3.09,0.4535,1.2905,2.19,0.4535,0.06885,1.2905,0.06885,3.09,0.4535,0.06885,1.2905,0.4535,1.2905,0.4535,0.06885,2.19,14.895000000000001,9.438,2.19,12.725000000000001,14.895000000000001,1.2905,3.09,0.4535,0.4535,0.00585,1.2905,4.466500000000001,6.289500000000001,9.438,6.289500000000001,9.438,9.438,6.289500000000001,18.205,9.438,6.289500000000001)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()