pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_8_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 6.0,2.0,5.0,4.0,3.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.02478766888891233, 0.0778506391484615,0.08811603988757456,0.106415139556734,0.11248860593211742,0.0538508130370312,0.09110385697543393,0.042393593575509605,0.06771127129970683,0.22816238496190788,0.038701915526639964,0.07210719548506143,0.0472028844667314,0.07250324727190657,-0.08666233535050337,-0.052220501766427216,-0.40923774921586664,-0.26908703589743327,-0.02685470832659015,0.1646930898721739,-0.1507880214899514,0.018370791877169595,0.02427819736868351,-0.020509555531705113,0.19554020936822353,-0.1906945986464644,-0.22109776463361033,-0.22796171184107317,-0.21001719314986428,-0.18967132309200932,0.4078483139236302,0.3003671446572638,0.4583292912278211,0.3951606172851131,0.4314710649706188,0.24281220766111417,-0.10309702590877531,-0.07471559411351031,0.06566944423785098,0.24961048472803032,0.19720358068144545,-0.03282008259073505,0.009858745853842409,-0.05424952434044298,-0.0012682829486802875,-0.03625611251629974,-0.00862407774358035,0.01662111669197134,-0.09131732975991709,-0.0055245603850990884,0.042591021588229,-0.05686950763400192,-0.032532622277028495,-0.011792648144031708,-0.06302672730472454,-0.035323090835734386,0.16131625215746576,0.07582449250989405,0.10253490513607948,0.12279020937675865,0.08188390673109923,-0.3203723575613099,0.3030021930504832,0.2846307276150326,0.3715077997455528,0.28939343310876475,0.275707087015431,0.2906184536551598,-0.026145346785326085,-0.062221666750659904,-0.09954750074666105,0.3473811526095421,0.4862841486798174,0.7152038005125304,0.7423122969246131,0.4149137242669546,0.7539165763465933,0.2770095706499793,0.34846398513743154,0.38607739988703416,0.38052633535189145,0.29223737110052533,0.4383275303844293,0.09949480469314263,0.04010047631851487,0.08640210863464813,-0.08752185054860842,-0.032415278712017784,-0.04933678112686066,-0.30114765856734393,-0.32297757459926013,-0.3231993092399936,-0.3126767747088765,-0.39607322941156264,-0.4130122245849761,0.48642254187496786,0.7130349562126244,0.6784877015881432,0.7410613194552881,0.40777490210797507,0.7192959029393831,0.7580420108846763,0.4886841573642913,0.46135287212311493,0.42753967620853867,0.6837848698864507,-0.16442573103218305,-0.04464428843839968,-0.03971746031752781,0.06682943771330735,-0.15955849433869268,-0.1658749799751143,0.3109039090688813,0.031983276754937284,0.011828359246517152,-0.016448136098765005,-0.020699182758329993,0.2893404302046376,-0.27088910651235737,-0.2942325890050577,-0.3165291063109547,-0.010762681073798663,-0.02542188014722334,0.0430627708222728,-0.02160907598031869,0.016299707838594038,0.00731270389782974,0.0421574956454905,0.09628020712866818,0.12501527131445425,0.13727315251461067,0.045169468194244174,0.1109217864869406,0.15789058568331157,0.08122986519476591,0.12067502089494486,0.14489059909868687,0.2613841494394382,0.2292746110299349,0.2263772926239894,0.24195486743549205,0.36683062169897374,0.23749585745119692,0.2113516506763331,0.24963212251322053,0.2518320951290593,0.36536739476833774,0.24187087508634136,0.22842728436438034,0.35790364526088164,0.35361156930649285,0.35270266941275935,0.37163629642588847,0.310528493674328,0.21360623905994294,0.14228495564198435,0.19329606740115046,0.1778311705442318,0.2856987752713515,0.17689567205699883,0.4438108250151021,0.20353218563584427,0.17001156186050545,0.23855104902479793,0.20068161422609798,0.12446713821532425,0.09611076252368066,0.06145549793725836,-0.03930680596283154,-0.030673469763854287,0.0728983296517921,0.06297497768006713,-0.03853023692693951,-0.0932243540830924,-0.09555766381184204)
shap_list[[2]]=c(-0.057839851698971115, -0.02049535657834643,-0.07540992789166194,-0.07062995142850179,-0.024944151355621943,-0.027700991868577687,-0.007145935853503888,-0.03087298642050311,-0.01085940787502149,0.05223137030440625,-0.013900464431917895,-0.028991704331907217,-0.02727749171609343,-0.014564709487823154,0.0022971828001513038,-0.036005904843399,0.0518679336895998,0.06348663488733441,0.013789388293689756,0.027933753898300075,-0.0013156350730617258,0.039227870479546,-0.05018043725695018,0.026986979205598675,-0.020136218587807203,0.06490933362425182,0.08841048291297943,0.11415573992923823,0.06758304456675052,0.06266672016106083,0.03007195826585495,0.0195510397957005,0.03430498503992443,0.02894133480376736,0.03784719662905121,0.027079317766388025,0.08312626299841243,-0.025347854673827434,-0.06167295600320896,-0.0344607289526412,-0.056471311844428246,-0.023553289465725925,0.024014877868266137,-0.0520412751652428,-0.00277749273393868,-0.011116782798934258,0.008088248270621835,0.025835563581255102,-0.014647026032343595,0.008980293373458183,-0.05124937679232406,-0.02298980609452022,-0.0033012983917753824,0.0096903136905374,-0.02136377155006162,-0.011366419064542749,0.05255262228275392,-0.07043757710185874,-0.06931745930779927,-0.022613756085434686,-0.0456789694446239,0.009051564714577822,0.044307340805079955,0.024058622984747882,0.022269351002486597,0.028208100606538448,0.02281793484296133,0.030138638443121857,0.07963657951873862,0.07633454430396283,0.053156461060525975,0.02120230894014703,0.14468620988225045,0.1619651980109176,0.20061461932553773,0.055528301460126765,0.17626666439642993,0.038369863500866,0.08391057749430592,0.054320629893130315,0.03603895125814227,0.01789448375720199,0.07530900714369569,-0.03274767996537063,-0.05840621203306367,-0.030162326538777793,0.013157558515001062,0.001660953784094701,0.0332619912692828,-0.023243588102615165,-0.02319569201689358,-0.0232034274009431,-0.024257449973368372,0.11072525671804347,0.08287099578971392,0.0670651137042695,0.1508838126333069,0.20531664855521664,0.15085623943947193,0.03847819814545092,0.16435012004931102,0.174199544341447,0.05342422572493219,0.054576848100649396,0.04194741550030388,0.1660823809252112,0.001194331468491601,-0.022792726732929314,-0.01971100852433893,-0.03494538626333438,-0.006047022347489401,0.0012305946554567332,-0.005611964847589862,-0.048189062595540705,-0.05249197713984943,-0.062039631842031505,-0.06343833606546169,0.022369000383768392,0.02758087893821878,0.04734939046436774,0.04753894563789444,-0.033097059142320806,-0.05329116513904089,-0.06201287164258962,-0.048051015824145685,-0.05356683902735219,-0.05076141585009319,-0.06545695936452793,-0.04177194373324513,0.06677486012816079,0.05414142302757308,0.13101685212987002,0.11645778926070208,0.08345932680781022,0.1673113955430477,0.11774238650517739,0.07404088488715527,-0.010814970167605631,0.03840447264476166,0.010473837806800577,0.0028100638152723013,0.07017703193668488,0.010197952546842253,0.01825391547287692,0.00967654425661568,0.02283241607625074,0.04811749900086845,0.019370874529108857,0.010753172468522657,0.07219900282924549,0.07741905227733206,0.0764912135550269,0.060576813403224086,0.03854388090871148,-0.020976954604812872,-0.002563224241142536,0.03679848216420211,0.03800494962702371,0.03828831683376208,-0.025484309812217342,0.030882400628508694,-0.009958272419313241,0.0006248228932504836,-0.0039906581990348695,-0.00017442377139027804,-0.011046151514266777,-0.008997447939274147,0.008764420379626912,-0.020735270469277423,-0.012846523699680397,-0.03180305767564288,-0.06303075226437363,0.12892862427426469,0.029242875989849995,0.004142872829112818)
shap_list[[3]]=c(-0.05193362384480964, -0.010478306243267238,0.0935049216928716,0.11168324186416687,0.02136221898643354,0.004482619968202478,-0.039546394016405806,0.011874247795097858,-0.0382760610896846,1.2034336759142055,-0.03837375849283559,0.013348794460700161,0.004991435228995469,-0.044201420573696304,0.06731407962051003,-0.19040160707553555,-0.02018513117719314,-0.02387256963872608,0.04587016617890578,0.17492905702802375,0.061375639395697804,0.10485495550046592,-0.051295275134006904,0.07083163045196601,0.03329856537511769,-0.021844301427864317,0.04007234353121032,0.057137472835651335,0.03125769571328172,0.02179100549791016,-0.037403649092695675,-0.05284755472842398,0.027433402528303157,0.057956595288117294,0.024675380258054064,-0.1940790724258224,-0.029632951156721633,-0.03536422573120566,0.04972750437065417,0.11073889200586604,0.007292890941673774,-0.1701877187666272,0.09464398736831277,-0.05211740518911987,0.061517995534654604,0.0486357440286785,0.08138473895547281,0.1019503587098613,0.032488843657056704,0.07885357222634233,0.1136351232021077,0.024838223262107044,0.07134260975958043,0.07892119997720809,0.03126418593948351,0.04924774776106834,0.1776051178380568,0.031487260628180885,0.09827674085515796,0.019086928196953585,0.050170312838198346,-0.018258477914495926,-0.04228099670192473,-0.05120572946623151,-0.0458490412367961,-0.03670108054270601,-0.052879319870595284,-0.0495002215799695,0.11450873205848627,-0.09760729048288708,-0.08655922159778423,-0.0401817976168533,0.19777778225518722,1.1742038180410002,1.1262637417716836,0.02830771694717804,1.1829441442617072,-0.25258659013587026,-0.060902363990428976,0.029315520081131655,0.02423317932601297,-0.042325780041180865,0.03431117478248865,0.13025671065169536,0.034097413641052114,0.14948738504857279,0.04215202800970312,0.0526436793719375,-0.07744923971153662,-0.02491993026273275,-0.025402269920169,-0.025313487269902582,-0.025667646307238303,-0.002891628454125094,-0.01513625091958895,0.036507770353359455,1.2192041779132223,1.0409485608553102,1.128339106505762,-0.03797128387951764,1.2008647651263722,1.1887749165294137,0.029834624733661257,0.03216008667057834,-0.031205964787534093,1.224288554682955,0.002534608859663989,0.024941807015251224,0.02831454617050843,0.1223006300806111,-0.008037096657899478,0.0021038380976580876,0.03871781903759316,0.11737839684044471,0.09490968509227518,0.06359685600011435,0.05812554565141793,-0.02999291416863944,0.030620099948571906,-0.026588230288249113,0.05939171224183377,-0.054649450862055325,0.04726030860559511,0.10332563920587347,-0.027845415262754913,0.07455376388171236,0.0056172108760958695,0.006505004684359945,0.14168384762583613,0.08520763494755053,0.17759996396950822,0.25695548068388235,0.3010746606701173,0.28933473776912844,0.2427263862890039,0.2986267110571707,0.29121793611762226,-0.046298977829577495,0.01028629784978703,0.005527754215232772,0.010918461759760726,0.8439043550492671,0.005529223269553773,0.0028329331004963688,0.00661689119701633,-0.03578908552260619,0.9404881068879717,0.004866838738139926,0.00401458051522432,0.8301270391674471,0.8480780651823286,0.856429771548707,0.8306695390525174,0.017544300504945334,0.027171281953776303,0.02641747526835845,0.09213325214586227,0.08499407165764662,0.8263868618968169,0.008258570360961339,0.8033626982741484,-0.040937178445299045,-0.047323284689580684,0.02864345792343265,-0.033522130762305646,-0.029585013759505306,-0.16682355020907047,0.047193283844934035,-0.1347094993465701,0.039454914347825415,0.1396222809927879,0.09422259044357417,-0.019288523662862635,0.009735371396551501,0.031631966143268415)
shap_list[[4]]=c(-0.0036455578978425735, 0.04790772867243367,0.02692163981398065,0.015120577484337601,-0.004552421478024604,-0.04742238244506395,0.04414006358860328,-0.013080238696259943,0.037151589739681204,0.09592386323224822,0.03197827856443192,-0.013330288741083269,-0.014653030189609968,0.03105128333007963,0.038898383800888565,0.022018227791966556,0.049620690261682275,0.06784146709331099,-0.011098787472365612,0.08637901015023942,0.022311225466722717,0.04941414501684439,0.0053493134065370354,0.01647392938049012,0.15539249305636108,0.029626142585952805,-0.002128585558911841,0.04347096090731941,-0.015949345477219396,-0.028385548846663673,0.003073508616739114,0.002592258303108848,0.026146056185763853,0.06030890414359184,0.018585084360405783,0.022794041983681016,0.06481126981206477,0.022069400612451898,-0.004899525344465734,0.1309589693717859,-0.05402354273388672,0.022423309659737302,0.047071098210142506,-0.013055950439298688,0.0437962498024674,0.027964087546356247,0.050961594607154034,0.060080606207274345,-0.006972269831949868,0.04039791572175705,-0.0533892823161261,-0.006171895714037433,0.042394567147852356,0.043344764041799703,0.012065401292670402,0.028697357670015564,0.07879561114165547,0.001553297756693493,0.03152402947341972,0.04224833291814766,0.016373531514780403,0.04736014904273336,0.003972857857320181,0.009508624714169016,0.003901572792783858,0.011161676014675936,0.01002483200280328,0.0034250637403003626,-0.05499851724392265,0.008418079753981168,0.006424473124382894,0.0024002749687041455,-0.009157168841444142,0.17213411965435074,0.14368518623294116,0.01858388876879646,0.18177023903511108,0.015308508938700957,0.0020404164948542563,0.005552598181432583,0.017445979172339723,0.009366715756620032,0.017192691802691947,0.10316552037187765,-0.04868770284474214,0.13997361900603583,0.03360491715007275,0.024164222434385176,-0.015689983497006364,0.02736697930962015,0.03941020890445963,0.03899839575436684,0.042311587305257255,0.07253625065291655,0.05311881307151869,0.024056574679597154,0.17346137384028254,0.0774652723094961,0.16603938357641146,0.00910131634063958,0.1761938751471,0.18295665484204843,0.02408285961135129,0.017826768501111156,0.008591770194873054,0.17476073611256332,0.0666950638750291,-0.009003863084462277,-0.005369570072304196,0.04904662614379538,0.059557713861159774,0.06493969813095875,0.025650457799292693,0.06749815052073245,0.05605549918311176,0.03846853444531559,0.03604163272295068,0.007525318871127633,-0.00268155029553837,0.03224404987047564,0.03261864647397987,0.004902218518297658,0.02714123904312397,0.04512706604589555,0.013474162689474703,0.04610759912451296,0.06993115786585248,0.06542506957579491,0.008333564148797034,0.0009848378827266777,0.13226979512057316,0.007792235707213884,0.00922936294920701,-0.028889022875840442,0.019453477855844156,-0.015289159484119382,-0.023415487739334738,0.03392014284839113,-0.025479451802970034,0.0036336217104333012,0.014938027406342338,-0.02237184703036973,-0.00019037574466600354,-0.0252539261222718,0.005059021307736076,0.021220104217610853,-0.012628295767620966,-0.01664944181786362,-0.0070379311205042835,-0.019221935719919595,-0.0143595243935576,-0.014760432141125684,-0.02842717440623004,0.0032534203008386486,0.011130896915946717,0.0412929356636693,0.20309484222697025,0.15196069984829985,0.04209302184594598,-0.0011461328134876958,-0.07726070872949982,-0.06446973430210859,-0.06020327029967546,0.14663021023230519,0.018101834382229745,0.0518090844050107,0.03337391977373309,0.008344544559003332,0.00959265750413011,0.02992409202879913,0.009256507854410064,0.0226842242821246,0.07242274945375399,-0.020879281748435678,0.008109104808927353)
shap_list[[5]]=c(0.008438613998055464, 0.04127467696389888,0.029736261095422066,0.05000707856869835,-0.060163850844957144,-0.04181316053748166,0.00297246584675077,-0.04979639827830143,-0.0013140606282816371,0.04115758448086836,-0.004638083907210445,-0.051963380778252695,-0.032791634774379554,-0.008030216652928829,0.04228170619249172,0.01276917281277702,0.025177587477997955,0.03183089330495514,0.05343379110440808,0.11290151486382602,0.039705032696549285,0.08441521901204017,0.009262685035841173,0.06587209989829407,0.06649100148971479,0.018895703245674005,0.04079938731018539,0.04967789352674516,0.03397070842106625,0.026551408976789665,-0.035397916912657486,-0.03436317650454177,-0.0050163069976353405,-0.0310550753971074,-0.0029131557653675182,0.0009755551710105896,0.04023488574023211,0.025112900012522688,0.07050896473211485,0.10368207199274286,0.053720313159260936,-0.019589950787588815,-0.020706171967224407,0.006797758210449491,-0.04291071722530402,-0.05384379884589651,-0.02832023479536512,-0.009071915600785557,-0.044392000620240096,-0.045841507208483505,-0.028787103661483456,-0.04577726683560072,-0.04531382447629092,-0.04002952968639919,-0.049892620995826815,-0.05633287833292641,0.14287542581004115,0.01996816281188683,0.03197456320601416,0.048753131614142645,0.03435120100139271,0.016976967992017696,-0.032962561061307155,-0.025606572066405504,-0.03436388802642703,-0.028672202509546066,-0.024829373637806438,-0.0335668001577388,0.026893492883576477,0.024844678569439255,0.018582012522835537,-0.03566642901406884,0.08770670634309718,0.1271055893660223,0.15865099751235337,0.007363881583734227,0.14153624268736728,0.014684783775623995,0.04596968823287666,0.010039089280202588,0.0018016060489058495,-0.030610921679717257,0.012898822771383347,0.10382416730026162,0.05993720569175476,0.11182623865535565,0.048544704185867586,0.05782895001348067,0.03077535202257788,0.02012840748561055,0.02672213800140839,0.026743433141724338,0.028660587129608183,0.03887949301423375,0.025547172052419433,0.010306571150767586,0.12044829138140685,0.14752554817074692,0.11896926842124424,-0.030450863249771275,0.127015241949208,0.14110102684537984,0.0019315886164670906,0.005167623341602728,-0.031063769333391836,0.12567860144004198,0.05331785201080391,0.0010660651634165233,0.006123773823878272,-0.0015745846132424605,0.03705393301335183,0.05185714586452245,-0.00371820382056083,0.04323135103478341,0.03331690308274993,0.01936537212650694,0.017546049216648988,-0.029202454908337703,0.024631468923821707,0.02091514314889879,0.036884680411168096,0.01268538058013827,0.017732378095600885,0.04071873770949487,0.006305828494177158,0.029579381687018083,0.0439577650896456,0.050406953456143,0.07183762728987875,0.11013910724462683,0.1434044077895031,0.13296643446057635,0.14878608512953098,0.13521433329922777,0.14077659828808856,0.1447645587496616,0.13562028045798105,-0.013290970302602734,-0.030508655911219085,-0.045568552552058314,-0.04253486250313409,0.00793616346057064,-0.04493836446221281,-0.04506626082445343,-0.04605296767573857,-0.015427297036451496,0.015413929833670738,-0.04442290130034843,-0.04441830363035621,0.010901461600821684,0.010327535853640298,0.008786936312203909,0.008977605234359306,-0.040706034921762745,-0.07022014582659106,-0.040830717811870997,0.023521363349355843,0.01109386624254423,8.954072782059235e-05,-0.07026286604656087,-0.018073594721738244,0.030244124298039278,0.031158582879707068,0.0649929327019718,0.03972816526380915,0.008262344405312368,0.0209325356892418,0.0074892476602587245,-0.006260387462091705,-0.0254338164159703,0.07621654871500577,0.031500793368793426,0.05496323818185444,0.019722902927592448,0.03564490990709629)
shap_list[[6]]=c(-0.0399840172207354, 0.00476761910463811,-0.0015194815623423017,0.013270679462736407,0.0019471757725658878,-0.0076264078868445275,0.013546797165838963,-0.006919718610758019,0.010832000046336398,0.10300472998122501,0.005764242191241491,-0.0042223721664842485,-0.009945179039690288,0.0058128587244145385,-0.010208517094930971,-0.013905734033269451,-0.06317151133632219,-0.04346990905855796,-0.03324326814717859,-0.028149577739920873,-0.04232749430226913,-0.02749276716748906,-0.043411639682086695,-0.03141357275347165,0.29509850230001566,-0.03957568167836853,-0.009432570643542528,0.0010609585924922066,-0.017059999439786366,-0.023816327735874884,0.04402579441084525,0.03206814643737284,0.04577782928107634,0.029339636469983985,0.04477127511355935,0.01868300186858968,-0.0355532557022142,-0.019943942231863625,0.2157072785316663,0.3181858698012665,0.183382674206552,-0.006207857326107783,0.009483275303080012,-0.0076525821610635685,-0.002389347618589923,-0.006083637503488155,0.0016079936516825563,0.009963600140813187,-0.008124240240945354,0.0045960077004643515,0.03302555305982732,-0.008854733762953116,0.002977042659219815,0.004107936836025533,-0.010244134838472215,-0.004474023060390118,-0.025153974579896862,-0.019425411449811514,-0.0006288990499249993,-0.00039676056538342315,-0.016651276976367244,-0.03381679690523547,0.035486929040550126,0.03159805079984551,0.04053200905025656,0.04159222792070949,0.029166210304510838,0.03285319307166622,-0.03534549316401294,-0.03070509059174671,-0.030297339573554065,0.04266985174322601,0.09706238131539152,0.18348760235006709,0.176052829408843,0.05351193959868705,0.18891728455170614,0.023955733428841313,0.05706641982925808,0.05098196079947757,0.04431942157937218,0.04020414599929029,0.0590162241578604,0.29337384540175826,0.18017483841046864,0.3194413135862662,-0.04565483495436837,-0.04596371233937214,-0.039010041699009124,-0.058029428149116796,-0.061873857024796614,-0.06201935074226819,-0.061586555794696435,-0.046825192228867066,-0.05770811610760349,0.06146060648172919,0.19241985820016427,0.15722208018740347,0.17894863331113509,0.04409326309491358,0.18973165961605443,0.1919939548742381,0.05470443057443831,0.05477814387731039,0.048353475269764905,0.19122619885450137,-0.021358032954628597,0.00266905105689261,0.004950321093657993,0.03364393067047253,-0.02330617092146032,-0.021292464286754048,0.034679832757461275,0.00040608215191461093,-0.0045306239972173505,-0.012973269854004788,-0.0141867241406261,0.03790573241277811,-0.0441746538415559,-0.05475475095865983,-0.04009541197579554,-0.012067252176343324,-0.016313120171841652,-0.01287129426873588,-0.01598582404956998,-0.011370554680356281,0.24209864883422186,0.24404833877421234,0.03424475735639662,-0.026461504990376264,0.5118576014670493,0.54845787803136,0.5419448866027275,0.492979817433371,0.5858143572942073,0.5331977145691226,0.495444734424518,0.034399057710581396,-0.006364133686722681,-0.014855143256849591,-0.017462658414694715,0.027199404267135706,-0.014832239660133521,-0.01567411567635509,-0.013931001786884535,-0.0016843264487508853,0.0321533555330295,-0.014451532077312652,-0.015519186395396964,0.029794463059997257,0.029261949419662755,0.026971765093024378,0.028143541842333763,-0.003609933026236964,-0.0036106725703109487,-0.011304251412848175,0.005506873530905498,0.005383838921769779,0.05847007740735371,-0.010319349324562353,0.08078004375789231,0.16494755707907,0.1709828128260038,0.2865770383002566,0.20220907171677235,0.03169881579983427,0.013668517085813488,0.012048299259348602,-0.003964501009184274,0.0019953643070702563,0.03286018465098457,0.005140903223434013,-0.031563348669976066,-0.05040554402549201,-0.05275516541417999)
shap_list[[7]]=c(0.1526726190223618, 0.0911693716887806,-0.026696408957954363,-0.025295879494595837,0.059300362034425895,-0.07625141982902131,-0.030916718143600138,-0.03487744738750946,-0.058209734530304695,-0.1987505923368963,-0.08940761410890671,-0.016884222115603725,-0.1467560012734949,-0.10183258509000577,0.0891246431857237,0.15877368786921528,0.39772379538932245,0.2714331979876439,0.0016798206102615414,0.31772817120930924,0.14502955408431698,0.10030177196889054,0.047372438834310915,0.05960362106444117,-0.202840624061138,-0.06824233632858528,0.02468488218576428,0.03315079859333519,-0.009316115908183454,-0.060855021489447915,-0.16348310741102476,-0.1330160560569305,-0.17865955325460045,-0.1685792229632315,-0.19607020111418164,-0.1044226788233654,0.2326603153938064,0.3275769517982699,0.16389215756716186,0.050772772349817745,-0.013445358307054341,0.08983965242723349,0.24131784498739228,0.4633379504037388,0.19455941881229646,0.112095846177698,0.217173374524472,0.24770949510402504,0.06155540931187917,0.2249467040502317,0.18023144448892123,0.0218712265521348,0.1967721442217731,0.2182159514017545,0.042846137259542755,0.12002457097760075,0.5394198482194035,-0.028991703815907627,-0.026079546030509607,-0.09603078325926154,0.006663482830678797,0.25202862265629,-0.13426922553892362,-0.20526715773658707,-0.1631009812563589,-0.08232503973116263,-0.2141571287081598,-0.1326326498483342,-0.11524456723964857,-0.04705978913229641,-0.05627887518536771,-0.08948328355339685,-0.21977221186676701,-0.2188324721010641,-0.23283846467596103,-0.14303512589067272,-0.22351244733859074,-0.10725189227416686,-0.16968199176675794,-0.20748313853461448,-0.16179516178255227,-0.08237421465339441,-0.2085373639415498,0.0989209239537029,0.06420614009008575,0.09054980462121796,0.15646251325537314,0.17108360517009763,0.09671686883124865,0.2859711187995359,0.410598889929141,0.41039216067064777,0.4211029904070459,0.43491052021922605,0.3393443103985347,-0.20826777427261983,-0.23910360987076026,-0.23407129799997314,-0.1991594975866664,-0.22184120136244984,-0.23233439121465305,-0.2251347554785319,-0.18650940449545714,-0.2103226935579622,-0.18829844808480825,-0.236367476395454,0.41202590630927927,-0.04126320818507966,-0.0367493569076286,0.017667911116593455,0.2704047533845157,0.407768967937602,-0.14144122673498322,0.25646307873463725,0.19419697537048006,0.11571763448827346,0.10302879463314933,-0.027817054267042212,0.0548262269816584,0.19490364754199813,0.18684735720502893,0.2474159872402958,0.06389693607353804,0.22762559969459878,0.04589019727183699,0.12563947979862422,-0.18922001273448033,-0.029397744780649035,-0.023701357626289977,-0.09346519936866993,-0.19744443343864085,-0.1522432350904164,-0.15923147703708151,-0.23623090900665838,-0.11535395702260462,-0.15686778819561112,-0.21506451944874946,-0.07907227762354532,-0.18550058314007745,-0.13252094636478245,-0.10402629262403124,-0.20424475683741838,-0.15450911279781396,-0.1490463133144495,-0.13131413019562072,-0.048502970915362896,-0.18964574656737523,-0.1552091185127209,-0.16922572300890432,-0.14706460025776616,-0.1990480857537536,-0.2143659258971814,-0.18188305996504925,-0.06173891802896629,0.213745983379435,0.06629172595723437,-0.17338974232427332,0.0646115944394578,0.11157573394236804,-0.006359945599793855,-0.1466745943997836,-0.19498537211819666,-0.1391938420531486,-0.2642332042003108,-0.14255225407541944,-0.05185923622220692,-0.03478445083766564,-0.02425618879160932,-0.005005635448825418,0.035790340471171966,-0.02621138960973039,-0.028807187856901728,0.15010342551539677,-0.03374961100865718,0.13558242321279607)
shap = do.call('cbind', shap_list)
baseline = 0.33862031191671926
rate=c(0.3735306990397836, 0.5685086129376211,0.4741037397998714,0.538558506329419,0.4451854352114671,0.19832925409441413,0.4132494978838289,0.25933090883042076,0.34657622609722705,1.8479630508976048,0.2702082648087261,0.3104717880688158,0.16119590975716988,0.28118372960148375,0.4772287977751039,0.24100398776034887,0.37134054161137964,0.43603184388929783,0.3797049764567362,1.1821770040490034,0.41042436813566824,0.699292570876794,0.28247183618324245,0.5212899698806752,0.8605314483916784,0.13348112627142944,0.29886553999601584,0.40695045868298374,0.21923801454797023,0.14823592326962529,0.5896270649718918,0.47580475591984267,0.7475729623359335,0.711239484626021,0.6979960209939801,0.35325110355143247,0.5896800313207853,0.556752148171346,0.8364774078164872,1.260480153320206,0.6577801157770508,0.2001848001454403,0.7381592367603309,0.6314173064299616,0.587679665279357,0.4191090082158029,0.6569098442702132,0.7847304553634405,0.26731895398721667,0.6413551009362038,0.5746453562594344,0.24536522662231322,0.5683502210008085,0.6371946978201979,0.280685832730927,0.42832026072422735,1.4537237801629943,0.3489814889499292,0.5074374999068479,0.4504830334379668,0.4641747169755102,0.29192157910396765,0.5180918779835222,0.40892784899975004,0.5361053951958596,0.5629605702919497,0.3870418944530666,0.48258717302762116,0.3287961916005008,0.2115852647814018,0.1456143031491504,0.5890660384697866,1.1181535610546678,2.6346674787311297,2.634243310326817,0.7737157028279934,2.7199105823933403,0.34906707194394926,0.6437205374265423,0.6678459033773264,0.6818308845323959,0.5450857986478217,0.7669955724749884,1.1266864224971327,0.6114877289101154,1.1963918191422582,0.4985016213074013,0.5663164555699813,0.3183573832235581,0.2649336591086262,0.38196368703396083,0.381090355472259,0.40650557155344036,0.5481391156732757,0.35422698521761775,0.8161460247044543,2.648201934516482,2.395972691464647,2.606937658936356,0.5501303829812403,2.6631068955838018,2.7297541443494904,0.8052983700798707,0.7546216419203361,0.6163742123518686,2.646746425915626,0.6829182062077668,0.2499931962224407,0.2764405387157776,0.5897931963906629,0.5045981459782286,0.673786887244904,0.5978613188993197,0.8009619974445564,0.667120645277621,0.4822198005129155,0.45334708275674485,0.6100680975541866,0.15966444428473142,0.2593989570753563,0.34463605006491455,0.4943262221343607,0.39830357492718094,0.7199662139463368,0.2923420849771246,0.5625983915950601,0.4676892051617501,0.6520548725989982,0.6219602211611225,0.6020338193743513,1.2935774604142276,1.3003017584133314,1.3978495477760688,1.225136029688193,1.451613084445271,1.372097885111549,1.2338600427267696,0.5197743134447057,0.37031481377296993,0.39356712255842935,0.44722795524285686,1.4287425102844875,0.37938233614290856,0.3383774059442078,0.4201668615264697,0.5345185487662044,1.5356923343624904,0.3762206913983657,0.3477720835921824,1.475198731617472,1.4442744869010713,1.4306923509865774,1.4300844597263795,0.6030304408821207,0.7106161433591011,0.5617356728724989,0.715746435813054,0.8693962424501938,1.707581003624879,0.41263053418374945,1.4578897648390012,0.4323096989084128,0.4701522829451735,0.8359508302271154,0.6272977517719719,0.46263521841079885,0.2933717092715732,0.4568279891076764,0.1401105170456987,0.37605775228800414,0.6076003725550632,0.4637276463681892,0.6527789577405765,0.2004845010026812,0.4060466109338513)
rate_lwr=c(0.09738646927056457, 0.06692277154940818,0.08548609156121195,0.11989279993549812,0.10784313908004259,0.031015703883496337,0.11374901340134647,0.06305535225188469,0.053947472178497824,0.1539400130540467,0.04905737536035487,0.08533545937574971,0.022743414708310095,0.06617576226701699,0.06251744970188422,0.02004923640516615,0.07543820302026333,0.06597322887145901,0.020186019186199833,0.2412207979767932,0.03562436239626304,0.12638067805546566,0.05403933572189984,0.08883140298020314,0.19703983115188026,0.011731627623442986,0.04948706463062072,0.04148744672515747,0.03015022729825728,0.017918828232625555,0.23734729274695257,0.2154959733010637,0.21291503781656362,0.05389826286460575,0.23090126995911148,0.033326478960153894,0.10377354061815647,0.09881149008239803,0.16802952558620268,0.2591983381676282,0.07620827820351239,0.02238864411714761,0.23819970909094845,0.09978161974428845,0.14320887785479056,0.1217326360025302,0.254695471455373,0.2581330401763835,0.031606897057138816,0.21513014552027776,0.05948773465481405,0.06531881088814878,0.17220096064605173,0.2311035475106165,0.06665255069272852,0.13237951410082732,0.3084527920897723,0.05025387755259686,0.07732467244506319,0.019393309075197707,0.05932937420708473,0.009658247642278017,0.19950991112093514,0.10323538944860045,0.24021753385835645,0.19868687817081093,0.11140109559763561,0.2227998973128737,0.012270440857369613,0.013578001588629957,0.007992415149256582,0.23694490188753675,0.03290868376580325,1.30758547668874,0.983602014361892,0.2952584278690966,1.2402721911382986,0.012753533321955945,0.06553321952191776,0.2140248608498865,0.2275053595473486,0.2340088133593502,0.1846863357940034,0.25569190693260435,0.13334984356440147,0.25407204085036955,0.12318713031802533,0.09735488397213776,0.008043712767371036,0.049777870172129646,0.12086201230126459,0.12095479752678451,0.12652967231082202,0.050612078544115535,0.05180160105662429,0.2542616718575814,1.151223718805548,0.4591172188412911,1.2035636267726497,0.19822406901802947,1.2980209230595654,1.3642827717597021,0.3263376189175947,0.28341415049834745,0.21044050584464832,1.230853600237322,0.12997591736011854,0.04483317512360058,0.04157355105558774,0.03537969775830768,0.06560593564520167,0.12383617386348855,0.10657825165637724,0.2322063197039516,0.16993084113161733,0.16435120867308214,0.16431042681821503,0.2052708961047957,0.02322006588459169,0.05489632679641532,0.03613191384242315,0.09728470306285339,0.10590857747707039,0.19449756149530714,0.040559090110726004,0.17928229510579016,0.042576141675254475,0.12807348074494612,0.06610325028805372,0.033563215507771194,0.07060253830267077,0.2630435119267236,0.3386196648656974,0.2425824723264881,0.09823809813268744,0.35080138823844065,0.28460100103044567,0.056173387503874905,0.06678057405786453,0.1357399163086396,0.08897141263317199,0.484331784894548,0.14024997835234154,0.10564672035124018,0.14500303805636314,0.12542492303150948,0.4413158397082637,0.13790064733910715,0.14497397159290187,0.5282385191814817,0.4573488737797111,0.48140848201491454,0.5299790227424617,0.13883709705374114,0.14142596815409883,0.1126182700459219,0.04021621918832968,0.13816489149995057,0.3951534120956096,0.10308158062369296,0.2800542155362838,0.08825573031892009,0.06696578335815068,0.13518369697872,0.181773981954361,0.041192375115080726,0.03254507660840528,0.06657893751301436,0.013950827633820106,0.07963747353783188,0.06050999706379573,0.14452516050271874,0.10501186382947236,0.028038951318516636,0.0861877444399956)
rate_upr=c(0.7125832712456185, 1.5113756715923794,0.9064899960064803,1.0883172136506534,0.8731844905749944,0.41929383992704794,0.891325165163974,0.47364602136867445,0.6896347710000217,3.4208598861810766,0.5729761369617263,0.6291766867291879,0.3373443332444471,0.5547345237424774,1.1639892674159622,0.5654913042913855,0.6882727005647525,0.9517430637190787,0.9965268025261801,2.428632253638964,0.8992709082285647,1.5394653735380186,0.555735490004726,1.120420271258898,1.8304126128858171,0.31116742275587933,0.7642523331561377,1.0562109470991343,0.5192678620333706,0.314595912425385,1.0336588798542266,0.754211756510856,1.3783318762474315,1.540400258003571,1.2459124495537344,0.7334184367395211,1.2340192176162752,1.2145010789793935,1.6317966199114533,2.4688594378647153,1.4129188768616165,0.47569118424137424,1.4508666458786814,1.3318138523042604,1.1083640761977114,0.7789540948360658,1.2298201009779821,1.4781398898599825,0.602097925975061,1.1583399516071118,1.3737243742010248,0.48407668280743577,0.9963461632757524,1.1276272406227266,0.561864941807404,0.8302900059934974,3.060177115723056,0.7004373521316862,0.9811964120096309,1.2355069691565062,1.0311958720564474,0.6949127032387274,0.8889696772398674,0.7054140772032026,0.9118799632424539,1.0229369897992848,0.6837771217858803,0.820368748696087,0.8454055266033529,0.5431890353318506,0.36958737524954666,0.9794257799612768,2.5519935112294956,4.294433967969504,4.609954617141954,1.4504360193377281,4.388140092657517,0.7757977570176966,1.6440526470032235,1.3195480320238542,1.2318651776711895,0.9852593492797668,1.428780663535107,2.3283561936761403,1.2563854634807394,2.5241682216713306,1.019148715589179,1.1538926398520386,0.8429186945972533,0.5188808082677565,0.6708797181045307,0.6729979794918803,0.7033609063910692,1.2971808074064715,0.7705756666712744,1.4882024030175187,4.3744390671092,4.321882235715504,4.248492334482584,0.982856902257602,4.347842406555657,4.617648750730735,1.421854154272481,1.3669642361553695,1.0973939777357629,4.282883042819276,1.6413981356554352,0.5378339908899066,0.6128446541877886,1.4426277164038765,1.2279227558210768,1.6023308305647337,1.2627094074054526,1.5429954334384888,1.3033817245267592,0.8663378299207232,0.7983547461356781,1.21782901461281,0.3379362795428741,0.5269946680533454,0.7681916906969481,0.9701875523693466,0.7514469068655621,1.3814757022868516,0.6490352804332138,0.9930168696770189,1.0823441752289615,1.276213152997893,1.404818598302344,1.6405622950400802,2.7480762633594704,2.5047294413877035,2.632069312339331,2.467303698556321,2.8235633895164414,2.5757627624168276,2.4956329769210095,1.0814839945480323,0.8109364224142983,0.7338843378085429,0.8815257932750801,2.4484175169304074,0.6743132516809076,0.5755790021635953,0.7432533140248683,1.1805189868955586,2.74262880077131,0.6348976315725441,0.6161546144655614,2.6028270381541,2.4929423220660345,2.4998896736786347,2.468249728031413,1.2242530357176402,1.485066538089789,1.1022723884503685,1.616486176548774,1.9151949787557658,3.0379059467400573,0.7972643358443973,2.8440749182052603,0.9013379247267694,0.9185664880189067,1.7252676620637892,1.2883434510844405,1.0457919030407201,0.6517250040379443,1.1818683964201724,0.33325519151675825,0.7464244507085118,1.4597161071995253,0.9227397609250484,1.4913468116252306,0.4241279704909845,0.8261311833748053)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.88884247356902,12.543329772332134,18.452723600647822,11.389842614526929,11.754396453828296,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.979848282645456,13.509885309719447,12.762457973341409,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,11.610334918074667,10.928438777046042,19.116662982107215,19.495450853775065,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.605621306249663,20.328662959325403,11.825381067878618,15.251534849631417,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,22.420853396189166,19.736359940155797,17.601246343925673,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.474087405781923,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.141457947420491,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,21.561787314255916,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.699996492444631,8.672663178421974,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,20.39513914855202,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,12.762457973341409,16.117700075515444,20.783073207194157,13.644381033687072,15.307996387031654,14.445304095555281,9.062465735197444,10.647178292822375,22.72199624767148,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,7.629996531354187,12.685450981781905,17.04717817252226,22.62499624949477,12.543329772332134,10.058496485705948,12.685450981781905,19.776150149198095,19.555996307182443,10.704829806890222,11.754396453828296,23.05817805953415,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,17.990150182769337,22.72199624767148,21.1276885853318,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,12.89213279607875,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.060771091445902606, -0.05869921047264396,-0.06390396258176763,-0.06393820796461114,0.05354900230043159,0.05375921946649573,0.05502479210289088,0.05313470346488378,0.053790325001060416,0.053664682409292536,0.054960022616660865,0.05373949226784836,0.055165486777744674,0.05514362256445629,-0.059145612968870664,-0.05738377217633107,-0.08101064451797406,-0.07790931697826041,-0.06326139027829637,-0.06254306480268867,-0.06269876848706117,-0.06264071249892253,-0.06282883237938733,-0.06320918627724438,-0.08594023403453271,-0.08525457009584454,-0.08554270987255898,-0.08546444036809002,-0.08545032456692794,-0.08607065130570019,0.10409706269294075,0.10159781120592827,0.1047296171580498,0.10495545043477152,0.10510261030290872,0.1024687346539799,-0.062315805132424795,-0.057635958420691275,-0.07592028226022224,-0.08028775206506102,-0.08050305532586141,0.016140118337063282,0.0007775952791276917,-0.04622385939645711,0.027557238768985196,0.016227926772136646,0.005459041499783477,-0.004299579788926835,0.016059249664573123,0.01607938337990016,0.029093913073222382,0.029204100802286678,0.018081410988726242,0.01138069271437591,0.018188988577606268,0.02370622792887925,-0.059175525654470776,-0.06406048572473012,-0.06396612152318684,-0.06432700823802275,-0.06395762188503297,-0.06157817462477826,0.10284935077559915,0.10494365016630262,0.10412763125452365,0.10307975256424019,0.10494365016630337,0.10327689842827556,-0.07127709490535676,-0.07086183129360484,-0.0703168617665617,0.10495862238986155,0.10752017447281866,0.10725320919531497,0.10758776501366704,0.1065451907032374,0.10732050984056332,0.10662437894144014,0.107627026092141,0.10752344812334966,0.10620106106651854,0.10311686133275214,0.10756209682314266,-0.07213452261852958,-0.07252463377837769,-0.07255864453392982,-0.06885926812778291,-0.06869251892007117,-0.06890003577251615,-0.07609655045230762,-0.07551987476194875,-0.07563389253425785,-0.07564749767294068,-0.07748411136968854,-0.08168594266371142,0.1087748303858091,0.10882162230128278,0.10867224260501722,0.10835687187706858,0.10471414300927001,0.10883742911757752,0.1088371229590366,0.10766288378942002,0.10663752583105869,0.10451853027792454,0.10851554913701264,-0.06953991043912076,0.07337069421403868,0.07351926286597672,0.02919543818694804,-0.06879694297345515,-0.06816368209731621,0.10311803407253618,-0.05878228426255233,-0.059286518007359276,-0.05940055132512167,-0.059580769312761364,0.0948129408916274,-0.07995641403251426,-0.0794020686458877,-0.07968667321853491,-0.056945503867811734,-0.059792222482159055,-0.06118273580857568,-0.06115733073376015,-0.06120644106641344,-0.08347687578357472,-0.0828260489896962,-0.05775803706295192,-0.06894208288220668,-0.08632423824108698,-0.08579635897347229,-0.08582715273713953,-0.08660769948671841,-0.08524426841192564,-0.08570164307602392,-0.0865061457113927,0.09613557666408176,0.040386440617432684,0.04262457702248623,0.042531850021331176,0.043720347300956953,0.0428981914963022,0.04317965116123821,0.04264222716470275,0.04201047680080523,0.043629497863257496,0.04318698576040264,0.04294089327973173,0.043197104795011376,0.042697052647307,0.04375461288718574,0.0434472629564012,0.04017174785562026,0.032288721556329086,0.03293538694162206,0.03360127142863378,0.03216815876644276,0.0329456327162085,0.03292142197486559,0.09793089148974651,-0.08594264646602158,-0.08535308500469349,-0.08612749762591124,-0.08520695236529828,0.09321328269955038,0.09313337374320942,0.05198507439770224,0.051835980745670626,0.05167173249375796,-0.0600739516856846,-0.0603426803459082,-0.06807347486128096,-0.06852214463590106,-0.06811646422343177)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.035531506202824005, 0.012558934090319123,0.015538404951364812,0.015558096845103174,0.001447918672721813,0.001461330948496384,0.001546622277989593,0.0014204653222144661,0.0014634390228889552,0.0014548869470893831,0.0015422989241964092,0.001460117864033572,0.0015560362678194467,0.001554505093625614,0.012772808004019491,0.01185339667273163,0.10509640012256648,0.09571616753808483,0.03915782831691092,0.038106715660519465,0.03833796749709141,0.03824779647357925,0.03852530498724913,0.03908061273130139,-0.20172358968858703,0.12023067576960507,0.12120784197571864,0.12094455351740703,0.12089827631604519,0.12298312129468825,-0.008187800228807012,-0.0077148853826122755,-0.008306282809406679,-0.008348688752335751,-0.00837631286016851,-0.007878642502215672,0.03994586986245788,0.03277101105819539,-0.1468380519056333,-0.1705744959979762,-0.17165593421711406,0.0052122106781146834,0.005481111603193069,0.006061480110712965,0.004710533140894737,0.005279439636039715,0.005341996121590527,0.0055404448462307914,0.005149976178995048,0.005165721533349886,0.004741748097513179,0.00471948623292778,0.005095659706847861,0.005223590569097145,0.005167857359422702,0.004888180869561156,0.034477408425258996,0.015629148605604506,0.015574560775762386,0.015783470894948994,0.015570033899717431,0.03869659686621434,-0.00795559523016167,-0.008351093020414613,-0.008197714711831647,-0.008000586523451446,-0.008351093020414539,-0.008037250078035383,0.0561420794492949,0.055372026885768845,0.054349774131544556,-0.008359685464379103,-0.008855090286176268,-0.008802738811492855,-0.008868234727519839,-0.008665849663364656,-0.008815749852274622,-0.008681116402737726,-0.008875871341797521,-0.008855734033407383,-0.008599243600480271,-0.008005156941039666,-0.008863245708897311,-0.12590157467495527,-0.1275161760454698,-0.12765719281379592,0.051664487550675896,0.05136945107523478,0.051736565113489064,0.08900998655625635,0.08742140613321521,0.08773461923104703,0.08777229801468994,0.09374305838328444,0.10718262550538346,-0.009118240407563665,-0.009127478866400354,-0.0090979692039674,-0.00903569121823247,-0.008310208907543172,-0.009130602544144786,-0.009130539878834942,-0.008898791432045514,-0.008694953217619093,-0.008273588148626184,-0.009066892331789667,0.06914139564048252,-0.0023846415404180847,-0.0023960359595860082,0.004780911928862782,0.06634784888755166,0.06490974518199871,-0.008002620610809344,0.01258800807920548,0.012845914188259182,0.01290479347916698,0.012997383440156066,-0.006427704860346947,0.1018754760718998,0.10021513761390441,0.10106665299893113,0.011619053118630393,0.013177369335956554,0.013976018488687797,0.013952182914174714,0.013978580435227534,-0.18795869951702424,-0.18450642724489477,0.01202109933768712,0.05179193940320445,-0.20408583487692328,-0.20113236256223432,-0.2012969439107301,-0.20567223895400338,-0.19807398603058912,-0.2006041265053719,-0.20510430987795247,-0.0066742372355149855,0.009805310393813261,0.011239432295204006,0.011181748797405003,0.011948412367892677,0.01141672835570653,0.011599678154167048,0.01125040654635418,0.01085592727298892,0.011889893119258036,0.011604318352697275,0.011443524760872086,0.011611932824106889,0.011284698603052168,0.011970472943611933,0.011772459855287564,0.009682527878640634,0.00480631770599466,0.005152674701584214,0.005447784774897467,0.0047132590082452136,0.005197544151217756,0.005100939847513525,-0.007008755862158719,-0.2017355851427217,-0.1984624923945392,-0.20276111327249025,-0.19766243557482374,-0.0061200780324759405,-0.006107727448226694,0.0016459238135760374,0.0016348094331138556,0.0016225157752394904,0.013262504729335997,0.013403130471230915,0.05024140981815653,0.05102916183724633,0.05031635332167034)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(18.205000000000002, 14.895000000000001,9.438,9.438,12.725000000000001,6.2895,9.438,9.438,9.438,3.09,6.2895,9.438,2.1900000000000004,6.2895,14.895000000000001,21.735000000000003,36.3789485,25.565000000000005,9.438,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,12.725000000000001,3.09,9.438,14.895000000000001,14.895000000000001,12.725000000000001,9.438,3.09,4.4665,2.1900000000000004,1.2904999999999998,1.2904999999999998,4.4665,21.735000000000003,25.565000000000005,14.895000000000001,12.725000000000001,9.438,18.205000000000002,18.205000000000002,31.0,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,25.565000000000005,9.438,9.438,6.2895,9.438,31.0,4.4665,0.4535,3.09,6.2895,0.06885,4.4665,4.4665,9.438,9.438,6.2895,0.4535,0.4535,0.4535,4.4665,0.4535,3.09,1.2904999999999998,1.2904999999999998,3.09,6.2895,1.2904999999999998,12.725000000000001,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,18.205000000000002,31.0,36.3789485,36.3789485,36.3789485,36.3789485,36.3789485,1.2904999999999998,0.06885,0.4535,1.2904999999999998,0.4535,0.06885,0.4535,2.1900000000000004,1.2904999999999998,2.1900000000000004,0.06885,31.0,9.438,9.438,12.725000000000001,25.565000000000005,31.0,4.4665,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,18.205000000000002,25.565000000000005,25.565000000000005,21.735000000000003,12.725000000000001,18.205000000000002,14.895000000000001,14.895000000000001,2.1900000000000004,9.438,9.438,6.2895,2.1900000000000004,4.4665,4.4665,1.2904999999999998,6.2895,4.4665,2.1900000000000004,6.2895,1.2904999999999998,4.4665,6.2895,1.2904999999999998,3.09,3.09,4.4665,9.438,2.1900000000000004,3.09,2.1900000000000004,4.4665,1.2904999999999998,0.4535,2.1900000000000004,9.438,18.205000000000002,14.895000000000001,2.1900000000000004,14.895000000000001,18.205000000000002,9.438,4.4665,2.1900000000000004,4.4665,1.2904999999999998,4.4665,9.438,9.438,9.438,12.725000000000001,12.725000000000001,9.438,9.438,18.205000000000002,12.725000000000001,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(4.0, 2.0,1.0,3.0,0.0,5.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.01873127778222467, 0.015228127204607814,-0.012296579672114564,0.00913327169111077,0.1398894205913243,0.27140137364826256,0.18613965250735007,-0.012346250727106378,0.20092695665303945,0.16845858462584293,-0.023572278407082488,0.26809604481011867,0.2517900398238817,0.0481830944517158,0.10841373974192386,0.03212246980961978,0.13277155920179398,0.05946814966894089,0.030143057088214107,0.028799250343087376,0.0728154476826688,0.04221842527394863,-0.02408454845245363,0.044964516238704094,0.09616105668596507,0.20646674792946862,0.06443548278836456,0.0395754279189928,0.04166948504887478,0.0648945263235314,-0.26406995335099154,-0.02799813813979078,-0.1975770294980713,-0.2083882261764797,-0.17558084228307577,-0.12823308321607732,0.034724854930143385,0.11747667227755097,0.00324151214802874,0.002949146630265787,0.007365612890469097,0.008082533644917657,0.03777035003471058,0.03698447375000193,0.01248564672222081,0.031214999047532506,0.02798868404293994,0.03519591517756664,0.08606854840280422,0.0332330255269837,0.009408702507457612,0.03275937642071929,0.05390170772919319,0.031288585873600165,0.039297560808572565,0.06840372528150923,0.053480679388457006,-0.01630759451024678,-0.023689896693796633,-0.023240942774478985,-0.013039168216570252,0.20708828850046188,-0.02787030801351068,-0.04957866965059136,-0.23498333261470278,-0.027033599545216405,-0.056380016887252284,-0.03972307074579115,0.17434524082449146,0.034739425209805865,0.04405978602113281,-0.13252342896185948,-0.04134967004540294,-0.15276590201838502,-0.09650263859443696,-0.15253285605702332,0.007799056153074952,-0.12179459084600043,-0.14085314124808826,-0.2794325006309858,-0.08464315397461036,-0.027139489053285688,-0.3095440797945983,0.02146732895005876,0.003928499592683953,0.03729806101713215,0.0317567964840858,0.011218693133518427,0.021718344081528323,0.2576311148333996,0.21423826654557687,0.2603886829488733,0.21580308929306696,0.1247205487146833,0.14649149579780632,-0.1543990591365734,0.033252173070533145,-0.0610620981476983,-0.21896161444318873,-0.20045292489484012,0.02680940809549384,-0.15522918109438047,-0.3300963073442495,-0.14385528777153733,-0.2850769706728733,0.05729312100653605,0.3309244804280662,0.03109654761945231,0.04375577530832299,-8.718649082853999e-05,0.3727667030041889,0.33641137177397806,-0.10207078785558563,0.01220754569040157,0.03153425256228602,0.039535457074915153,0.021417460736152312,-0.021403766045821986,0.0788114640692995,0.09460252974080513,0.05986371314761839,0.023169534465598,0.01888111889665264,0.005600576007462732,0.02329581343613001,0.0065253178444731295,0.0032658408653093436,-0.007966098080078067,0.03359778383985319,0.0791284847740857,0.14115662676792654,0.16800272746386788,0.1274651455879171,0.13062682444037893,0.15944126725126262,0.12508808978804883,0.135611257819592,-0.019719429291969248,-0.06793531927638688,-0.05768479874660111,-0.048485775748865756,-0.04248411132655069,0.0635019211473566,-0.03182358353421291,0.06290485826659636,-0.011120329117631491,0.018419587506286562,-0.07988864617722403,-0.0500189615564804,-0.004904243924053273,-0.01848026779479169,-0.008715688874126923,0.0281176494852398,-0.023385366551591152,-0.006685488919489304,0.004765987103370879,0.11935149986896325,0.0312782793230601,0.028330657984996264,0.13229751894521655,-0.04846907925604174,-0.01627179318339115,0.0018790742176635227,0.09020749406131376,-0.028973044326809836,-0.03018182626228252,-0.010371216147322409,0.0020854134048576586,0.014131757459493278,0.011090385832551515,0.04660663118298726,0.0007571550276129611,0.0302100529202364,0.015374354135415855,0.033385935114476066)
shap_list[[2]]=c(0.06095089002900838, 0.09286120379742295,0.22434374390789202,0.30642625388838474,0.18629841361160773,0.37354783642984446,0.28468975330329277,-0.024549738878150915,0.30492897407772085,0.2981572843031298,-0.025023102926338445,0.37750672853805467,0.3681802194440002,0.09842894816133774,0.1670333399254077,0.08220411025149375,-0.08782075277879275,-0.08156501580923044,0.044305931222349666,0.09889151345103468,0.020445621993862205,0.07053379039321085,0.042589553244097134,0.06156928790818906,0.22217989012197184,-0.31030742632739666,-0.09076037775465173,-0.055104031554933285,-0.0753552631797293,-0.0911691133675518,-0.07367568863086732,-0.02743459373124507,0.10419131359357914,0.06159921278456209,0.11175389994453086,-0.06705489945374661,-0.07068486254641268,0.10850813160244052,0.17596549232708453,0.1317741617697149,0.1548690294271363,0.058343844797495506,0.08365589101402254,0.07657906020048127,0.048202839402002214,0.07255075821797077,0.06445898575194615,0.08175258077962942,0.09047033807911951,0.07434296413663674,0.1816443245257422,0.11863650153072496,0.13458097707548333,0.0673342318135503,0.11429337132410602,0.11111200878531188,0.0666220760533449,0.15626898881237855,0.17215622800837163,0.2661465546365194,0.10830357805486379,-0.06577770327824632,-0.020899561062085514,0.06598364596318779,-0.035808164060147474,-0.025133168791078887,0.062493277338374724,-0.028614813117977773,-0.20697998901624723,-0.07746567171081113,-0.0708815470543565,-0.03554289426063817,0.018436960029003517,-0.15151491585047205,-0.049387105313517185,-0.06438166568932739,0.033108733869610704,-0.04847507659215888,0.07020075650457377,-0.045089514047913004,-0.03618615828063602,-0.02823723782353807,-0.1023089182657768,0.21835758389505605,0.18976807156045625,0.2489734033446299,-0.06955952965582847,-0.05776221983443976,-0.04675189399762737,0.12793522557354517,0.08709429912436376,0.12905761111364952,0.0877400891411352,-0.073252894388089,-0.09068444415300443,0.04463123912652393,0.11980640953253048,-0.07894908645020496,-0.17436878439519388,0.00037866013896566266,0.05637822899990158,-0.05682519800269522,-0.09192441133865478,0.09438071904412715,-0.09814067118985512,0.06716793826290314,0.2951774072335659,0.12022217178029397,0.18210108814292444,0.16738251949219146,0.3283871994247038,0.2960766202148997,0.40583019629434186,0.12073898227556977,0.16341551808503632,0.17537141489423097,0.14413323941027892,-0.024460066225112972,-0.08418371480737798,-0.12378610898402254,-0.07979100304388612,0.04036816928654398,0.13201847454813923,0.114445637668995,0.19130546553947753,0.114065607653151,0.21532016178845337,0.17318861369455696,0.3309418474991141,0.03307266689075635,0.1811939973562837,0.10018022320527907,0.08516737276508451,0.15278790074605597,0.12139591857287531,0.09032791060660814,0.16115430889574364,0.11848811419770207,-0.07683763612265741,-0.09087177774555148,-0.04300031430380676,-0.06141321433101546,0.13845331561410623,-0.0740504526065484,0.14182168428620254,-0.026727742328572626,0.09147516251614032,-0.08929490876680393,-0.06042836712565835,-0.02820407585498939,-0.07630444070863782,-0.06465379569434626,0.08618099424010507,-0.0453484946467021,-0.02882935916730347,-0.019461718478616562,0.16028785806347431,0.012276352963381209,-0.037948436664155843,0.1647213869063463,0.06354347192920626,0.026114574075372397,0.04116246064068819,0.2018968203032627,-0.021903870974488877,0.1900245679782542,0.1392078311660266,0.19865607611656846,0.08004317264877249,0.08836884074716136,0.3152351605010056,0.21252424840087142,-0.04863418146910201,-0.06673984681193579,-0.06944317167353396)
shap_list[[3]]=c(0.13682723438483035, 0.302008727470984,-0.1542299990425796,-0.11803735187871929,0.024377133440309597,0.10681165658069068,0.537342093880062,-0.043463707756304065,0.5534781787520645,1.5854173880609603,0.08687929107784971,0.07580531907752691,0.02153347360778744,0.2689418168971102,-0.03230073361704308,-0.10233676432146926,0.10527363869946343,0.08681270830102582,-0.04477405142862219,-0.01114857464515015,-0.06272224048074503,-0.020707963990296473,0.11644184656665874,-0.05302554853374935,-0.04204502904486368,0.4215757166645691,-0.03021358985120028,-0.02199503854065207,-0.03302708648629947,-0.029163911689164414,0.34006143048845333,0.11363416991161224,0.027424372950506332,0.06996008514585424,0.02622424379430315,-0.015343277299869734,0.11601336303842592,0.18861846203542018,-0.19504216017069492,-0.147833983378311,-0.1790071219855378,-0.08217402098739846,-0.014031443462946573,0.13357719304955895,-0.026395340547104372,-0.0344824084745974,-0.012102291680142903,-0.008242930811106714,-0.018567902842753687,-0.031209627307751068,-0.16275536431296472,-0.046786438409442486,-0.046766911687397474,-0.02125758734853173,-0.047570819426910355,-0.039493756977014585,0.04922972283883536,-0.07458010282608005,-0.14499731713341904,0.39188127355816743,-0.060074079714692245,0.15811426839971765,0.1328974834723711,0.3876325229579625,0.4218666193349683,0.14050482697919503,0.3922515144512494,0.15909414939699693,-0.023124535937978096,-0.01645751497828393,-0.01831952627243092,0.31261143521975365,-0.01702056646970325,1.3817007815347253,1.1082967089637126,-0.0736710300022417,0.7983777747426125,-0.2789515314768895,-0.6834950892633289,-0.09984255696776716,-0.056666152085397534,0.13482244086737663,-0.07167736912608436,-0.11112908087187372,-0.16693368471936126,-0.08894071547728254,-0.029006697910981497,-0.02086890603310023,-0.1277600130556167,0.24589029373845847,0.1831101279077768,0.24894752354214306,0.21238172139558195,0.09972167549732797,0.10786179367418419,0.011949301436922025,0.7769334086296936,1.1515776752721385,1.3617576167565328,0.44533784632887685,0.7961938191450301,1.3596159740510843,-0.11018927011396269,0.022096190772801883,0.35538030268308324,0.7921146376090283,0.3841494567229162,-0.044580561532249756,-0.03509980938017449,-0.08491473897145052,0.42888012876065745,0.3887257439696862,-0.02206255649951937,-0.05263372242214747,-0.08165477739433197,-0.08230720241654675,-0.07252888240287865,0.10749297795404784,-0.041994977726509085,0.12345306504982545,-0.04136341962287945,0.15258026220027907,-0.06727237692985379,-0.059711891467965114,0.2289310723270346,-0.056315336026456435,-0.18011125408769083,-0.20748527423303958,-0.08877700035896363,0.02557596189212533,0.10124619494247716,0.15799505594485425,0.17542445070431892,0.15859734990592725,0.1380273598471881,0.17985907971162976,0.16142551949894057,0.19283431307955723,-0.11442088517236185,-0.13263961576860422,-0.08317282960966249,0.8986906337519333,0.03050558224534969,-0.13536598487314958,0.029386940013432967,0.10702725801694665,1.0205286737168564,-0.1349081748516876,-0.08165334135888903,0.5530416767852834,0.8916277554755432,0.9098623095957152,0.7703783426988411,-0.04618418876098822,-0.01853034434479601,-0.0028826772808327504,0.10474314932837411,0.04892950831488151,0.7188507889384133,-0.01517248509209116,0.6292173531169555,-0.21073662463786436,-0.18731405442009336,-0.03938672308137231,-0.19718802833066024,0.14656311696077057,-0.07410341736417021,-0.0355122280195842,-0.06908028117446913,-0.04504523952497177,-0.0893127676477175,-0.15156893170657393,0.12196160411247503,-0.028717086278816886,-0.02721401507449252)
shap_list[[4]]=c(-0.1116918112609992, 0.02549469427351701,0.0574073433264844,0.1965257278404084,0.2595341469836087,0.47930107039806885,-0.16029414517976265,0.011024798530549001,-0.09092008591310027,0.2503920302617397,-0.06156956252847981,0.3474606121845379,0.1679024272303083,-0.07506474936757858,0.04318429540511358,-0.04557647179838147,-0.06289010284598756,-0.0547405443380074,0.07377692173185733,0.04378958605968378,0.10193473171443698,0.037448541067746415,-0.1336638486250801,0.09098227318628083,0.032643687911296904,-0.08460149900410521,0.0765732737333977,-0.015840130355636074,0.028111757486007364,0.08079311829431415,-0.14147187408090453,-0.05274794177961181,0.3170452331105296,-0.3058812403052866,0.2509475393713964,0.026028471069971904,-0.04905207774581866,-0.10386947188430491,0.1529128741899697,-7.922876744511948e-05,0.07701185826639687,-0.010595192882969584,0.02464440582889539,-0.10871996036865414,-0.018545598405740892,0.020890168157812007,-0.012245485855323536,0.01007253952723411,0.051836001233097534,0.03142694270962331,0.20378939478321592,0.06792429247894485,0.06896025627082111,0.004958675472972119,0.04973945161539796,0.09901047464488316,0.022793957757319804,0.10282946882616584,0.017082716741417345,-0.07035450520942126,0.056506707379711224,-0.10168255822217143,-0.05065010117989535,-0.11234594486023548,-0.08413988707914694,-0.04089616653704141,-0.17092251601673716,-0.06309758930554638,0.42263195165600825,0.046286145764420285,0.008710253297125756,-0.10486578218956841,0.652279772609938,0.441462334319699,0.6587020022830917,0.18602105326174379,0.37625988177293157,0.1162618647097577,0.50936995229975,0.3547341879064178,0.09348352783111519,-0.0443502613796097,0.44465697948154026,0.03611156918386175,0.08114548600956385,0.041762667952618814,0.05452758703378176,-0.00507331844828868,0.060931915564135866,-0.09261712406817944,-0.1057534467568852,-0.09120829196746663,-0.08917074108927084,-0.053610236467423036,-0.05919258225761919,0.5495396082663885,0.3287803341754301,0.910925987807405,0.39743993338215605,-0.04054771005884065,0.3332384533714449,0.5028810750427701,0.19344443501452924,0.46539081889836353,-0.11268725722441021,0.32841883406871575,-0.06511613465416616,0.07410645624268757,0.11622395733585374,0.037748502621162985,-0.08061989162925916,-0.06632399735421675,0.14928557181959293,-0.005699706579160623,0.05141104311260381,0.07743288080497195,0.02920390155079365,-0.05376683615931785,0.06625462562513768,-0.0643309274531049,-0.0024297644743210816,-0.09028512681610569,0.02588014896754954,-0.012047425996996096,-0.17266688561541707,0.005495109876009924,0.004486052149553067,0.059384372620137224,0.26760154068221015,0.09287383003877793,-0.08816926575183115,0.23273904129657622,0.21879101915134763,0.2649694493569989,0.19884310219305912,0.28241606752775755,0.2855021929319742,-0.09306370481563965,0.33493772705859504,0.001294084123073137,0.0019857123955675424,-0.4272795993855689,0.3132972363792994,0.2344941752689545,0.30006685046058434,-0.05350133871860116,-0.1784229377930502,0.23877588154552842,-0.0007296460497210759,-0.09198631235337784,-0.4295249244359008,-0.4059741139520186,-0.36838157587529163,0.04965244598532212,-0.007594231883751938,-0.0027891442382526675,-0.15259508277552553,0.048850904320278055,0.055556315818854125,0.18307836695441057,-0.12291176724294617,0.3069496756097399,0.41236034443027214,0.023174702488628164,0.06749753091333574,-0.10647572230335642,-0.0338373082754171,0.05683194388939771,0.023542731923617527,0.00942623942927628,0.26916203778042647,0.07720504668029839,-0.031779385336351114,0.02212025700253243,0.06915956338710358)
shap_list[[5]]=c(-0.0974451976274318, -0.12608247691884225,-0.11737188948684801,-0.13779480704538924,0.7318275259374548,1.5796159583702742,1.5513840692912015,-0.0791320645305571,1.624728478545615,-0.23426573729161534,-0.08537120194660822,1.3928197000165685,1.1926581301500654,0.5124962701323755,-0.11427012428132871,-0.08403634499793877,-0.06907869038067863,-0.06880682710852593,-0.10437610223161516,-0.10208036793574753,-0.10196059072577125,-0.10067121859168955,-0.09462712297630728,-0.11486513192699715,2.931571779653917,0.9538380677757496,-0.07842262098278997,-0.061961456912764085,-0.06774757474847977,-0.07886013187485508,0.7448553818615012,-0.08848779765722617,3.124847619486915,2.544079364845115,3.1261230781126192,0.6331005848994143,-0.07987220556284447,-0.10050399164184634,-0.12723307417200247,-0.1114856586796976,-0.1165548155942844,-0.07884818611107171,-0.09393473257855006,-0.09062001644625292,-0.08086356011946683,-0.09368049072817675,-0.08440182460997547,-0.09216531642107956,-0.10204759917900072,-0.0925507267146246,-0.11402103408607007,-0.10531793447984897,-0.11110434415080958,-0.08752280958598582,-0.10183678381228822,-0.1029438452831824,-0.08780118152892073,-0.12089820830873375,-0.10330453063175658,-0.1492651269075279,-0.10719047870948269,-0.08410416972134237,-0.07841323619599669,3.0330639953772973,1.114469377507243,-0.08248166060591922,2.9845210455089686,0.012245778241196454,2.857946224137958,-0.06697015031078014,-0.07604304571733998,0.5337985223131678,0.779455597317315,1.232118879256694,-0.19090959047007966,0.3387203326178738,3.110915479911751,0.4886988343396274,2.696181644055669,0.7838741041252791,0.1330246230736638,-0.08627061186775058,0.9215381155696898,-0.128388192325728,-0.12515097857416055,-0.13248040489925406,-0.06939500869959034,-0.06433320741465139,-0.0657887494039445,-0.09521400647932365,-0.08205802356265321,-0.09590256156412784,-0.08969237415898311,-0.06739811436149942,-0.0693277780656281,3.070263382616921,3.17537228781794,1.1190624134008504,1.1762364750696521,2.393518978860144,3.169170885100975,1.4180601786514908,0.8467272046324028,3.1670083158912608,0.7332672405073151,3.174710438940725,-0.12341564938501279,-0.10880777241669053,-0.09370195784756227,-0.09629271084640414,-0.13202802962881582,-0.12433890588657086,1.0674309144791883,-0.09104716477976699,-0.11295325906610847,-0.11751399937800583,-0.10354086749719602,-0.08868321390391797,-0.0769220742856576,-0.08012155371151267,-0.06859512196740401,-0.09682707114583991,-0.10253241076760139,-0.09674962644551163,-0.11713146316429192,-0.09526635996320204,-0.12386634330830917,-0.12174264378180995,-0.14309979996375602,-0.10871883119082824,1.0292011728407342,-0.1399173533830184,-0.14356831273668696,0.9966848333600126,-0.13693450277926852,-0.14611612166722227,1.0056780993642307,0.18055820624231728,0.908055218497615,0.6805542856065269,0.7686535048958664,1.0294453338443892,3.4735018421573773,0.8762212978651722,3.4701901186787687,-0.08227821407882213,0.5900148768741558,0.8737657054307719,0.3007509400096102,-0.10228806490850616,1.0088537989781106,1.2489101260643702,3.0313002949221555,0.005351286479614744,-0.0671553881066454,-0.0728913858774107,0.9388212533754816,-0.08015741566944765,-0.1522080850574245,0.8234756040109047,-0.1366048028025208,-0.13147736430983772,-0.1364906405289999,2.906386056141381,-0.10489409362578103,-0.11307574210021853,-0.08392793748913623,-0.10517317772101702,-0.08954673664557004,-0.08911181717111868,-0.1437670649897447,-0.11832358070341087,-0.07987874598710437,-0.0742900996265044,-0.0850358765780242)
shap_list[[6]]=c(0.08670445597582827, 0.16889576133005985,0.0952568771702686,0.1507864703692146,-0.01952843826632087,0.026543283952841307,-0.01731751816799406,-0.06087703015204126,-0.012014008972080424,0.014588899339043055,-0.06034840257194579,0.0164858481444604,0.013823000894916428,-0.04051852708147894,0.13168164883165562,0.07418827101133267,0.04032792077746051,0.040469405727063965,0.10500991291349046,0.11766940017849628,0.07610749228298741,0.10881685861291304,0.08479184976081455,0.11269380191973341,0.1657543071073764,0.14787903083084142,0.061878324095016535,0.04087235876526141,0.05052675806295554,0.06346637831087004,-0.1727839176850433,-0.0420440891572117,-0.08440022701015697,-0.11225633511019045,-0.09555202530282945,-0.13110142526860455,0.04828970398864958,0.10617902036916724,0.09626166548222062,0.0647646352054194,0.07363907418662265,-0.028643286210206318,0.01865052001263755,0.06021751145778923,-0.03633903874233507,-0.01616007259260955,0.00033321890169708736,0.024829115900683287,0.003233988995887789,-0.013706460594516174,-0.055265176547594816,-0.034895362309979965,-0.01377913401466589,-0.007581336242839778,-0.017575977982260533,-0.016631020078076493,0.10892344528807046,0.0944894343731656,0.0761898894484203,0.19565402402227663,0.09584065485928576,0.04810625968413115,-0.039676505707494925,-0.1290796303357529,-0.18577563961541652,-0.04224197508810698,-0.12936938329516942,-0.055088832153004245,0.1262139217385135,0.07357059128859318,0.05482900004053388,-0.13968312323430443,-0.015242579581118389,-0.1866580221012364,-0.05677808829057537,-0.09348916574297796,-0.062112258112920885,-0.09586196026706643,-0.070668414120872,-0.17199342526469671,-0.06596182126883203,-0.04345858663105729,-0.15097130062590883,0.1105428845250469,0.09884146003603976,0.12297931885144532,0.06618557699033785,0.04827649880815018,0.052017019059949654,0.09304096202016061,0.07485664947956361,0.09343254484735308,0.08179620685645195,0.037996015426926,0.03970844106277364,-0.04792298946680036,-0.0686979524656353,-0.06642121416636296,-0.1926121788046303,-0.13915083630591082,-0.07302378341219747,-0.1705857325782507,-0.14020166382928456,-0.05184247665184063,-0.17169690875426794,-0.07033467386605072,0.1831053000628221,-0.08105892473677456,-0.07545881101932342,-0.01754685979794738,0.20107429440488966,0.18364187617088296,-0.1498057424554967,0.06845773391436803,0.08387489114952655,0.09242727985513201,0.07753708840650957,-0.04127142167340521,0.05379894157708384,0.04462033058419863,0.04273398042216895,0.09256627079975997,0.08132196155285754,0.07328132511056364,0.11982932690087422,0.07670808846851178,0.06640128599739062,0.06813742831477893,0.17827738505291907,0.18318810522929904,0.19844684076108352,0.20360720436716379,0.1960630847067902,0.1660856695850997,0.19991770024520075,0.20771490467969614,0.16222097155556017,-0.07111225346001149,-0.0354318584329409,-0.06708470119131076,-0.01840323800256929,-0.016665836178146494,0.0667186678013375,-0.056768607265311015,0.07072337528790881,-0.0404196757155631,0.010531197748182218,-0.056925462994186465,-0.054841408786394534,-0.019466684209386218,-0.010266880319959029,-0.004756241293901718,0.036816801043682984,-0.041933810369314393,-0.03464827451130325,-0.027001080863348886,0.08681448916252388,0.0031169504922425257,-0.018292669517190226,0.023661009868546305,-0.052251000758939944,0.08274760985766502,0.104627008437849,0.16566843474891874,0.05721919688102368,-0.08844944442163559,-0.0530027759231918,-0.02435308767963899,-0.061939707991007356,-0.06224424529310699,0.19384908334718165,0.09853315538580491,0.061147180992576294,0.05569690604647493,0.06745881476582176)
shap_list[[7]]=c(-0.022227342401983326, 0.03911428040171712,0.01513785325474918,0.04656676240831771,0.11229793218750805,0.2178252597883969,0.19821128138703153,7.515074930180593e-05,0.20945503878224028,0.1708993188586565,0.008183136684042908,0.19276344396691725,0.16806589134843836,0.07876957122740476,0.027215078900457604,0.0017328575734634844,-0.07932837543328067,-0.058498112096813305,-0.03598754950911331,0.00042419445479011965,-0.04025157766467775,-0.012058656688142011,-0.022850850004079402,-0.04114538557347531,0.14402408538774242,-0.21103722378479478,-0.08780157511700984,-0.04127993602188011,-0.06368002914815243,-0.08763011447182248,0.09074456417184239,0.023649533212159058,0.2955574555587619,0.2009701765895262,0.2891026407144467,0.07780188638702162,-0.017830886801645036,0.006675894550417636,0.1978892774376194,0.242408026545803,0.205944404280289,0.0025560564193881762,0.01251038356571834,0.017757842193205448,0.001751532124420251,0.006334431473305539,0.006598269472267008,0.011856292524550727,0.02172398223735359,0.007934703033003126,0.027588027193368152,0.011567396786303726,0.01593526996224676,0.006977521455462005,0.011216208336621557,0.021586563404266707,0.014430070276604475,0.0011990106077592007,0.0028280579452212343,0.048019633411580706,-0.0026861562035045594,-0.009311498884478367,0.02847266185362681,0.2337868357387872,0.13468868962567854,0.027503619483426597,0.23023157045320042,0.036439168396623124,0.01972516513385671,-0.03779678135132768,-0.03885675340373762,0.08672402691813628,0.15256361037261554,0.2278138770152945,0.16939936747843148,0.068870451353278,0.23913095215270302,0.06012911272823648,0.28193369233564797,0.1278878255795825,0.04583958467534879,0.025434689958115694,0.13807284437657935,0.3146084994590181,0.24648351017840794,0.34611799524712666,-0.041500556729068244,-0.024053404633044895,-0.022479198122278197,-0.07812247415042538,-0.07168266261084807,-0.07692892626786262,-0.07801253055898508,-0.06076273023412762,-0.08197463176631638,0.28011372982766436,0.23905371663169867,0.24046377476065361,0.2127006383887552,0.2058123679619563,0.24185142411667415,0.23968554530213207,0.09236923521527526,0.29489045668339,0.09035379219449262,0.24032075547682719,0.01091545448352432,0.02526667834011278,0.04122780829352886,0.01956452024713473,0.015237915253713805,0.015462954439318338,0.16129684889960294,-0.003218738172308424,0.0004939607674860112,0.00506252257295287,-0.0028823206880512747,0.02117734139985838,-0.09604060948747814,-0.10410234900408331,-0.07458562517316863,0.013553983051100643,-0.0026696080763605793,-0.005631800028026917,0.021197093041464884,-0.00426059628659909,0.2403046790922769,0.14538147833814416,0.07228069010382411,0.003645487906675061,0.40919264729465415,0.5755137575372165,0.5143952791237474,0.18024515711948708,0.6051560092768251,0.5250548205961129,0.17050385039197952,0.05978351955167217,0.043329102398450905,0.000613711374400036,0.020941175710308717,0.07667302409069507,0.2035664967023982,0.020425906579837377,0.20432399189292413,0.00464846149773446,0.08704103863351857,0.01766510914652257,-0.0027787602896370027,0.03334168733538309,0.08033558868929017,0.08936979319153028,0.1461040132195152,-0.00018616581916979717,-0.00013571313217355311,0.0026373705775726516,0.10166043450439231,0.01865571483369221,0.04271400659022868,0.09660370209931807,0.06295693134569805,0.20349905070022753,0.2604596622525986,0.1604511053908584,0.15636878938686155,0.040366846954907984,0.0185322781228659,0.020441572306201757,0.011821645170391531,0.0061703846724375545,0.07585969050668573,0.024260404819942565,-0.01935943520772323,-0.03678967165320887,-0.04096723853749095)
shap_list[[8]]=c(-0.020854608251439637, -0.05837492208093373,0.08141046190336089,0.07510172932104339,0.1828399056521078,0.30771468197014434,0.2907505579558716,0.014548020930771961,0.29171191572858574,0.25473046343724537,0.024584570608071562,0.28293030749275744,0.2704443555900292,0.14131879915315015,-0.04877806309319534,-0.02196545245650516,-0.11242291187577656,-0.07181932753030801,-0.0046630246359681,-0.03759589518665073,0.008859372281660652,-0.024438204404049826,0.007351821744959433,0.048701716679205184,0.15930103277268487,0.2061125653973982,0.03359442053104965,-0.02671640631264034,-0.019897598693948276,0.034192073904075956,0.14844735075130247,0.04680601415570539,0.3163473242779778,0.2399787813359813,0.3155308823022937,0.12730851019997347,-0.05096823744443721,-0.16665453295933824,0.007115691689767732,0.0013222098340584215,0.0024266067663506496,-0.0024795625480537706,-0.05343739839227636,-0.1437492503591292,-0.019875505247173297,-0.024561644301014988,-0.04956862947356753,-0.05063369364252541,-0.045671297302470666,-0.036999511985957655,0.0054032874540713574,-0.003965911857712389,0.0017068670623725422,-0.048001464045586396,-0.0043555434990898536,0.04858734977642818,-0.060588904987460994,0.05173208072192249,0.039032979017024225,0.09735915946403191,-0.008219197139831649,-0.1424294928868129,0.057234606172100404,0.24406592927750254,0.20261651576199508,0.042473394610777156,0.24501894038437097,0.07192850498168407,0.1998429680306095,0.06712258634053764,0.03277135456919465,0.13893462061257708,0.1651315627534631,0.2781582115184415,0.2229733087664965,0.10222721872320614,0.20946383626293733,0.09447773421609787,0.29463811849830934,0.1894058390682114,0.07111006820283952,0.04312464787080435,0.18774544370191068,-0.026225323381535128,-0.031830864297178685,-0.016421967773545966,0.026276918980265556,-0.04012562594920168,0.0016039023004019183,-0.25967745610795284,-0.29314959435844207,-0.2615955523818306,-0.24286735831789577,-0.10919721371403412,-0.10678978825960832,0.2712586406882449,0.2018447815983131,0.23922135209722784,0.24638181132696907,0.24140802889458288,0.20903938745738493,0.2747168173126661,0.14266255633462566,0.28740820150294016,0.15625598728525636,0.20700782984710808,-0.26291980838665874,0.04087240133899862,0.08111253196456009,0.004662490166795259,-0.2000745051985774,-0.2659747286554273,0.24056977775349864,-0.0662638142660708,-0.005166017809657044,-0.007928430073311888,-0.03815530888282882,0.038024177182517514,0.011858479759590361,0.0006927390178543555,0.004992555657903989,-0.09109636380804319,-0.039000469381061754,-0.017695533861964256,-0.02548024909368256,-0.04712938321976543,0.09433567162398601,0.10925971301160801,0.022583411274243816,0.038363357595313854,0.16179570936521712,0.09252379830038725,0.07661534189376734,0.17348421748256646,0.05057391649460238,0.07860731950305992,0.18255191866098572,0.10036950165683843,0.21182881868141654,0.1351607820862721,0.1404043378275476,0.23032924713324243,0.2676242959176176,0.20559371108162283,0.270693567253563,0.04855697986305537,0.21258449135151378,0.21402365964315023,0.08254078783920704,0.09636049092189171,0.20978628957857756,0.2329362866332853,0.22154967044962787,0.038147377468902635,-0.022391010612856654,0.0013926512219284272,0.18198339912201622,-0.01267280345564041,-0.09643850786559413,0.22204139659820707,0.09610391354505264,0.11816110502444477,0.12374870412230844,0.16221132374275626,0.0702830991117389,0.07376088880524372,0.03179604975101288,0.005040073532127683,0.03305792608690061,-0.006372370597385866,0.022686940432086793,0.05833311747275218,-0.04825550860582685,-0.003201732911894922,0.03063887135010441)
shap = do.call('cbind', shap_list)
baseline = 0.3157361819498527
rate=c(0.3292685250154417, 0.7748815774283857,0.505393993311066,0.8444442385442245,1.9332722220874508,3.6784973030883754,3.1866419269269053,0.12101536011631633,3.3980316296039392,2.8241144135448555,0.17949863193936266,3.2696041861807954,2.77013372003928,1.3482914055238897,0.5979153637628449,0.25206885702146836,0.18256846731405513,0.16705661876399885,0.379171277100446,0.4544852886693973,0.3909644390342754,0.41687775362349455,0.291684883208463,0.4656117118477442,4.025326992545946,1.6456621614315818,0.2650195193920297,0.17328696893560147,0.17633663029108185,0.2722590073792512,0.9878434754751454,0.26111333876424464,4.219172244419899,2.8057980010589367,4.164285598603534,0.8382429492679365,0.2463558338059142,0.4721663662993602,0.626847460881847,0.49955549110966124,0.5414308301872953,0.1819783680719548,0.33156415797206445,0.297763035426854,0.19615715713667622,0.27784192275007547,0.25679710849969384,0.32840068498480596,0.40278224157389103,0.28820749075325064,0.41152834346707945,0.3556581021095625,0.4191708701970972,0.2619319993424942,0.3589436493140024,0.5053676815039791,0.4828260470361038,0.5104692596461847,0.3510343086513359,1.0719362521510007,0.38517804225963276,0.325739575541113,0.3168312212889685,3.989264866418009,1.6486703608103261,0.3084314524558896,3.873580613886859,0.4089194776440346,3.886337128517067,0.33876481220200744,0.2520057034299754,0.9751895583671187,2.0099908689359642,3.3860514256246157,2.0815301467729754,0.6275005204143844,5.028679638702553,0.5302205687614576,3.2730437010115154,1.1752801417179821,0.41573670012334457,0.2896617738909088,1.373247897267205,0.7510814513837581,0.611987681736304,0.8750245402127239,0.28502126844285547,0.16301469157879522,0.18922750837640231,0.5146027173095356,0.32239179771830523,0.5219272122205848,0.4137142845109545,0.21395323242361758,0.20182868798244075,4.341170035309146,5.122081340940353,3.7705549865238637,3.124310079230904,3.222040592874789,5.075394004824562,3.7280556606346735,0.918527960520534,4.451213120319356,0.9833916967785946,5.112435063295647,1.0685566884549105,0.3728531785856839,0.5758967647479833,0.3462527183705075,1.2493599963413546,1.0794171166224038,2.0662104043854748,0.2982772976107383,0.4466917933566946,0.4978161052841918,0.37092049258263293,0.2528453744787011,0.22731831667394203,0.20676390718981316,0.15656149689588544,0.35976583998314665,0.3623630207601745,0.3172274429364106,0.5850163553214428,0.3155586302959764,0.635872276070823,0.5338937718341515,0.9891420400792981,0.6628652450860584,2.449800105526398,1.7063806366821797,1.5660895631461391,2.539217583946381,1.652156953051599,1.658688252695544,2.5803843010688605,0.7838744491103202,1.519261349581583,0.7850781516880574,1.0546587551142383,2.0030316595488324,4.872905539914695,1.3544626444662193,4.865847568089836,0.2619215813683993,2.1679082725034577,1.2989493449259235,0.44857742463189,0.7516306557420988,1.971763101412086,2.3127148576203616,4.267802372133731,0.2518492657359269,0.12976637127153384,0.19950618411426366,1.8568031825995526,0.38601367307230094,0.8563002521779811,1.9464426822407108,0.8073212018263177,0.6947224150862094,0.9361687411021403,3.9863453957455977,0.314145760985073,0.42826886756153654,0.25002968579052126,0.43375276777876653,0.257766689427982,0.22801836004469658,1.0060558930627648,0.517456797327151,0.3011477633690333,0.1991892618519156,0.2937190647038175)
rate_lwr=c(0.06562555814027393, 0.041066128484705255,0.11510621875638938,0.12221310202965313,0.018545496939965822,0.16555267255997277,0.917217976499539,0.0045574994828253,0.7961707080764284,0.27093002217184037,0.012689948329556444,0.03631393922953294,0.010343742075990953,0.0334962040532209,0.0883117668777457,0.03288253371675648,0.04247739760355859,0.03085487913974372,0.07442011280103478,0.09297062960173452,0.026328576804163062,0.03992598707093728,0.04534687128521572,0.06783065180281825,1.182753294327887,0.09735840353669961,0.038671644705730646,0.022156082148559464,0.048304592984378086,0.04580494509702532,0.2159892524810117,0.08275207216467356,1.6172264799757443,0.4536870651901154,1.5649455595627457,0.060142536221826554,0.0402185723723488,0.0676574356907691,0.12221485453831077,0.0514333778257709,0.07416486228173541,0.01417568763103047,0.06681921665649804,0.06470236115626626,0.02674318848509233,0.09530287364183537,0.04425467059895871,0.0874910317777125,0.036315995533704015,0.08071898891850432,0.03680182427392259,0.09875851664112761,0.11415890954584476,0.0805715680330229,0.12027059976162716,0.09655548707102302,0.02055256134747832,0.09982070266541404,0.06281784243087196,0.06742357423060386,0.07925572269852615,0.051699957802631924,0.08171409508957334,1.5013473811973364,0.2321880167760414,0.06500766704041866,1.3082601434088525,0.05811567534327067,1.0975743748843554,0.037650953248782815,0.03455885098246256,0.09262517915383095,0.03045743959698377,1.1277698339800122,0.06515424142453077,0.02967626436949089,2.918696049860564,0.01945887224299206,0.330089783002048,0.22354357512014594,0.009462817436682036,0.07593992981798048,0.16500236689880682,0.07094986415812082,0.12406089177117255,0.0567132386928845,0.04620524777076099,0.017670082328828773,0.004454009586497554,0.10347428172646675,0.07711590323172873,0.09199939111235075,0.09343370334271228,0.032074659385553955,0.043572297217859074,1.9569809920841101,2.5473205744455654,1.2700756182301975,0.9443862491681585,0.42263497567341685,2.7078068667135518,1.2863473752869268,0.08407361991676293,2.266594601452084,0.16692179120043668,2.652629531607832,0.11035013707681185,0.07362945434260992,0.05583480132401297,0.018035478798523852,0.11664469728240395,0.150645511912184,0.04516650562116803,0.06612269751135363,0.14670171394203152,0.14501798307851282,0.14243433300203776,0.07489758066225108,0.046892910282543776,0.032420064044612285,0.03689248234100195,0.05180812604278168,0.12425595629324701,0.07640971436924046,0.059533305047398705,0.10910714463207999,0.06198782577936818,0.07555409473271768,0.12154534222762306,0.02480045316096291,0.08590191959105511,0.31625313871397737,0.25916324944522506,0.5441282431513086,0.10314735536730929,0.2724210826731591,0.5743417616584765,0.023582055160049964,0.2946547881324296,0.07183936210380115,0.10027048889024467,0.5902265609819989,2.6375605804953897,0.40221283573864336,2.6064532605284376,0.023790981456735638,0.09890070571915,0.3860637655961164,0.01694510708712732,0.06620926070240357,0.5513806019383867,0.3529901695190509,1.7210504979675048,0.008428351522708988,0.004274587223796311,0.015968225649609036,0.1432476659211585,0.009662464040186891,0.04368671093351373,0.02032541585733655,0.017571525022906376,0.09008120895702523,0.09315866716554688,1.338984609020636,0.048248025392228555,0.033036766925607475,0.013187942073263376,0.06118542049327863,0.012173154371313999,0.043594265004761074,0.15362522328522257,0.12244180811962002,0.02774228841159243,0.04186552993041229,0.05004713841053951)
rate_upr=c(0.7081388993843813, 2.202483527548064,1.0482665343283655,1.858018578080695,5.616575222522234,6.23935355946977,5.937258314568293,0.24908757527719938,5.893329212371405,5.297207654905822,0.375214840785453,6.069217082500503,5.664628141594791,4.984133044849826,1.68747256503632,0.5459875979188311,0.3550879683821211,0.3207357688718096,0.7407972507561532,1.118043932634917,0.854344617704988,0.9633096826233689,0.6681478575772462,0.9908219788457991,6.544927359828483,3.879165300921697,0.6204075436684567,0.3640921928770093,0.31663144500409085,0.6569411369411678,1.9996753268931995,0.47299061158579736,6.4896524011712104,5.330278384149227,6.5337955314417755,2.1469944162030505,0.5504341842937164,1.208262823398536,1.3375342617682657,1.2840091079502558,1.324313536998396,0.3801678934692729,0.6991061451210692,0.6835416877482232,0.39078292652922586,0.49353500957357543,0.498396339601089,0.7514410390764901,1.0235559408298474,0.5446713969017083,0.9626607445117402,0.6665029199696009,0.8340267941301049,0.4898480731450162,0.6362142422556818,1.0063919165485555,1.5776996313487883,1.1266844335974917,0.6656065146030349,2.684502649030634,0.725327534229834,0.7642133673447701,0.6497536744208957,6.778749828882747,4.484709955486006,0.5840541118827114,6.638625900200133,1.3765412494324536,6.986397993138262,0.9273034848078282,0.6422947545777917,2.2966179077865765,5.654605205263575,5.4719620507375835,4.259861534887426,1.7077433963467528,7.6996958173488705,1.4091102491727623,5.686949045010988,2.3812270222150866,1.589382436120585,0.5426700515205212,4.154248429024697,1.9280882919884572,1.357537798676645,2.387204227980688,0.5865816124042077,0.337347910594282,0.4781379861135667,1.1106034275169674,0.6267908825249575,1.12474887117671,0.8165512877181912,0.4709720341853086,0.4327961532473811,6.6305501466802195,7.400608247047458,6.4002730242578245,5.283869049058746,6.057815329014905,7.4476783993908215,6.0546560386245165,4.514769940449601,6.923031256894603,1.99761249696272,7.355650918310468,2.5172893626980883,0.8749690483930661,1.4591575365234053,0.9545094336833868,2.8956815925453325,2.5933825215247945,4.33403224796528,0.5266872107773254,0.8178026956236923,0.9499674800711753,0.6429837149191397,0.4665650195122357,0.5051345998172502,0.4523957688615548,0.30120615922203675,0.8585946247991977,0.6135562089157105,0.56288796386001,1.501044384120532,0.5429622313842806,1.388304119863589,1.1621376624163762,2.2764455711624736,2.155279856515067,4.935223477844095,3.3371265087757576,3.1617591014140287,4.722196684639925,3.342545993580134,3.3346427640250895,4.769542438192653,3.6268168445650018,2.867824045579223,1.5908538117878481,2.686569561413207,3.8078743555176944,7.561298805206879,2.562302351866278,7.473178408631937,0.5864247034487016,4.776720120472983,2.5175328860770234,1.3135388274969184,1.981083393176022,3.852182798409835,4.811278101374735,7.0701852038583395,1.098835741995537,0.28343424339846657,0.4597310622687583,3.9608829230735396,1.1942634687638554,2.1265288496679635,4.849019358885533,1.9602422762481937,1.5742438217778951,2.3086343367881885,6.641056568050754,0.690755167912162,1.1005842041323255,0.6334147714736418,1.1936690108344832,0.6580905405694801,0.41805130665298146,2.4175992170047267,1.0455730929953906,0.8728620907881548,0.3892259482606976,0.7128160807558994)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.675380920322993, 16.77145789798466,12.54225098447362,10.29810557211113,8.193996520752748,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.539329847594917,11.45516312611962,18.316996330471802,13.644381033687072,16.687957899554206,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,12.762457973341409,20.505765520098972,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,21.779996265378173,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.584860112175583,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,-3.5450032585905245,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.251534849631417,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,16.211996370039262,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.15963284744126,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.676359941283643,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,12.762457973341409,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.451546459520934,9.062465735197444,10.647178292822375,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.723329637370448,7.629996531354187,11.45516312611962,15.453496384296702,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.555996307182443,8.396996516936989,11.754396453828296,22.72199624767148,22.62499624949477,22.26749625621469,21.779996265378173,10.15963284744126,13.644381033687072,17.899611722932722,22.62499624949477,21.2476885830762,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,4.276046594398034,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,11.566150303520583,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,2.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.060771091445902606, -0.05869921047264396,-0.06390396258176763,-0.06393820796461114,0.05354900230043159,0.05375921946649573,0.05502479210289088,0.05313470346488378,0.053790325001060416,0.053664682409292536,0.054960022616660865,0.05373949226784836,0.055165486777744674,0.05514362256445629,-0.059145612968870664,-0.05738377217633107,-0.08101064451797406,-0.07790931697826041,-0.06326139027829637,-0.06254306480268867,-0.06269876848706117,-0.06264071249892253,-0.06282883237938733,-0.06320918627724438,-0.08594023403453271,-0.08525457009584454,-0.08554270987255898,-0.08546444036809002,-0.08545032456692794,-0.08607065130570019,0.10409706269294075,0.10159781120592827,0.1047296171580498,0.10495545043477152,0.10510261030290872,0.1024687346539799,-0.062315805132424795,-0.057635958420691275,-0.07592028226022224,-0.08028775206506102,-0.08050305532586141,0.016140118337063282,0.0007775952791276917,-0.04622385939645711,0.027557238768985196,0.016227926772136646,0.005459041499783477,-0.004299579788926835,0.016059249664573123,0.01607938337990016,0.029093913073222382,0.029204100802286678,0.018081410988726242,0.01138069271437591,0.018188988577606268,0.02370622792887925,-0.059175525654470776,-0.06406048572473012,-0.06396612152318684,-0.06432700823802275,-0.06395762188503297,-0.06157817462477826,0.10284935077559915,0.10494365016630262,0.10412763125452365,0.10307975256424019,0.10494365016630337,0.10327689842827556,-0.07127709490535676,-0.07086183129360484,-0.0703168617665617,0.10495862238986155,0.10752017447281866,0.10725320919531497,0.10758776501366704,0.1065451907032374,0.10732050984056332,0.10662437894144014,0.107627026092141,0.10752344812334966,0.10620106106651854,0.10311686133275214,0.10756209682314266,-0.07213452261852958,-0.07252463377837769,-0.07255864453392982,-0.06885926812778291,-0.06869251892007117,-0.06890003577251615,-0.07609655045230762,-0.07551987476194875,-0.07563389253425785,-0.07564749767294068,-0.07748411136968854,-0.08168594266371142,0.1087748303858091,0.10882162230128278,0.10867224260501722,0.10835687187706858,0.10471414300927001,0.10883742911757752,0.1088371229590366,0.10766288378942002,0.10663752583105869,0.10451853027792454,0.10851554913701264,-0.06953991043912076,0.07337069421403868,0.07351926286597672,0.02919543818694804,-0.06879694297345515,-0.06816368209731621,0.10311803407253618,-0.05878228426255233,-0.059286518007359276,-0.05940055132512167,-0.059580769312761364,0.0948129408916274,-0.07995641403251426,-0.0794020686458877,-0.07968667321853491,-0.056945503867811734,-0.059792222482159055,-0.06118273580857568,-0.06115733073376015,-0.06120644106641344,-0.08347687578357472,-0.0828260489896962,-0.05775803706295192,-0.06894208288220668,-0.08632423824108698,-0.08579635897347229,-0.08582715273713953,-0.08660769948671841,-0.08524426841192564,-0.08570164307602392,-0.0865061457113927,0.09613557666408176,0.040386440617432684,0.04262457702248623,0.042531850021331176,0.043720347300956953,0.0428981914963022,0.04317965116123821,0.04264222716470275,0.04201047680080523,0.043629497863257496,0.04318698576040264,0.04294089327973173,0.043197104795011376,0.042697052647307,0.04375461288718574,0.0434472629564012,0.04017174785562026,0.032288721556329086,0.03293538694162206,0.03360127142863378,0.03216815876644276,0.0329456327162085,0.03292142197486559,0.09793089148974651,-0.08594264646602158,-0.08535308500469349,-0.08612749762591124,-0.08520695236529828,0.09321328269955038,0.09313337374320942,0.05198507439770224,0.051835980745670626,0.05167173249375796,-0.0600739516856846,-0.0603426803459082,-0.06807347486128096,-0.06852214463590106,-0.06811646422343177)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.035531506202824005, 0.012558934090319123,0.015538404951364812,0.015558096845103174,0.001447918672721813,0.001461330948496384,0.001546622277989593,0.0014204653222144661,0.0014634390228889552,0.0014548869470893831,0.0015422989241964092,0.001460117864033572,0.0015560362678194467,0.001554505093625614,0.012772808004019491,0.01185339667273163,0.10509640012256648,0.09571616753808483,0.03915782831691092,0.038106715660519465,0.03833796749709141,0.03824779647357925,0.03852530498724913,0.03908061273130139,-0.20172358968858703,0.12023067576960507,0.12120784197571864,0.12094455351740703,0.12089827631604519,0.12298312129468825,-0.008187800228807012,-0.0077148853826122755,-0.008306282809406679,-0.008348688752335751,-0.00837631286016851,-0.007878642502215672,0.03994586986245788,0.03277101105819539,-0.1468380519056333,-0.1705744959979762,-0.17165593421711406,0.0052122106781146834,0.005481111603193069,0.006061480110712965,0.004710533140894737,0.005279439636039715,0.005341996121590527,0.0055404448462307914,0.005149976178995048,0.005165721533349886,0.004741748097513179,0.00471948623292778,0.005095659706847861,0.005223590569097145,0.005167857359422702,0.004888180869561156,0.034477408425258996,0.015629148605604506,0.015574560775762386,0.015783470894948994,0.015570033899717431,0.03869659686621434,-0.00795559523016167,-0.008351093020414613,-0.008197714711831647,-0.008000586523451446,-0.008351093020414539,-0.008037250078035383,0.0561420794492949,0.055372026885768845,0.054349774131544556,-0.008359685464379103,-0.008855090286176268,-0.008802738811492855,-0.008868234727519839,-0.008665849663364656,-0.008815749852274622,-0.008681116402737726,-0.008875871341797521,-0.008855734033407383,-0.008599243600480271,-0.008005156941039666,-0.008863245708897311,-0.12590157467495527,-0.1275161760454698,-0.12765719281379592,0.051664487550675896,0.05136945107523478,0.051736565113489064,0.08900998655625635,0.08742140613321521,0.08773461923104703,0.08777229801468994,0.09374305838328444,0.10718262550538346,-0.009118240407563665,-0.009127478866400354,-0.0090979692039674,-0.00903569121823247,-0.008310208907543172,-0.009130602544144786,-0.009130539878834942,-0.008898791432045514,-0.008694953217619093,-0.008273588148626184,-0.009066892331789667,0.06914139564048252,-0.0023846415404180847,-0.0023960359595860082,0.004780911928862782,0.06634784888755166,0.06490974518199871,-0.008002620610809344,0.01258800807920548,0.012845914188259182,0.01290479347916698,0.012997383440156066,-0.006427704860346947,0.1018754760718998,0.10021513761390441,0.10106665299893113,0.011619053118630393,0.013177369335956554,0.013976018488687797,0.013952182914174714,0.013978580435227534,-0.18795869951702424,-0.18450642724489477,0.01202109933768712,0.05179193940320445,-0.20408583487692328,-0.20113236256223432,-0.2012969439107301,-0.20567223895400338,-0.19807398603058912,-0.2006041265053719,-0.20510430987795247,-0.0066742372355149855,0.009805310393813261,0.011239432295204006,0.011181748797405003,0.011948412367892677,0.01141672835570653,0.011599678154167048,0.01125040654635418,0.01085592727298892,0.011889893119258036,0.011604318352697275,0.011443524760872086,0.011611932824106889,0.011284698603052168,0.011970472943611933,0.011772459855287564,0.009682527878640634,0.00480631770599466,0.005152674701584214,0.005447784774897467,0.0047132590082452136,0.005197544151217756,0.005100939847513525,-0.007008755862158719,-0.2017355851427217,-0.1984624923945392,-0.20276111327249025,-0.19766243557482374,-0.0061200780324759405,-0.006107727448226694,0.0016459238135760374,0.0016348094331138556,0.0016225157752394904,0.013262504729335997,0.013403130471230915,0.05024140981815653,0.05102916183724633,0.05031635332167034)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(12.725000000000001, 14.895000000000001,4.4665,6.2895,2.1900000000000004,1.2904999999999998,1.2904999999999998,6.2895,1.2904999999999998,3.09,6.2895,1.2904999999999998,1.2904999999999998,2.1900000000000004,14.895000000000001,12.725000000000001,31.0,25.565000000000005,9.438,14.895000000000001,9.438,12.725000000000001,9.438,4.4665,0.00585,1.2904999999999998,6.2895,14.895000000000001,12.725000000000001,6.2895,1.2904999999999998,3.09,0.06885,0.06885,0.00585,1.2904999999999998,18.205000000000002,25.565000000000005,9.438,9.438,9.438,9.438,18.205000000000002,21.735000000000003,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,9.438,9.438,18.205000000000002,9.438,6.2895,25.565000000000005,4.4665,6.2895,6.2895,9.438,25.565000000000005,2.1900000000000004,0.00585,0.4535,4.4665,0.00585,2.1900000000000004,0.00585,2.1900000000000004,4.4665,1.2904999999999998,0.06885,0.4535,0.06885,2.1900000000000004,0.06885,0.4535,0.00585,0.4535,2.1900000000000004,4.4665,0.4535,12.725000000000001,12.725000000000001,12.725000000000001,6.2895,18.205000000000002,9.438,31.0,36.3789485,31.0,31.0,36.3789485,31.0,0.06885,0.06885,0.4535,1.2904999999999998,0.06885,0.06885,0.4535,0.4535,0.06885,0.4535,0.06885,31.0,6.2895,4.4665,9.438,25.565000000000005,31.0,1.2904999999999998,18.205000000000002,9.438,9.438,12.725000000000001,4.4665,9.438,9.438,9.438,18.205000000000002,12.725000000000001,9.438,12.725000000000001,14.895000000000001,2.1900000000000004,1.2904999999999998,9.438,6.2895,1.2904999999999998,3.09,4.4665,1.2904999999999998,6.2895,4.4665,0.4535,3.09,1.2904999999999998,1.2904999999999998,1.2904999999999998,0.4535,0.06885,1.2904999999999998,0.06885,3.09,2.1900000000000004,0.4535,2.1900000000000004,2.1900000000000004,1.2904999999999998,0.4535,0.06885,4.4665,14.895000000000001,9.438,1.2904999999999998,12.725000000000001,14.895000000000001,2.1900000000000004,3.09,0.4535,0.4535,0.00585,1.2904999999999998,4.4665,6.2895,9.438,6.2895,9.438,9.438,6.2895,18.205000000000002,9.438,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()