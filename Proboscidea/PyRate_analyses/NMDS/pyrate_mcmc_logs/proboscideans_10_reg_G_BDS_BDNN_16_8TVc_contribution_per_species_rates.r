pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_10_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(1.0, 5.0,2.0,6.0,4.0,3.0,0.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.003567757239211998, 0.10772896030335989,0.09882085144521817,0.12624972997558573,0.14964571425379844,0.05459138355485096,0.0902980604729234,0.045717440666657914,0.057234539850444556,0.25441392273180136,0.029987848705727377,0.07893504441579728,0.042635082474957585,0.0699000137247586,-0.09347579519268757,-0.06821057201386746,-0.43324888776988185,-0.3175916852256586,-0.04749814234514468,0.16757387198513699,-0.18784144472616027,0.041106152546841905,0.007307071986821085,-0.04739932480899352,0.21085397158684913,-0.19177955590480927,-0.23474602205174463,-0.2570818259413688,-0.2381389057560084,-0.18383270513079233,0.48867551325299774,0.34760505045356405,0.5963585195022427,0.5715191309659625,0.5425295359132074,0.2781564255553932,-0.17239430275778064,-0.11941573846870801,0.07658035340543391,0.29010075593185797,0.2538797287434804,-0.047937795667220534,-0.0062262943632899245,-0.0960648398633954,-0.017254343247662594,-0.05392169455768025,-0.029894229138024402,-0.00806825341433285,-0.11252353596681194,-0.02332812872665534,0.014499224337135455,-0.06800475233415024,-0.05845561375455167,-0.03613949756179361,-0.08261676930189796,-0.05410015243297409,0.20881337749756057,0.09426598782265785,0.1154787378056048,0.1303983439532067,0.08519418333303633,-0.3114177277353034,0.342199910504646,0.3252384046783982,0.43915844549141403,0.3254030935846023,0.31376854600635673,0.32989657850003995,-0.043527823317021506,-0.07771409334856218,-0.10716594960867745,0.3926298965836705,0.5706059566047099,0.8866466709161702,0.8933344642996456,0.5094437998531937,0.9237463192766214,0.31572555494604426,0.3947650499712147,0.46980334378421307,0.47828456693347365,0.33110530191317583,0.5412157728304793,0.12728176683088846,0.042123838568158364,0.07695054962933333,-0.13798322232955057,-0.06640960041550469,-0.07485951522323114,-0.35266299583030936,-0.38206736419119325,-0.3825146121057889,-0.374033236136764,-0.4219770748047489,-0.40541915300829,0.6069255102011223,0.8725332097229893,0.8090212606509619,0.9351286908855847,0.4838881406292758,0.8861976719908019,0.927137684958803,0.6113326668989402,0.5678470847602739,0.5068485588782543,0.8372170940520783,-0.2056386694830337,-0.05772496114288422,-0.0530509213738965,0.056446763926446424,-0.19798535436522866,-0.20543632074969154,0.38065652834692154,0.02219124730449639,0.0217554336064179,-0.003632037925918736,-0.019472754843429998,0.3320782606539824,-0.2963305319197793,-0.3180164095954093,-0.3780791557128537,-0.017797325474266528,-0.01539422819790292,0.05150967399425164,-0.024264589975221497,0.011362454722666684,0.0045424002228161295,0.04346933341742919,0.12264204228526976,0.18778582655385992,0.16832605854183694,0.06316800283622345,0.13957951449283143,0.19283516058185654,0.10448469535463162,0.15257818908443704,0.1788658210234207,0.33738375881995525,0.2595210322544161,0.2726831013858431,0.3101410850423815,0.4953831399680245,0.2884932359430864,0.2370801069262324,0.3089398747281114,0.26307675446436474,0.4881166113714852,0.27506956257799065,0.24865738618181238,0.4815880869089766,0.4764052231769568,0.47551584889185095,0.4974474559918277,0.4026665959093322,0.3492548040572233,0.1953490595045483,0.2249748560660431,0.23881051972085077,0.36990955628926,0.2227038315082944,0.6078833815373597,0.22725102988460955,0.1942804909440818,0.27380057386227236,0.2252355580515279,0.14681059323945775,0.11653766484678946,0.0710850780910827,-0.04985002579079398,-0.04733941808611049,0.13565576993573586,0.07350580650502907,-0.09831121653396643,-0.12218170792604893,-0.14125827815471323)
shap_list[[2]]=c(-0.04879914273888525, 0.007841434151463062,-0.07519381026466883,-0.06109251630053393,-0.010154977188114896,-0.025856879663048424,0.0018468798190627112,-0.02722488813384846,-0.005973690858735107,0.0665254534548203,-0.009710009196245843,-0.025154627634482094,-0.02417313642349812,-0.00785475326851608,-0.010535406338438386,-0.03846542356781187,0.0331886978861861,0.04082502649715467,0.007055946632713836,0.015299825935021343,-0.009783506182147251,0.047968220251947996,-0.04342080957784725,0.015448763179007714,-0.02404503903152174,0.0610985402320243,0.08897475523871365,0.11608655400895254,0.07490484667318069,0.06123490152126177,0.021244741044182967,0.007957159319791426,0.0680846230498669,0.05558731542676986,0.06828081856907041,0.028347304605595404,0.05627804581142985,-0.006973892710070319,-0.07955581637985196,-0.033194992021273705,-0.05580120310781708,-0.029042191010364097,0.00408309057325903,-0.04796261729779321,-0.01827204252786493,-0.02569272742753869,-0.013600006506298395,-0.0016092562880902993,-0.02301133665076563,-0.00957703719432038,-0.07044563289404678,-0.029873882275745202,-0.022361229547685556,-0.012143657086759687,-0.03321546279483568,-0.02672963042457617,0.06469194804169656,-0.08735848848606563,-0.06805544523781089,-0.024812253563658557,-0.05988765458712037,0.008955589185670739,0.024933039240185754,0.017283376208891178,0.016166946574720578,0.020862896274592528,0.013810797538513522,0.014837354654593241,0.06097602349106159,0.08674968394846246,0.05961733541079353,0.011090920507290863,0.15197917760830018,0.19485625016899014,0.2144240576176543,0.08773430061097069,0.2044772712221795,0.046338793552930004,0.09002763660448382,0.0742500561721699,0.06473857823652295,0.012763528190957548,0.10309681500057935,-0.05164292152410362,-0.07649893099507364,-0.050592506049933955,0.03207213552016604,0.01591008183744602,0.03457728244684859,-0.0067735726275694776,-0.0004636292512202847,-0.0005012106622344314,-0.002268394696763567,0.07615399787202597,0.059314249569618,0.10383610936463972,0.17548233218380258,0.21377820849336004,0.19224673471430032,0.029012096565695825,0.19436392753838846,0.20112359339184063,0.09306061563071891,0.08723426716114402,0.032443061611562816,0.1930374885834249,0.05481961625549836,-0.02989968694055214,-0.026493973723919012,-0.0664637983404102,0.01332754243852767,0.054635475698066566,-0.007069820461957585,-0.09542444435520768,-0.09211853952135252,-0.09646175390571403,-0.09642734960318566,0.011622127404442779,0.02534292543464553,0.02968259677061356,0.040656349780685434,-0.0025767618082271288,-0.08711444489699392,-0.09689059852125867,-0.0491580990764596,-0.08883863002745974,-0.061224224638192125,-0.07722245370903875,-0.022533300134292007,0.09349884199723084,0.05898101415853791,0.1594504116277164,0.1305620704264887,0.08482862086668298,0.20296523527935867,0.13218062224486202,0.07416844053898944,0.028768995590301976,0.029271460806818854,0.025265697325807093,0.01839684173653078,0.09588321235723044,0.023809250423125275,0.02260181011937684,0.02708156451319124,0.014545415439773933,0.07755385246413421,0.027196096267565615,0.019162038876586702,0.09696734038469662,0.10422934217755428,0.10373574671184395,0.08234043744165433,0.05729998982764409,0.021115566113827214,0.0035957138132288683,0.03986063754521227,0.04469287559026024,0.0689882120236828,-0.0022207451956429247,0.04028100946873876,-0.009032156969506296,0.0026119055893481756,-0.004724146487133348,-0.0035405613020491433,0.0133965032436515,0.001971884616547599,0.01721188322940983,-0.027099971215100487,-0.02564229794806961,-0.02181260580459845,-0.05850766162448827,0.10298304101048901,0.03693969063429794,0.026591996997006016)
shap_list[[3]]=c(-0.0803511796582936, -0.01056224620998672,0.13244542571874507,0.15284712998736036,0.050759457234903264,0.012310998699633712,-0.052277567767615794,0.022341483892945026,-0.0511466510860784,1.3945559602826327,-0.04734352597861143,0.025144687746389137,0.011583434700066368,-0.05570243357010926,0.07642544719590287,-0.21591113624470798,-0.016469490539211623,-0.026824044797331706,0.03947100790689669,0.18630173888753648,0.06070189177602752,0.1528412243071296,-0.07607632465175079,0.05817198280339102,-0.013556989117073988,-0.022733468739736685,0.040667293725157434,0.05579762420950622,0.037249958967129494,0.020352014904539167,-0.07860233037128148,-0.09219751546107484,0.07473571096093518,0.1436064037389581,0.06194554607966706,-0.23091460787566673,-0.05874006572721458,-0.0570174565227592,0.028302067525112974,0.08505558246088235,0.021071890790167563,-0.1725802145591241,0.11826522959591827,-0.08896215718150151,0.07912352116150244,0.06339053883477547,0.09974922992297225,0.1144830523057508,0.04133936982044506,0.09727578963148152,0.07321137737186541,0.03998118839465883,0.08305290555502247,0.09206503243484677,0.03733967129783569,0.06043116152882629,0.268347758639627,0.059695471018860934,0.13860418467936875,0.026826273570460482,0.06534870388427423,-0.019005594070156548,-0.08566341620435956,-0.0819604947339147,-0.0841384770883362,-0.07488751599663926,-0.08404392172160154,-0.08931851960367576,0.10671672442534899,-0.10650474558942272,-0.09529177805199687,-0.08452130971584788,0.25182899508739404,1.3837938415956343,1.3127681148552768,0.06466527569793687,1.3820108236791218,-0.2913723319654788,-0.062206943325588744,0.055980444551108725,0.05831921948494063,-0.07826229709725419,0.06721127352210922,0.11820966475977944,0.013997197414536157,0.10168267561076962,0.06269593201214352,0.0854481246303071,-0.09168055217603954,-0.012526478314458295,-0.016810061347662903,-0.016684995771341696,-0.019132074396507298,-0.008297525934944388,-0.013266599253464925,0.07844740926419551,1.422900531354157,1.2254362064148208,1.337616932367748,-0.07610377729297732,1.4101439050232478,1.3841612705418058,0.07486593192973082,0.07096225169180871,-0.07117876856640762,1.437766846508979,0.020591745367362795,0.03120056877135178,0.033733537976031076,0.07479006779029881,-0.0027787835155618293,0.020373308771307223,0.058457711169936984,0.12559553366981976,0.12398806284057698,0.09543573396219507,0.0777001005610748,-0.07409003513326043,0.02853925948391863,-0.027645968796625477,0.05215197180166915,-0.054970109501092795,0.07442840372453433,0.13389905417116246,-0.03210507771607725,0.08450889807178182,-0.01572795789261414,-0.02518102093956198,0.18804040280349904,0.15050162887956423,0.2555428144428402,0.31204392037507656,0.3641610414192971,0.3426896168779486,0.2936906553182105,0.35806919557959616,0.3483307458122388,-0.04469764790557782,0.01831346688831017,0.03371196338866989,0.048821909862146025,1.1189952118577444,0.033029416885518116,0.016845674910539444,0.03935253047643932,-0.07381228825334257,1.2420511448855072,0.022318115894307364,0.020260430480044247,1.0919584587817206,1.119310260999692,1.1308823513791846,1.0917524707584982,0.0650904277229915,0.12526544429861888,0.06666953279423483,0.1205851492521835,0.14063334366238397,1.0015775299430725,0.038280794141268386,1.004551783857896,-0.05244951705925123,-0.06277972114965522,-0.0010895027797048816,-0.059627418561582046,-0.03505145225610687,-0.1815656532585608,0.08283578040136921,-0.12980679283967136,0.04866014942047014,0.22198052388396888,0.1350400118326501,-0.0578613545764511,0.024580243223000394,0.052738582436175074)
shap_list[[4]]=c(0.0036199595050474174, 0.06639290713213175,0.029904528428888986,0.020207632512626358,0.0030828588180667467,-0.056412291476657966,0.05624570752590558,-0.010849042749202798,0.04551767662844004,0.07944856154675765,0.04029749990870628,-0.015811862519521002,-0.019097957669263095,0.04208001202753371,0.03265532903700192,0.023654295002205835,0.05398016332776313,0.06245418143339538,-0.018622101199783855,0.07704927145499835,0.02330757894794892,0.06542564616643952,0.009884825253456988,0.001939396507030286,0.15736901479563187,0.03192726737158919,0.004115011888033045,0.051900475173737304,0.0035867260022013204,-0.029687153194301936,0.020335773722983827,0.014110270167387877,0.01768114826950262,0.11801662437007228,0.0015877110928485922,0.0269019198200066,0.056984844675365603,0.02346032139000691,-0.02281293055710753,0.12983921044650604,-0.06272968313140195,0.02019782966130193,0.04842194878829524,-0.010447281084293748,0.049252595525744486,0.03074588414692129,0.04983580434067946,0.05419084212415467,-0.002735084397189568,0.04329440923026649,-0.06256549736951582,-0.00016121602331695394,0.041547190244676076,0.0434247411955975,0.008357304623582812,0.031953500983768264,0.10414410212623486,0.008830074260576531,0.034954127900572014,0.04776078175019496,0.012826386335341305,0.04379874586592477,0.01302801152474148,0.02239223938795922,0.020557289314409775,0.02446680375259023,0.021897989352194717,0.012873020483815029,-0.07018552327914156,0.015289820766262934,0.012040315306188496,0.01714637534654948,-0.05879043725321916,0.11761259469508642,0.04557755416632032,-6.009908446608272e-05,0.11366137490737305,0.011961574406838399,-0.033266633448924776,-0.022074154955162642,0.003525240726502036,0.023378800348639418,-0.013049540329777164,0.09359099222955342,-0.0630303499923384,0.1329681478995533,0.04857894673956719,0.03818773511766476,-0.016051742037988356,0.038992535591048115,0.04620198336644926,0.04599291584917654,0.04760642775686011,0.0672179877914818,0.04988151719936109,-0.00259500720488792,0.12017002341218835,-0.03939517568445637,0.11999671668720363,0.02476652605804368,0.1224294283804965,0.11656829790585682,0.0040019784452393434,-0.007362301180798936,0.025703083355797372,0.1210144932242641,0.0804305793186852,-0.00914736330156073,-0.00834797651893908,0.040807875845572904,0.05820420112365994,0.0802315374631051,0.021075307845155367,0.05571395369370566,0.054897930450099455,0.04106024824898252,0.032363370753381325,0.01836855097122867,0.005614251837318477,0.037503033280403254,0.04149444640782437,0.031014017651772505,0.03129716414991848,0.05002775498179248,0.020640869924559845,0.0360273203558467,0.09180073064315092,0.06035108051907647,0.017980983096609313,0.022680783858661725,0.18282515873106603,0.008728190317565433,0.00434337639664398,-0.040366097876322636,0.022102638080485678,-0.023046632759512742,-0.03399156026277523,0.07329623607471268,-0.05823628262039736,0.016677215358101516,0.048005713434572994,-0.0032426568477402955,0.011930877914161813,-0.042273677373593554,0.018807997160780274,0.03288968809468713,0.03013181998887472,-0.028469197469643034,-0.014162372697048512,-0.00695017988418944,0.003701836200121126,0.006037659896576578,-0.013141581902641343,0.007625447150834893,0.057254204095062225,0.054955347355419966,0.21546332160687154,0.13942087875686263,0.049213071465628005,0.010342863101062059,-0.03998230244578541,-0.07483357143534554,-0.06037097917922717,0.16829679476043116,0.0070766580245679245,0.07976026133257061,0.04767679477487144,0.005411638565624669,0.008881263654740333,0.028728655131028576,0.037971889825691926,0.02549012420193777,0.059337553262614716,-0.004543148805393091,0.021071660485870405)
shap_list[[5]]=c(-0.003950991395831311, 0.09320046659673933,0.09854391352099853,0.12168610181688247,-0.07490113154825413,-0.05814599437866445,-7.837805495993896e-05,-0.06452440583136847,-0.007523984972055644,0.014427961615742117,-0.00967196237795198,-0.06706278359542568,-0.04565682628875118,-0.014018328549623215,0.06484969120283282,0.027348413356947012,0.03143699659670642,0.033359661084806584,0.056663086537164155,0.1335873593795467,0.03995196596496956,0.12420867056477683,-0.0012909822079532787,0.06655144904206381,0.08122534851191679,0.019622498583732665,0.032967767873771266,0.04230874905504961,0.031834657277169276,0.021595644378175346,-0.05603048988506013,-0.051927737623234806,-0.041420249998499206,-0.043839012779387294,-0.03407839695848889,-0.02761033656203343,0.03544065504645318,0.024009193515373707,0.08338726084336584,0.12024941615283628,0.0841871961034575,-0.025404770506044463,-0.01797750973244414,-0.011685369566525898,-0.05608001443934945,-0.05199672974558063,-0.027895829098596822,-0.017670603393019877,-0.042956608045729115,-0.04472264594647865,-0.06162757529839506,-0.05147380735404528,-0.049034682936626245,-0.04299369531091829,-0.051444345124773534,-0.05864018935627867,0.18483144303758353,0.06677304100827125,0.10487719891122174,0.07146918662933391,0.07661883019736945,0.01889179527205748,-0.05275141480500202,-0.0436657416127957,-0.05590867896682816,-0.04461302286902573,-0.04298328349998601,-0.051604110806370965,0.024993765127498326,0.027314846730616474,0.021938023382525797,-0.05225854777881201,0.04565792534573381,0.10110064498043853,0.13099696493849997,-0.023407744492105805,0.11869737188474119,-0.0106245725114442,0.00981017315273879,-0.0191288387267793,-0.03592582672843109,-0.04624476358449314,-0.010054776741343264,0.12120473455115789,0.06974588757386876,0.11372772016483972,0.050897323434116584,0.06627726949192397,0.0329201242537938,0.030348212864542666,0.03673751194351853,0.03676356659880418,0.03721352574218318,0.03891454706798866,0.029227014063437105,-0.005405828872818944,0.0952071261091004,0.1233738091021772,0.1013813183845319,-0.05525508665500843,0.10173192223078477,0.11801064161673117,-0.01910731365318704,-0.01392269590320246,-0.055593793099827114,0.09635927772227908,0.08011871784168412,-0.03320545557730228,-0.030749885004307247,-0.05554030674604424,0.04536269913838452,0.07983176423132636,-0.05440764198757004,0.08090307656500617,0.08180833063903419,0.06496529175318876,0.0547587632872545,-0.04312735956617173,0.024878128799482237,0.025284808567708476,0.03577927070502094,0.04543205101877286,0.0578033481739331,0.08570580035516119,0.028277364604188452,0.06519585544779173,0.05534041350947451,0.06365900198579769,0.13850183645985412,0.16648908988283329,0.22027195473759573,0.22165914935991823,0.2332246229261874,0.20294606094689616,0.23188011057241703,0.2264781379106733,0.20321643784938126,-0.007403786857735043,-0.058640371530904054,-0.05852890299938239,-0.05485369484215191,-0.00256454795962315,-0.057858151082331895,-0.0626121227042455,-0.05836442907532072,-0.030504325327443634,0.0002294983919655127,-0.06089811990281119,-0.056981376437806534,-0.0014756039741060148,-0.00014020040498725342,-0.0018388212502617133,-0.003391556232305759,-0.057571208530334365,-0.06025113141103096,-0.05693773172487363,0.00431772419885377,-0.013940359097417742,-0.012758994472311911,-0.06968327881904356,-0.02092202188205108,0.055137147677260225,0.05810422230889408,0.0902527636964237,0.06479493480515473,0.014409479529569053,0.004525385466451146,-0.016758286909312383,-0.022615442788502225,-0.04614101764222565,0.16110452439130685,0.09915858233543044,0.040613958949181295,0.02542459569110826,0.04081608815234728)
shap_list[[6]]=c(-0.03876393456360186, 0.011929517546691332,-0.0756496559732398,-0.053768970643284376,0.020952548881759722,0.0009177454054394307,0.020883771537675323,0.003911440417585193,0.015288161227045322,0.1374331015084469,0.01193484460578148,0.006829502960752741,-0.001999584825103847,0.012239753186115145,-0.03888490924031309,-0.03073523367864729,-0.04501615700908266,-0.0461252853992038,-0.03434880282548833,-0.036825946955542296,-0.03864037767006787,-0.03212004529256446,-0.039908688821401056,-0.034080977827356834,0.2800725355460211,-0.045018598426931906,-0.04033205308227125,-0.03604124095156211,-0.04055328648136866,-0.042013460547486225,0.06545251325002122,0.05033002068944762,0.09263541658796665,0.07966609494592486,0.0932767150785277,0.035314529143147755,-0.04345408843252396,-0.01662361976001807,0.19349342614972068,0.29980448129572895,0.18392228294785667,-0.0034907763793514284,0.009774046106315201,-0.028188185048130837,0.0028524997158400804,-0.003417300827723379,0.00018189868537317558,0.0060851053213243295,-0.0038200231752628586,0.006132763240655834,0.02672355490478431,-0.00030820890618648645,0.005907769725894348,0.003852475201286749,-0.005004477295156985,3.9775864726617396e-05,-0.02602215370232507,-0.07788470458576818,-0.07966713935482536,-0.020164059672445035,-0.07044948760600993,-0.025939670495845238,0.05336431172854525,0.052004830269447674,0.06471610280408381,0.062091318274257574,0.04823713784607371,0.05247190826688323,-0.03846471742053557,-0.03702712008728405,-0.0331155979081409,0.06027621792616583,0.1415017895557293,0.24487484769100523,0.23473172599092332,0.10530754135675732,0.24801403122386786,0.045085637653955554,0.09042056821809036,0.10193191698239996,0.08979779123395859,0.06090147692530324,0.11625680650105355,0.28676642618055287,0.18657278637279961,0.31721889403491005,-0.05630104697590402,-0.059077554727960335,-0.044617508338841386,-0.03485939084586531,-0.03351286222943137,-0.03355584063164159,-0.03391107362462795,-0.041517716468129726,-0.044367076756752895,0.1270530247113171,0.25493670893940384,0.21808826225071123,0.24513835196380004,0.06693899084461313,0.2545087259123276,0.25485096329325874,0.11533765490221994,0.11571099142463273,0.07312984485231264,0.25574968813328386,0.008971294679510777,0.014296743688922448,0.01627480928983987,0.035434677202584086,-0.010046613807705097,0.008919237404872493,0.06487511091026961,-0.06623950436645522,-0.06579115139247885,-0.06774189975497868,-0.06948030868305548,0.04789063996208559,-0.04742527296821947,-0.052144695519624674,-0.05103718016572382,-0.0029301969754081244,-0.06874660341731718,-0.06957580640163362,-0.013814369478176805,-0.07136627724071995,0.2678885531353104,0.22783075681174839,-0.0016295077902715295,-0.04581179900299589,0.6496559999356304,0.6588007284199212,0.6335760012409913,0.5631690073692307,0.7089893056468345,0.6216328300993884,0.5653452048078913,0.05381505149523428,-0.008477685710373203,-0.005568178018544448,-0.006948728089423889,0.0610939680243103,-0.005685729477914922,-0.012146038641458624,-0.0029485594817706866,0.002033985157620496,0.0717218950005761,-0.00958436198373655,-0.010859484514909482,0.06257039454816485,0.06319530872506957,0.061219028196327144,0.0609297011230965,0.008834516383740802,0.025167610177149493,0.0002804984510587893,0.021615347796135158,0.023819253252046858,0.09259041597962019,0.0021761234426750493,0.13748291318728562,0.1749720952881381,0.17619178861596924,0.2894974386498025,0.186531624100432,0.04034682641594457,0.02601341411971626,0.02258907623257125,-0.0012369476498466578,0.003942004570686671,-0.019501058951556995,-0.053175585787822506,-0.04499082163094334,-0.05647989924635578,-0.059853686157023495)
shap_list[[7]]=c(0.16900744402810033, 0.22720452538675454,-0.021934887542581435,-0.012598957616568976,0.09842742271278751,-0.07586658699262395,-0.027487966448815696,-0.031194002028249058,-0.07355617466394285,-0.22683503482710424,-0.09656079650856784,-0.01651850181379198,-0.16619519674863065,-0.10870297883031661,0.08582007591166568,0.19055368483564558,0.47520491888930166,0.3327682956434,-0.03943387696285154,0.30871458050244216,0.19227788167235696,0.1822688598315375,0.06716473114530525,0.010422908666125073,-0.23462883479158142,-0.06825493960106262,0.02684648046487346,0.033385638620364276,0.024128529366832126,-0.06471355916316243,-0.1836914594644405,-0.13954829170220653,-0.21750859599029873,-0.23281117951745336,-0.2535026663360586,-0.11434196347679948,0.34601050697648467,0.377942928070589,0.19768869493344146,0.019080392798220422,0.000237229139655349,0.09780544021884383,0.2604611426563268,0.5241160457736245,0.21931761202087546,0.13287196328152207,0.24352527885581618,0.2578190970335266,0.06391090586900071,0.2448759630290654,0.1473973607499137,0.039449139549519174,0.20834215394343722,0.23260247162580966,0.03170275764753531,0.1369385783399533,0.7025318810693884,-0.030622145225356324,-0.017739751344432675,-0.10289169456105692,-0.025019582339967615,0.2327585686025209,-0.14008652353045187,-0.22905013944381616,-0.18304864719395267,-0.08915396495228467,-0.23776194065376707,-0.14248970204593386,-0.12257099692712509,-0.05011637938137565,-0.06403432364226073,-0.12240293848418599,-0.2527992342825198,-0.27934416824041747,-0.2853209259772941,-0.20230360980159548,-0.28501878637257566,-0.1208387202766619,-0.19852138198855054,-0.25727439322900464,-0.19975955586310534,-0.09417316530864364,-0.2605532540619065,0.22353867529015575,0.07500366813280293,0.10225911879484441,0.18239258326403143,0.2082630002672101,0.1024114653058144,0.3761537158108052,0.5172551005775496,0.5172647678450032,0.5242498665244895,0.49303099017201946,0.3509876246466774,-0.26852250035289216,-0.3009151098884576,-0.2844615906780359,-0.26000676774356873,-0.24979789511995606,-0.29723011164626817,-0.28622059993065535,-0.26131111466959084,-0.2812351795203766,-0.21554412106706192,-0.30087453540234954,0.6769609423818213,-0.03487856032854043,-0.03526285523886671,0.07060524591871006,0.35819565961407684,0.6767859215333778,-0.150422854168733,0.25293887422652367,0.2475937256451562,0.16942881406046878,0.12530746512255686,-0.014614836391019573,0.07171960494853741,0.23540649413429013,0.23219763006263602,0.30606560555803575,0.10828326376161346,0.25996107124957957,0.1084954970743742,0.1232305965098365,-0.19982394380681168,-0.02465944573557683,-0.010148739173249825,-0.02605995329752223,-0.2510282170540269,-0.17817533038569816,-0.18303133069075006,-0.2712153907736216,-0.13199636266952502,-0.1800322933526526,-0.24610913509797502,-0.09105270691434915,-0.17398650211429534,-0.15576081089221847,-0.1385067770727112,-0.2662100180561387,-0.1751572634064061,-0.15926740273773374,-0.14786266513233032,-0.04780242870400852,-0.2766938350297599,-0.1765770039012778,-0.21690478092581653,-0.19087442215859174,-0.24690846942687256,-0.2674300442228648,-0.2397101495748179,-0.01171035476884722,0.3444386414857522,0.10283943028167296,-0.1949292570560339,0.17263756620494303,0.18140742353015943,-0.017199068100440043,-0.1956316606140477,-0.23070933901569263,-0.1573086063864642,-0.2868609828902368,-0.14238963041818517,-0.07640299054851053,-0.030857604523020984,-0.022326516960245915,-0.005708547328357143,0.04636465071375357,0.1098254118477432,-0.020467207255465854,0.13617222198108703,0.0005874163591661595,0.16263890277924437)
shap = do.call('cbind', shap_list)
baseline = 0.34676796403128113
rate=c(0.35357625036835894, 0.8442400873327265,0.5331226789750853,0.6374420603908343,0.5843856586224969,0.2008388300588861,0.43651774848169317,0.2869448720321831,0.3276631989719016,2.0499238159944975,0.26712896824007243,0.3349269631742567,0.1458726807001901,0.2863591971470252,0.45965803757046275,0.23621522057935093,0.44608718868114877,0.425927775948428,0.30900203241617263,1.1859157844139223,0.4249367818794015,0.9167992230896469,0.27301466131174024,0.4144853495235326,0.8064624746427994,0.1335278680513253,0.264801921919509,0.3521245857573764,0.23968620318168335,0.1309709171959094,0.6270276553235383,0.48664986981224995,0.9370526588792918,1.0363345235544326,0.8271202854215456,0.34366135761524275,0.567257731145364,0.5708634984228096,0.8256964309890852,1.2529940218439097,0.773751753950701,0.1880100812048648,0.7570921129855305,0.5902658207387813,0.604376453213568,0.43779510703115143,0.6649190525051851,0.7461193568811043,0.26690913890046264,0.6568860459573667,0.4163230425400651,0.276981787511275,0.5534578327752199,0.6240218358352309,0.25264251086602296,0.43598835761572025,1.8368736119778246,0.38153842792664694,0.5742267333181805,0.47275337100863396,0.4311945647927642,0.294976124275219,0.505107743174387,0.4119347191736205,0.5673887279151352,0.5732386168286995,0.38260174567726285,0.4769627089595439,0.26655453689659897,0.20602100150275315,0.1425613113189289,0.5716293956882643,1.1911803281391957,2.9767256994814084,2.8743562937642584,0.8868861035319776,3.031627149359337,0.3435049647375074,0.6361772657503384,0.7497891069127547,0.8056957653154595,0.5587334317036586,0.8891668004145972,1.2595782563818556,0.5979966158436455,1.134894815458783,0.5286757375362342,0.6340376987365391,0.2908919978984831,0.38498603826852773,0.5135185063111283,0.5129516745826793,0.5259872279005368,0.5491441148030849,0.37311407921385115,0.984118419188909,2.965654821796843,2.596845628196138,3.000492330637405,0.5733244217661593,2.997623305357929,3.0413492668935076,0.9638132008478503,0.8847944431022872,0.6452384717900419,2.965067791216352,1.0537484588995216,0.22832325590839114,0.24358688919838925,0.5036971537080133,0.6059730109386192,1.0528515950525876,0.6602684139494336,0.7184074788179926,0.7148016200850084,0.5479203466765611,0.4509475052851988,0.6271082932839968,0.16032181323184733,0.27788626325708365,0.320344164902704,0.6487577287299272,0.4467153542914004,0.7579859015323641,0.3848153970681716,0.5057472580997349,0.49122449327073375,0.617360632526382,0.772923087349144,0.8872083540122501,1.6239952247027658,1.580749529031143,1.6571724421120866,1.4144463006805497,1.766558623657682,1.6237128975816122,1.4290119970758235,0.6954334049843967,0.3573762510303292,0.47699649401875205,0.5732675446356893,1.845054836783944,0.46727300858051385,0.3498930819435152,0.5332916933192768,0.5092744712685825,1.9734466574785738,0.39853722956776794,0.3387029099343291,1.8819977320772046,1.8657669317030359,1.8531909324189249,1.8236201017030285,0.8183542513844977,1.2046906166826796,0.7145999394262481,0.7747678470412706,1.0885517092251964,2.1061112065271197,0.5321693902317197,1.8830804907445808,0.4429955652305853,0.5038528185432753,0.8781519448445274,0.6312659173439468,0.5291121106150687,0.3319580094375776,0.503363227327131,0.12159297456256098,0.3549868088809225,0.9628462377354308,0.5461827476411286,0.4845853017301637,0.2527027461388213,0.45027786446797785)
rate_lwr=c(0.056323000084872565, 0.05283460053861888,0.10951331507445289,0.08590552638432541,0.11995938257674854,0.030921513492669583,0.06976244783705812,0.08271370688000845,0.05802215176589906,0.21024289981917196,0.04277536017914635,0.07854235468866325,0.013676760674313393,0.07484971947247543,0.036312214959942746,0.019901896208838754,0.10768672159093401,0.07532681056525733,0.04196915750978092,0.24157032132615153,0.04439613414296101,0.14138121802493145,0.03925604189392784,0.03848384881980882,0.13076760900811224,0.005104050472969829,0.038250977277521025,0.024713954777042246,0.03728563540993385,0.017812249347993026,0.2589242395283728,0.2136095349351412,0.28359931260233145,0.15364866601902502,0.31998316689507905,0.03974953952548327,0.07413189091592248,0.077095980900145,0.1733773564091277,0.27085730426901367,0.11367729831501872,0.015765582191053562,0.14808907739115687,0.10118181760004735,0.15478747465444295,0.10744790855878335,0.16379595827507276,0.19194812361778327,0.018589017747703218,0.22619347500787101,0.028747577008516212,0.05405424411567045,0.18410453654389797,0.19891485236756895,0.07032726782424273,0.12217394844456056,0.3364736610571194,0.03221017235660478,0.13046055932437953,0.012730264739974184,0.05720341774128124,0.02745634221898019,0.1882183727610064,0.1142859577705384,0.27041745949371304,0.1903192126483237,0.08311812165238619,0.19620319499445135,0.01075658196656748,0.012358873382252222,0.006229976488525968,0.23011576835373093,0.08305437522186182,1.4429693135846164,1.0437260279203593,0.2790391229373267,1.2990719964241695,0.015653280347483256,0.02197505322194196,0.23488963550755007,0.27280185160839376,0.21477224410762513,0.2712426235432236,0.19964467754199058,0.07888249750706927,0.20251353670708955,0.11628471425528397,0.1015763834042574,0.010864115282841424,0.05697182368460707,0.13782596298074618,0.1294191180654086,0.14563094805819526,0.10381902526273246,0.058920214818989236,0.34767887435976597,1.355331840129778,0.5997264857971929,1.534612840358734,0.23572747051491566,1.424769709487331,1.3616057012937492,0.3796251558007233,0.2662983366716832,0.2589565304173964,1.369897750062856,0.2176605181523209,0.021551600147814293,0.03863754817381221,0.019451345183617907,0.05754546966476398,0.18043340910829214,0.13395940801676087,0.21424378057180996,0.20177258064472525,0.12636736471583615,0.1417508891155223,0.18572483456581873,0.024838631551065388,0.06419216872190181,0.046183991651330664,0.08206158007548098,0.16550386993604269,0.1638465653934737,0.04036357298680715,0.18218016022980071,0.04691119523594284,0.1650498839138847,0.07328258605245347,0.07607049083794162,0.092883345998659,0.2733514990448106,0.35946182349919753,0.2946908386080722,0.30210839023492364,0.35880007975255374,0.29259336042419776,0.08737113562237259,0.08938059752848221,0.12959780191814868,0.11162736731427406,0.5498698984478901,0.16834475804929872,0.11566274609851732,0.16332256908679485,0.065021599550382,0.5528639317195247,0.15322747871529457,0.10516342824504499,0.5839702484856608,0.5519614873002032,0.49508346779190726,0.5848351169826025,0.22070270189755056,0.21709422053273741,0.15735019187677957,0.05663609604181852,0.2032938341658538,0.5886230177407803,0.12580849903151062,0.4598013977934132,0.057930943022345666,0.08856750499671778,0.1322753390878224,0.10554309717968507,0.047435740345367516,0.011729621249412514,0.03143773218495055,0.00916480839185635,0.10555509968417526,0.10416097428465565,0.1485540313984387,0.046134827278283635,0.05936916975534273,0.09193745154897454)
rate_upr=c(0.7091243960316151, 2.0271543164183097,1.007175845791204,1.2722298678007962,1.1333811083255385,0.4258003860091992,0.9844288983638103,0.5349288399546791,0.6687184664793986,3.840434151784917,0.53811050378145,0.6090040777014344,0.3123030578612759,0.5903418846599028,1.1798013347340532,0.5956862987904432,0.8861440330564831,0.9667554733162773,0.7065637312733142,2.2583496530790237,0.980936561274626,1.9289020703050768,0.5675923526888043,0.9911681661661623,1.5949763415738842,0.2928176662483535,0.6520164227662294,0.9884506921438319,0.5953177044037099,0.2764230226124165,1.1448763054279614,0.7683449422448245,1.7109520257351223,2.309181705104684,1.4341483913376978,0.7491792712407017,1.2839365650955474,1.2531302233056199,1.6332724098665166,2.6206184221373627,1.6918247569930849,0.45737840637550436,1.4311879501181997,1.2701373280292514,1.2097967316000595,0.8489090786887861,1.240523732881581,1.364239322014565,0.6931572352603956,1.1985900831179261,1.060494178657224,0.5634723217231872,1.0556037516599055,1.0853965177289002,0.4872927474535884,0.8689287426382777,3.6756529266045304,0.8029887793321961,1.1363758583453913,1.2950264778043399,0.9568331758312195,0.6614435942116148,0.909784458110045,0.7332304658487514,0.9620379852665173,1.0831013474399582,0.6866195508393498,0.7931298113880706,0.7223001626791119,0.5159761900844846,0.34096949369375745,0.9772213127145932,2.762389067158567,4.794937702088181,4.675113817865425,1.5080503132140703,4.666612446084011,0.8618382555185116,1.5610501432396102,1.4110216177433235,1.4726545277742116,0.9987647578116665,1.6480015545830076,2.5788102095227066,1.1943897944698023,2.471591668539259,1.0972687226615094,1.4412154297104522,0.745044965406687,0.7926792219833372,0.9418660563387642,0.929030873387932,0.9673193530701777,1.2770104314933375,0.8285144135895165,1.83658508542386,4.620918019500612,4.5459290116548265,4.858822844060017,1.0216976224203886,4.714614451914848,4.683732426443605,1.6990154003518496,1.5652935148512719,1.14424141413081,4.6336038755169975,2.426518982428691,0.4856764049114671,0.5628597745640431,1.2344580266885332,1.4844209128433463,2.381494854559148,1.389100687315649,1.3702311566810135,1.3997252252364278,1.160182515763681,0.9169600203825611,1.2728327562825303,0.3446370899080907,0.5330970403344738,0.7321217841918926,1.481913125964577,0.7742776821430988,1.558101154348317,0.906415057870808,0.9067248607808879,1.0840618444646428,1.2189227689830784,1.9233259356030707,2.149968895403784,3.4609951945036226,3.011556202296754,2.9791223261702076,2.7162150558526066,3.5242062147271462,2.97228784514955,2.7633437911650383,1.5614858577547008,0.698607249064796,0.8137925176225028,1.1695980996673967,2.9923531165612998,0.8505378330487237,0.6354608726238304,0.925238540480487,1.1095403504974617,3.4689933649189952,0.6812217677458268,0.6028930122374261,3.1102146691205776,3.0759094512668907,3.03330245670686,2.9944363157766865,1.649333402081918,2.471982849723062,1.345932701419494,1.8394563361920973,2.3312073921277254,3.8686645733985965,1.0574845629970673,3.4455500812860826,0.8864420823066308,0.9728179806838639,1.8057509218706382,1.231898278672027,1.2125837543329616,0.7805967117383479,1.357880501358584,0.28716199893603245,0.6801355020308844,2.0674006884629037,1.043787091571172,1.1408447043349492,0.494254412136481,0.8995652493609214)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.042959260992028, 17.637774121016847,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.834541775289008,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,21.868567692284742,10.092919561981976,12.979848282645456,13.509885309719447,13.644381033687072,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,12.763996434850949,10.928438777046042,19.116662982107215,19.495450853775065,12.67666310315921,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,17.601246343925673,18.560496325894754,17.761269068190476,19.184996314156102,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.579496325537615,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,21.04119030911618,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,21.04119030911618,12.685450981781905,14.172329741711991,13.876163080612338,14.172329741711991,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.953699984613685,13.644381033687072,16.26999636894904,14.445304095555281,9.062465735197444,11.566150303520583,22.62499624949477,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.26749625621469,12.543329772332134,10.058496485705948,12.685450981781905,19.776150149198095,18.82474632092768,10.704829806890222,11.45516312611962,23.096662907295563,22.62499624949477,22.26749625621469,22.62499624949477,11.566150303520583,14.172329741711991,18.04222710486738,22.72199624767148,21.1276885853318,13.580403826912434,12.518304131776894,23.096662907295563,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,19.967269026724537,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,10.74007339597134,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.06086318545978361, -0.07320681727606428,-0.07654386546924924,-0.07652082005947268,0.06015277042745716,0.060532182241244445,0.06134160877155066,0.05883647335204323,0.06049601822232399,0.06016221345052792,0.06139460454800635,0.06039206126448988,0.06138903518756388,0.061520983980732295,-0.07209824586668527,-0.06922863134887078,-0.06910948281423708,-0.07161118111329488,-0.06192029879561736,-0.06131933579919258,-0.061327977153789556,-0.06146726901591268,-0.06136291441456196,-0.06170344241304467,-0.08893380195546513,-0.07976016902898862,-0.07955792294167474,-0.07894364089016828,-0.0793768336540074,-0.07995504658238008,0.09788447786700544,0.09593808752730798,0.09868807414607662,0.098726580840775,0.09885123463650929,0.09634769055247284,-0.0648585389200765,-0.05957162711971377,-0.08115495325971364,-0.0820398763457792,-0.08238017286631438,0.022813042716348802,0.009229190915564725,-0.04557356707020532,0.03685080621474376,0.02285466617227072,0.009642813194151133,0.006766637181752046,0.02284673822562455,0.0227445896268209,0.03967907917964772,0.04112748739955513,0.030446364855025856,0.020459765889077268,0.030591194068119654,0.033495721524301754,-0.05757741652839084,-0.07691422929805923,-0.07689361555560559,-0.07715538593628542,-0.07671325810181982,-0.06071069314928294,0.09719790264756598,0.10249032847658794,0.10184980688164588,0.09744977975872963,0.10249032847658794,0.09961632655428475,-0.07051088980067645,-0.07035778570750412,-0.07040093643125926,0.09753675648182475,0.10043582143234506,0.09924740092506278,0.10047138144545441,0.0986561195212667,0.09930482795080899,0.09877558705182889,0.10044584016482101,0.10033714803788372,0.09825129929205648,0.09732779193782583,0.1003701511163029,-0.07811555890718322,-0.07814236227038887,-0.07809441010494492,-0.06804272423989662,-0.06804891569395767,-0.06811022509021282,-0.06937270206264284,-0.06900546752659756,-0.06903601803835074,-0.0690188344332923,-0.06888269886928487,-0.06955655425542563,0.1037733931532181,0.1037633575726896,0.10357606179229606,0.10324774653863121,0.10254054575470525,0.10382623270826564,0.10381266104753697,0.10309915537312599,0.10269556488843296,0.10239488734609872,0.10336390163993146,-0.06345016863189182,0.07334882521558622,0.07360631131333446,0.039880200479503684,-0.06372005944857383,-0.06328242704877324,0.09653296763313617,-0.07171735264158448,-0.0722744574858852,-0.072293871963516,-0.07248434364707344,0.08108191417615915,-0.07520864461440263,-0.07472620452451106,-0.07485040424751153,-0.06813985969469914,-0.07352821565751656,-0.07359220858430288,-0.07372851767374754,-0.07383517685541059,-0.08727648872003313,-0.08660305925208758,-0.06941424541511607,-0.0685290732684182,-0.08969812819891607,-0.0889731887948056,-0.08876398257860366,-0.08987528834698731,-0.08654924136005526,-0.08869648644233913,-0.08979744912076086,0.0850265542917809,0.05253999816150864,0.052897080295195485,0.05283909848981713,0.05429048430326618,0.053607451804809685,0.05354690792780892,0.05291816156967447,0.052257854409575415,0.05416549783779733,0.05355615841765849,0.05363955484110088,0.05358555599967042,0.05294361831068793,0.054313435590982645,0.05406580720860022,0.05231967302879916,0.04161979671927981,0.04210841979005081,0.04283199701354937,0.041758802773506146,0.04209656800408919,0.04219929731322728,0.09518983668683846,-0.08919652356918696,-0.08900895996880469,-0.08911434585720089,-0.08906317033427297,0.07894341555887935,0.07889626640009036,0.045935992918228565,0.0455992836847894,0.04582059893690615,-0.07284491389831158,-0.07324876953223641,-0.06793447546166666,-0.06830321244694364,-0.06793199529150763)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.03462024071906069, 0.07018066553476544,0.07851358038821488,0.07845636517082556,-6.167341075193957e-05,-6.26208322354559e-05,-6.471432891869522e-05,-5.830386317981467e-05,-6.253144808346988e-05,-6.166835546200166e-05,-6.484953227148783e-05,-6.227005165509265e-05,-6.48345433053406e-05,-6.517380366707649e-05,0.06737363908527712,0.06065142797523809,0.05775953648598828,0.0650279892825026,0.03610680305246459,0.03525575995242727,0.03527133955528855,0.03546210408682689,0.03531827123831282,0.035798090204728794,-0.2056659901999113,0.08600437831751898,0.08547627868190652,0.0838747145962025,0.08500358679432671,0.08651676274447061,-0.01248385118327658,-0.011873599924562732,-0.0127349636805204,-0.01274701531513814,-0.012786004406633735,-0.012000245543109888,0.044165049262359035,0.03621550323622672,-0.16230111118674165,-0.16701843082999865,-0.16870448128367338,0.0068289983506128514,0.0080699499404625,0.012746700302059915,0.005042298155076044,0.006859270217647005,0.008016582470091549,0.008247958694016955,0.006853527356061122,0.006779378811098134,0.004724679064291637,0.004577821105504379,0.005859675877131437,0.006893384568341847,0.0059276272109553526,0.005491737178147434,0.03109801646293377,0.07945235732361824,0.07939985681609887,0.08005825101738792,0.0789496838053357,0.036725865240875434,-0.012302119867368217,-0.014072448334858137,-0.013859629765493412,-0.0123895059993934,-0.014072448334858063,-0.013113098295605021,0.0545371411629066,0.05424995961167207,0.054330507239812156,-0.012376941235415587,-0.013305111974983387,-0.012918259178816333,-0.013316507243567824,-0.012731813217488381,-0.01293638830631625,-0.012769623298662717,-0.013308279722953903,-0.013273443805182885,-0.012603349045069876,-0.012312529993346063,-0.013284019241828355,-0.14524385197812298,-0.1453644722716534,-0.14514778542901705,0.04991763676010614,0.04992867037788672,0.05003773212149853,0.05823898316275772,0.057492232285369066,0.0575538340991296,0.05751918828160447,0.057265252465541275,0.05867293694307972,-0.014509533066124122,-0.014506116608304016,-0.01444270054748201,-0.01433146687063186,-0.014091260907832177,-0.014527415829414423,-0.014522814384805524,-0.014281478737629676,-0.014144531489181808,-0.014042848757113497,-0.014370566621944872,0.045210480083165326,-0.004670108797673021,-0.004709958318709225,0.0047830843928095505,0.04550080799342111,0.044743761689009245,-0.012057797527212819,0.06651243888297398,0.06777849667943807,0.06782274162680663,0.06825661503192569,-0.007093538488054764,0.07399564547102289,0.07284839249303435,0.07314301533539617,0.05809863624502364,0.07097779662735106,0.07116551258507708,0.07145790907598502,0.0717083766604414,-0.1962625086988851,-0.1925993930146172,0.0609420381696553,0.05078236390881816,-0.2101194127013782,-0.20599903567380803,-0.20480311441779925,-0.21112657434301718,-0.19225770214983773,-0.20442620060289005,-0.21068444030268993,-0.008354608561954708,0.009777015930329388,0.009941980238598222,0.009915478731409551,0.010602961914556952,0.01027910114411212,0.010251075731703842,0.009951572287262733,0.009650262437008951,0.010543763884224022,0.010255364949980349,0.010294040669512118,0.010269918341355209,0.00996322071877191,0.010613808167261379,0.010496763676417048,0.00967779747091427,0.004761566773114621,0.004946880248819223,0.005188106213538591,0.004788069302060452,0.004972731204726922,0.004958530489560851,-0.011631609091310972,-0.207145140623968,-0.2060918219305312,-0.20668293569451335,-0.20639581093063813,-0.0063713920575913675,-0.006362191794353136,0.0036278901868327627,0.0035635376171133703,0.0036058527610191874,0.06911638993328464,0.07005015441191662,0.04971492775053995,0.05037279053198538,0.049710538095631966)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(18.205000000000002, 18.205000000000002,9.438,9.438,12.725000000000001,6.2895,9.438,9.438,6.2895,3.0900000000000003,6.2895,9.438,1.2905000000000002,6.2895,14.895000000000001,21.735000000000003,36.357544499999996,31.000000000000004,9.438,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,12.725000000000001,3.0900000000000003,9.438,14.895000000000001,14.895000000000001,14.895000000000001,9.438,3.0900000000000003,4.466500000000001,3.0900000000000003,1.2905000000000002,1.2905000000000002,4.466500000000001,25.565000000000005,25.565000000000005,14.895000000000001,9.438,9.438,18.205000000000002,18.205000000000002,31.000000000000004,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,25.565000000000005,9.438,9.438,6.2895,9.438,25.565000000000005,4.466500000000001,0.4535,3.0900000000000003,6.2895,0.00585,4.466500000000001,4.466500000000001,9.438,9.438,6.2895,0.4535,0.4535,0.4535,3.0900000000000003,0.4535,3.0900000000000003,1.2905000000000002,1.2905000000000002,3.0900000000000003,6.2895,1.2905000000000002,14.895000000000001,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,18.205000000000002,31.000000000000004,36.357544499999996,36.357544499999996,36.357544499999996,36.357544499999996,31.000000000000004,1.2905000000000002,0.06885,0.4535,1.2905000000000002,1.2905000000000002,0.06885,0.4535,1.2905000000000002,0.4535,2.19,0.06885,36.357544499999996,9.438,9.438,12.725000000000001,25.565000000000005,36.357544499999996,4.466500000000001,18.205000000000002,18.205000000000002,18.205000000000002,14.895000000000001,9.438,18.205000000000002,25.565000000000005,25.565000000000005,21.735000000000003,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,3.0900000000000003,9.438,9.438,9.438,1.2905000000000002,4.466500000000001,4.466500000000001,1.2905000000000002,6.2895,4.466500000000001,2.19,6.2895,3.0900000000000003,4.466500000000001,4.466500000000001,0.4535,3.0900000000000003,3.0900000000000003,4.466500000000001,9.438,0.4535,3.0900000000000003,1.2905000000000002,3.0900000000000003,1.2905000000000002,0.4535,1.2905000000000002,9.438,18.205000000000002,12.725000000000001,2.19,14.895000000000001,18.205000000000002,9.438,3.0900000000000003,2.19,4.466500000000001,1.2905000000000002,6.2895,6.2895,9.438,9.438,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205000000000002,12.725000000000001,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(6.0, 3.0,1.0,4.0,0.0,2.0,5.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.04274580169834859, 0.022551121831379455,-0.004810488543337025,0.020554756321208623,0.2717693112160533,0.2817957482891396,0.2260998655818907,-0.01463283644922571,0.23865747882354207,0.15122877327125153,-0.029788610982103902,0.3007861039826067,0.33149231850096955,0.09706270776245206,0.02726995474468633,-0.0028913155044775034,0.1770376876020416,0.05565528034032364,0.004640049253659116,0.007397114599049703,-0.00506287887876,0.020398986282228138,-0.04448927823468645,0.008225373832809942,0.15489484856409547,0.1189502338426158,0.0408343957700837,0.022055645326473555,0.018593262853199483,0.04130027717584406,-0.18597594636633064,0.0018265277777528516,-0.17387562309207122,-0.06694544830191258,-0.15717560991170756,-0.09384693220513406,0.005601384833538327,0.1060046540237677,0.007291929716206013,0.04424995525899286,0.0662021166297562,-0.010649852064232905,0.01137788690854859,0.013883096840887095,-0.01436956000025902,-0.005937041331378664,0.003244650925485066,0.010251950719880411,0.028808473093008404,-0.0016506407310416993,-0.007272857180654724,-0.005512283291446552,0.008127809643610194,-0.0024622769857291222,-0.005107673309243576,0.037725167169379216,0.05279794707678406,-0.003930862540464352,-0.015171100058853517,-0.008371217749896652,-0.0005553396903472605,0.2230792235175385,-0.0035260022101010957,0.044052450072095975,-0.15404433810365362,-0.0048113323382901994,0.03266620802443662,-0.011038036727013562,0.15530360016525568,0.13369312898603905,0.00804861510010277,-0.09490417695106147,0.05616810713169563,-0.07678244005627409,-0.0641961982108396,-0.059541224321597114,0.12514227068103717,-0.06796812413447749,-0.07106499286210738,-0.2195295543525003,-0.02731177118516385,-0.0047865607166741875,-0.2549760880250628,0.015660696044291142,0.010700881245663554,0.025649928520845935,-0.004043145188826253,-0.009413690690369271,0.0008557176983932967,0.31541589062259917,0.25761303297632004,0.26165524767973286,0.22919910624228879,0.1681824511434183,0.21448579796285247,-0.09876377838287909,0.13663690781044463,0.024033464848356053,-0.13558469011486096,-0.059920389560885134,0.13452882176103761,-0.0629390495352146,-0.2546744326900593,-0.11177659726915373,-0.20993034115426884,0.1592382607067961,0.3371296899543906,0.0069164183017925126,0.012783092138336425,-0.018263671632705293,0.442832944175176,0.3374176082552327,-0.09377491687567574,-0.018923369620822087,-0.006854955644894204,-0.00551324871545934,-0.013625184018807784,0.003947320940659933,0.044845996281827276,0.08504244376212605,0.02526762655015072,0.00830334513292708,-0.014931691394097973,-0.018717041746761594,-7.617840716603918e-05,-0.017766397726172986,-0.012044072133401706,-0.014821861519234788,0.04024228197749428,0.11712999654107731,0.1767067035347217,0.1974006322760775,0.1575862835967759,0.16830965335942727,0.1916104142759448,0.15513355111354382,0.16970043614665345,0.0340255210304807,-0.058654010206912195,0.0001794119984111238,-0.0017846848335135068,0.015856421962899703,0.11727793288302946,-0.03779527872188637,0.11736520428864002,0.006675170540053313,0.10895455381518813,-0.07995390571751496,-0.08673183967063201,0.03565724699164944,0.038655711996023225,0.04479414809291103,0.1051234403182979,-0.017585706134736978,0.0101631537907523,0.019946053570545977,0.10254759500290295,0.059431667056836904,0.020368901543109733,0.13561037067065404,0.04037954132799265,0.01642977427633997,0.034105547253387936,0.16101214149193493,-0.015770408916960778,-0.020726186454274733,0.01220955023176392,0.024107219814728235,-0.01272262788470633,-0.01967819079951309,0.01739922798668205,0.0035886421132977574,0.005205032397688998,-0.011310630852431041,-0.002518843677814478)
shap_list[[2]]=c(0.0665488197502039, 0.13236714016434237,0.23541390198146286,0.33410197048859364,0.36513335980965533,0.3868274007243452,0.3536350666139868,-0.03976740708777979,0.3734035848638076,0.29319892709316475,-0.030961409441191683,0.41739838300388493,0.47545236393747137,0.1800510626744126,0.13320525488070437,0.08536616284188775,-0.09396872612707718,-0.09162469168157947,0.05413367081842755,0.09396991429090581,0.011410978790022602,0.07539021184584185,0.04917514416329628,0.07397649484995793,0.238884714988123,-0.34933690615955093,-0.08050006651002943,-0.03284303011266532,-0.0624399787162683,-0.08156045539412568,-0.08229877670201513,-0.031051178944206906,0.10922690932565744,0.0011391814895444531,0.11262358888610997,-0.0803446928066175,-0.07876442976550345,0.12645848562386247,0.24055800998415364,0.17806634454092815,0.2477791562564146,0.08393241189435323,0.0829599747806977,0.08519864351172127,0.030164717274510172,0.05187618579349702,0.06658712141328008,0.08104835831315015,0.061678127650608386,0.05881488141028756,0.18604313680475618,0.11200271025284339,0.13684266221022331,0.0516298097435273,0.09880770688658379,0.1095025654424811,0.07839045329607293,0.14566389232344742,0.17946399111026862,0.2467562202076451,0.10294385476773432,-0.0763095936930459,-0.025718553564434365,0.06110624131014714,-0.036196011071204875,-0.02902907032322116,0.055998291927711226,-0.033477268255924196,-0.1304637282540898,-0.1548648033434398,-0.06848621788270325,-0.04539416561583738,0.0577264392528439,-0.1347319430439522,-0.06250529519240638,-0.047708148533393835,0.06351907501610118,-0.05096062170515759,0.08874505118496445,-0.06955332579474603,-0.03329590098814288,-0.03214294771929305,-0.1131804141778347,0.24037870322100904,0.2488165517411067,0.2958367242064821,-0.07008769699611395,-0.05191846037436975,-0.0517747507435807,0.16066535020970826,0.10840053345575403,0.11230576810029513,0.08566876574735134,-0.0693097645047933,-0.09174412048608914,0.04650649060555692,0.1523474167480315,-0.0698196977741323,-0.1557900932620723,0.03262445735813282,0.07922125958365986,-0.019296057827903394,-0.1077861966459418,0.10565908394437819,-0.11276478871789006,0.08875466197943827,0.2991392475873209,0.12519066409454133,0.17673216668319933,0.14741572229048291,0.3925097205927833,0.2989278793505798,0.3494065309628874,0.11573261594200902,0.16271836578582635,0.1692717722054458,0.14116443003733012,-0.02840522958803965,-0.08851877376028458,-0.14052672316958553,-0.078319368395168,0.06357683900792145,0.1169223346124899,0.10797408330715637,0.18401188817139166,0.10512666844937137,0.23998642546752005,0.21452918658664125,0.3938698470902906,0.06236501430576199,0.18547710495795136,0.1455917768518762,0.11208905149875345,0.13745476455822495,0.16812502877779983,0.11230489510522797,0.14159871813007055,0.06681037721566772,-0.07966036721795737,-0.03979654568240861,-0.04044617806633061,-0.05374483897652323,0.17197991212095276,-0.08752740032987179,0.17170614158247044,-0.027334519516369553,0.20784991972975886,-0.10628395931861567,-0.10655174934618795,-0.030601904060278348,-0.07121192629458586,-0.0674395208875839,0.11016755978294984,-0.05984155476128538,-0.02416754485270612,-0.010481958078434427,0.06382589532361417,0.03262129185029708,-0.03717487975060666,0.1915748395666458,0.09195687502104098,0.021039561836568767,0.04046817151092247,0.2212693507001518,-0.028904878095329222,0.2288108605308488,0.17845498888399594,0.2793732186864265,0.0932197843730496,0.08519391534962076,0.26737357206540485,0.23103122723787398,-0.05718586493111245,-0.06516044614923781,-0.07192536913476784)
shap_list[[3]]=c(0.10769187149588492, 0.3110741824202664,-0.13443784574902534,-0.08317284826243956,0.13025680229307357,0.15837352852565997,0.6604077071286546,-0.019443543444515432,0.668239901970912,1.68685017034513,0.04991466556919385,0.1371878852777548,0.0402950298694609,0.38442418268137774,-0.02418641927150085,-0.1026768594234357,0.12638011187332845,0.07660178391670747,-0.02188372168511225,0.005086813076825123,-0.04015235279212813,0.01566088574853935,0.096811797823267,-0.029447416976322045,-0.07987583205438036,0.3877300497168454,-0.00641370081573797,-0.003417649636781334,-0.017535632491407386,-0.005503922001945413,0.2859227151379256,0.06346518059769057,-0.024510948099397946,0.04744577949291643,-0.032230796978976656,-0.06080722321338038,0.07543526361718157,0.1908802382230995,-0.21885474780349778,-0.18607263038396063,-0.2037186436441636,-0.08614798065791823,0.04858593491079603,0.10953917610265902,0.010722796890212579,0.017376413390784478,0.05140181937966346,0.056751974147685715,0.016123991192376647,0.014174743194358862,-0.18443811240208985,-0.013517312694245978,-0.004040236751018355,0.02436587383586275,-0.0047431258323806565,0.0047079573986474315,0.10712668709598913,-0.04106168735573021,-0.13201081785173693,0.37409958532145215,-0.029909601107247146,0.18777615691365634,0.07707246000054242,0.5542770405286711,0.4019824739909532,0.08928582470047179,0.5656090590003067,0.09977701196784511,-0.08672926617837934,-0.004868090438720651,-0.039843541767326796,0.29304401223756155,-0.04533844984333182,1.6535377497476902,1.2030893842004797,-0.039620436660175666,0.9040772136393714,-0.2954918108836383,-0.7729611768597549,-0.09663858273747299,-0.02794724433626323,0.09023423460398577,-0.060941541817661544,-0.16679111360665486,-0.20349169567435477,-0.16191753164769196,0.0025416648266442547,0.005055854416774103,-0.13270081904913208,0.31930251676816335,0.23130198645056957,0.23834278184764007,0.22130846397748954,0.12050078860105938,0.14837894669872517,-0.024744588852332817,0.8838411835831079,1.3951787025036926,1.6201942565467322,0.5819087055821385,0.9132358374941866,1.634223305023369,-0.10519176701406775,-0.017649793332320318,0.3104119535829187,0.90309613323565,0.400301693420511,-0.019160760099125686,-0.012532915792588938,-0.12722176614473846,0.5296288964260837,0.4006789451018841,-0.0746624291729655,-0.03495662206172896,-0.06095316952784583,-0.062056305156351445,-0.05315593168811799,0.052365455297617595,-0.02387062514933579,0.11705497943063295,-0.026743396276421635,0.1335273538905399,-0.041810064522743697,-0.042402213715895136,0.20482432483673849,-0.03545403744263953,-0.2460195844575797,-0.25254065757317484,-0.04657614247521973,0.1024515153375205,0.20537114086384023,0.30761015173997724,0.3256031730203584,0.267501892109256,0.2569464559734688,0.32617547171898087,0.269574238930977,0.09594104617075039,-0.09327947384609539,-0.015548805659010102,-0.024860757081040963,1.02787171675628,0.015461081642483793,-0.12467971082667705,0.01464587650693563,0.05421821923216362,1.4399750899111619,-0.12828538167370754,-0.1283431590752051,0.5525429403121952,1.0206622030492627,1.054854510513396,0.9939229919990408,-0.03748888244370608,0.019599494409072056,0.046220148380536855,0.19331197536008357,0.13233027718472012,0.684643394070222,-0.009359266133995434,0.6595216071000939,-0.24664531328445385,-0.21527194023401172,-0.07705420780013399,-0.23045682458541444,0.13642518266587197,-0.07678187193700069,0.04961301439071678,-0.06352547392814929,-0.014984152526412131,-0.08811545429811392,-0.12815357439607436,0.07903985830243124,-0.0012776873566752096,0.0032038803029734602)
shap_list[[4]]=c(-0.10343176992852193, 0.058858081394484806,0.08254044608685761,0.22281363140230467,0.44739440793503005,0.5240891701514353,-0.11845039316095153,-0.004614060182179297,-0.055192667381015914,0.22423092063442265,-0.04187276056202733,0.40695247767314424,0.22796177848727492,-0.0596516225345435,0.029757869592224307,-0.036919842089672306,-0.04574572597471638,-0.03832088136594119,0.07473556722448785,0.0357161152102007,0.08583337296647296,0.035033069384754194,-0.13338903826046405,0.09512587182223653,0.03898103903820506,-0.050219666487425145,0.05924219749521801,-0.010132121948873715,0.016843408339985547,0.06312327066966421,-0.13153968245686157,-0.027297919905818636,0.4518683293657583,0.039578954410771486,0.36971087557892857,0.008834784239443786,-0.0349603592535993,-0.08243620435088826,0.20146635687455156,-0.0041610700234089425,0.11444124767572937,0.014643041249400785,0.02883271218597256,-0.09309980216307717,-0.014378133048205776,0.0015122565940688933,-1.1298052003903602e-05,0.017559412196120047,0.03994072480319128,0.017944343553370757,0.17246518402692676,0.05040584096605218,0.0602992114313741,0.00315724325857828,0.028044459147268976,0.09444485701409841,0.03350729042627247,0.10137394702429098,0.03833773695824482,-0.05281849414129888,0.06274337073082917,-0.06343854964704118,-0.028028531084009444,-0.11899039492658736,-0.08156057332667922,-0.025700261241546174,-0.1888562705221728,-0.03974501818768267,0.3683170254219997,0.14145479083900192,0.0007406913943228595,-0.09797402585922826,0.6142088596845422,0.5004088209070194,0.5669466964493,0.09029861206528891,0.3814203189114058,0.09129955204510193,0.5980409711240755,0.2507359941786909,0.034534984221609076,-0.027750582262092247,0.3870717886236854,0.018466827744783733,0.10020071421293339,0.014941724153591256,0.03673559997003024,-0.005956291522824294,0.04288510128710398,-0.05669481669895171,-0.07287212678034143,-0.07160783262751051,-0.06587160229679939,-0.03413681277618822,-0.03982186093511131,0.7261908092119386,0.32360830924575634,0.9292311745425643,0.4962601825800131,-0.002494820435669921,0.33858089109378936,0.5693670146731133,0.12151430588904233,0.6145755363995146,-0.10188351301719176,0.32963275343928766,-0.02999272011196341,0.07341006456664453,0.08852019091422142,0.02751284384823612,-0.01943534289656943,-0.03011368070052701,0.10477870896250058,-0.004616113080992302,0.058672963659655554,0.07479135337327296,0.03336960148934698,-0.026871146883130564,0.05222048282351153,-0.054217820540341646,-0.010156929475714647,-0.06466251157274679,0.015185310896366424,-0.0023055173681708835,-0.1550629845570504,0.006139244340766642,-0.019993384484146053,0.06872196869700356,0.30288758967981044,0.08601467431166188,-0.06708971953063768,0.2470015677086615,0.22906076297015943,0.2601348376623462,0.22266792875061314,0.2898669751183985,0.2622794332253446,-0.04279879652381701,0.3385876967790155,-0.008172790540926865,0.0179283223198808,-0.43684909674798167,0.4432399536952443,0.21440495737821927,0.4323153883740208,-0.028291488894490076,-0.21937772902831473,0.19645461896380884,-0.030684230814555877,-0.022337734219687072,-0.43571639364292486,-0.4195893305693045,-0.3873371103260387,0.038812266269136836,0.000175420427974912,0.031327935954648646,0.20812985488925875,0.11226281341747237,0.034480824892332784,0.21288705138679503,-0.054284492329596284,0.33004812154408947,0.44236455007376657,0.025985119263184402,0.058913778334353815,-0.09033290838499394,-0.031496202278158004,0.07680899722408807,0.030965538775080258,0.0012567101044349005,0.17633072754144374,0.10241192316040311,-0.021077356384791517,0.014279184996904113,0.051131310633435866)
shap_list[[5]]=c(-0.09416338471226156, -0.1241807386649835,-0.11377083299996431,-0.13313934650456824,1.428910767788805,1.5613870346291816,1.6647416770611478,-0.07853182156191055,1.73981728411686,-0.25057937348545545,-0.08143796325095187,1.5133084066265565,1.571169820359429,0.8301827554499156,-0.09675543342469842,-0.07413634687741111,-0.07401927536741072,-0.06851342870453567,-0.11057838509969065,-0.10293434177980779,-0.09590072395715099,-0.10174022257352296,-0.09460740245199084,-0.12187598910783591,3.2776020412020146,1.0535747396923072,-0.08056390726843045,-0.06404180504138414,-0.06819163617483136,-0.0809549180917529,0.7469403283177998,-0.09058442493639886,3.2952756787520445,1.132177214845978,3.270450913281064,0.6023196901466419,-0.07423263270648943,-0.10164260963302935,-0.1396039544289956,-0.12162673527085464,-0.13917129939410428,-0.08934002433338606,-0.09833532542630082,-0.0885994598386024,-0.08051003472142625,-0.08819974214967606,-0.09115670282226078,-0.09675909994458509,-0.09644189801158741,-0.09211703468677886,-0.10645377526219112,-0.10382858835779467,-0.11250621144943034,-0.0856363357526199,-0.09986304605361378,-0.10630127954878281,-0.09343776284516013,-0.10910594850324114,-0.10115280189126143,-0.13408558122042152,-0.10050128539165398,-0.09040566835390479,-0.0829716923017797,3.282196903163489,1.1169055676335315,-0.08434442576083459,3.2162525250039233,-0.011167885282626348,2.95480495742737,0.5818980851058677,-0.07175155370377263,0.6079421960822663,2.7574565209090793,1.402051076582616,-0.15786284074869647,0.14024455974822134,3.5066273603175597,0.49370895206344667,2.8936040748396437,0.7286677277137446,0.030823057380412112,-0.08212188937956622,0.9484562241467464,-0.12680086382922032,-0.13564514661559707,-0.13805769083399297,-0.0691407112260656,-0.06694965486552679,-0.06522672226006086,-0.11012670660243624,-0.09338245306935086,-0.09479666511672054,-0.09154198523361348,-0.07206656355525498,-0.07718208780983303,3.3200563592387966,3.555100788542448,1.294789896456385,1.3412127654698367,3.228717063809547,3.5461810624971877,1.6064372245433773,0.6267474762734477,3.3796733639541086,0.7321774765000201,3.5528667113819408,-0.12338922445063524,-0.11389025093497929,-0.09021063254512084,-0.08909264585387684,-0.14554237441433318,-0.12350040341856122,1.039390743827537,-0.08267360847683103,-0.10264494915175312,-0.103679668822979,-0.0933046682182748,-0.0889432008018269,-0.07804622604997001,-0.08022169781906971,-0.06723358137922711,-0.09446514756152749,-0.08873591108136032,-0.09038214632245987,-0.10622718528594072,-0.08605667311023044,-0.12267795351282632,-0.12739077948530947,-0.14089271184148663,-0.1247779958518349,1.1180117589104057,-0.15896629265496606,-0.16021448415668735,1.1088160725366196,-0.15343381088823185,-0.1616531361234766,1.1184203869826796,-0.09601864291979949,0.9553475037232253,0.017245530698305762,0.3780265605754958,1.0915426863798392,3.7808457634989927,0.8857177614956163,3.7765062465734642,-0.06832313776962738,1.5705461197674406,0.8408201891309547,0.6611685757347778,-0.12356338895204831,1.07783005973119,1.1768971146899176,3.333294210006742,0.10137277391851181,-0.0727227225204357,-0.08370406172873779,-0.09872478434213487,-0.08790420826322519,-0.15214916640987777,0.9487520281135919,-0.15042972972867824,-0.1405809951652611,-0.14732019233470584,3.2472138290951453,-0.1060800070714946,-0.12026074143596364,-0.09310040146882538,-0.12513253102440489,-0.09079464476639293,-0.09024863541934182,-0.11818319750925373,-0.11618895506383549,-0.07571780778873498,-0.07658836629740176,-0.08606406487155938)
shap_list[[6]]=c(0.10043350629528164, 0.2358014591049022,0.1715764066611414,0.24016078514198413,-0.014914978695677534,-0.01786276525949691,-0.07608432556954496,-0.08567926479988042,-0.07274833411489638,-0.07401179964580087,-0.07983256449626178,-0.01034757741118444,-0.02097769736327429,-0.07903962920202816,0.13113592613982253,0.09808414246417467,0.05824969103423513,0.04999277326959862,0.15452122123392834,0.144458473588217,0.09838012755445649,0.1400258185243763,0.09960150380975179,0.16989352872958316,0.2595236205628013,0.25502010874208775,0.06274261029896641,0.04280270056452947,0.0496929112857165,0.06424536869982637,-0.2722035819530519,-0.06222118647025677,-0.22523254188108582,-0.19442462552673231,-0.245921053980944,-0.20082542491897656,0.05151408781233041,0.14269245493566884,0.17504368525393854,0.12174613793398284,0.16827503049114517,-0.023772482470161498,0.03738418242343594,0.07218482375856602,-0.05314558420731899,-0.0138910259321138,0.020232030889230816,0.03879842445985077,0.000875279111323965,-0.007873715180435939,-0.09043865928001021,-0.051935618518990034,-0.011217604819833221,-0.008795247923286512,-0.02351153853390704,-0.012669699666460216,0.13591823608540976,0.1381578920619119,0.14380564224201434,0.23178857417436172,0.13476690256306442,0.08124520023078566,-0.057712844475809696,-0.28146937244428766,-0.31143699719633744,-0.06275623506480758,-0.2887900447428018,-0.07593578176133617,0.22533968364550055,0.2408383062049104,0.05355192412326992,-0.23314611939167212,-0.1201702446814943,-0.3012396094487538,-0.1506255124527923,-0.12467500425889742,-0.08501055580883111,-0.1356991846519731,-0.19876265018209038,-0.27521439345001947,-0.09696950339707221,-0.06814785135631724,-0.25631517193275993,0.15165614795376928,0.17167746982081186,0.17675114160280397,0.0691990344735711,0.049831769472887116,0.05366686640390166,0.16108179485166374,0.12737492161617361,0.1291916637808551,0.12080160056389573,0.05436670687839703,0.05988934240477327,-0.1659353917118978,-0.09261138049165583,-0.1474597490432904,-0.3238484308180372,-0.27561555750466377,-0.11223405921626681,-0.28215434521201527,-0.22311889805686677,-0.18912027200399953,-0.28856668195855817,-0.10584460080896806,0.23704917410988915,-0.13797536668461213,-0.13947892242703117,-0.07265455427232219,0.30487217927800536,0.23688315763584675,-0.32027061493114267,0.09074360288083923,0.11587453625774324,0.11922550658475531,0.1046085863435266,-0.05995413188586329,0.05896905025338437,0.06086365913246091,0.04379464740240698,0.13373878891421165,0.10241822130163203,0.0985997579904326,0.15212859514295385,0.09862819421903649,0.11358479503721632,0.12719278036087725,0.2796096760219665,0.2509538513771239,0.3703069893580731,0.32849539051473164,0.31233638286780463,0.32654251278818863,0.3249340428781716,0.324561417560944,0.3163154480230011,-0.07754195155046925,-0.07737307546070277,-0.06944740561392249,-0.05768786692444611,-0.0730193120776592,0.06736299708835862,-0.0954944431683681,0.0690816276182923,-0.05689123410709196,-0.028213425021275874,-0.09813919445770021,-0.11063017273904165,-0.04973525412528792,-0.061887380119288786,-0.06577362636930822,0.0003567531412355386,-0.06874149651249208,-0.05325139264391053,-0.043781548156783714,0.01852337476012199,-0.005317146831235381,-0.06404458330198785,0.04981714371261729,-0.10628322924538784,0.1566791293991435,0.18182133261724592,0.27529941351699405,0.09120356865391377,-0.10871921101516603,-0.0875064190381169,-0.018086821378277357,-0.06857218004228412,-0.06971322967399073,0.20933298103672518,0.17841470261529815,0.06119611057795812,0.058573985903495836,0.06929685619039651)
shap_list[[7]]=c(-0.01408474293049812, 0.018058908488818266,-0.07950381157590677,-0.07023121836540645,0.22432820057200759,0.24193597714397558,0.2782493093993384,0.00635141855960042,0.2886233696298025,0.20738451683934275,0.01871587887970931,0.23577431711819072,0.24153958963974997,0.15897021606768263,-0.0294991635977538,-0.031014609166193474,-0.04043284655701031,-0.051690046209939326,-0.02219947219431725,-0.006323233956041098,-0.022877136775494952,0.0016824585981595585,-0.015946051791238404,-0.02442117533440852,0.24339250377414814,-0.18576748027636464,-0.09234554526100827,-0.05596455456992927,-0.06564961723737044,-0.09361387976780167,0.10700664414790909,0.037954630157027075,0.35989217192709766,0.14843906420342198,0.3548087539008773,0.082808543498272,-0.02223772466901637,0.014316510890396901,0.20981638761633148,0.2679733234806804,0.25094590645993486,0.021394425477496273,0.028242676144825087,0.027241927943794608,0.009094415183025893,0.014438690411480257,0.023602017865765598,0.02892260801193391,0.02341796250981887,0.015975527137227732,0.03113543844152386,0.01802733795102521,0.02801988866752803,0.015645599754017338,0.016941725554384817,0.034032013087417094,0.02497175679748906,-0.1006833243746199,-0.0680462456198002,-0.05049559377519177,-0.06641339625976564,0.023156718654076265,0.043220188198189846,0.30533022005804705,0.15686758171688558,0.042049167699298916,0.3046002841032742,0.052340229656684376,-0.012060144185867526,-0.03774763306054213,-0.037491494046253855,0.11004691192692719,0.2861832703729333,0.2966045319200517,0.20494248104493978,0.06417450381515376,0.2964658778014828,0.0716860224747524,0.3461583871783992,0.13191976772170996,0.04587528615564233,0.042776290812877746,0.16449196438442074,0.3178899504137609,0.27238052701786253,0.363255646824662,-0.03755288805041596,-0.0237105046683126,-0.01749085525785924,-0.024052674857326813,-0.027023279240313083,-0.026948519880890653,-0.029458240364497384,-0.0353836790464307,-0.04002393892752339,0.32976214374655066,0.3015193115580588,0.3049939676713505,0.29161887909734746,0.3116928386509261,0.30411089616981324,0.3166913765892995,0.09341639345467564,0.359727035345516,0.1122075505800708,0.30296466225659185,0.05538656268463436,0.04234758392405193,0.054286685855437423,0.02777130791214659,0.06380398633734287,0.056471597469446126,0.17661688555953298,-0.05584349836507078,-0.08505793324868585,-0.08629059233807439,-0.0745670383799802,0.030934145219388722,-0.0763008118021779,-0.09162352713675723,-0.06185158839721591,-0.00726336259858242,-0.06251289459992526,-0.06759901858222762,-0.05540998276019422,-0.058536284053312286,0.17958670099928625,0.10422855768297225,-0.004318995947178417,0.00992180390324298,0.4687282061649173,0.7028030460387985,0.5984979910631759,0.2537007347406002,0.7420751659221317,0.6099919825452941,0.24649798801595554,0.05122050905377928,0.04677533829883417,0.003898916590854833,0.02635052352121157,0.12501825898964897,0.24731912876549114,0.024668379449228898,0.24872343582182282,0.0134426878177237,0.2049753812257278,0.017288827067017034,-0.0011324174157866442,0.05407393689719734,0.12888890599868946,0.13145996726709838,0.20390425108610258,0.006416040577610043,0.00841753266519879,0.01665665013280913,0.072092786315105,0.04387401820305947,0.05173093165014557,0.12914895675686477,0.11485015163196442,0.176301967514033,0.246167318138805,0.24416486703801643,0.12586080548630454,0.07295321200889608,0.044238856098427704,0.06172371266425927,0.02272026031709676,0.01231273715369112,-0.022065093490091305,-0.044592305214277476,-0.0218392415757672,-0.03254226371277328,-0.03878286525647416)
shap_list[[8]]=c(-0.01662750862262029, -0.03678826477502919,0.08395335574847401,0.07821060476940095,0.302062793228985,0.31644773075159727,0.3633819502221909,0.017343889463927432,0.3628760371578455,0.259914211459224,0.03130950006802482,0.3049018213107025,0.36121090352053264,0.21919533218326667,-0.039849519916416415,-0.018250957725020313,-0.1480124707836747,-0.07883484057359459,0.004466682480343739,-0.03508270936548607,0.028127620395085512,-0.02676758671683964,0.030681813619708242,0.0693840338967554,0.17242680118231532,0.21141275116845093,0.03864481872468156,-0.027226837145616304,-0.020174713796160076,0.03940209751053279,0.15435579785965148,0.05267410726699751,0.3653210372795397,0.15288093184924076,0.3695641504212093,0.11614077673273838,-0.04892180203046883,-0.17041145732859436,0.02411068900297968,0.00984571582653514,0.02325005898496795,0.05423800363047343,-0.05705168906294765,-0.1341974685793437,-0.01362014085869554,-0.0347224587748445,-0.04864410803652814,-0.05493200755931221,-0.04133029207177317,-0.03756230074177195,0.008795095221260868,0.004896719108105417,0.012416506098907876,-0.05358142066726632,-0.008320856171527408,0.08540851056146008,-0.06611469465881956,0.047992603601973945,0.04625439794439245,0.10863757836987348,0.0020148050276001675,-0.14485327629243305,0.06154626057959725,0.2934686188975357,0.21448601769011355,0.04412047217018903,0.2989639020924852,0.07103995492541439,0.2108320400560101,0.17720640368862153,0.032834185267101114,0.1583896424609396,0.23829125949765484,0.31075067820403923,0.2247572517711946,0.07368368693794591,0.23416869114181374,0.09295818817812258,0.32648181030893175,0.15835614705764536,0.05614507022519315,0.05475464279845342,0.18960793478773888,-0.04221517401506429,-0.026329453085909418,0.02203935462027272,0.03283864588424544,-0.043376473835867416,0.0051906840880724175,-0.28733448556365054,-0.3398424063851794,-0.33675445162508366,-0.3088938904830578,-0.13493446093875686,-0.1325510911669063,0.2941344151756639,0.22800489146805653,0.25887802781589914,0.2858937618830106,0.29696295506712816,0.23623771982225633,0.30555713414475527,0.12068421128892472,0.3345961696191624,0.1695438828004664,0.23429497994740064,-0.337572739383172,0.07299723423319605,0.07961653959669576,0.015041953104425987,-0.21799395839910782,-0.3383453137616882,0.23387378049000918,-0.05968551380447432,0.011744566110616608,0.0012770458142304084,-0.027168227828619912,0.0403926253520105,0.016060513785736044,0.006115810112906083,-3.0339753111037727e-05,-0.07590911463177896,-0.037800153174651456,0.0011326185246337678,-0.009860681568609262,-0.04055704636651633,0.11874800572035635,0.1315836758051378,0.03296611955840176,0.05688347976668114,0.18944345003535065,0.13637895435259134,0.10970081060425563,0.2008074860281157,0.08166847231833577,0.11161190657672945,0.2028685917224533,0.06565496600117235,0.2248702309385321,0.0456531862098218,0.09155862982256023,0.2565718749090693,0.30341995863218296,0.20059974989090829,0.30568637170807905,0.056346696565671546,0.3536047098026311,0.2009398973799647,0.1176899781024822,0.10134675741916542,0.23267973797222977,0.2601679628876877,0.2656275057921779,0.06186107458474,-0.026438797842588128,0.0063176613278924584,0.07416581572718313,-0.025191973164057406,-0.10680295571882616,0.2550843966292841,0.10814426764874738,0.14151119174088372,0.15031740701910895,0.17931814406219895,0.07544636238225863,0.09675884733491343,0.05699179194872144,0.023133136229250676,0.05131658572171991,0.000690647983024068,-0.021903864235047407,0.05829350125146426,-0.04628319348102177,0.0013439134266410699,0.0351557157034078)
shap = do.call('cbind', shap_list)
baseline = 0.3274518434000895
rate=c(0.3310728330492095, 0.94519373336427,0.5684129750097925,0.936750178391167,3.482392507548021,3.7804456683559255,3.679432700676802,0.10847821789812638,3.8711284984669465,2.825668189911371,0.16349857918448105,3.6334136609817422,3.555595950351704,2.058646848482624,0.4585303125471572,0.24501221791994143,0.2869402890998054,0.18071779239112884,0.4652874554318158,0.4697399890639529,0.38721085070259287,0.48713546449362655,0.31529033207773294,0.568312565112866,4.633281580657417,1.7688156736390557,0.26909264583383297,0.19868419083584243,0.1785898474629535,0.2738896822003311,0.9496593413851148,0.2722175789428767,4.4854168569776345,1.5877428958633164,4.369282664596653,0.7017313648730772,0.20088563123806222,0.5533139157843734,0.8272801996157566,0.637472884762985,0.8554554168597692,0.29174938612611456,0.40944819626511675,0.3196027809766943,0.20141031991193234,0.26990512140190703,0.3527073749627217,0.4090934637448132,0.36052421167705656,0.2951576473553059,0.33728729376961164,0.33799064881563856,0.44539386843145123,0.2717750886631734,0.32969949508765456,0.5743019348583299,0.6006117566741268,0.5058583556376581,0.41893264623335746,1.042962914586613,0.43254115404030347,0.4677020547297214,0.3113331285422847,4.4674235500592,1.6344555647336974,0.29626598324134934,4.323895798287253,0.37924504973545026,4.012796011497894,1.4050620313818285,0.20505445188482951,1.0254561182899844,4.171977605724014,3.978050708212525,2.091997810261269,0.42430839219263555,5.7538620951000246,0.5269848167862662,3.537693318132155,0.9361956237371407,0.3093058214763039,0.3002671801814636,1.3316665393893623,0.735697017326764,0.7657616920626064,0.9259511408470625,0.28794234709315886,0.18101439133248068,0.16285706556692808,0.8057087121298592,0.5190220524237219,0.5388398355584065,0.4886640615531466,0.3246705092015403,0.36888283114097714,4.754658302431489,5.815899271864344,4.317277630420914,3.747408474782061,4.441327096366743,5.76731427260575,4.395338445798871,0.5990429358992455,4.803136370057295,0.9386473820156567,5.792455405538224,1.165503527211065,0.37728743080159827,0.4971680478232391,0.23796103265173837,1.6781278944994702,1.1658716333323034,1.7428105322227732,0.2772293368130181,0.42095126764075164,0.4344777063449298,0.34477341113649246,0.25091768105090567,0.23281144978278043,0.22993896717246126,0.15217891367578887,0.424298033981054,0.31618699543779893,0.31375236548679697,0.541779638972212,0.29897551171039205,0.5786227760365141,0.5789547139550023,1.185239507464169,0.8883941830913243,2.9744074776947103,2.233767070227839,2.012111814864685,3.0507197971828686,2.1620455414083244,2.0954449070157315,3.054707084577224,0.42474487187785415,1.5840656864080283,0.261463341401215,0.7165363927339067,2.280699554595664,5.474358571726829,1.307345858567259,5.463482135873807,0.2772942372681225,3.9657664636024075,1.1702929347742954,0.6422368281759406,0.8448344436629956,2.2573527620906857,2.4428230690249038,4.952511445200598,0.3522563588978674,0.18922698683344708,0.3099527248025665,0.9613243564362239,0.5895585828539575,0.7585043103746013,2.2409673641025476,1.0313068348262666,0.7822352812614327,1.060104037444609,4.60466050076758,0.29766423958772104,0.5223608986502214,0.3304621358408977,0.6989917900068768,0.29005908596550345,0.23228164557160239,0.7476207424978388,0.6122570051042392,0.25078938051673993,0.21476953335861138,0.2869484632896874)
rate_lwr=c(0.052242202363805695, 0.05621846781815748,0.14386756563150732,0.17335625223401463,0.024996114956539917,0.06006405664949521,1.025475684912868,0.00600539050567378,1.1520628487243545,0.11217639113931438,0.01093513726185319,0.019064505809838955,0.7473771823953843,0.023465878536943346,0.025603801557162076,0.007218428501088392,0.052061329355713226,0.023275143113521524,0.10982802615300058,0.10728995790915782,0.024112251831315545,0.06716098257440006,0.027226789457958533,0.10596525905845866,1.6248623004948666,0.10133866392648955,0.057312918250283035,0.007793876008994283,0.050801652310683815,0.03992687555525526,0.2118847681337203,0.060192982851911714,1.841156189959998,0.08200785438284142,1.3911874188167064,0.08433299094472918,0.03429723137212287,0.05739667588236269,0.12377085603015836,0.029529104769493053,0.12891094239113718,0.017293204141240415,0.08912299070093699,0.017852908348833407,0.01564367139423778,0.09696934227862469,0.05043445319550266,0.08612510406657947,0.018066679110751716,0.08809726343866098,0.014009136753756812,0.08241692512147258,0.10379449828806497,0.07298964668083338,0.08298880360921343,0.10344522452096935,0.015346804543322823,0.06240013799274041,0.08565629198562622,0.04300813650720281,0.11699994359436033,0.041414071107481576,0.07696390461655156,1.456465882030285,0.27366499489544516,0.06682920462448466,1.3490287961264305,0.0801440206140192,0.1601743387348065,0.04872292902068681,0.00850266393115462,0.10639884951457074,0.11420899671241652,1.4946867366253298,0.06985464569402197,0.009130247268796354,3.371403133792983,0.030276245388073497,0.38317874674593266,0.15665610811075484,0.017060272539245636,0.06845757822311618,0.09600887687919415,0.08713522984804775,0.15510584519850812,0.09336741876453142,0.04946856570928876,0.0333656109159754,0.00632824694786438,0.13889485149960426,0.08359701471906367,0.09506718620373494,0.10310287116117392,0.04596706094725633,0.046858661524459055,2.2408103241232444,3.0459808006266904,1.089293641628028,1.1190257598504965,1.0842664888656963,3.2189698740667056,1.8346109208848866,0.08140235284678693,2.1102441611078957,0.2307940878196988,3.1581662166352755,0.15608516003746542,0.0347593078043566,0.05864903564011939,0.004362090761524662,0.2785819786251248,0.15853590707155427,0.19087664870785237,0.08447915558761132,0.12368453486113651,0.12114553740809508,0.1445597413009581,0.08048400166398623,0.023101027021450005,0.031732276744059984,0.01747333510173049,0.04549009888339123,0.12609963741926802,0.09534786051438235,0.05241554737908061,0.112068212340524,0.07095232243770477,0.09395712912558446,0.18184439014212245,0.02772123423227585,0.2093977953142238,0.35018849203575364,0.3475298404659358,0.7529601655613523,0.2952928054560162,0.39588165952257925,0.7594152915067602,0.021903677767155516,0.4563283324755441,0.013204697696478723,0.04076332402729635,0.5256628467188547,2.8646407343758105,0.35832501710408626,2.849801136961373,0.018052021834688847,1.3072715002224566,0.34752560049011594,0.1503255492321252,0.04412836244944063,0.6043013122771608,0.5094042777079397,1.8702193814693546,0.012856478398339394,0.01418615494697345,0.047161465140527936,0.05848137488830257,0.04816847189729595,0.05773036045457236,0.029609338585262823,0.08285691430734801,0.09194208557046918,0.10903297348096469,1.614149471741769,0.022250150602903418,0.02148455754376216,0.014312277130309525,0.04458093982450867,0.023622058910639093,0.04959687143245314,0.08563026611541494,0.16392960041630228,0.02235541425608928,0.054110346868957215,0.04635173178697294)
rate_upr=c(0.7168569969659679, 2.6969096794782828,1.1221436611805884,2.051861002938786,6.5660096348449795,6.612683852288845,6.532768450552802,0.2192922263024894,6.639438849338979,5.381667572409504,0.35728284161885554,6.680735553066458,6.12705903085934,5.703521888084677,1.2705089507966787,0.5407409267266522,0.6994296584853167,0.3678300533374064,0.9413728384784157,1.044775722805432,0.9486740031579738,1.299433912842448,0.7440012875911612,1.2601753306214287,7.542859604039897,4.173079740726029,0.59551633456699,0.4931841410399068,0.35377597144953743,0.5910892610911727,1.900670860184919,0.47560467952382524,7.4423796748604225,4.30961481659822,7.225071579367206,1.7941148958300004,0.44831232292046197,1.3482804578980958,1.9274313959739247,1.8780101164409735,2.3456699123429927,0.7709106335769953,0.9621784695937521,0.733227699691225,0.44591694982152796,0.5080854562370802,0.8061097088015523,0.926578624458511,0.9151568343444907,0.5642031214775957,0.8097798111382322,0.6323454668109698,0.9791340176504698,0.5693445170227516,0.6173311628286409,1.4171581579569632,1.871237296522302,1.0505353784080829,0.843076886480441,2.8594719493074297,0.8709680762842562,1.309531688322842,0.5911281424692135,7.379407594798041,5.2229470243635445,0.5600745727651704,7.361780452496671,0.9948602335928045,7.057608824560209,4.6844045123351945,0.4639153497897275,2.289724169220209,7.340763736161403,6.642314988093123,4.750431178126658,1.3225471534985558,8.889166400958427,1.5032296844610098,6.4837300076229445,2.0055332646897677,0.9494493076835755,0.5532052983200663,4.482622783235257,1.852365213251015,1.7719549159386583,2.4302316011847527,0.6254202035113814,0.3845668472404627,0.395622175316104,1.8554623904866014,0.9868729908949416,1.0695965977717796,1.0620404228315012,0.9160192740238748,1.094159733878958,7.525904412070335,8.532318786586368,7.026191816467862,6.35051048277015,6.953978395872973,8.748627121916988,7.311144093542204,1.1725921009065354,7.522386135335466,1.8476940308021523,8.723908359135518,2.9220475501118948,0.9472959883001637,1.2588463311708673,0.6081330480145177,3.8267935053155577,2.9233152370732634,3.7194044446983905,0.5041308397101683,0.81807580936589,0.819440691265267,0.6378195728563173,0.4680224001503101,0.543757130913906,0.5211553521739642,0.299508883902764,1.092374176899888,0.5390468393718868,0.5439123550024798,1.3278735971008269,0.5232346712128836,1.3242161925568396,1.2870977950867644,2.829734689770951,2.557829919396272,5.843779242355557,4.200353487937595,3.880345382791365,5.298358746010137,4.407902243708724,4.023844121738101,5.293658807306777,1.2045472000805204,3.149359853091289,0.7671900814422721,2.2104858562686065,4.4262148594368345,8.409786117581838,2.4704334764209674,8.433317344222413,0.5568082263199465,6.801366520826471,2.2524502263109705,1.3238968459062348,2.0168273329489255,4.513359452380137,4.787680666622941,7.894431470668319,1.2623718235149357,0.4256391073564082,0.646508026670488,2.635648059006942,1.5840165283868712,1.9782459337942577,5.238379304090215,2.5734441645691324,1.7673433774211404,2.611034030171058,7.578204228956145,0.6589554627810403,1.3833527831213053,0.876829328214781,1.9306590565666357,0.7542218758615282,0.44779727535488756,1.76048122452484,1.1767161560620298,0.7168793461814003,0.42668274830000363,0.7075505464815197)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.675380920322993, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.539329847594917,11.45516312611962,18.316996330471802,13.644381033687072,16.687957899554206,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.505765520098972,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,13.693511568894099,12.910033469142949,19.98812129905982,15.133227159547541,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.15963284744126,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,7.629996531354187,9.222796501414518,17.9299963377462,5.5135590711366635,14.197688715594296,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,8.275121519227847,16.211996370039262,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,21.04119030911618,10.15963284744126,10.15963284744126,12.8613425868673,20.792329617276543,21.04119030911618,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.676359941283643,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,12.762457973341409,14.062688718131877,20.653073209637714,13.644381033687072,15.03049639224779,11.915536450799365,9.062465735197444,10.647178292822375,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,8.672663178421974,19.709996304287746,6.680496549201861,12.543329772332134,15.453496384296702,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,18.82474632092768,8.396996516936989,11.45516312611962,22.72199624767148,22.62499624949477,22.26749625621469,21.779996265378173,10.058496485705948,14.172329741711991,17.899611722932722,22.72199624767148,21.1276885853318,13.580403826912434,9.906796488557434,23.096662907295563,6.560946551449007,4.276046594398034,17.61049634375181,11.251996463271851,19.87726902841626,16.67272363410629,11.566150303520583,12.795723706981848,12.518304131776894,10.74007339597134,12.130541901303385,18.8692555793503,11.566150303520583,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,2.0,1.0,2.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.06086318545978361, -0.07320681727606428,-0.07654386546924924,-0.07652082005947268,0.06015277042745716,0.060532182241244445,0.06134160877155066,0.05883647335204323,0.06049601822232399,0.06016221345052792,0.06139460454800635,0.06039206126448988,0.06138903518756388,0.061520983980732295,-0.07209824586668527,-0.06922863134887078,-0.06910948281423708,-0.07161118111329488,-0.06192029879561736,-0.06131933579919258,-0.061327977153789556,-0.06146726901591268,-0.06136291441456196,-0.06170344241304467,-0.08893380195546513,-0.07976016902898862,-0.07955792294167474,-0.07894364089016828,-0.0793768336540074,-0.07995504658238008,0.09788447786700544,0.09593808752730798,0.09868807414607662,0.098726580840775,0.09885123463650929,0.09634769055247284,-0.0648585389200765,-0.05957162711971377,-0.08115495325971364,-0.0820398763457792,-0.08238017286631438,0.022813042716348802,0.009229190915564725,-0.04557356707020532,0.03685080621474376,0.02285466617227072,0.009642813194151133,0.006766637181752046,0.02284673822562455,0.0227445896268209,0.03967907917964772,0.04112748739955513,0.030446364855025856,0.020459765889077268,0.030591194068119654,0.033495721524301754,-0.05757741652839084,-0.07691422929805923,-0.07689361555560559,-0.07715538593628542,-0.07671325810181982,-0.06071069314928294,0.09719790264756598,0.10249032847658794,0.10184980688164588,0.09744977975872963,0.10249032847658794,0.09961632655428475,-0.07051088980067645,-0.07035778570750412,-0.07040093643125926,0.09753675648182475,0.10043582143234506,0.09924740092506278,0.10047138144545441,0.0986561195212667,0.09930482795080899,0.09877558705182889,0.10044584016482101,0.10033714803788372,0.09825129929205648,0.09732779193782583,0.1003701511163029,-0.07811555890718322,-0.07814236227038887,-0.07809441010494492,-0.06804272423989662,-0.06804891569395767,-0.06811022509021282,-0.06937270206264284,-0.06900546752659756,-0.06903601803835074,-0.0690188344332923,-0.06888269886928487,-0.06955655425542563,0.1037733931532181,0.1037633575726896,0.10357606179229606,0.10324774653863121,0.10254054575470525,0.10382623270826564,0.10381266104753697,0.10309915537312599,0.10269556488843296,0.10239488734609872,0.10336390163993146,-0.06345016863189182,0.07334882521558622,0.07360631131333446,0.039880200479503684,-0.06372005944857383,-0.06328242704877324,0.09653296763313617,-0.07171735264158448,-0.0722744574858852,-0.072293871963516,-0.07248434364707344,0.08108191417615915,-0.07520864461440263,-0.07472620452451106,-0.07485040424751153,-0.06813985969469914,-0.07352821565751656,-0.07359220858430288,-0.07372851767374754,-0.07383517685541059,-0.08727648872003313,-0.08660305925208758,-0.06941424541511607,-0.0685290732684182,-0.08969812819891607,-0.0889731887948056,-0.08876398257860366,-0.08987528834698731,-0.08654924136005526,-0.08869648644233913,-0.08979744912076086,0.0850265542917809,0.05253999816150864,0.052897080295195485,0.05283909848981713,0.05429048430326618,0.053607451804809685,0.05354690792780892,0.05291816156967447,0.052257854409575415,0.05416549783779733,0.05355615841765849,0.05363955484110088,0.05358555599967042,0.05294361831068793,0.054313435590982645,0.05406580720860022,0.05231967302879916,0.04161979671927981,0.04210841979005081,0.04283199701354937,0.041758802773506146,0.04209656800408919,0.04219929731322728,0.09518983668683846,-0.08919652356918696,-0.08900895996880469,-0.08911434585720089,-0.08906317033427297,0.07894341555887935,0.07889626640009036,0.045935992918228565,0.0455992836847894,0.04582059893690615,-0.07284491389831158,-0.07324876953223641,-0.06793447546166666,-0.06830321244694364,-0.06793199529150763)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.03462024071906069, 0.07018066553476544,0.07851358038821488,0.07845636517082556,-6.167341075193957e-05,-6.26208322354559e-05,-6.471432891869522e-05,-5.830386317981467e-05,-6.253144808346988e-05,-6.166835546200166e-05,-6.484953227148783e-05,-6.227005165509265e-05,-6.48345433053406e-05,-6.517380366707649e-05,0.06737363908527712,0.06065142797523809,0.05775953648598828,0.0650279892825026,0.03610680305246459,0.03525575995242727,0.03527133955528855,0.03546210408682689,0.03531827123831282,0.035798090204728794,-0.2056659901999113,0.08600437831751898,0.08547627868190652,0.0838747145962025,0.08500358679432671,0.08651676274447061,-0.01248385118327658,-0.011873599924562732,-0.0127349636805204,-0.01274701531513814,-0.012786004406633735,-0.012000245543109888,0.044165049262359035,0.03621550323622672,-0.16230111118674165,-0.16701843082999865,-0.16870448128367338,0.0068289983506128514,0.0080699499404625,0.012746700302059915,0.005042298155076044,0.006859270217647005,0.008016582470091549,0.008247958694016955,0.006853527356061122,0.006779378811098134,0.004724679064291637,0.004577821105504379,0.005859675877131437,0.006893384568341847,0.0059276272109553526,0.005491737178147434,0.03109801646293377,0.07945235732361824,0.07939985681609887,0.08005825101738792,0.0789496838053357,0.036725865240875434,-0.012302119867368217,-0.014072448334858137,-0.013859629765493412,-0.0123895059993934,-0.014072448334858063,-0.013113098295605021,0.0545371411629066,0.05424995961167207,0.054330507239812156,-0.012376941235415587,-0.013305111974983387,-0.012918259178816333,-0.013316507243567824,-0.012731813217488381,-0.01293638830631625,-0.012769623298662717,-0.013308279722953903,-0.013273443805182885,-0.012603349045069876,-0.012312529993346063,-0.013284019241828355,-0.14524385197812298,-0.1453644722716534,-0.14514778542901705,0.04991763676010614,0.04992867037788672,0.05003773212149853,0.05823898316275772,0.057492232285369066,0.0575538340991296,0.05751918828160447,0.057265252465541275,0.05867293694307972,-0.014509533066124122,-0.014506116608304016,-0.01444270054748201,-0.01433146687063186,-0.014091260907832177,-0.014527415829414423,-0.014522814384805524,-0.014281478737629676,-0.014144531489181808,-0.014042848757113497,-0.014370566621944872,0.045210480083165326,-0.004670108797673021,-0.004709958318709225,0.0047830843928095505,0.04550080799342111,0.044743761689009245,-0.012057797527212819,0.06651243888297398,0.06777849667943807,0.06782274162680663,0.06825661503192569,-0.007093538488054764,0.07399564547102289,0.07284839249303435,0.07314301533539617,0.05809863624502364,0.07097779662735106,0.07116551258507708,0.07145790907598502,0.0717083766604414,-0.1962625086988851,-0.1925993930146172,0.0609420381696553,0.05078236390881816,-0.2101194127013782,-0.20599903567380803,-0.20480311441779925,-0.21112657434301718,-0.19225770214983773,-0.20442620060289005,-0.21068444030268993,-0.008354608561954708,0.009777015930329388,0.009941980238598222,0.009915478731409551,0.010602961914556952,0.01027910114411212,0.010251075731703842,0.009951572287262733,0.009650262437008951,0.010543763884224022,0.010255364949980349,0.010294040669512118,0.010269918341355209,0.00996322071877191,0.010613808167261379,0.010496763676417048,0.00967779747091427,0.004761566773114621,0.004946880248819223,0.005188106213538591,0.004788069302060452,0.004972731204726922,0.004958530489560851,-0.011631609091310972,-0.207145140623968,-0.2060918219305312,-0.20668293569451335,-0.20639581093063813,-0.0063713920575913675,-0.006362191794353136,0.0036278901868327627,0.0035635376171133703,0.0036058527610191874,0.06911638993328464,0.07005015441191662,0.04971492775053995,0.05037279053198538,0.049710538095631966)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(12.725000000000001, 14.895000000000001,4.466500000000001,6.2895,1.2905000000000002,1.2905000000000002,1.2905000000000002,6.2895,1.2905000000000002,3.0900000000000003,6.2895,1.2905000000000002,1.2905000000000002,2.19,14.895000000000001,12.725000000000001,31.000000000000004,25.565000000000005,9.438,14.895000000000001,9.438,14.895000000000001,9.438,4.466500000000001,0.00585,1.2905000000000002,6.2895,14.895000000000001,12.725000000000001,6.2895,1.2905000000000002,3.0900000000000003,0.06885,0.4535,0.00585,1.2905000000000002,18.205000000000002,25.565000000000005,9.438,9.438,9.438,6.2895,18.205000000000002,21.735000000000003,12.725000000000001,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,9.438,9.438,9.438,18.205000000000002,9.438,4.466500000000001,25.565000000000005,6.2895,6.2895,6.2895,9.438,25.565000000000005,2.19,0.00585,0.4535,4.466500000000001,0.00585,2.19,0.00585,2.19,4.466500000000001,1.2905000000000002,0.00585,0.4535,0.06885,2.19,0.06885,0.4535,0.00585,1.2905000000000002,2.19,3.0900000000000003,0.4535,14.895000000000001,12.725000000000001,9.438,6.2895,18.205000000000002,9.438,31.000000000000004,36.357544499999996,36.357544499999996,36.357544499999996,36.357544499999996,31.000000000000004,0.06885,0.06885,0.4535,0.4535,0.06885,0.06885,0.4535,0.4535,0.06885,0.4535,0.06885,36.357544499999996,4.466500000000001,4.466500000000001,9.438,25.565000000000005,36.357544499999996,1.2905000000000002,18.205000000000002,9.438,9.438,12.725000000000001,4.466500000000001,9.438,9.438,9.438,18.205000000000002,12.725000000000001,9.438,12.725000000000001,14.895000000000001,1.2905000000000002,2.19,9.438,6.2895,1.2905000000000002,3.0900000000000003,4.466500000000001,1.2905000000000002,6.2895,4.466500000000001,1.2905000000000002,4.466500000000001,0.4535,3.0900000000000003,1.2905000000000002,0.4535,0.06885,1.2905000000000002,0.06885,3.0900000000000003,0.4535,0.4535,1.2905000000000002,2.19,1.2905000000000002,0.4535,0.06885,3.0900000000000003,18.205000000000002,9.438,2.19,14.895000000000001,18.205000000000002,2.19,3.0900000000000003,0.4535,0.4535,0.00585,2.19,4.466500000000001,4.466500000000001,9.438,6.2895,9.438,12.725000000000001,6.2895,18.205000000000002,9.438,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()