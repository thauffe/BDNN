pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_7_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 6.0,2.0,5.0,4.0,3.0,1.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.002203864068931479, 0.05849828866629971,0.08594361484770491,0.09886689586724745,0.10288208085564343,0.044668219406490316,0.06007415679176698,0.04134087889227858,0.052573872049899904,0.180157405308268,0.02650984341787026,0.06621056721212933,0.046702858442511826,0.06441396777820241,-0.09797679257400639,-0.06387263113659666,-0.3349210826395843,-0.2441119717199374,-0.05462968406179034,0.08517060805754327,-0.16647105295949627,0.0023866983146094587,0.00688511229126586,-0.04959609597211861,0.17352491523855104,-0.17310183609265734,-0.19459293954616283,-0.19780411624760805,-0.19105835551588088,-0.15969015582851107,0.4018011045244153,0.28299674309590894,0.4728724467322732,0.42766124280364615,0.4477394963211204,0.24043691852613314,-0.13109421900011406,-0.10688517810545486,0.06125298088289012,0.20027099683440838,0.18221824573129805,-0.04276051523506227,-0.032056834957912055,-0.08153253196695534,-0.01773859209499429,-0.048238065417769434,-0.03650866555260504,-0.022956339830402104,-0.09778733068762373,-0.029877252284030487,0.027075447166330778,-0.06116263364909137,-0.05528343859637688,-0.03695136324847139,-0.06887832017434463,-0.04994334951147208,0.10527424850951121,0.07612599189554405,0.09949241783368348,0.10840476926737219,0.07436489524613393,-0.26148137493027396,0.27810952740679434,0.27740683120277265,0.3613919688870635,0.26412885918951623,0.27264526001765255,0.27882493526187385,-0.030419745003309785,-0.06363677599379162,-0.09418790811472451,0.3187588501885658,0.4520796244927857,0.6490143556915788,0.6559599173240988,0.4277472059711498,0.6803226854830032,0.27841167584965304,0.3492111231894663,0.41125378206178986,0.4004816407980931,0.27092989078116064,0.46035576637398834,0.09279431246825715,0.03294465673010827,0.04313585858086916,-0.10159929258705785,-0.05500427333528634,-0.061748087679734595,-0.2800927634729815,-0.29537931823487473,-0.295734537966267,-0.2892402877927023,-0.3254642796752235,-0.3319047880692541,0.5099292357546114,0.6517283156636899,0.5942088888865443,0.6775813604776566,0.4040906220834216,0.6553523684374745,0.6862323273529465,0.502424843130297,0.4821623558374616,0.4187391993936651,0.6190010593625793,-0.18296529626206867,-0.03887556082678955,-0.0372345295753258,0.04809193122090028,-0.16697634993366692,-0.18170995844691576,0.32405595454382974,0.0007398741381652475,0.0006835467891902426,-0.03017407969848626,-0.025623745425324095,0.24098798725107232,-0.24734171621843698,-0.25854717023140406,-0.29549818062756333,-0.03472889798494086,-0.020655513930637772,0.025805615661960664,-0.029781013683373526,0.0008540431238033226,0.01023167442142704,0.03802075744635437,0.11695484681542574,0.1281435348019414,0.11640362477773392,0.026881319256681274,0.09263584152390647,0.14594443946610872,0.05522590846116476,0.10489337078043713,0.13365363251290388,0.27538079769014145,0.20573796941729788,0.22676487052218564,0.258251535030431,0.31287549178935303,0.23644175508827253,0.1975302790661565,0.2500894484128514,0.21039307692561485,0.31083705507509857,0.225592330104983,0.21497030671444167,0.303084975575558,0.2978133871793659,0.2975108540608978,0.3173247745088124,0.2826431787036874,0.21495608522357879,0.14974481508207343,0.19362082327007976,0.17742193733062617,0.23370596155398315,0.17634360754104833,0.429965340494361,0.18004793574867756,0.1538804777424578,0.21176100960973293,0.17605723410542998,0.12148401712160274,0.10439784638646206,0.05915102633201406,-0.04033907844215043,-0.035566004381994885,0.0784683475597849,0.0606042916784677,-0.07201367763763483,-0.09447112424969495,-0.10508465671666138)
shap_list[[2]]=c(-0.03299911214139517, 0.003381731051718708,-0.025164553054954086,-0.013816595907737662,-0.01884030625999657,-0.024577681598438955,-0.006943789977031081,-0.022949757160755927,-0.007334675891815791,0.06110565301453321,-0.01161131137126257,-0.022617432233729688,-0.02221746328866857,-0.01024379319432199,-0.001967224145176097,-0.022667675565109555,0.01860502819252335,0.026337082412644628,-0.0004577875137207773,0.01901080271170815,0.0016130851996502722,0.03186970917155241,-0.030720384486530087,0.014609228878928154,-0.011335572804598697,0.04725526052721708,0.06444718407900302,0.07831595642629607,0.05120297356111837,0.04650805525671818,0.005643461985834533,-0.0032333607298461802,0.039168980948676414,0.02127425960366756,0.04488845878223005,0.019034122956976325,0.04069493463779642,-0.0050608543706393665,-0.018186109693076664,-0.006727427810376872,-0.01837274593602058,-0.01578526447777012,0.002528382542606215,-0.020635080014357633,0.0014579947284458045,-0.008498040151485755,0.0023489745611010625,0.007915409025487933,-0.015104549238416375,0.004114306983850946,-0.027170685103173862,-0.013148708395206616,-0.0005316786413554237,0.002402759631170802,-0.014208731364640613,-0.010477305952771354,0.04374615041410598,-0.037831348798243965,-0.021598849646016372,-0.0022035658557157433,-0.02465309487205908,-0.0035593666386145814,0.01031876917236011,0.0035294627602951286,0.001778745841340835,0.0036740236078276617,0.004394101329224405,0.003135802256223281,0.0486015344449877,0.06341979386337065,0.0456508119618505,-0.0018599290031783419,0.11208349801319921,0.12370012395364584,0.14989370965872179,0.0629341032158478,0.13551605161994798,0.03197533105510611,0.07851730709433133,0.06437767728072558,0.043700709712897155,-0.0016033822768876014,0.08226962070980995,0.002064250712208662,-0.02524308867041241,0.0015416299439518805,0.010489792047515697,0.0004587243044956542,0.02386630622220178,-0.009131698243627463,-0.007444065576455569,-0.007454107056896793,-0.010291287883427928,0.06086000788385358,0.042653181120728106,0.0786982858296153,0.12441662030112428,0.15214431709495974,0.11094285591573057,0.012332338774751787,0.1296963684495423,0.1364455969663594,0.06439238329177491,0.06947855589224339,0.013903216406084478,0.13047771670605035,0.027087533481437873,-0.005210370200681571,-0.0022098488176276274,-0.011773161597191047,0.011843504814467989,0.0261979815080726,0.005019835712660646,-0.03667825424154042,-0.0347852934840964,-0.04572070468119408,-0.044670476893971314,-0.0037921480479235505,0.012863407183704411,0.01834818098002319,0.02138266876626366,-0.010829439279876157,-0.03957026348624415,-0.03944514987672571,-0.02926183300917974,-0.038765222657939385,-0.015122350771965196,-0.026407407693249688,0.004005620274278405,0.04417259665130641,0.04676549084836216,0.08832101406558326,0.08497846183760988,0.06565192934673203,0.10970913239128288,0.08632364972715639,0.059785527084008944,0.03630247569613432,0.013745884214368601,0.014359138706561997,0.013104119013050784,0.041284953669335496,0.013103353877393331,0.01049100562403502,0.014151852682739276,0.00916900992782085,0.035339502803713375,0.013745169927498612,0.009784275210863811,0.04273491002789653,0.04553712214396186,0.04538796757180162,0.03681712884326797,0.02776871614120657,-0.014236692907080961,-0.0055369711691839515,0.03172853053763516,0.025450555999136204,0.01076599560469607,-0.018632318904171278,0.039170173813658976,-0.007451374010432255,-0.0050519457642497845,-0.004197861756583442,-0.008159891367610049,0.0365677297411697,0.018801214789293693,0.03309188053635939,-0.010974927039080852,0.0007894088685650382,0.005447253216696445,-0.018950052153316698,0.0796338860515341,0.019921257788561516,0.010529319467951674)
shap_list[[3]]=c(-0.09182420416743858, -0.04030691135492444,0.11691956823205424,0.12935980636962294,0.03560665950836646,0.011679107325291262,-0.08276953393934225,0.02331060450016649,-0.07921107242244177,0.9739076426432728,-0.07490803841605544,0.024232832595694465,0.014770674336010746,-0.08277172322995162,0.06276217782957992,-0.17677291506448262,-0.03570626976693856,-0.041769014335426354,0.02490559218420677,0.11696957647365767,0.06268653684024031,0.11064916750192146,-0.08956662693868497,0.051656966833891066,0.017725757097616777,-0.033625735173970335,0.03693386656914022,0.04854020483112798,0.032468550235230556,0.02130463391707524,-0.07962229438937933,-0.09998947111184811,0.056060241603785727,0.09782064693615418,0.05609877532727595,-0.20181960543521044,-0.06371443472816649,-0.06777151369714748,0.06968694718503068,0.06964862916640147,0.0246376767340865,-0.1801455026185473,0.07033956601678873,-0.09030724475975233,0.07602690910187866,0.05494221219479835,0.08056293615763016,0.08541191879584108,0.030258659752533255,0.07477502530089618,0.1210188148741576,0.028751247199660282,0.06827226563523234,0.07550831067129757,0.03642784731971373,0.050607798162269575,0.1810071530116786,0.048365690583080885,0.12120858519206265,-0.02078383905990187,0.06049256057159064,-0.034265330202534076,-0.09537104305493585,-0.09176383603598133,-0.08732314976856335,-0.08984795724141317,-0.09012383827865929,-0.0956671941655153,0.10806027811392144,-0.09699166033025224,-0.08345892910737908,-0.09301802211108846,0.21985786070377936,0.9849581053267201,0.9215299112197708,0.0660139402690069,0.9876015617897459,-0.2458082916717663,-0.021262098263726548,0.06800687576660142,0.05894352159139889,-0.09055860582561746,0.07381079462892737,0.12790926004536937,0.0360281741430746,0.09750671185795799,0.0546540228605722,0.06205497298374113,-0.03486476605069411,-0.03499758218110558,-0.038881591725357253,-0.03879429634657447,-0.040639622624599914,-0.025609715322325803,-0.030857178739870532,0.0783862108533211,1.024908650021488,0.8477469553726326,0.9390070611653366,-0.07538699693745222,1.0069946115788557,0.9937704928728008,0.06628993749371186,0.07381973590648634,-0.07157268400219381,1.0273116375391478,-0.021439864744059674,0.03821860239411193,0.038647933831829476,0.12521363327289833,-0.029972335702549317,-0.022743302922825823,0.05429092860720107,0.10128122994427378,0.09997169397484677,0.06037383188690009,0.06644102839912452,-0.09714718842579642,0.030707232312045,-0.040469976871454934,0.05207956407348066,-0.08044064874198852,0.06658316730359246,0.11238767296641014,-0.06246935862851906,0.07294475035837238,0.006619660535543934,0.004252544721908308,0.1819786051465697,0.10013091813439504,0.18467973956337913,0.21857432441507116,0.25826344107835864,0.2550364753567002,0.20811016455500042,0.25670213928214025,0.2573813994892114,-0.06773501675347061,0.023613823433960388,0.04654348120744969,0.06549796780388786,0.6268568315760945,0.04344119403614262,0.027743321683710465,0.04896369493391074,-0.08152873211604104,0.7093098891147926,0.033672565811714524,0.03492260572370969,0.6169939047707246,0.6254949103372246,0.6300289128964752,0.6184535699647382,0.04751617366708155,0.071629841295187,0.06295643492910392,0.11291312119334386,0.11215683756696804,0.6527862881606785,0.03572084849491116,0.662158487921842,-0.03487044964757277,-0.04252623812832121,0.013143401523832391,-0.03492286013652466,-0.062075787214477415,-0.1840414213788603,0.061994633415945535,-0.13880610871366608,0.049404645046100704,0.1588741925735716,0.1192130765330274,-0.058440145460959825,0.02494219294904071,0.044035530300718134)
shap_list[[4]]=c(0.02371949124432681, 0.06390227143034441,0.029457509057321078,-0.0034060314240192536,-0.025291383166720388,-0.07882659608995284,0.06633702349032031,-0.027411236339161624,0.05902361753665888,0.061219623741475146,0.0495505030033888,-0.031931902148299565,-0.033960964362058595,0.053153800697270506,0.028613123413722394,0.038182913307869285,0.06745062295970787,0.0698895023588609,-0.051839972661629964,0.04409643889743333,0.0236916347557337,0.056311275562407205,0.02807471568761852,-0.011379102691818329,0.1404974571801327,0.041219068181061795,-0.0032941326266963263,0.04201269412625281,-0.010355976772094285,-0.03708233577696269,0.028325311744959284,0.025699227605712093,0.0051539394465675405,0.10012590265439793,-0.005598709979136051,0.026768820431844337,0.07056136588142237,0.04799777773597493,-0.01986626953793109,0.0966237342159442,-0.0607083406959827,0.02958145969555456,0.015871268786987993,0.02797711462755701,0.07855476163338038,0.027814905734016633,0.06123135782950476,0.044213815632961874,-0.02693564932062027,0.027802702036443635,-0.08225894544142535,-0.024148939335047064,0.03767290819069953,0.033123850837473746,0.003903446413049517,0.02655074423011646,0.10692899659165056,-0.01165447975537737,0.03640243270339918,0.05742821865220617,-0.0009754217163783882,0.06596011430145722,0.026910229795906012,0.02767115260971739,0.026902630955049547,0.02869183541935084,0.030366422759734925,0.02532217659709673,-0.07835950529287355,0.010143061000340623,0.009520065465204789,0.024577103825117505,-0.0719690850466312,0.11177287658166282,0.05961281664469203,-0.004430331168868964,0.11229831053413304,0.007114910107357325,-0.036260443193245326,-0.01630738769146739,-0.004639563814654743,0.027769117762978187,-0.0064250352883385336,0.08514759550558959,-0.06262751757430675,0.10495824711657203,0.04270882120613285,0.027496746623535646,-0.030604804868131413,0.05356203004838447,0.0642870612638532,0.06394748473106897,0.06484704786141358,0.08265282048260054,0.06641268713078458,0.004116937794965923,0.11487993943582646,-0.005247614689713907,0.10747353931469575,0.030567868821687296,0.11686979283891748,0.1145295518072389,0.002083856077619648,-0.0024102371391032866,0.03054380341965364,0.11597693879986758,0.0841329285610782,-0.01897558476615444,-0.021679887365299348,0.03196498402890196,0.07413201781920425,0.08385715562092312,0.008898017001612683,0.05771212238585481,0.05358531841050975,0.029390278629282302,0.032696044710753235,0.03262546688566106,0.00151805691585861,0.046918754595619575,0.044703033702630096,0.03849451775150126,0.03224808362720045,0.07113104298944345,0.03424603368949511,0.03601724206576313,0.06352533217307686,0.04652057966903486,-0.004016449835537018,-0.0008605311547926113,0.14674386749304422,-0.017686160561607576,-0.015012545463687327,-0.0404269438467951,-0.008892823087764744,-0.033357007359399816,-0.035971455713298614,0.07007495732901885,-0.08696268386393262,0.0064546079927469595,0.0747649068737134,0.07214022691862548,-0.006629531441175565,-0.06315832195843035,0.007898652702800279,0.06506606980457395,0.07078013936055853,-0.047821674610695857,-0.027836154013011233,0.07361885033816168,0.0780272517178502,0.07850335979104661,0.06690516661653201,-0.031135484388366445,0.03347316109214784,0.09748802911489375,0.23683845983353347,0.17641731822330073,0.023092547178807734,-0.00039336732931096445,-0.016903166174613196,-0.07708801937496416,-0.0653858863481284,0.12996397332976017,-0.002898099265320459,0.08384491923134768,0.05504002585612851,-0.013937588819733206,0.008737798658817172,0.0311299374619785,-0.009596180850420268,0.01962758818196565,0.07565333116947079,-0.009728209987376255,0.013996241597534369)
shap_list[[5]]=c(-0.003927029242636642, 0.0529274067873349,0.04452284970447736,0.0572613626521474,-0.045003995965677945,-0.03306568320251579,0.010515710353843754,-0.03703918240767877,0.008973779373713443,0.0459649483562904,0.004426857107316903,-0.038976264767022914,-0.024942710871967883,0.002931981080191649,0.03516711926306653,0.01514412983577295,0.01231546219274888,0.012712372759351975,0.021173722550896983,0.07076685458745109,0.02780830397056223,0.06860462365445792,-0.003458092271334832,0.03653363984076133,0.03098682925708537,0.006335762478722492,0.01583350632918549,0.019174616731368707,0.014082566792530527,0.007503962003622317,-0.019388458736634636,-0.01914525757294931,0.018876325842232828,-0.008045642190019424,0.029142139953886086,0.011197994650926022,0.02314727586868703,0.013651329418044443,0.0443405502575954,0.05065609368434513,0.03251591872670056,-0.024586557834108604,-0.04188509880133633,0.0021225134008360973,-0.03822455923821848,-0.0462930830117644,-0.03228928848081684,-0.026451853777141678,-0.04407025437178364,-0.042014317168715794,-0.03590417878406773,-0.041645620091243944,-0.04439615113441578,-0.03984672652123034,-0.046752497069772914,-0.05254345946650664,0.12238497047278425,0.03528994651121019,0.04759099384848824,0.04355339961554964,0.04564590102285885,0.010185888633101608,-0.018721762313100472,-0.011268508623586799,-0.01862397010363583,-0.011854993505249245,-0.010021666673717263,-0.019321353398777674,0.008508768675597893,0.016102445330169614,0.012839836479440732,-0.019201730851071384,0.12276061999989546,0.158533119313649,0.1959226734702526,0.04602597755437592,0.17507249127756896,0.027779667174670317,0.07870938385958076,0.05573853630084741,0.02926024752839586,-0.01215247762708775,0.06701255480087853,0.0676053884065512,0.03196630384874808,0.05646194090757259,0.03057377135287483,0.03552528933488972,0.014039275068138476,0.01187661680782873,0.015544254831338193,0.015544784933468498,0.01599320890643593,0.018780713716121385,0.011650300798527254,0.0663994010400703,0.15447452631552658,0.18879881678688681,0.14105535406197509,-0.01657732220116471,0.1611776986452698,0.17511529788660124,0.04672554293680837,0.05828423275382242,-0.016867688146024455,0.15995920098096283,0.03497514973048679,0.012850607648327558,0.015847150286862847,-0.016075300054756526,0.021157084498317737,0.033895175212864156,0.010334396758027371,0.047080196524417146,0.047782575948183394,0.02558446609697826,0.028620063333291985,-0.013957853728926236,0.01080045873144572,0.008590166004162911,0.01732982636956661,0.014233642301231262,0.03201193299298622,0.05083205907113541,0.009087683212387024,0.036686539220053306,0.02152384482825249,0.024415969895266017,0.0740401137075726,0.09446027965220602,0.09281457575834841,0.09990028070343554,0.11438199666055239,0.10819401729025727,0.10583431621799591,0.11472213686966008,0.10819668125881422,0.027245271800728624,-0.03311570237224704,-0.027904205166473066,-0.02085037080662691,0.016492503631208997,-0.027617151086947924,-0.03425617988170351,-0.027319029385585097,-0.009244014071361023,0.021441841876402776,-0.03125233177051834,-0.029308035471906354,0.018336221559421845,0.01820133226170475,0.017403040904410177,0.016408290219936002,-0.0285333893594988,-0.051528399891659776,-0.032647135460410856,0.02365988776483734,0.01078482024249895,-0.002116984781819438,-0.05731126383630442,0.008957676941318831,0.008087062705332458,0.007829224288555075,0.029054687345606813,0.01004981182199534,0.0423837075279088,0.031099357488228268,0.0005764677771825053,-0.0053520501147766315,-0.016925264479381027,0.07151781981936163,0.04353788736556724,0.0288284658334382,0.009139353604100156,0.02136047186625009)
shap_list[[6]]=c(-0.028769536337642173, -0.018841539353732898,-0.06037801759732841,-0.04640247012690066,0.0009547254498378122,-0.007156085823622818,0.007256658356343646,-0.005557997217222539,0.009191398582395722,0.09425720579298717,0.004143227149243742,-0.004757689291934601,-0.008980722788090915,0.005817571775346191,-0.03608063017517941,-0.026833358361093605,-0.06366302077484792,-0.05381263342635208,-0.030025801193430575,-0.022327371072254038,-0.02587724142825875,-0.02095739511016233,-0.02971314519681098,-0.02768729671333107,0.29596742825258926,-0.044905919467458984,-0.03129698030006113,-0.03019405081387717,-0.032398450004092194,-0.036477995263929586,0.07832915520361419,0.05843104926380667,0.08872560942761036,0.07353608587484736,0.09483198044728106,0.042665761839528325,-0.0320983760212504,-0.017179968431921436,0.22382353979233302,0.2795331121019929,0.2118903516816161,-0.012208464262236787,-0.009372833742905628,-0.010989405627080643,-0.006219047789141997,-0.015379232338812469,-0.007583756137422381,-0.005868966804156208,-0.01665981376569976,-0.009004736162785635,0.01712946070138049,-0.014524931918417878,-0.006577771940696474,-0.008166238997114546,-0.01621907555641601,-0.014522363138588913,-0.01641839562702005,-0.05602370104878144,-0.061187229253044206,-0.02964409570568625,-0.05425163171325365,-0.019759783040355344,0.05970549935642267,0.06493169727768257,0.07688231504157331,0.06812787538523771,0.06433289255196888,0.06566038273022383,-0.03978576094596803,-0.028386257135066775,-0.026877428753797904,0.07026404238196991,0.13505691442229414,0.23885085893017258,0.2215317122878335,0.11615382918443665,0.2408726784646533,0.05644421826913992,0.11263169246097157,0.12708284843326412,0.09632877874886081,0.06813347541287784,0.13509697257416786,0.2836296762062939,0.20497761412223803,0.2991869482861238,-0.04263094530321477,-0.04428357803796519,-0.0374917137744087,-0.047511522057416114,-0.05095246951065903,-0.050994835372900046,-0.051355107065319074,-0.05193147689332104,-0.060768207616532184,0.1405508252422457,0.24855323643124708,0.19976157898402624,0.23707485076289547,0.08289520909092878,0.24807293853768297,0.2470425929080274,0.1206428991909993,0.1317810351253778,0.08700829388001041,0.24861404081299493,-0.014857420719741296,0.02837344770524645,0.02959868329337689,0.019772015662591916,-0.016218965132248554,-0.012612179420513642,0.0752895197516749,-0.04209513561739393,-0.04223667708473614,-0.046499553003328434,-0.046015116822498016,0.049553475130176716,-0.04476746157761571,-0.058193546657135074,-0.05080632539353026,-0.021271974078593287,-0.04860376410597771,-0.05124891630786265,-0.029943448677201893,-0.04965887805178754,0.27922432382512913,0.25510569398766136,-0.00584753308303273,-0.03997490798864066,0.5280693188858552,0.5565248072953,0.5590246368138223,0.5332287546889395,0.5839556415075133,0.5583965231997924,0.5329824044516858,0.07364876125113752,-0.045766833611034084,-0.0414229812146544,-0.038439876273228965,-0.03778303205901045,-0.042178792446976004,-0.048870137968210346,-0.04147386574593417,-0.02927998503249845,-0.0378586774727394,-0.047758470346294234,-0.04404155618055646,-0.03646084924907615,-0.033867298202563505,-0.03674579980073029,-0.03833819326544917,-0.045169809392628955,-0.02156040548529245,-0.0238513063565251,-0.0017181104141574305,-0.0009915604745538054,0.02262457664384623,-0.029488029854971187,0.1249338580952656,0.22205052071203193,0.21791313835836806,0.2870013576771216,0.2202565341521578,0.04940763125341586,0.03172457814638174,0.018151330848320595,-0.001957441615281905,0.008770012819861247,-0.02147703856702036,-0.042808095606608684,-0.03074606427074116,-0.04401055009289046,-0.045047853124517805)
shap_list[[7]]=c(0.12752524925429862, 0.08277499485099467,-0.018508128590897958,-0.01758979480764889,0.05232264772226994,-0.0786400633225837,-0.06511517327110707,-0.028860589611863767,-0.046936782306797,-0.17487063505454148,-0.0813651798115568,-0.017746382888792246,-0.14228096536314666,-0.0764335378924694,0.06760214085640852,0.11578575565436622,0.3331317075714308,0.20511451829860713,-0.03935496286615826,0.17412346287349909,0.13279146183106869,0.12894919636185923,0.06378360204868358,0.03714032637997654,-0.17231174893775342,-0.05293105634240218,0.02271714540948369,-0.0034529681613116978,0.009972342472859674,-0.048417061277170104,-0.13979764833548006,-0.11583174824840553,-0.1671304670933802,-0.1636809730922893,-0.18516481973476961,-0.10031088033329068,0.23589475887701805,0.27627880219191037,0.12909558267976487,-0.015388525271656139,-0.01585548706993987,0.0977604558314589,0.18049466447380522,0.4003550699111474,0.1720858487779004,0.09993939171818736,0.18182235758191267,0.19475995910980526,0.04874825083085441,0.1932571776474557,0.16048758084344672,0.014488233660511919,0.16542336602300284,0.19105751158644035,0.035198257939719646,0.09818133157572025,0.4717402938005191,-0.03011890009167666,-0.018087921776413024,-0.08687248315453712,-0.0069214106169598975,0.18547660650469908,-0.11652177557685064,-0.17502992233209166,-0.14611130343810347,-0.06781740294241421,-0.19020055309705547,-0.0933083489741722,-0.09649609957249584,-0.039441964678005224,-0.0509420667462273,-0.09650159341565422,-0.1860275832078759,-0.20270205406688765,-0.2066731500875436,-0.14492438766322283,-0.20562970727977506,-0.10257350129127557,-0.1597557724915534,-0.19352090776060496,-0.14383537998645576,-0.06842333640236992,-0.19281687703611564,0.13866943893513992,0.04602236230106553,-0.011506546133184805,0.14506189247664233,0.14984446301831317,0.06485276741330394,0.26214218145464563,0.35746856878091576,0.35743909476431596,0.3619717210676282,0.35736273981930394,0.2821398911601545,-0.19545492729802172,-0.21978272171162572,-0.201331178100876,-0.1731466736272391,-0.19203201403566114,-0.21195709666173437,-0.2069641137407551,-0.19110933346886735,-0.20715338533175512,-0.16378904950113485,-0.21819579307093848,0.37115534478787504,-0.026331456760690725,-0.03456438129662416,-0.00295364336837116,0.2326306608168316,0.36643311458080374,-0.1372474603925737,0.19804383304232331,0.1985070043766937,0.08575101002303664,0.10078837754704456,-0.07039620784504533,0.05679379831613924,0.171958063951771,0.16189546353217305,0.22053328427593272,0.08919937860140344,0.19654943966469263,0.09737178371117981,0.09774018170427873,-0.1701686033565264,-0.030738967314717047,0.053442561105866655,-0.013164154383374291,-0.17174810109041067,-0.13288403454013062,-0.13748733460194956,-0.19580155676173808,-0.09842739138709158,-0.1345236520813213,-0.17982316421692435,-0.07840055020557217,-0.13184330097975777,-0.12456527259153581,-0.12695563155267897,-0.18405841368506307,-0.13917274289823522,-0.11617319568641901,-0.12181388897400505,-0.06728809789680051,-0.16626485815063954,-0.1334900270742649,-0.16070867876593575,-0.12205735590501084,-0.17233686072783544,-0.18565691694671596,-0.15673151698442606,-0.05503981945302527,0.19180484173141663,0.057637760739309755,-0.16592264142069593,0.1322517785762787,0.1242048917500353,-0.0068589693841591875,-0.12547930855824185,-0.17794161185572444,-0.11890078624551251,-0.21938185209069755,-0.10985383341956824,-0.07040857144368466,-0.031952417123304336,-0.02663504798452211,-0.0015894747434783854,0.030927954127757392,0.02612673276424983,-0.02098695631295023,0.11344896309174067,0.00360544253138929,0.12496820449781755)
shap = do.call('cbind', shap_list)
baseline = 0.3433592254174227
rate=c(0.33705481018426076, 0.5427754409419991,0.5161004861948421,0.546505647029881,0.4468098206041306,0.1795007422291718,0.3339461537330386,0.2876452396217136,0.34059102518704415,1.5724330428150652,0.2615709513025155,0.3192920572059505,0.17400556125588523,0.3017602478790246,0.3988298673423916,0.22321912583094095,0.341257113372724,0.31818663294892874,0.21340784395188941,0.8238752652193724,0.3973919092061687,0.7137199077852552,0.2908469133868683,0.3921436889577302,0.8197449730946619,0.1353309124778985,0.2532807773573286,0.29873381143805466,0.21693453077389557,0.1379394917027807,0.6210966577078573,0.4756976482599548,0.8572206815995437,0.8925400722392933,0.8251709326803257,0.3819373675838598,0.4864836086624849,0.48376562646368576,0.8335883044218585,1.0161243774421231,0.7018090331685786,0.1963934268656528,0.5268817934294402,0.5718053159417275,0.6073943777579309,0.4065990352951177,0.5899999806611486,0.6165711216215186,0.2222343690773987,0.5597447850183203,0.5244916100478568,0.23261170725780542,0.5061152851152103,0.5577597048348807,0.27311704572750534,0.3907958291021756,1.347288772894455,0.3677996076497111,0.5467795033291475,0.4118904212289673,0.4362311858841917,0.28602641945436413,0.4910058321777781,0.4416733909703837,0.5610750803365505,0.5410272321567429,0.427467054639102,0.5112411294022646,0.26453384742464353,0.205218964486814,0.15688292008858332,0.5493393255687099,1.121576748795791,2.391056856658836,2.324960386387582,0.9110426516535683,2.452008777703095,0.39685588542165806,0.7416874199589194,0.8576018988846416,0.8231596907196504,0.5400564718993931,0.9592736886069355,1.1361816448291073,0.6100659172457702,0.930917071097523,0.48163232758540314,0.5182398512308203,0.28189754838917486,0.2994150327324596,0.38813442919365143,0.387452941491245,0.39485579601806003,0.4592656232976368,0.3231758238621334,1.022485270285891,2.424765009593635,2.10583843258166,2.3699192176570105,0.5916775520910689,2.4320108752086544,2.471931035441972,0.9531748674838233,0.9465249706488468,0.6434748511590858,2.408205911702477,0.6370064743542457,0.3332531429738931,0.3316486839205696,0.5369195762357882,0.4668700458546602,0.6322273707617384,0.6840318031040861,0.6655384504548797,0.662903708798534,0.42120126347551845,0.454262374241879,0.48419705815359404,0.16448056357096555,0.23293371168147944,0.29426933748759215,0.4695293252009209,0.45319140819172093,0.7060980364445263,0.3335623240032068,0.4973961354900802,0.540178412678985,0.6563111566528714,0.7590702766511257,0.6510266549901085,1.2845434274592917,1.1770892617765472,1.292548677104841,1.2092401744715064,1.292410387174904,1.2892222642663709,1.2134293697390963,0.6787391407239545,0.29095696479626576,0.4441565180745575,0.5685692878702832,1.1922082177686266,0.42152734627471616,0.31862039093955186,0.4743172359131357,0.442014295998868,1.2853898552445964,0.35776119760290304,0.3425928106003681,1.2417618432944013,1.2033610749378967,1.1904740590509042,1.2061529190749065,0.542068196385857,0.7679944836012006,0.6501209928766227,0.7707404275988896,0.9740865894477051,1.412759192434699,0.4443596476093827,1.4689514288036576,0.4613373522195835,0.4969216199481113,0.7927934292213693,0.5993424359145839,0.5440273964866517,0.3687900176511828,0.4733100790440041,0.15431587465224983,0.41079332035605537,0.6489616066873359,0.503253256124512,0.4787017184645663,0.2534109873379132,0.4079950837110586)
rate_lwr=c(0.09112648117026118, 0.024139212428000212,0.11812505979740962,0.11602726481108883,0.11370513005984284,0.0275661149937394,0.04663173241700008,0.08140638085003896,0.08976700509218383,0.1228707048497879,0.0631734519022388,0.10053372937482657,0.01997873936925665,0.06804026116854806,0.04703608412157567,0.022685683030331916,0.10184730070911929,0.07450884253335338,0.023566119201115787,0.1802418654931072,0.05005917062303386,0.16723098004223308,0.07017430609186415,0.053761292320740145,0.22593855637331878,0.01000539714587867,0.051508191706188367,0.03288032738958002,0.049168497512285025,0.02257740722531143,0.25557119881550766,0.23360892795840282,0.2836518520237433,0.11294976026552603,0.25331434228204663,0.024258543309435332,0.09078178573466825,0.10687909757330366,0.1694304823036929,0.2536142545821418,0.11495177900548298,0.015809846976017616,0.19992248276526203,0.11958613701174958,0.10235779197279929,0.14060918708078707,0.1996056593378912,0.19798323522040545,0.03266852439481843,0.19601660067366192,0.056646438929909726,0.06720756825741003,0.18479564181886562,0.18820802040884876,0.07251648014470014,0.12030280442458735,0.27433797213265626,0.05418616686517552,0.1173235333197547,0.022399723170758723,0.07926957649837962,0.03607405846855738,0.21157990237980712,0.15974399132375228,0.2565224996931444,0.21955838590361176,0.15031500320504249,0.22768370097964297,0.02272127396086221,0.018576435120796375,0.008038854066610535,0.24142942043054236,0.07170310298379234,0.9894886942002401,0.7189132387382825,0.3194666940786076,0.9075880867398177,0.03108496352900697,0.03084569337947196,0.24697520279272642,0.29217338386126324,0.22347232879518963,0.2200475702927167,0.21675373230219325,0.12773793544683243,0.19129391881070293,0.11024916596897716,0.10980423059863645,0.02921341711038472,0.05740989348155895,0.13451500707004482,0.1343716117126667,0.16191723961171914,0.08961035428211739,0.05159705971372186,0.3267361709766381,0.9032873900505727,0.49541582303181453,1.0377574626146675,0.212533270983213,1.075461646987708,0.8982623344917056,0.4130401527134947,0.2772933830336115,0.26539790627176396,1.1007959431068124,0.1364359832711275,0.07756015054201504,0.09016003207958123,0.032799958661273054,0.08104274936313233,0.13729393370167203,0.0867931151665145,0.24872532483752705,0.22152188283196617,0.148834421595905,0.1438249925833665,0.19139802980383824,0.017376969999145342,0.06005157403096195,0.05067793938307627,0.07417070886326282,0.18668948738223232,0.20287999472269894,0.061203528572861154,0.16016884988442578,0.07515752150567806,0.20478737956830298,0.10120343101694051,0.039669723258840495,0.08791156469122097,0.3933361954733399,0.39259845684574035,0.2818788962640919,0.2153101601771542,0.32861793674161793,0.28859410302744826,0.11742859360849767,0.04163798966748067,0.178341428869985,0.1243915523540994,0.39079264610411024,0.13067038594595476,0.09810094475669157,0.19990302055396098,0.05902975641518354,0.37437117937802733,0.11852974848918393,0.11076200132438446,0.4018654021197169,0.39146575278515433,0.3707202684804664,0.3943728384159144,0.15217698170051594,0.18665792042458101,0.14942273645332468,0.03707436185260904,0.22892230485135312,0.18934050031890984,0.126833601162834,0.43169180795216394,0.08396379969812334,0.15142290902752573,0.15085833380608027,0.13455981383934268,0.0464628306834603,0.03606297101789557,0.043857293725960866,0.02078876704393312,0.08153283902802688,0.08250364528001261,0.13814667518425972,0.07043304529323505,0.07314030570098909,0.1083622505927519)
rate_upr=c(0.6586989536639023, 1.4722236139509997,1.0242414939949964,1.091882257129274,0.8195627250291018,0.3680908812610897,0.634081380888736,0.5334604588369259,0.6857962100519011,3.1348180633098197,0.4872684561535794,0.5856679573525784,0.35816571293096383,0.5712295526242492,0.9039890292297594,0.5426264053340242,0.6813487151536155,0.6696151303083366,0.47677547640567697,1.6013140407332571,0.9213297209126764,1.444095143687613,0.5632996346812644,0.8012587421993299,1.6816975131674141,0.2883574892611596,0.5728188016485403,0.7224869961939052,0.48499258531106415,0.287909615381746,1.0916450954581378,0.7797066103126759,1.5722313318026364,1.8089611933845715,1.3918295641880682,0.8205765811269037,1.0557022980892492,1.0088087857301988,1.637538986584933,2.073935580993964,1.45283121283978,0.45683832543714836,0.9454219029202275,1.1781529690096066,1.1326969293295717,0.7593018861156833,1.0540830888759718,1.0625319730836926,0.4783759931339121,0.9608962567748629,1.2330231533985354,0.46390736515030934,0.9543798227793387,0.937716263043378,0.5466957175983397,0.7262778927189241,3.0568169175926254,0.7942703000952951,1.1007010343161108,1.0675318800651539,0.9368585529848007,0.5936647232848586,0.8454068291983668,0.7455278506431195,0.9412582277641558,0.9558503612614601,0.7631088283237639,0.8794490939600345,0.6459839176046598,0.4880686521754391,0.38567743142848127,0.9035092095116892,2.592353731030113,4.054429398296575,4.0125666497653185,1.5920165820428622,4.083292353373435,0.9389376606890876,1.7271963111597053,1.596891144477132,1.4964585812232731,0.9489029921911167,1.7340424215903154,2.2755320588634524,1.2104665780484223,1.9781554680399467,0.9459916049687673,1.053052085814501,0.705596224647902,0.5666244596192698,0.676643272363296,0.6769204846683894,0.713192556076095,1.0628442388046853,0.6812264705303648,1.813243702076587,4.014432445893623,3.9541967669771534,4.170253066960067,1.0338753297015582,4.167954073504975,4.076713030128326,1.680297853273624,1.6638733250040851,1.146215889283145,4.173861576927253,1.4213064831489224,0.7216868152989702,0.7377973551251178,1.3350705227203719,1.0491279555961524,1.4482071686036724,1.4059996061980808,1.2522863157463753,1.2376753429058347,0.7070904265597187,0.8085981223910905,0.8556788451868469,0.3194725653543846,0.44496011330631063,0.62629087598634,0.928821075537639,0.7832018825806182,1.4058764091548124,0.7102666043129384,0.8200325805699548,1.1149673414390544,1.2435612541332277,1.6109860310231445,1.6176108088237804,2.5773589389744287,2.2995494723296055,2.443044284562246,2.402083516964709,2.523335305777366,2.3851499414435677,2.4199024870862864,1.401084493845683,0.5711419813360236,0.8291758351014065,1.1207880047776335,2.0037948338133575,0.734083177843267,0.5687060410097224,0.8802971710738685,0.9670368587981171,2.28197311920905,0.6014848627726781,0.607389657885101,2.10931944800629,2.073035408971993,2.0486843516464432,2.025341889313187,1.0222866927420449,1.5159899184359154,1.237637674683044,1.7601415277097614,2.002127324508808,2.5980276615741387,0.8160540825915329,2.8765899167808646,0.9343522989929858,0.9903469987991314,1.5296164304736606,1.1488750996494228,1.1256999238678944,0.8509596055715882,1.1297722647953625,0.36175913579953356,0.7928238611330733,1.518265246880376,0.9201091703866765,1.0887201234395145,0.4796766509963032,0.7736447661799268)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.709087213395712,11.763688761345936,18.88884247356902,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.78599643443742,13.509885309719447,13.644381033687072,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.275304079953862,12.763996434850949,10.928438777046042,19.116662982107215,19.495450853775065,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.709087213395712,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.474087405781923,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,11.108996465959809,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.109881006140222,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,21.561787314255916,7.7528298623786664,9.341546499182357,1.4329216478399402,10.180996483403327,18.093996334663508,9.179446502229375,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,12.8613425868673,20.792329617276543,20.39513914855202,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.709087213395712,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.953699984613685,13.644381033687072,15.307996387031654,14.445304095555281,10.74007339597134,11.566150303520583,22.72199624767148,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.26749625621469,12.543329772332134,10.15963284744126,12.685450981781905,19.64726903273955,19.555996307182443,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,17.990150182769337,22.62499624949477,20.759218506787857,13.580403826912434,12.518304131776894,23.05817805953415,8.592796513256541,10.029705577156214,17.296329682990496,13.202287335703351,19.967269026724537,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,10.74007339597134,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.05785612839113452, 0.06802858238722335,0.07292955213009941,0.07295628772342831,-0.05633295186654971,-0.05662255243685576,-0.05740287522929166,-0.05559186934076041,-0.05665994399375819,-0.05613541871933935,-0.05737523038489924,-0.056685937252266796,-0.05723722168284572,-0.05750562742744336,0.06741770735481976,0.06560033983279567,0.0739394493893565,0.07169366493540609,0.05865002711303664,0.05840186649519753,0.0582161071319528,0.05838117574116085,0.058311579759827106,0.058647086703716086,0.08828146830942983,0.07840363138282382,0.07953490994145065,0.0790440029444104,0.07943090023996194,0.07996217559886966,-0.10309229641376937,-0.10076184440062447,-0.10388773817575515,-0.10409607857309923,-0.10420272953239915,-0.10138030102111882,0.06411969464862532,0.056815799655868235,0.07599653789839274,0.08220110973624353,0.08242896854821213,-0.0074578623256241336,-0.004560805561175062,0.04516088964809221,-0.028755450141626598,-0.007473596729338155,-0.005877337237460853,0.00279153512826115,-0.007447238540290661,-0.007416270974625002,-0.029783384096544876,-0.03154799400656372,-0.019620785819735607,-0.006136235774034863,-0.01970897706758071,-0.023791755983957844,0.05612290481710405,0.07316143132712273,0.0729612024223646,0.0734301960337513,0.07305909930654872,0.05892108602402065,-0.10091552158719443,-0.10658790190077008,-0.10589320080625322,-0.10172496230910981,-0.10658790190077008,-0.10505649072153825,0.0689829226441806,0.06870267918836985,0.06859480586394189,-0.1038260787501696,-0.10652243865456086,-0.10626801085025794,-0.1065831179659239,-0.10575559871532535,-0.1063352861405661,-0.10574655674776966,-0.10652083268874446,-0.10632502362091713,-0.10435010378770729,-0.10198125613714625,-0.106493315546798,0.07548808104103559,0.07602371931330487,0.07607866986943199,0.06630002815707019,0.06613985603812628,0.06646421313809892,0.07034408436374892,0.06976363165146496,0.06978758759096373,0.06962494830878938,0.0701435029246018,0.07456731171962676,-0.10899747705968542,-0.10900238078560487,-0.1088368211619334,-0.10848690054616632,-0.10708387480270597,-0.10905389878754146,-0.10903645428230505,-0.1080862635371853,-0.10717107162990196,-0.1068965741229292,-0.10858734350492429,0.06055732594981012,-0.07988041157627958,-0.0800703812507892,-0.029881213350097576,0.05967040973041003,0.0593220853355087,-0.10215958958371826,0.06723062464930805,0.0674943594872065,0.06767361823591747,0.0678406996488148,-0.09255091789797348,0.0759734270921258,0.07562939039571834,0.07566635234465885,0.060629298961713894,0.06958758196948353,0.06991739944586052,0.06972629798363737,0.06989456195104943,0.08651143202207043,0.08589077461238424,0.06283363812985678,0.06678492452172827,0.08834285289603337,0.08728407827292745,0.08741679624725952,0.0885180082982633,0.08693436500879202,0.08740309650747274,0.08845529439632847,-0.09649645516620431,-0.041458912698286624,-0.04350802725909164,-0.04352334887290736,-0.04422485462643398,-0.04382598634747038,-0.04390318658908662,-0.04349503763581573,-0.04143730544846076,-0.044167981906180126,-0.043903023420688164,-0.043848963932483775,-0.04397567093712138,-0.043627175335699424,-0.044258408280545586,-0.04419250607941486,-0.0412664528623249,-0.03287325616846145,-0.03344224761258623,-0.033966833434358995,-0.032285152190559316,-0.03331109546636284,-0.033453830701036864,-0.09708388358041375,0.08824492452972126,0.0880568324233388,0.08849291478261646,0.08780117540679712,-0.0852920935890166,-0.08525289401535226,-0.05408486115138537,-0.05373793113413814,-0.05392259577078256,0.06810282860510586,0.06848119374648952,0.06608567123203042,0.0666822183711513,0.06625939102507108)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.02785389248814156, 0.04934883633688976,0.059005630177246186,0.05905848466498717,0.003935606173421853,0.003985332897510432,0.004124064288485217,0.0038053398390429805,0.003991807674296835,0.0038989368663262585,0.004119216799490814,0.003996287497822285,0.004094405952947162,0.004142136011240178,0.04803090912539122,0.04476488508922074,0.07586783720680638,0.07093072351764478,0.028804661409510348,0.02850369170148027,0.02828392045660547,0.028479007728562152,0.028396859729771427,0.028800566557592208,-0.20804490725886968,0.08971914274298379,0.09300825001219891,0.09159348622939695,0.09271039061619037,0.094238262335769,-0.020411279141790507,-0.01925903902069493,-0.020801019311076065,-0.020903086091398522,-0.02095540133668654,-0.0195628779892495,0.043125656424937805,0.031223950247695927,-0.13823445062006884,-0.17321865003919398,-0.17439675838491134,0.013924748201101124,0.013476710469192146,0.012647082351460422,0.012571756415693778,0.013996599811145254,0.013404932984766603,0.013388221250623755,0.01387558600328807,0.013734584745398353,0.012848074032721368,0.012570252048498652,0.013140446725390513,0.013391742194075561,0.013285641493936781,0.012948226311285022,0.02906698498153238,0.059470881742061214,0.059070149801531274,0.060006574646819674,0.059267508070354115,0.034029183236428596,-0.019352924951222993,-0.022296552387047117,-0.02194140734000089,-0.01978536604482662,-0.022296552387047117,-0.02151220755635917,0.05190580585242527,0.051391210725085706,0.05119185419059859,-0.02079965208003895,-0.022165645191930317,-0.022034485730077352,-0.022196464756827107,-0.02177518771786344,-0.022068550716766933,-0.021770694624061015,-0.02216461837453122,-0.022065041906007363,-0.021061814568087533,-0.019871774746213378,-0.02215065426306412,-0.1352107911798305,-0.1375865495569704,-0.1378293239948486,0.04695401020561803,0.04667552850355952,0.04723877178365647,0.06607855334009112,0.06474716622491941,0.06480186537427772,0.06443168949911368,0.06579501937199846,0.07745846701263591,-0.023580527580975025,-0.023583095537055624,-0.02349554157619599,-0.023310074703563256,-0.02256470090027826,-0.023610327494353597,-0.023601105464377707,-0.023099141359246893,-0.022613850644781865,-0.022468372531101868,-0.02336278775381109,0.04106326643592092,-0.008840154470780747,-0.00889163909871496,0.012951456027995863,0.038386832063502664,0.0378404084054509,-0.019950342221096776,0.04770676854126319,0.048166386298187945,0.04848202682468434,0.04877495405765744,-0.015141453656343546,0.08277477115321494,0.0818584571730429,0.0819570965158129,0.03554525465388402,0.05237657968959496,0.05304818918816423,0.05264306313974907,0.05295409876833336,-0.1977778133172012,-0.19431773359890064,0.03938092722623196,0.04779895480530371,-0.20843096461533975,-0.20231895941964537,-0.20306934370292867,-0.20944132788481518,-0.20032354720391543,-0.20299173755187838,-0.2090791323483478,-0.017118498678672753,0.03139765929596569,0.03562321534537383,0.0356543971412922,0.037100975494813816,0.036278737503361226,0.03643924738819349,0.03559728141662138,0.03143183970383664,0.03698421668770564,0.03643891715337913,0.036325151948832894,0.03659119896069338,0.035862913229251725,0.03716992907748444,0.03703432366787618,0.031042148711844637,0.014412273892776693,0.01535461782724893,0.015986556324861456,0.013187954452971605,0.015234069072987513,0.015167164206471585,-0.017392763936181364,-0.20783020340569883,-0.2067499612168194,-0.20926533416314408,-0.20527801035509582,-0.011474885823359702,-0.011462001637397837,0.004056672966054316,0.003993080360609874,0.004026981063291408,0.04926190222150133,0.049935517528793924,0.04657458775461062,0.04761397484999905,0.04687746293256328)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(18.205000000000002, 14.895000000000001,9.438,9.438,12.725000000000001,6.2895,6.2895,9.438,9.438,3.0900000000000003,6.2895,9.438,1.2905000000000002,6.2895,14.895000000000001,21.735000000000003,36.3634,25.565,9.438,14.895000000000001,18.205000000000002,14.895000000000001,14.895000000000001,12.725000000000001,3.0900000000000003,9.438,14.895000000000001,12.725000000000001,14.895000000000001,9.438,3.0900000000000003,4.4665,2.1900000000000004,1.2905000000000002,1.2905000000000002,4.4665,25.565,25.565,14.895000000000001,9.438,9.438,18.205000000000002,18.205000000000002,31.0,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,18.205000000000002,18.205000000000002,12.725000000000001,18.205000000000002,18.205000000000002,12.725000000000001,14.895000000000001,25.565,9.438,9.438,6.2895,9.438,25.565,4.4665,1.2905000000000002,3.0900000000000003,6.2895,0.06885,6.2895,4.4665,9.438,9.438,6.2895,0.4535,0.4535,0.4535,4.4665,0.4535,3.0900000000000003,1.2905000000000002,1.2905000000000002,4.4665,6.2895,1.2905000000000002,14.895000000000001,12.725000000000001,9.438,18.205000000000002,18.205000000000002,18.205000000000002,31.0,36.3634,36.3634,36.3634,36.3634,36.3634,1.2905000000000002,0.06885,0.4535,2.1900000000000004,0.4535,0.4535,0.4535,1.2905000000000002,0.4535,2.1900000000000004,0.06885,31.0,9.438,9.438,9.438,25.565,31.0,4.4665,18.205000000000002,18.205000000000002,14.895000000000001,14.895000000000001,6.2895,18.205000000000002,25.565,25.565,21.735000000000003,14.895000000000001,18.205000000000002,18.205000000000002,14.895000000000001,2.1900000000000004,9.438,12.725000000000001,9.438,2.1900000000000004,4.4665,4.4665,1.2905000000000002,6.2895,4.4665,2.1900000000000004,6.2895,3.0900000000000003,4.4665,4.4665,0.4535,3.0900000000000003,4.4665,4.4665,6.2895,2.1900000000000004,3.0900000000000003,1.2905000000000002,4.4665,1.2905000000000002,0.4535,2.1900000000000004,9.438,18.205000000000002,14.895000000000001,1.2905000000000002,18.205000000000002,18.205000000000002,9.438,4.4665,1.2905000000000002,4.4665,1.2905000000000002,6.2895,6.2895,9.438,9.438,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205000000000002,12.725000000000001,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(5.0, 2.0,1.0,3.0,0.0,4.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.03844077555991064, 0.00966958297693897,-0.019760210039038474,0.017606784862253307,0.2654927425936411,0.24003276597776296,0.1731047723651267,-0.017354729204642108,0.185149663184576,0.12355436424411723,-0.03352627383006307,0.2789275197447847,0.34857280802082946,0.0760688567976216,0.04348329232315143,0.010227036251736411,0.18925926714896718,0.07359051455751608,0.012154218854975248,0.01141556224684076,0.036918885951665203,0.02392657877053255,-0.04176696910585559,0.02248002466788182,0.0949703025503438,0.2670097458820444,0.08886747475224632,0.03910269712941093,0.043701351879581435,0.07674787435492336,-0.2545259665363223,-0.024538206271238785,-0.17913643351915748,-0.20743105032159553,-0.15880359699555124,-0.13722907069944307,0.019659291971513285,0.10996689314497138,0.003535250850349054,-0.007823038046136472,-0.0023530640894157085,-0.009783888386490781,0.009590449725225242,0.023429283342101367,-0.0033526722470356967,0.014244855034899997,0.0058390936981622165,0.010748793874768686,0.04317185460491512,0.01755499099731911,0.0012389191348314657,0.018533195714692884,0.03279172127251458,0.009314941099694059,0.019358614559902943,0.038908679520025476,0.03976524196386777,-0.006828025600079869,-0.030836976702159995,-0.04180153570656864,-0.005654725644237481,0.2667925372678081,-0.02429177759287742,-0.03289342487460958,-0.23189860434111245,-0.023335152946170574,-0.03856667841036442,-0.04648136828195659,0.1449112992713093,0.19219974304334417,0.02592393021802384,-0.16471710736108341,-0.05871603960327727,-0.19383131278715868,-0.1473661286814527,-0.1273509874217541,0.0006091638789031138,-0.11785137952679327,-0.13859692474467783,-0.28631879466580384,-0.04865561925384422,-0.023118263593695117,-0.3348499153651724,-0.004369023810082775,-0.012190887202510168,0.011093858327646665,0.014944921039911466,0.0012088203320386568,0.00909523738595398,0.3528509931503336,0.2679508094835232,0.3468800703148185,0.28074418619416414,0.18164082383752955,0.2134730968498286,-0.1345926772100697,0.02870749756932016,-0.12257634875350902,-0.2633279773123589,-0.2465712103852864,0.01983947349517304,-0.2039456879659893,-0.3155609216407706,-0.127341972463043,-0.2707049923246773,0.04944369402574583,0.4004340040720959,0.028961082286937702,0.023630432839092722,-0.012868440427888796,0.47626800410734826,0.40912370438495976,-0.11394761242679328,-0.005344271613650424,0.012505728893833813,0.015999911521731518,2.578248256148642e-05,-0.019355084822344985,0.08865684125131487,0.11761219565030476,0.06123754087468116,0.009627039628153021,-0.003140557447475365,-0.008143056605885783,0.012821401990437511,-0.006857725864001998,-0.012019121701680067,-0.01574344818682251,0.0425901982571852,0.06777808898731791,0.14305210538870147,0.12133833753258116,0.09173693997969017,0.15145238293222052,0.10073195323886515,0.09715448718612947,0.1570532681071099,-0.009293777344661684,-0.09972577827642878,-0.030154141177184502,-0.014543963951365755,-0.06327644019451581,0.06073663110050699,-0.06730208749208993,0.06078953531918013,-0.010137046148735913,-0.00023866813585749868,-0.08948563418356417,-0.10272999239638288,-0.05222516428719683,-0.04035165510687528,-0.02615318041972496,0.02541972731446433,-0.05391931032337664,-0.002018006660616499,0.005615511161620682,0.11227136621921197,0.017469122044003936,0.0043240286978056645,0.13601185535872848,-0.032946379201306615,-0.017393182702520393,-0.010851362100552929,0.08969894059114458,-0.03293889728131714,-0.032218338720921745,-0.005980245834144191,0.011130114260650609,-0.0007995970653335709,-0.0018008382395872037,0.05253014582963299,0.003319576117056254,0.016084941423965365,-0.001184716652784949,0.01280786591825996)
shap_list[[2]]=c(0.089474336100525, 0.144745795343041,0.2848472886586218,0.42364106446497357,0.4067370521051006,0.37071324669527195,0.33658165972949966,-0.0340530756282251,0.35085993591886416,0.28992594658164406,-0.030109893472178562,0.4304992771837971,0.5309643781382797,0.1799484782503008,0.14793785713291888,0.10508677453217481,-0.11042108391043784,-0.09292301717245442,0.04448341937351352,0.10433129488385035,0.005501107417762339,0.06522134877525736,0.06650158038845176,0.06902201876588857,0.2307120779850179,-0.38313783564669485,-0.11488158190737338,-0.05365710551500178,-0.07696559928938253,-0.10688214754860556,-0.09635978879141151,-0.050869351091230336,0.05787051228845861,0.0216882147285056,0.06272484481483391,-0.10148731157166099,-0.08611681110103567,0.12523766945599685,0.3064663953034059,0.17703341417309662,0.22996509130909792,0.08080123030926821,0.07466722369925141,0.0961413709530613,0.05350794579354587,0.08627847900260983,0.06502981119302949,0.07835524706071254,0.08236746630810525,0.08846227375555848,0.24621077645210687,0.1548642708076469,0.1697838693398846,0.07038340405754463,0.1394157274606966,0.11758917124434867,0.05409429801673525,0.22283322758762203,0.2133696992075464,0.34923371743230247,0.1444337672141595,-0.08683094156894523,-0.04930850717663081,0.010349081968257942,-0.06816543349372287,-0.04851313341603331,0.01155483815579772,-0.060214944529940806,-0.25181527258715114,-0.2595294399284045,-0.0791037646510882,-0.05755825952320411,0.0007550793008631004,-0.19963497506617434,-0.10686014668493926,-0.07663732221824146,0.005024175828576099,-0.07050417058579085,0.041879787060013385,-0.07323413129784614,-0.04900874668838402,-0.04871775153276023,-0.1422095279500673,0.2685579593777941,0.25639334983656903,0.32356329516687127,-0.08503865782320337,-0.05718880570544004,-0.05330227331879222,0.1718572981508268,0.09665856810455628,0.16439370023534441,0.10695401082593685,-0.08460909912102071,-0.11367009878081137,0.009507070477754844,0.08391753138528106,-0.1468448061616532,-0.22612268955121398,-0.11364313065977,0.02225096447868165,-0.10440011756259054,-0.10138655879689848,0.05414608546617738,-0.131277062367271,0.03351835282489183,0.35567996003608304,0.1757440661841755,0.20897350147649024,0.1959423543730935,0.417364475950673,0.35938685716113733,0.46614526914236726,0.14756374840336,0.22255629640367477,0.23376111119691942,0.18112405078890229,-0.047235618885212105,-0.10420139286897472,-0.15637327078640906,-0.09020787611920027,0.05255376723278248,0.14567576944571428,0.1443421934176983,0.2552191572796535,0.13928624483887495,0.31199629143383145,0.28121791198539925,0.4781652674978944,0.011470795490489561,0.1855389659481013,0.035350035256756035,0.046316249516028904,0.1813244114184205,0.032760199080571165,0.05652099753779078,0.19795951622958846,0.08245540145390477,-0.1000479636930152,-0.07354139180818438,-0.04472670821910689,-0.08537515836376007,0.10009098078317323,-0.10121850339464965,0.09999186309924597,-0.04109058083760146,0.07294948274316927,-0.09265139338329004,-0.10872816261538266,-0.08746399577502362,-0.10834517168064095,-0.09558628095891612,0.06617270372625114,-0.10838444835191677,-0.03337618883514175,-0.025877257641406245,0.15300489446474713,-0.007529683059837445,-0.06230989666431245,0.18527009658199453,0.08831927232803881,0.056705664686475796,0.04121157969661579,0.20859941509975807,-0.024733906321006156,0.29903575945152167,0.20654336254355124,0.2936643157548591,0.11039400339499074,0.11339350066771181,0.4352056616981053,0.30788026534880586,-0.06418398327005277,-0.06603630992514949,-0.08468739120595292)
shap_list[[3]]=c(0.16690118578392452, 0.38957365053655985,-0.20259453470870953,-0.15110429041492218,0.1164537015050566,0.12377494253390663,0.7131241165424202,-0.03409602430103564,0.7095230984537505,1.4909604768589075,0.07982377383417764,0.11481974350006346,0.06984368710482278,0.43888414381418767,-0.04121269873124751,-0.10486033149704392,0.125500108044835,0.08696025822476373,-0.051972841722235374,-0.015002502776976396,-0.06678918197673264,-0.005189057128197736,0.14715374997813618,-0.06336960776394733,-0.073452267456101,0.5598539796093227,-0.019235021058122196,-0.019000300178746248,-0.03031270433259949,-0.02383169940778782,0.4746937583236622,0.10581500998543741,0.04066220232451448,0.032183015604187466,0.04006374646876943,-0.012032798748948676,0.09914105181982268,0.228067270582655,-0.23780588460873392,-0.19049816579484927,-0.23226317643589087,-0.09832283603729608,-0.006529994292392139,0.14751975413579718,-0.010501547383316538,-0.01962001556284052,-0.0002519233538231442,0.0026226201058914137,-0.01319438037453784,-0.01720153788658398,-0.22471700409987624,-0.03351121801407832,-0.03580655822376873,-0.007209133955739551,-0.036739970892314185,-0.03093295842697369,0.07066634653098726,-0.0668273284017688,-0.18768732653687678,0.4995920825572611,-0.053550558585032715,0.21673483939669433,0.11817901518578623,0.374378882305607,0.5460727399509244,0.12774054168514382,0.3886828113529232,0.21942778087458256,-0.07805987693727902,0.004134781214653551,-0.036864301247792504,0.4976260248256694,-0.08187167778356118,1.3906910035624354,1.0772310939665783,-0.056779454886955405,0.7058240756216316,-0.3301317550768212,-0.7797754495423247,-0.10075295142400402,-0.039727490744002114,0.11981415038251826,-0.06159121300603811,-0.178542933148264,-0.2360162875248518,-0.1609939826792137,-0.020102016119412994,-0.006692707161776528,-0.12828916216377703,0.3689608717106217,0.2340700311587936,0.35841505136167257,0.28939109099947286,0.12140755279294388,0.1325444635900334,0.011246846995501127,0.6914973168456817,1.2241029739131946,1.35957323782292,0.4892939122952915,0.7070267428354309,1.3808762208658876,-0.08308666964643956,0.024157650228110044,0.46734048698104363,0.7002961810102225,0.5479405725731921,-0.03145113938986933,-0.0247814284237041,-0.13116671148967812,0.6476871339746043,0.5572221404083446,-0.03218236089018675,-0.04816105365018724,-0.08396067112576738,-0.08477055474105157,-0.07086273049670767,0.09630443557073141,-0.040690168689527635,0.13402946025470633,-0.03901425434734004,0.16147556904765675,-0.05356811598909244,-0.05676949589141542,0.29133911600442325,-0.049825303088130615,-0.23395484743907352,-0.2606413500810169,-0.1119441910226149,0.04831195935615392,0.08746940492275701,0.10719252310689069,0.12663753206538847,0.1717782509113532,0.08466274608778357,0.13963448453183314,0.17290052154002206,0.14186788197023908,-0.1075808382731366,-0.0638561833016326,-0.025915948539632035,0.8906414892695211,0.04251418547554321,-0.1305809063817261,0.0416569780742323,0.09630938227363237,0.9093476751554834,-0.10499166945940754,-0.13751841499744083,0.870586109563092,0.8842412849278024,0.903669553591511,0.7384991380779632,-0.07418521626193447,0.0018472505592585164,0.023085106439784425,0.05947441789743419,0.051045582509436714,0.5450398082078896,-0.0030525434450998125,0.5461046770900307,-0.247316961182963,-0.24704830460232347,-0.06927515433479392,-0.2354840442957262,0.2009715271912182,-0.08275468873243969,0.004786623849966784,-0.0855849574046498,-0.02449380467191789,-0.11571218667138278,-0.20353057607409397,0.10401745645994846,-0.015772388426240604,-0.02059900627437338)
shap_list[[4]]=c(-0.13168388468153744, 0.059339471302229344,0.08472539628209684,0.2732785344757826,0.4538944769539037,0.4833412514722451,-0.17508167244651676,0.011849461358016835,-0.10948338893348289,0.24881166655184567,-0.055822561262833144,0.3996994227655631,0.26149789174270505,-0.08894389508406218,0.03067950665138138,-0.040495101900400614,-0.06344429017274282,-0.05453293597264004,0.07670666645612143,0.04617124995860125,0.0992073257338755,0.03614920472607181,-0.1696820249446883,0.09641287637006844,0.0032340553763318303,-0.08231824559031152,0.08903902274435656,-0.007536189131495736,0.02818341965825902,0.07594709397966011,-0.1472284591346992,-0.0484416748079301,0.36190116675325296,-0.38157612134824936,0.29176578707217604,0.0421497586198,-0.045071928313887545,-0.11798320961529363,0.21062680119740756,-0.006313531890782287,0.10811622931203704,6.611350548703696e-05,0.023620474020770162,-0.11532504537735065,-0.00508720931252248,0.03174810298067883,-0.0008483547174589312,0.01565651514134029,0.04671759682277145,0.04425722853652536,0.21247204390753524,0.0754233940495664,0.07674815870719653,0.014013126537397964,0.055654906890299706,0.08522510630999043,0.02677364216866796,0.13301763990747886,0.03005691379325077,-0.07782527330441194,0.07591213833509504,-0.09672857136702342,-0.04638164832791726,-0.13479509778015303,-0.10549130818614884,-0.03119121451943545,-0.18808258005690026,-0.07321061379635246,0.39735226396596496,0.15242562667395673,0.008369273991066703,-0.13431937346816375,0.6172924231037925,0.46883576191312487,0.6148980705270326,0.16207673513708698,0.34942348321731326,0.11584536517424505,0.5722780565484052,0.3350865805661211,0.059060793311616365,-0.03294072493206538,0.4671568586264074,0.031090371271665498,0.10305325394301627,0.03282673938478771,0.05190344810147177,0.005948261494360209,0.05167247149139258,-0.09953090226900767,-0.12227295659606892,-0.10181770359815977,-0.09944106735961979,-0.05203941289142664,-0.05839793225234139,0.623652356631577,0.2928101224287135,0.9774218872520325,0.41507335435892434,-0.11056046853246508,0.3051765580290582,0.535115010399039,0.263236325345463,0.5227613231682128,-0.12367909033594339,0.29966920342049314,-0.0864281677874999,0.0881618266141388,0.0816672164480409,0.04325301223132759,-0.10645794200975299,-0.08519339742719496,0.1893620673116837,0.003273701823607727,0.07455656026701746,0.09645779199556834,0.038991281112300734,-0.04970879805778862,0.06361125976015883,-0.06553486035992583,0.0004027390936789245,-0.08892083125814258,0.014832506788087571,0.0006769007245672454,-0.21241406951524766,0.01624712093752193,-0.015648874541561292,0.08132463523029525,0.36353845862970435,0.06689066637230913,-0.21026198749903333,0.25117936239739064,0.22938993011809544,0.3824769951442536,0.1807677859230199,0.3086795462166152,0.3798796551953038,-0.07352928596123441,0.3089273863814003,0.010401736516417657,0.022278076368010984,-0.4572048794076927,0.3167442988543595,0.1990391179311936,0.3152628328518102,-0.0428065662010168,-0.17742032743109382,0.22445905954615814,0.007432652177885779,-0.48645905599227196,-0.4669443405837985,-0.43822613737373356,-0.3491206334464155,0.0963366952819655,0.007388885991114853,0.013710992197051103,-0.20389187046006108,0.03087543391076804,0.07646635576427137,0.21316993376276439,-0.14008827964353718,0.3829489829612484,0.39113898015136056,-0.013572357521740283,0.09335960280269602,-0.119587037948613,-0.028388821151449598,0.08924415444986615,0.03246632722742998,0.010905077833469888,0.35258694920744055,0.13990499240837584,-0.02882951244868818,0.009526617748582301,0.05565799736038967)
shap_list[[5]]=c(-0.11436799907784942, -0.14527365884626928,-0.1301217497004267,-0.16181915478910117,1.6105150663556893,1.522737954642426,1.8280061338404714,-0.08617613999610797,1.8942971236301522,-0.2573311025125909,-0.09176147170848713,1.575826297630084,1.769248258521901,0.9720548030697306,-0.11261436858240291,-0.09076734127236642,-0.08257684534217104,-0.07789537506171519,-0.1200107860113972,-0.11570136140497544,-0.1133690932717028,-0.10980238295704765,-0.11327079331863858,-0.13388182608316734,3.3759902224040914,1.2878277508958005,-0.09861475834682977,-0.07391049983195637,-0.07862799000106775,-0.09361100703949429,0.9089353495564407,-0.09392308989041467,3.5366915136199277,2.8351753696941246,3.5283838837202683,0.7166152624529112,-0.08682132841363466,-0.11113572964361756,-0.16409514009883572,-0.1269019917141824,-0.14126646839936202,-0.08779218654419961,-0.09644017648602948,-0.09835410259753358,-0.08929972402922048,-0.10621671282153924,-0.09139787068092874,-0.09765619991764482,-0.10626547267386297,-0.10648889103173823,-0.1280567487412655,-0.12008392824588243,-0.12548654378620894,-0.09516164519951717,-0.11730507597003044,-0.11788466780104988,-0.09813682646101271,-0.13831775268004995,-0.11200669712880564,-0.17033190207052243,-0.12091343977708467,-0.10382072045005449,-0.09067717414041836,3.394642342993779,1.127999043260157,-0.0942699197824609,3.3562776850433558,0.14317472881201934,3.32613794647614,0.7106301392203611,-0.08438867875504522,0.9011296243567013,3.233780065110122,1.4289341032833782,-0.2220697888450855,0.27634965761792607,3.5642171190955545,0.5366734851959477,3.083128564292716,0.8533464063663845,0.04341811494670345,-0.10466369683401208,1.0593180757174654,-0.1427813867364619,-0.1447269420386538,-0.1538932395163508,-0.07658089850345114,-0.07564349663290758,-0.07261358226321007,-0.12255538929891024,-0.09474602048067007,-0.12060768067229159,-0.1091656296194575,-0.08235989173177694,-0.08476993566962142,3.5454583554833,3.5920794047540556,1.3452555981065917,1.3520266121865014,1.3385569124840644,3.5972581091566442,1.5325319924050553,1.3857056233911471,3.6065273380784832,0.8740710883025606,3.604848432856714,-0.15009870677997103,-0.1328324608191494,-0.1316509073412212,-0.10362051302331024,-0.1655566597830291,-0.15154117918712506,1.250142079614363,-0.0992696197569736,-0.12780073846787574,-0.1308015352459344,-0.11254047277828792,-0.10001924394091187,-0.09045850935027593,-0.0928987629365936,-0.07944723533784188,-0.10439664270652815,-0.10433301266450505,-0.10823275324586057,-0.13536389408076863,-0.10399180203973965,-0.14708874987225903,-0.15135256538131286,-0.17307371644135494,-0.11576588181724184,1.2009789591690099,-0.1387170652355938,-0.17391449181683652,1.3149145550312522,-0.15838270304637106,-0.1803615604346749,1.3266977364737167,-0.1158505305167633,0.9600453124393326,0.31296461761625866,0.2869636806442532,1.268273309245866,3.8481250555174564,0.8934632455148654,3.851139181680947,-0.04659901657275013,0.7810300655244287,1.2506936066969574,0.7214514217261726,1.1797777449461948,1.1832484068973699,1.4600961593705966,3.576214136045666,0.3646475819777737,-0.07577445057314629,-0.08288125064576006,1.0105674623806555,-0.08185425977035211,-0.15054480856561445,0.9822491457443214,-0.15216396777802682,-0.16484659378185276,-0.16347369858866548,3.3532610348058745,-0.12398375457383846,-0.14550434944177112,-0.10544493504437065,-0.13403388345804457,-0.10156484587471126,-0.09903610621820019,-0.16943367959110864,-0.1440160367702659,-0.08816925230159858,-0.07976617652042393,-0.09560395969755832)
shap_list[[6]]=c(0.09947111760578907, 0.22597797651077703,0.13717843526797122,0.2340719809792165,0.006947416542801649,-0.0035528768772223555,-0.0589919424955502,-0.07016395786980342,-0.052302569589880214,-0.06186747099215906,-0.07219075391905909,0.00840855856679409,0.014562024190747968,-0.07037135748599534,0.11953190201025157,0.09263024326104081,0.054245654286256446,0.04754947259889065,0.12046484614258805,0.11923861415166169,0.08683386149142622,0.1126889278750208,0.09838992684355263,0.13318203052463667,0.1849253449816062,0.26882638659409547,0.07662971294469188,0.049364791307273295,0.05530221207077288,0.07091397747181519,-0.27063831837469243,-0.05476840462114989,-0.16358973989005124,-0.21966092850234467,-0.17696707653989435,-0.19217485192366754,0.05421773723945735,0.11974372707937099,0.16315426668083463,0.09222969306720477,0.11233779420753612,-0.028466630103111703,-0.0038965664937735548,0.06162551587098632,-0.04893670186569778,-0.006313576311853708,-0.013230705054237986,0.008532663228805464,0.007624171862426521,-0.00288105386348147,-0.07841580020158145,-0.045677579885504235,-0.02309387438923285,-0.009015367191600376,-0.028979946124732887,-0.02677929076893698,0.10640081775782655,0.14155838344125046,0.10679838014113872,0.24790516920420705,0.12709494968788845,0.07753019881634877,-0.05320580542193432,-0.25103141798781015,-0.30838013800868774,-0.054729486401960424,-0.255778816750933,-0.10446967210515544,0.16980488256979967,0.23001296706279864,0.054858195132864856,-0.28042618911062556,-0.14434542883849089,-0.2949774561889656,-0.12527344289694525,-0.13699063095230124,-0.11974280655172329,-0.1262707653837982,-0.1637230580770696,-0.27528976225190077,-0.0889753301193801,-0.05395051422560461,-0.23943148351670893,0.13084572998168978,0.12982853985891954,0.15024859792944217,0.07105274432252905,0.052062999087084345,0.05432188797406045,0.1521814663048802,0.10353081700698001,0.14590758373978424,0.12070262886106727,0.05102381200725412,0.05434546119249161,-0.12126781527975275,-0.12864708350135007,-0.1632440611249147,-0.30857457999513116,-0.26863992824360383,-0.13575905375518862,-0.28887423226336223,-0.2115316275321208,-0.12808457192935882,-0.27537744231534783,-0.1295496867325965,0.24162671480116973,-0.11305899084678725,-0.10531730675171937,-0.04664174208805632,0.28416406862485893,0.24398760854465013,-0.2863881832790045,0.08003651379931226,0.10739485620642887,0.1144709289513172,0.09227727577703701,-0.051060871891457325,0.06452075200758854,0.0619425554721896,0.050054688449091195,0.10711657536973862,0.09015091514793326,0.09012025373211831,0.15579224406359773,0.09086851616278713,0.09876994229618918,0.11118023040388841,0.2768244406526838,0.17184511711871595,0.2670409291780732,0.21643642102115224,0.21631077265604592,0.24960554950440658,0.2013969162750977,0.23407148933983643,0.24382769467039636,-0.06953683612068787,-0.039439723136374304,-0.05594661969443897,-0.0259507238900537,-0.03340141979933544,0.07754684372233077,-0.0696570203782296,0.07816489604252168,-0.04116630222531098,-0.01913023151349204,-0.048253966032989766,-0.07559959646049925,-0.034463595938025386,-0.02772571285855498,-0.020901321041314144,0.02993949063211947,-0.049255092252513066,-0.0402226023694636,-0.030801358338608736,0.09348063546087863,-0.013815000767156506,-0.03856051875988897,0.0638391834598773,-0.06852523494207814,0.14683716414214776,0.14602119793520446,0.19411148413907375,0.08879764682775176,-0.09478215959096363,-0.0633214394511343,-0.0398249063299572,-0.07848300694045282,-0.06957069875723067,0.28117588633295126,0.1625441148141575,0.06139520194182153,0.053182863448647026,0.06652050712475548)
shap_list[[7]]=c(-0.0023362797562235266, 0.008513811360179768,-0.06276170079788088,-0.03308311686314575,0.18236400664924587,0.17330748155160974,0.18424556478720067,0.003871057429277473,0.1879397908346782,0.14151561110669883,0.011988111201974964,0.17996445410107406,0.22454881934419707,0.10610985651403801,-0.01807832097905314,-0.020254716165123882,-0.08680957646307554,-0.06273598720216789,-0.009954674437043936,0.005226956424907661,-0.008217735182782461,0.008881344442634857,-0.0032390889819785044,-0.007786547429173155,0.10689056368307602,-0.1734732936177779,-0.09878597204213756,-0.05957311136806011,-0.06708185249778031,-0.09457694589097057,0.1368242513750879,0.044026617428680935,0.3257427413625319,0.25708098909288174,0.3217717092113735,0.12324182904841093,-0.019361774031888407,0.012717955714994497,0.22480819792670084,0.24176916406903634,0.20637245831707682,0.005245851064005838,0.011722999099807492,0.0269819578883353,0.0065662044460639045,0.012171016494011975,0.011889297578316969,0.015764287556914683,0.016473264217467306,0.012780940306222472,0.015970322063925693,0.015546662383335616,0.020796581289642617,0.011691658638230944,0.013854314861655798,0.016518021377732426,0.022366160105241006,-0.06741478590901509,-0.05768954314684196,-0.035414143162498586,-0.050426877601332014,0.02570430423158711,0.045963657787908105,0.23222723502069637,0.16607179360154914,0.048407674052302084,0.23411637906434782,0.07404922814670024,-0.013420587112661968,-0.030358363536941525,-0.032034553098798046,0.1468999978238627,0.26764343719815437,0.2736128931772336,0.1927387695971324,0.11227592843686408,0.24735712018556294,0.09392767107459143,0.3363163618000911,0.20186102399918723,0.06324313170423909,0.04657911385212615,0.2121065674970381,0.3178247049630581,0.23783042699787488,0.36432743042864635,-0.02906560602752411,-0.018835872071792607,-0.01858650629317692,-0.0834497366289067,-0.07102519951396152,-0.0786306709674165,-0.07770296139855588,-0.0571846350602361,-0.09065727815944931,0.30583751830795136,0.24745836076510022,0.2946436252970137,0.2621228748820531,0.1578185001483409,0.25054856853996604,0.28653465716574067,0.1907572170506217,0.31271661838197284,0.13637115437723674,0.2476737071931816,0.03770015093650229,0.05577970628958075,0.058966882652895465,0.01960323724085442,0.05689993202196766,0.05074470467707154,0.2602646997624014,-0.03355106602000034,-0.04950317833164811,-0.050659525027992425,-0.04552107730683931,0.03749008718943528,-0.08453819058628971,-0.12199921813289027,-0.06933950908473036,-0.006333665462234537,-0.039612249145247753,-0.04408501570486085,-0.039625387287172825,-0.039183048336003744,0.251969749883339,0.1382534120496937,0.044573718121315054,0.002262461730425618,0.30815768785612124,0.5171334830620302,0.4581327304263114,0.19817463091136986,0.5035288280124394,0.48896007720945767,0.1880020072212557,0.06105321153503305,-0.07062160370487769,-0.03856960822904619,-0.00883670075465454,-0.027254608673817127,0.030411558984697214,-0.10328986096794249,0.033993180555551665,-0.006042711326043902,-0.010337520634939864,-0.08581062629776422,-0.07607791421531115,-0.027306043005942172,-0.019545968094075078,-0.01963034734079776,0.025897599427540007,-0.04075147702018644,0.0027484894845705094,0.00737708657162454,0.09700091528579904,0.01810843501342336,0.025383426932434186,0.08021100734390606,0.09796412835431728,0.23708399905575803,0.25635952645071075,0.1171881538871395,0.15789643715210852,0.08111082178035413,0.04777322973093191,0.05374706785264595,0.01956745543575336,0.0172165519639132,0.026005958876945626,-0.02555338310377987,-0.018453480804509845,-0.023285125252527062,-0.030969052492865207)
shap_list[[8]]=c(-0.0163133182076479, -0.05278914211495718,0.10141223009581271,0.10825296277594423,0.31450233181176507,0.30339294019996255,0.3439399394919117,0.018943107660986436,0.33852207737190043,0.27281512991921764,0.0313458738237842,0.31137478382470085,0.39341718046854074,0.22441637985100849,-0.050070808512725065,-0.020041791152703128,-0.14706068297291222,-0.08279711353719144,-0.00045643833147247234,-0.0395126189172632,0.02560666203316845,-0.03466910352235862,0.03283902863321084,0.06172716985745574,0.18276960282345325,0.24549992721716407,0.06653819481319037,-0.016651878206950296,-0.020049074589072326,0.04104888940224189,0.18198961915808623,0.05455957893796547,0.31979631579967976,0.27173310588058697,0.3241075701299982,0.1430263723178128,-0.049787905213308926,-0.21470138103904005,0.024754473598149754,0.004880964418050308,0.01102541972441346,0.005652095529265666,-0.06152253518253821,-0.176383434901656,-0.016270826189827524,-0.021088149254848924,-0.050197807675073314,-0.05832840099908085,-0.04754855759514252,-0.03635519571880963,0.011137750929186013,0.006445125544071063,0.01191854622621201,-0.05292950661069096,0.004280910068265644,0.04843254792133985,-0.06849099937917237,0.06145045620658449,0.051186295526484946,0.13779434402670754,0.0007968621701432882,-0.17134912610408665,0.06140517238722071,0.2396970644176231,0.23274497196301847,0.04671169094801846,0.24304197666916977,0.095349074236548,0.19206976258076774,0.185581293370464,0.029428661331969006,0.20138420030200554,0.245758375378672,0.303615233942001,0.22687665646355443,0.0970967985681988,0.20961280649462566,0.10228012834463902,0.32343779701101155,0.18646889078548823,0.06065436559812734,0.04417040767707895,0.20541745164461053,-0.03514014391358107,-0.03694367386867794,0.015849404574979072,0.036091241469842446,-0.038636047307704736,0.0038003134053854397,-0.337106921446455,-0.40448734821897764,-0.3488833133937196,-0.32964646604907705,-0.14220427293666024,-0.13731216649301198,0.26733619168240563,0.20261981501913645,0.26765222278713946,0.26559806262221564,0.20715905706995913,0.20851773276950689,0.30028409261524414,0.1799411010726526,0.28174572390732067,0.1768037833653223,0.20551891563039684,-0.37565771887787824,0.06191735411315888,0.041376849004349465,0.009597535275932021,-0.27434362533310647,-0.37713188291605476,0.29340428333219093,-0.0684603862063157,0.014654639833279658,0.005130611875733413,-0.03558260526456789,0.047030888577533424,0.016873880067695742,0.00793834376080644,0.004580085567140373,-0.09486977189601513,-0.04761246536734577,-0.002391472281211124,-0.0038680286172975012,-0.045672339694973134,0.1360125074793128,0.15768317025849707,0.04848871227076882,0.00771356434043691,0.2174845678077206,0.1334418071217337,0.10114678483654325,0.2327895330629776,0.06023000366820179,0.10533131443398525,0.2346127536039832,0.06801453809599392,0.2224808308079273,0.08443179662764017,0.08480691771896763,0.2685096694222122,0.27101436108083043,0.19743464503816316,0.2705394492516717,0.056538027911109484,0.23894097163972178,0.21540181892824273,0.1298527965225989,0.24244882690550426,0.2521559450538009,0.2740759163203053,0.22409615889983178,0.1003169734872325,-0.02235468070689649,0.0035217846125980474,0.2078326285601526,-0.0185696629905562,-0.08956720838821146,0.2609769483767337,0.10124586540236709,0.17054995112336466,0.15647920528244158,0.19072604986249753,0.09548261892830857,0.10461890014333923,0.0450424984671475,0.0203059647261393,0.04476357659849284,-0.015060892364481325,0.04544335802577718,0.1172897991603681,-0.048123889403726985,-0.01770367149533681,0.029619935403717604)
shap = do.call('cbind', shap_list)
baseline = 0.32021837949677917
rate=c(0.37292276170384897, 0.9599758665652784,0.5131435345552261,1.031063144987781,3.6771251740139834,3.533966085692743,3.6651469513113444,0.11303807894524585,3.824724110367339,2.568603001254457,0.15996518416409503,3.619738436813638,3.932873427028802,2.158385645223607,0.439874740809054,0.2517431515540933,0.19891093011549843,0.15743419593178093,0.39163278982182875,0.4363855740634258,0.3859102116934591,0.41742524047869256,0.3371437889889698,0.49800451840642235,4.426258281844599,2.310306794840423,0.3097754513968013,0.178356783701253,0.1743681423954904,0.26597441481856127,1.2539088250729287,0.25207885916689915,4.620156658235932,2.929410974324873,4.5532652473787545,0.902327568991994,0.20607671345381737,0.47213157517681653,0.8516627403460576,0.5045948877782169,0.6121526634422727,0.18761812883370768,0.27143025358710027,0.2858536788105204,0.2068438487087687,0.3114223790578976,0.24704992048476576,0.2959139055484868,0.3495643226689215,0.3203471345917915,0.37605863894164115,0.39175830185062704,0.44787027993301937,0.26130585687209873,0.3697578603505225,0.4512949888732555,0.47365706019991977,0.5996901940488011,0.3334091246505159,1.229370838473256,0.43791049529637865,0.44825089971910825,0.28190131219791636,4.152793045560171,1.6791714442427566,0.291039379116183,4.071463994564174,0.5678425928532242,4.207198797723668,1.5053151266170113,0.2064071424179797,1.430237297341941,4.400514613363057,3.4974636313326544,1.830393462942656,0.5702591037776022,5.282543517267221,0.5241869587129995,3.595163513844944,1.1613856415744035,0.32022759825185504,0.26739110029036534,1.486135193144313,0.7077036574825968,0.6174461594984656,0.9032404831135877,0.28342355595694274,0.182441531530641,0.1663167657146155,0.7234260591701602,0.3298970804409546,0.6858754165168113,0.5020541719507103,0.2558932563933865,0.23577398977389727,4.82739622658545,5.330661344762719,3.996629470812673,3.17658727451069,1.7736320236733085,5.29507747504605,3.7583403151558032,1.628292868740435,4.866846574334658,1.1737663051797034,5.331637179725825,1.2914151884704734,0.45343982392896487,0.4730836194010034,0.29431711158905355,1.6562437670503427,1.326816935142567,2.347018622063803,0.29630594627593154,0.4906218731757231,0.5198071200230711,0.3681298838111779,0.23366417323676456,0.2339928510884694,0.20493482241896746,0.15848455859225835,0.3564704194521895,0.3226111702648478,0.3357359336419295,0.644118919334404,0.32109004241311423,0.7102552770348781,0.6621403757754005,1.2893812674623606,0.5807251510753862,2.5196790122682304,1.5635732837597207,1.4159748272780464,3.2027346884130328,1.3259141087363873,1.570209215517752,3.2211515325381535,0.40539898260860274,1.3942560020416064,0.4659485860466085,0.5942930088731985,2.081130340995259,5.067402295015676,1.1381070093663646,5.071756296371946,0.285223566370062,2.115359826844198,1.5895795753111228,0.6783011692384202,1.925113205913111,1.9769511680518066,2.357562741644709,4.657336700174199,0.5550240860338236,0.15845707638645865,0.23396899385368305,1.8499588293055973,0.315948346386509,0.6304495667211536,2.2388940066800065,0.7601284611065835,0.884787403798437,0.8900555037215714,4.390955946025731,0.3386140827357569,0.6138635023609433,0.3336873400248716,0.619237830602905,0.2609773348682985,0.2517711697104567,1.228020473205142,0.6780571313974033,0.2539558610939382,0.17917947242154583,0.2529652756331522)
rate_lwr=c(0.06457433850213062, 0.0727225739684011,0.12089596461171506,0.12139262457421615,0.0434785917976761,0.033751030815723254,0.8940673547138398,0.010857199232365194,1.0078701339674667,0.25916629311993955,0.01135067958358954,0.009750872998303267,1.3234354992216406,0.00898805452715179,0.07216881969135575,0.021595054394425883,0.04462603247819841,0.028358047416261023,0.10916913921961305,0.09327810178506515,0.022703018370095418,0.07028592151665985,0.0580672388385895,0.10921195853434487,1.8448208988958248,0.09465243702556017,0.032706953780110876,0.03219806589833496,0.0518460702434419,0.04473147200363203,0.2532923653724431,0.06863325516706947,2.1484238041453807,0.2949058259608057,2.1397677663748844,0.06276286225193292,0.021646749450854763,0.03556096597140984,0.11704517822836992,0.04485379789312993,0.08274732587185629,0.024055843573207947,0.08709229916899897,0.026004062778406,0.01926594936736223,0.10907613793771526,0.07222466932644878,0.07888611589984582,0.06915549598566423,0.09751194256068871,0.02249026765589751,0.08932771318367505,0.13487011882060035,0.0858637285628521,0.12572072940944537,0.11213575942009227,0.0071565762965535296,0.1023825950379359,0.05764114323625191,0.10177251303022075,0.12153100046287535,0.00712315489175952,0.06729847291727237,1.2347963058972324,0.2998293818652785,0.060934191561789225,1.0780825738409758,0.055041252795734213,1.40857562353556,0.06055307184612746,0.02272041653302978,0.15732812649639952,1.4470571488196096,0.9826983651771375,0.05533172450200266,0.009474002445510943,2.907154249641293,0.01721623537333805,0.3615740020268553,0.18842095899408143,0.009400708872900926,0.06789841504877059,0.1428214354543646,0.08863981858026371,0.1315891466604656,0.10344407703277231,0.04652969380607497,0.02253761822607986,0.007539456729313193,0.08402663498206756,0.06543994965665967,0.09888853816819904,0.0920833723649786,0.019262120929487758,0.041259036305073105,2.5789580741953073,3.070104049285204,1.3445025428658144,0.6271719801286999,0.2665502678579577,2.8722467284923914,1.4716433393006554,0.0799989439653346,2.760382820142958,0.24133154956585207,2.9117351087598435,0.15855940428087587,0.05216938244142791,0.09446241993539134,0.009733865207034453,0.14540729999700505,0.15997876648714726,0.10278813881794663,0.0970269911265802,0.1739508179894568,0.17136935819034965,0.12880934021539714,0.053009646327467796,0.027912720829709997,0.034685779761492175,0.023878322282904263,0.03535056678766468,0.11998568889470107,0.1199142509439623,0.0395038290582872,0.10697050616233603,0.09318742723125992,0.08964153589216708,0.11427857300241243,0.02126933531015779,0.16161953109623706,0.20840464600270742,0.2377822096166089,0.5526323989971995,0.05193493224255674,0.24911538936358402,0.7190145621095156,0.017138174955630914,0.2410816217295058,0.006959063817270267,0.01884163894910007,0.48387883372881546,2.7124727449640575,0.23582704642361685,2.7253319767049744,0.006476115988448161,0.03076592886148896,0.12071041778433564,0.14150529946224186,0.5647025409993991,0.5382374768560212,0.39127756937567815,2.108707042996278,0.014678995476715917,0.014780918683006905,0.02036417957254799,0.15608645798374693,0.01953430427374736,0.012008255110487642,0.012438360847681296,0.04726928181465406,0.11590333968741096,0.10704208719100569,1.931488207769543,0.025937664866415744,0.04089571561373473,0.019327792901544877,0.08909592301132557,0.01572104847008987,0.03805197253343934,0.16141874778454074,0.12776887888871483,0.02327888575739584,0.038853793243886214,0.043061404524072755)
rate_upr=c(0.7856177945321083, 2.7287110987505874,1.0671884593415804,2.401688969393352,6.579676463466327,6.63807230710311,6.303110960612884,0.24356396822281678,6.437467069603401,4.929842641728828,0.35612415374981266,6.656949517788419,6.574623785414602,5.675766486770708,1.2251119705284217,0.5948541913812746,0.4119832095257485,0.30823200123292893,0.8170137263090441,0.9273808049531921,0.9529056374427324,0.9588234504823359,0.7695046913194488,1.111321060322933,7.381713428179945,4.5231514945679026,0.7577382056431772,0.3908284535044288,0.3509157017292866,0.5757622199820006,2.432529932145838,0.4708819001966037,7.332868086455617,5.836539885834473,7.397453581550041,2.274151835677404,0.471414487110606,1.181148048456777,1.9399545869571067,1.283950570308781,1.478947444875032,0.42418743641814377,0.5000514696204308,0.6420166374714671,0.40299538461320417,0.5512445402002446,0.4945104557401506,0.5845625808339936,0.8877275531467357,0.6037526483354883,0.8753775377902251,0.796459148987748,0.909272831548269,0.4786430724430126,0.6836245754299419,1.0307467789404976,1.448267908058631,1.3182702471163585,0.6549782351699316,3.0868697102335343,0.8827542972849374,1.377845193453657,0.5661636322256077,6.956211682022799,3.4058799410589335,0.5822952342007727,6.822859785293412,2.1484145489506052,7.293682463992943,4.28258375511949,0.47569279276478094,3.0309055455801883,7.738158420429854,5.7602436659488285,4.0497717034636755,1.8289714840211466,7.810813450640939,1.4773261104258095,6.166239896954334,2.475375054493877,1.3896439545365968,0.5300128489960834,4.336139587698408,1.7369909871603486,1.3805615519032273,2.4761672762633227,0.5774828214169065,0.3908527137509655,0.385044882520565,1.7028587433476752,0.6126180891440562,1.614289220264577,1.0962265593728966,0.6917176365492421,0.596920036954317,7.655839238883502,7.923828698192669,6.513130354914521,5.46462721905299,5.221423365518528,7.829461522241825,6.416116037531187,6.102188131465123,7.682009293256248,2.325449097071767,7.873961231583004,3.044078453977427,1.0478362082973312,1.1351950186553477,0.8285623916121816,3.5802469299427453,3.1240158059713075,4.483284010592122,0.5352002080031434,0.9804491968880681,1.1303589012132464,0.6418457981541695,0.43341550542956875,0.5555819006723055,0.4550784068330971,0.31044853294316976,0.8625535344227637,0.5647993377705506,0.6303222853107223,1.5573800945129366,0.5665509318482085,1.7322215602219628,1.4563175518182292,3.058946336884553,1.7132235834029976,4.983634846189033,3.1684321166711733,2.9161407245407056,5.482540689759846,3.041127717774782,3.153942936055509,5.646798809040458,1.0968141181963762,2.8716415429578714,1.3960870359826703,1.997999715320537,3.910683426593687,7.955455395613974,2.163770891281078,7.964723008124828,0.6385047765198794,5.0079082922384615,5.250169410747563,1.4353090202724124,3.630319657510664,3.7115392859533283,4.7520570412981575,7.890818847016736,1.6710005294167467,0.3539572223185605,0.5355157814407462,4.089990199247064,0.8891086771521924,1.6356487756582134,5.387866523934787,2.0503793903012433,2.1207057558485607,2.175936008338873,7.511717790656955,0.7423291403606677,1.6144000091090949,0.8996732132959753,1.7216472831038288,0.6287125808303318,0.5329168632753742,2.9433872126001113,1.3888879350169518,0.6811045940479763,0.34483550529710116,0.5662763278250366)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.675380920322993, 16.77145789798466,12.54225098447362,10.29810557211113,7.66879653062488,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.539329847594917,11.45516312611962,18.316996330471802,13.644381033687072,16.687957899554206,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.505765520098972,10.270132845364204,17.06367135403042,18.771662988592148,9.812860126686786,15.275304079953862,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,22.72499624761509,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,20.05366296449453,15.133227159547541,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,11.438227229002063,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.604602479656231,18.161829666721786,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,7.629996531354187,10.955496468845132,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,18.08099633490787,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.451546459520934,9.062465735197444,11.566150303520583,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,8.672663178421974,19.709996304287746,7.629996531354187,11.754396453828296,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.555996307182443,8.396996516936989,11.45516312611962,22.62499624949477,22.26749625621469,22.26749625621469,21.779996265378173,9.026196505109999,13.644381033687072,17.899611722932722,22.62499624949477,21.1276885853318,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,6.758613214400147,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,11.810096452781309,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,2.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.05785612839113452, 0.06802858238722335,0.07292955213009941,0.07295628772342831,-0.05633295186654971,-0.05662255243685576,-0.05740287522929166,-0.05559186934076041,-0.05665994399375819,-0.05613541871933935,-0.05737523038489924,-0.056685937252266796,-0.05723722168284572,-0.05750562742744336,0.06741770735481976,0.06560033983279567,0.0739394493893565,0.07169366493540609,0.05865002711303664,0.05840186649519753,0.0582161071319528,0.05838117574116085,0.058311579759827106,0.058647086703716086,0.08828146830942983,0.07840363138282382,0.07953490994145065,0.0790440029444104,0.07943090023996194,0.07996217559886966,-0.10309229641376937,-0.10076184440062447,-0.10388773817575515,-0.10409607857309923,-0.10420272953239915,-0.10138030102111882,0.06411969464862532,0.056815799655868235,0.07599653789839274,0.08220110973624353,0.08242896854821213,-0.0074578623256241336,-0.004560805561175062,0.04516088964809221,-0.028755450141626598,-0.007473596729338155,-0.005877337237460853,0.00279153512826115,-0.007447238540290661,-0.007416270974625002,-0.029783384096544876,-0.03154799400656372,-0.019620785819735607,-0.006136235774034863,-0.01970897706758071,-0.023791755983957844,0.05612290481710405,0.07316143132712273,0.0729612024223646,0.0734301960337513,0.07305909930654872,0.05892108602402065,-0.10091552158719443,-0.10658790190077008,-0.10589320080625322,-0.10172496230910981,-0.10658790190077008,-0.10505649072153825,0.0689829226441806,0.06870267918836985,0.06859480586394189,-0.1038260787501696,-0.10652243865456086,-0.10626801085025794,-0.1065831179659239,-0.10575559871532535,-0.1063352861405661,-0.10574655674776966,-0.10652083268874446,-0.10632502362091713,-0.10435010378770729,-0.10198125613714625,-0.106493315546798,0.07548808104103559,0.07602371931330487,0.07607866986943199,0.06630002815707019,0.06613985603812628,0.06646421313809892,0.07034408436374892,0.06976363165146496,0.06978758759096373,0.06962494830878938,0.0701435029246018,0.07456731171962676,-0.10899747705968542,-0.10900238078560487,-0.1088368211619334,-0.10848690054616632,-0.10708387480270597,-0.10905389878754146,-0.10903645428230505,-0.1080862635371853,-0.10717107162990196,-0.1068965741229292,-0.10858734350492429,0.06055732594981012,-0.07988041157627958,-0.0800703812507892,-0.029881213350097576,0.05967040973041003,0.0593220853355087,-0.10215958958371826,0.06723062464930805,0.0674943594872065,0.06767361823591747,0.0678406996488148,-0.09255091789797348,0.0759734270921258,0.07562939039571834,0.07566635234465885,0.060629298961713894,0.06958758196948353,0.06991739944586052,0.06972629798363737,0.06989456195104943,0.08651143202207043,0.08589077461238424,0.06283363812985678,0.06678492452172827,0.08834285289603337,0.08728407827292745,0.08741679624725952,0.0885180082982633,0.08693436500879202,0.08740309650747274,0.08845529439632847,-0.09649645516620431,-0.041458912698286624,-0.04350802725909164,-0.04352334887290736,-0.04422485462643398,-0.04382598634747038,-0.04390318658908662,-0.04349503763581573,-0.04143730544846076,-0.044167981906180126,-0.043903023420688164,-0.043848963932483775,-0.04397567093712138,-0.043627175335699424,-0.044258408280545586,-0.04419250607941486,-0.0412664528623249,-0.03287325616846145,-0.03344224761258623,-0.033966833434358995,-0.032285152190559316,-0.03331109546636284,-0.033453830701036864,-0.09708388358041375,0.08824492452972126,0.0880568324233388,0.08849291478261646,0.08780117540679712,-0.0852920935890166,-0.08525289401535226,-0.05408486115138537,-0.05373793113413814,-0.05392259577078256,0.06810282860510586,0.06848119374648952,0.06608567123203042,0.0666822183711513,0.06625939102507108)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.02785389248814156, 0.04934883633688976,0.059005630177246186,0.05905848466498717,0.003935606173421853,0.003985332897510432,0.004124064288485217,0.0038053398390429805,0.003991807674296835,0.0038989368663262585,0.004119216799490814,0.003996287497822285,0.004094405952947162,0.004142136011240178,0.04803090912539122,0.04476488508922074,0.07586783720680638,0.07093072351764478,0.028804661409510348,0.02850369170148027,0.02828392045660547,0.028479007728562152,0.028396859729771427,0.028800566557592208,-0.20804490725886968,0.08971914274298379,0.09300825001219891,0.09159348622939695,0.09271039061619037,0.094238262335769,-0.020411279141790507,-0.01925903902069493,-0.020801019311076065,-0.020903086091398522,-0.02095540133668654,-0.0195628779892495,0.043125656424937805,0.031223950247695927,-0.13823445062006884,-0.17321865003919398,-0.17439675838491134,0.013924748201101124,0.013476710469192146,0.012647082351460422,0.012571756415693778,0.013996599811145254,0.013404932984766603,0.013388221250623755,0.01387558600328807,0.013734584745398353,0.012848074032721368,0.012570252048498652,0.013140446725390513,0.013391742194075561,0.013285641493936781,0.012948226311285022,0.02906698498153238,0.059470881742061214,0.059070149801531274,0.060006574646819674,0.059267508070354115,0.034029183236428596,-0.019352924951222993,-0.022296552387047117,-0.02194140734000089,-0.01978536604482662,-0.022296552387047117,-0.02151220755635917,0.05190580585242527,0.051391210725085706,0.05119185419059859,-0.02079965208003895,-0.022165645191930317,-0.022034485730077352,-0.022196464756827107,-0.02177518771786344,-0.022068550716766933,-0.021770694624061015,-0.02216461837453122,-0.022065041906007363,-0.021061814568087533,-0.019871774746213378,-0.02215065426306412,-0.1352107911798305,-0.1375865495569704,-0.1378293239948486,0.04695401020561803,0.04667552850355952,0.04723877178365647,0.06607855334009112,0.06474716622491941,0.06480186537427772,0.06443168949911368,0.06579501937199846,0.07745846701263591,-0.023580527580975025,-0.023583095537055624,-0.02349554157619599,-0.023310074703563256,-0.02256470090027826,-0.023610327494353597,-0.023601105464377707,-0.023099141359246893,-0.022613850644781865,-0.022468372531101868,-0.02336278775381109,0.04106326643592092,-0.008840154470780747,-0.00889163909871496,0.012951456027995863,0.038386832063502664,0.0378404084054509,-0.019950342221096776,0.04770676854126319,0.048166386298187945,0.04848202682468434,0.04877495405765744,-0.015141453656343546,0.08277477115321494,0.0818584571730429,0.0819570965158129,0.03554525465388402,0.05237657968959496,0.05304818918816423,0.05264306313974907,0.05295409876833336,-0.1977778133172012,-0.19431773359890064,0.03938092722623196,0.04779895480530371,-0.20843096461533975,-0.20231895941964537,-0.20306934370292867,-0.20944132788481518,-0.20032354720391543,-0.20299173755187838,-0.2090791323483478,-0.017118498678672753,0.03139765929596569,0.03562321534537383,0.0356543971412922,0.037100975494813816,0.036278737503361226,0.03643924738819349,0.03559728141662138,0.03143183970383664,0.03698421668770564,0.03643891715337913,0.036325151948832894,0.03659119896069338,0.035862913229251725,0.03716992907748444,0.03703432366787618,0.031042148711844637,0.014412273892776693,0.01535461782724893,0.015986556324861456,0.013187954452971605,0.015234069072987513,0.015167164206471585,-0.017392763936181364,-0.20783020340569883,-0.2067499612168194,-0.20926533416314408,-0.20527801035509582,-0.011474885823359702,-0.011462001637397837,0.004056672966054316,0.003993080360609874,0.004026981063291408,0.04926190222150133,0.049935517528793924,0.04657458775461062,0.04761397484999905,0.04687746293256328)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(12.725000000000001, 14.895000000000001,4.4665,6.2895,1.2905000000000002,1.2905000000000002,1.2905000000000002,6.2895,1.2905000000000002,3.0900000000000003,6.2895,1.2905000000000002,1.2905000000000002,2.1900000000000004,14.895000000000001,12.725000000000001,31.0,25.565,9.438,14.895000000000001,9.438,14.895000000000001,9.438,6.2895,0.00585,1.2905000000000002,4.4665,12.725000000000001,12.725000000000001,6.2895,1.2905000000000002,3.0900000000000003,0.06885,0.00585,0.00585,1.2905000000000002,18.205000000000002,25.565,9.438,9.438,9.438,9.438,18.205000000000002,25.565,12.725000000000001,12.725000000000001,18.205000000000002,18.205000000000002,14.895000000000001,12.725000000000001,9.438,9.438,9.438,18.205000000000002,9.438,6.2895,25.565,6.2895,6.2895,6.2895,9.438,25.565,2.1900000000000004,0.00585,0.4535,4.4665,0.00585,2.1900000000000004,0.00585,2.1900000000000004,6.2895,1.2905000000000002,0.00585,0.4535,0.06885,2.1900000000000004,0.06885,0.4535,0.00585,1.2905000000000002,3.0900000000000003,4.4665,0.4535,12.725000000000001,12.725000000000001,9.438,6.2895,18.205000000000002,9.438,31.0,36.3634,31.0,31.0,36.3634,31.0,0.06885,0.06885,0.4535,1.2905000000000002,0.4535,0.06885,0.4535,0.4535,0.06885,1.2905000000000002,0.06885,31.0,6.2895,6.2895,9.438,25.565,31.0,1.2905000000000002,18.205000000000002,9.438,9.438,12.725000000000001,3.0900000000000003,9.438,9.438,9.438,18.205000000000002,14.895000000000001,9.438,12.725000000000001,14.895000000000001,2.1900000000000004,1.2905000000000002,9.438,9.438,1.2905000000000002,3.0900000000000003,4.4665,1.2905000000000002,6.2895,4.4665,1.2905000000000002,4.4665,1.2905000000000002,2.1900000000000004,2.1900000000000004,0.4535,0.06885,1.2905000000000002,0.06885,3.0900000000000003,2.1900000000000004,0.4535,1.2905000000000002,1.2905000000000002,0.4535,0.4535,0.06885,2.1900000000000004,14.895000000000001,9.438,1.2905000000000002,14.895000000000001,14.895000000000001,2.1900000000000004,3.0900000000000003,0.4535,1.2905000000000002,0.00585,1.2905000000000002,4.4665,6.2895,9.438,6.2895,9.438,9.438,4.4665,18.205000000000002,12.725000000000001,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()