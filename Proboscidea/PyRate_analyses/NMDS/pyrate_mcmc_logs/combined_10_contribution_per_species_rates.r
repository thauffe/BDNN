pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/combined_10_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 6.0,2.0,7.0,5.0,4.0,3.0,1.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.0325598467513981, 0.11480402643719648,0.10916639835737485,0.12944240517741695,0.15738295324010226,0.07505460911128062,0.07980091915338132,0.07857032937582054,0.06638334413914765,0.23645931429354242,0.044313397345789596,0.10142625814150011,0.07055354642133185,0.07901130922221163,-0.07157606747524721,-0.038118646107101924,-0.38799652585894995,-0.2871854289178365,-0.026922209051442717,0.16078582849000952,-0.15710454485142852,0.049860439300865644,0.035357436892007266,-0.030091142116309054,0.20440908456738002,-0.1748997568383072,-0.21974527377676162,-0.23019283540622493,-0.20642973774069728,-0.17791264585543118,0.47167810383451486,0.34732918064360585,0.5632083043511102,0.5338435190090983,0.5237444536796961,0.30639733660360796,-0.14002834044902387,-0.0974308321500895,0.07364324459502164,0.27286867873775517,0.22767151409271297,-0.02926718023781307,0.025343889121052697,-0.06584078701141749,-0.0012977334711752027,-0.01870040055606425,0.012108370304424439,0.026118285902009288,-0.08015999061200937,0.015937307371641753,0.05440930018914148,-0.04236478466610827,-0.014162511988207772,0.008876405573322048,-0.047773473906014344,-0.02630189576968576,0.1905031414750326,0.11635452579727935,0.1242008899213271,0.12222842774389917,0.11647727980524682,-0.2962233932664715,0.34381511695717387,0.33496846909095745,0.4282849434482194,0.32058335156848455,0.3265317103280075,0.3306775668783245,-0.017490879636677437,-0.06292536362280803,-0.10113733352161933,0.3792393133908025,0.5581819562608441,0.8255808436539597,0.8500388089018444,0.4887768035020542,0.8725232843587606,0.3543575925921528,0.42840193217879025,0.4620309541287583,0.4569613846290155,0.32459881998059165,0.5378052151172608,0.12468921018495605,0.05543711521293125,0.0847894763142466,-0.07266478816318925,-0.004978220459290748,-0.04114740412650817,-0.31134264596953204,-0.3340825164056364,-0.33451846351078446,-0.32799344771358213,-0.3843217950142584,-0.37494781062214605,0.5992345403505211,0.8213022641763436,0.7654738213569459,0.8748901956456975,0.4793925319750686,0.8294426614817134,0.8762852013516529,0.5936723791984189,0.5644633308190126,0.49479754722551234,0.7796645924682126,-0.189384699491998,-0.02489558311325612,-0.03270871871411671,0.08653149737128824,-0.17911510104379508,-0.18865545401229075,0.3701001572210159,0.038448401598911636,0.03602733223757059,0.015049572878660758,0.0045288001887607765,0.2998715016975947,-0.25985310420504093,-0.29958022136800755,-0.35801417628693044,0.006794328106766451,0.012982022959683157,0.06357527721604062,-0.008470725036807876,0.04017512776232131,0.02420195995443853,0.05489209414800051,0.13318528191788565,0.17420330604792555,0.13290747435621916,0.051526733720284885,0.11339350732311777,0.16732750677590322,0.09168749898392037,0.12810961458971662,0.15400107166462573,0.2973822195874305,0.2713995435375586,0.28432398710067164,0.3201630171695991,0.3889840855148139,0.2964647107361991,0.25590202917814586,0.3158557764611213,0.2425292587875243,0.38874879834680265,0.29039451439715913,0.2694566685798145,0.37538811754105267,0.3704191266533119,0.3715282320418295,0.3909506670889942,0.36969166680204407,0.29092585181483865,0.191260389017048,0.22143543464147578,0.20990642777395044,0.31504628071830904,0.22755116525879804,0.4963774648998578,0.22562803306452664,0.18899067614077858,0.2569682388989365,0.21421495929026296,0.13377363223180133,0.12517857604021115,0.07794473983938391,-0.0376658271069628,-0.009930232573627707,0.10269736820125819,0.08300025155031858,-0.06515658171673022,-0.08325332452578771,-0.08123555721752428)
shap_list[[2]]=c(-0.026893316412315488, 0.015644594363475504,-0.05781665972975325,-0.05371839544234234,-0.0034392627127977416,-0.012164620468644161,-0.0007504079373593706,-0.007568136789266503,-0.0029034094666525903,0.06036776792125762,-0.004634158304120112,-0.008320702963762425,-0.010452668423185603,-0.003995486176618503,0.0018554162890822236,-0.01360042904352476,0.04902749121275273,0.04970249810989009,0.01583394554450831,0.028748185960979177,0.00916223152316246,0.04734637124252793,-0.021131718981489953,0.023191593995150736,-0.0001198373037426545,0.0642950901104461,0.0863075745463037,0.10449229868489746,0.066884143925025,0.06934467677682363,0.03645892297825973,0.02813856808909025,0.05347461744481957,0.0567016402242863,0.05596927790334356,0.034678092345463325,0.07125123905348375,0.002822264906661932,-0.034653477014791226,0.003523601360831245,-0.02210986765756522,-0.016369944404150245,0.029444027418115866,-0.025783866138406178,-0.022396547937472557,0.004064707405636694,0.016476107466449796,0.025741056202932003,-0.0018449834602676106,0.021388204479412528,-0.03522747070538638,-0.01044409581488336,0.005855920322527767,0.020776619189489757,-0.010050214381264657,0.000689456487121729,0.05853297408746602,-0.055304588548546356,-0.05081540972349716,-0.010781967434855695,-0.03204437797589209,0.009159770843973403,0.04976784125903934,0.03391342229915876,0.031316771756539526,0.03425255225821713,0.03277970564436266,0.03733554191855547,0.08838529078072126,0.08661848106105967,0.059997259625128536,0.025709693148673052,0.14125745637172493,0.17125644681946756,0.1854519027496757,0.07214247281482156,0.1788603306831512,0.0431683615544445,0.0950033737531669,0.06842194356564994,0.05083553716116627,0.025533671742710665,0.0953082344387409,-0.004346478802595049,-0.03269431294620721,-0.005439982733153905,0.04963535515062781,0.036474755350897205,0.05069143352580816,-0.004401083514926272,-0.00098610448432646,-0.0010634463581921762,-0.0035826389400869857,0.09977627911738471,0.07990005536042165,0.09033812906847624,0.1543699196054358,0.18215486861782484,0.17190431667000575,0.04658324841610748,0.17273245062393583,0.17616239209853124,0.07825088563642742,0.07793151306174295,0.04892548723246771,0.17030374074317067,0.04471456739894407,-0.011131242805776945,-0.012869123356724474,-0.0273606117081269,0.022598214783511584,0.044221817336889895,0.0009451768612909019,-0.06495883026066257,-0.06372113273626069,-0.06256628566278484,-0.06260730323024273,0.024075481830766656,0.027184590927360912,0.0439274699543455,0.06210145953001883,0.003355891551932315,-0.05211855134039056,-0.061082545765419174,-0.02085734073808914,-0.05431239146019608,-0.03172501523724629,-0.04040608321084005,-0.0362240151818446,0.07936441008487519,0.04982846881389001,0.1199328522970977,0.10070726023123741,0.07468322856675676,0.16404880369593655,0.10297228697589317,0.0662923849521136,0.011796251096892467,0.032844067025410505,0.026104137598738857,0.02488450976188768,0.06984254430094759,0.025117193711280968,0.024879907204977552,0.026991891358823995,0.023899875023419465,0.04665702939636715,0.028786599056017582,0.02238379482993763,0.07102536688414024,0.07702290957667657,0.07680875515932836,0.05884477918716766,0.04906153396560902,0.0018590608262348336,0.006787983181785572,0.04075110570369286,0.040247565259878264,0.04161458216241503,-0.00490764678995545,0.03758326562049516,0.004018253341482779,0.012255346764455756,0.013672846223734145,0.01182364734719648,0.004262500914498093,-0.004330875996685044,0.01437690066319134,-0.018963740971327542,-0.002493005142401031,-0.02643386341107794,-0.04605074858590748,0.12487060991819245,0.04601820197316461,0.04428484396060187)
shap_list[[3]]=c(-0.09516358258465633, -0.04738048492207419,0.12022888467504815,0.1320435367517088,0.0667027243470484,0.0295038015211516,-0.08067334589243191,0.048620511163536884,-0.07627554456135471,0.9785950235747172,-0.06979898127836699,0.047693156689390566,0.029829396412485484,-0.07520888153355716,0.0798851345937284,-0.16004217067325494,-0.043856068030301176,-0.05317116859604279,0.04922868929787124,0.1605065846338812,0.07947553354800695,0.1393851520530698,-0.089076270396426,0.06535442075488254,0.03947294259024946,-0.031180122619365574,0.03692015812421434,0.05078435560674976,0.03200417359885538,0.02618653545351496,-0.08290330166568065,-0.09299762298872531,0.07975734121516402,0.13860900872154033,0.07272316130023372,-0.18217070581111983,-0.08115488896433669,-0.07504526135683288,0.05800902415394715,0.11509625121763793,0.05713124762050831,-0.15101694764509535,0.11619000502382633,-0.0941202687205349,0.08299920458804128,0.07686891953123266,0.11529093026474312,0.11856733205601278,0.05764566720937069,0.10632134519488264,0.10867964170703713,0.04960157059474082,0.09922664222813367,0.10842175506928078,0.0558592723012859,0.07067537450325274,0.20412267555238353,0.07791640566066182,0.1254761919576582,-0.018824895955973416,0.08877025423021968,-0.041659503890015985,-0.08927319719369728,-0.08237242116505702,-0.08373296515206402,-0.07850494975368932,-0.0824993575798644,-0.09148089189343729,0.11903222047871884,-0.09248738307040053,-0.07435023311648085,-0.0884489975667357,0.22343212068394677,1.1221256241574569,1.052489097126518,0.0742912500905627,1.1276727532592699,-0.22430850710351177,0.0017347915819242144,0.07344942037864373,0.06888332606883851,-0.08161572588635906,0.08623874788915666,0.1305489772948329,0.055472528217350464,0.12029841384398483,0.07331315619279795,0.08879503643647184,-0.016421003052759866,-0.04088826212940626,-0.04535989465987726,-0.045327706669542375,-0.0469857036027117,-0.037257315467527294,-0.036143268981264375,0.09094738243116336,1.1523488296677806,0.9676209366607437,1.0873030666890926,-0.0776373563943883,1.1437685906560005,1.128457905962398,0.08423522482731169,0.08540845345256715,-0.0744253672225012,1.1615737820664873,-0.029879658694470942,0.049566362584105475,0.041464634144376546,0.12412990086224322,-0.03724583210433052,-0.029509081788395074,0.07022176386465279,0.11976331566035481,0.11636597063390679,0.09715442475547675,0.08766981179284566,-0.09206470505812288,0.032873335750186826,-0.04722405901979799,0.07615853227939018,-0.08080343933531398,0.08963420805849147,0.12867661022375113,-0.04673948498295424,0.10084962646354731,0.02102279169160918,0.020485940687571813,0.15591230004470927,0.1130929844157031,0.1762758126806465,0.22919029245617936,0.26072869357346035,0.2531871217509631,0.22669504594865375,0.26050160871251354,0.2541036644002123,-0.08183615098091174,0.03656323339984438,0.0577982476898602,0.080379980169959,0.6772182831190172,0.054730307668056394,0.03784421728738208,0.06238652592377256,-0.08931144715041418,0.7832298808578165,0.04288348549532028,0.042416898290679725,0.6630292129006836,0.6740504370217962,0.6830492140996598,0.6652838118571045,0.06808834303466348,0.09947117272205387,0.08893426937310153,0.13234352736435998,0.13763934148351795,0.7331230798074678,0.05964119884531776,0.6679982022572394,-0.006323596915118891,-0.011437002519589724,0.04453955346909067,-0.005542310187721281,-0.07013237303204822,-0.15596474149899822,0.06931079494460522,-0.12366619176720425,0.06899710701158161,0.14482369296927278,0.11896875128253635,-0.07845763998726256,0.031840328790866394,0.05870823220006423)
shap_list[[4]]=c(0.07460268778264804, 0.05827078844472833,-0.00467328270143185,-0.0032466021517601786,-0.006458232893890644,-0.004831756133404623,-0.005126803831155511,-0.003502955506834241,-0.003712399727047135,-0.020775820450557387,-0.002610185682616279,-0.004427843113685476,-0.003001597138790373,-0.004252556459560403,-0.00469501734415116,0.06691239311878355,0.060030238920643034,0.05737313749822862,-0.004626303267370336,-0.006870941775908011,0.03898045060143603,-0.004805949976007957,0.03518639825885834,-0.004388263136315844,-3.050080311427858e-05,-0.005776998152828735,-0.00829965492139309,-0.008311626439118687,-0.008299452586475565,-0.0070782773993882326,-0.0128002825808774,-0.011780495190728001,-0.010901566850435453,-0.015341701023180016,-0.009649100966776313,-0.0075869964087314345,0.06410814799123413,0.07531000028788315,-0.0017756104993395634,0.0018760925000687754,0.0010325626870020543,0.010150087066627643,0.0009212735660605453,0.056571807552007365,0.015533695799156847,0.0018825008440251803,0.008531879125625886,0.0015357106684703086,-0.0016529588338883663,0.0046192608488474516,-0.0029593591512587732,-0.001996329210902751,0.0064950675545649315,0.005332818269266535,5.3966140467168955e-05,0.001570178338609962,0.07255509003424156,-0.003401631927349664,-0.005008160228709158,-0.006255421369857761,-0.0038292287270448736,0.046076684856965845,-0.012273165800048625,-0.009975543306483264,-0.011606401281080278,-0.01043046750136109,-0.009792452893395722,-0.011650003876194335,-0.0033330209870980894,-0.0037428942849490093,-0.0037318245618566965,-0.011922034552056007,-0.007103269382774137,-0.033668503251225244,-0.024400235474107558,-0.009850690765838586,-0.0331603855268763,-0.006321780083258317,-0.008192220161644802,-0.008391877831706501,-0.009516476988309883,-0.010396969437400478,-0.008933237543416269,0.0004154176471948376,-0.0006105533509762387,0.0006674848770300306,0.0005200477845467833,-0.011860485583587025,-0.004506603535225553,0.047052477744119275,0.049222936293283566,0.049228237365535256,0.048836092645127054,0.0723302484449651,0.06356372561786995,-0.009362990323014785,-0.03473019933115087,-0.018697677773062152,-0.032145445009699895,-0.011969265317051532,-0.03446970195849449,-0.0328405239964719,-0.010243245599796797,-0.008247977863306846,-0.012370533756392727,-0.034986048865836734,0.08329308167958759,-0.0011021698239360859,-0.0021426632104754,-0.0035237226826440524,0.07055356703950555,0.08259180626965378,-0.007922249585726722,-0.0035939784632962814,-0.004811190222350477,-0.005393825012168177,-0.005238144417587287,-0.012108498303739577,-0.00881367601557994,0.05288934030394205,0.07592364150600128,0.0838720088508697,-0.004935105767266866,-0.008414843554699224,0.03255670965275981,-0.004756336670972307,-0.0020435494239638458,-0.001906738346318839,-0.004384499461887841,-0.005533438249661357,0.0003467715232057816,-0.003598248612926196,-0.002348802023509104,-0.0013957578538806375,-0.007447273600940706,-0.0021214434284017505,-0.0013631130342858712,-0.01073918081617007,-0.006746450733011458,-0.008292645769290731,-0.012221482714440146,-0.01919977373164732,-0.008055345009952676,-0.0073286736143635695,-0.009037545604237293,-0.010713660874351163,-0.023281008780915532,-0.007465406807166857,-0.006827810199164968,-0.017875558390974693,-0.018972289096415434,-0.01958150550750284,-0.01781906834358644,-0.011044636149377996,-0.011539025410868485,-0.012708406543906113,-0.012163081224635568,-0.015967446383526894,-0.021210094461017962,-0.008838099624746016,-0.01579513516697818,0.000921381389771992,0.0013742508610258284,0.000863247440357111,0.001781409400057183,-0.005903309037475645,-0.0027961355273064363,-0.0023036012900719645,-0.0028115269235447432,0.003506876502776494,-0.003669107821259442,-0.004397034564429342,0.07228988581527755,-0.007682897574874557,-0.010901849059724796)
shap_list[[5]]=c(0.039929171796823454, 0.08348258303921598,0.03988224891930704,0.017998447983258205,-0.0005438547274826068,-0.06638684182340651,0.05760248193578086,-0.0094926759363026,0.052283454531281456,0.09493043912475069,0.04829161890938911,-0.01993904052815122,-0.021541302966092555,0.04957470765988161,0.04082222706613175,0.06121792666311616,0.06988671199763465,0.07632120235314918,-0.023821567254043743,0.09071391855582944,0.03709004452363371,0.08020880158273293,0.043162276813663226,0.00354840238824943,0.14857437843965415,0.0459803080495903,-0.0018999384050389628,0.047467863734756796,-0.013712442620088415,-0.029688089923863962,0.03853033995006843,0.038789992644918656,0.009763883625123308,0.13306533413129842,-0.004967045033083887,0.04098261941387715,0.07299082123038306,0.05647073397488922,-0.009356473933805827,0.13120593357110166,-0.041291698718355384,0.03598162199397225,0.05294391139669227,0.025063369743888193,0.0598097022332601,0.04155959244927744,0.074280530352352,0.06721368693741954,-0.0020805766686582505,0.051941898433971054,-0.062460163777076985,-0.009211418201171186,0.05816132793682706,0.057559093284862306,0.017702107416284574,0.03241129538517694,0.13173627061900864,0.0121826196811083,0.046309593922729944,0.06069008701965301,0.02214509630069385,0.06740264338840961,0.04182446468291951,0.04304725439337817,0.039949166970625116,0.045265247445797324,0.04338748597060925,0.04114195335464522,-0.07097731725990385,0.018042969578290217,0.01292072484985161,0.03848523757785253,-0.005666681994799622,0.1800811679916802,0.14714682003413165,-0.011517788500444593,0.19105528784359768,0.015019160471549591,-0.01643141930738951,-0.020523156719693163,-0.006106054010421119,0.04262089689219873,-0.007532791656404971,0.09903791103294769,-0.04271682769099276,0.12700541454638056,0.06467055215762534,0.05772174215883459,-0.012094286495399925,0.05654385739827663,0.06575628390707229,0.06534265740301332,0.06640186581365423,0.0805281964810018,0.06660290177273069,0.003233332598298319,0.1848258710278426,0.0765964613450465,0.18432586857432035,0.04325419086569389,0.1865498454396291,0.1922973466283176,-0.0014968081341890252,-0.0007866117678563847,0.04354362482556134,0.1825623342153593,0.09279789544260063,-0.006425781543622493,-0.018829275278149336,0.05388837521657958,0.08435173154249898,0.092877808008927,0.017942802984669725,0.07317483940838895,0.0683944089824723,0.055937737643012034,0.04883254551376162,0.04049865581654822,0.0038743741180804676,0.05304115083119943,0.05651698869604109,0.06173192857041967,0.049402653801280685,0.08198203968761263,0.05507232080993944,0.05740599358371932,0.07463980158883499,0.05777885966480651,0.018077983913445124,0.01892947903804886,0.14981020050384738,0.010332531893920895,0.010691889666828757,-0.01663857019053503,0.026091961087220276,-0.007535867942955913,-0.012676889724791472,0.06120728029261043,-0.0634186802036046,0.01424390065223455,0.07114171748228397,-0.028332336555519838,0.004977187011459964,-0.04759638381579017,0.016489692453958843,0.04703573194240273,0.0038641329426828833,-0.03371325534315924,-0.01707035488524717,-0.02842755757190483,-0.0207235891864399,-0.018863589576071954,-0.03653266514605142,-0.012226796913593416,0.04609932803987639,0.08636663019915669,0.22711819365466548,0.16664195580883315,0.062247050997172974,0.012820349149976863,-0.05881519484794874,-0.05224069384485221,-0.04488174234923178,0.15169227221705484,0.01581747906149634,0.071329315525634,0.05801358047794897,-0.0008292694834520175,0.012316387720017486,0.04346963375618609,0.011011710202531125,0.03098370138433584,0.08393488784719,4.636901253409781e-05,0.033263335601120235)
shap_list[[6]]=c(0.020180868584786352, 0.07843073702802267,0.059558848959452126,0.07093974332692168,-0.026641024020864407,-0.013470556889598102,0.012107398105840958,-0.021274235844884866,0.009767552067824235,0.03750952872845368,0.008767621937420741,-0.019241025773744872,-0.010452055813087086,0.006746341082342806,0.04286293210901031,0.04473109866395203,0.03100397891863482,0.028254216580670604,0.0334581584230702,0.08002491023002349,0.03897028949122907,0.06860481335875374,0.014426747808114072,0.03490522878176741,0.06466245114189159,0.01928254682602947,0.021146641605844455,0.023276708385980612,0.020153053023928974,0.018258286711670013,0.02521256967538842,0.027485530479094585,0.014901490019270772,0.025519719086033843,0.019629912666643875,0.026032480791197268,0.03164266422690945,0.031487744070782406,0.061395195940751546,0.08583404791372826,0.0674724339848403,-0.014686870698241181,-0.0269673145058027,0.008566205089606356,-0.024914659224885,-0.040308734639916965,-0.026752505774026106,-0.028802630016513384,-0.032470061626672576,-0.035259151438679144,-0.0208918155707212,-0.024294940551999173,-0.032348145408511726,-0.03457428790232638,-0.03393282805710215,-0.03559071218284334,0.1509483713611423,0.05305711184036206,0.06239043565863559,0.04999640492514323,0.060926200926937554,0.021808370321790293,0.03167109771230695,0.035994942441118075,0.02840976170028908,0.03261217643569636,0.03504316803366002,0.03390621212428891,0.027391103143846695,0.020954567733411877,0.01684361245411524,0.027306882891698102,0.10335280752084687,0.1350166154396288,0.1698493785284361,0.03204396043061418,0.15247049906303628,0.037276399005336205,0.07117492894655157,0.042154460343396837,0.022873408141163166,0.03145102442938018,0.04750930607339651,0.0816511572891366,0.05628222243757919,0.07694948743266797,0.043323878004149774,0.057176933886823045,0.028524396449369258,0.028322951532523066,0.03246969387919937,0.03249807332340994,0.03255344620729023,0.03291239273712682,0.02972288000616231,0.04642409353585612,0.13619701639222748,0.1676604062755011,0.13990464546508624,0.029662224594317124,0.14244477764912022,0.154735679535376,0.031226516373954422,0.041528654815427786,0.029474734260757782,0.14046315756089264,0.05922075426813501,0.012559187226225678,0.016067156696057624,-0.0025829843532560173,0.041622139522097444,0.05850876495375589,0.013797355304187148,0.054411290383502876,0.05548968174563208,0.043181738186115655,0.040339592593210065,0.015860655417030668,0.01960334728787888,0.02669613764255266,0.038238454413504264,0.04973302512532496,0.045449269696838206,0.0579507390312424,0.031260555562780595,0.05054805665689036,0.043610706604832045,0.04784471567840678,0.07689514155636797,0.11659231477817522,0.1098643642320209,0.11970589244167298,0.1273031755965442,0.1199821625157221,0.13427081163443014,0.12802648456985216,0.11868446572708477,0.02928557057191368,-0.019578431255470267,-0.025030229060169423,-0.018944948737451558,0.027461648029485874,-0.02353128856281609,-0.024112913801213623,-0.024354050681124582,-0.0036172341856615347,0.029125050505891304,-0.024390156252316154,-0.023108125586136168,0.02911494127544806,0.0277045640904931,0.027877868915396824,0.028565812891217426,-0.02313034342945293,-0.03980224462150659,-0.028415800224401887,0.014055922017997088,0.005850272351779723,-0.004899508464003705,-0.04290972301355213,0.0521300173263129,0.05096841581526646,0.051347397911843326,0.06744509670938716,0.052743139719744425,0.0332890203854304,0.02976954178558871,0.004077717033061104,-0.009071389475202824,-0.015689335370670618,0.07872248619533309,0.054808207979403646,0.03820873530085894,0.02213530862501443,0.034603168325060246)
shap_list[[7]]=c(-0.0030249984960193242, 0.02670094774272474,-0.009039011591399086,0.0006444443508310188,0.007258288313285062,-0.002794150653708772,0.00825688439715021,0.0015980560675863756,0.007643981573962242,0.08813708458367438,0.005918748419643415,0.0015576652014102305,-0.0028139779281485472,0.0064461951090763825,0.002815244759335404,0.011352166895711831,-0.017062663254938538,-0.018061913562733102,-0.011389428444989254,-0.00020041782544089783,-0.012587872800977376,-0.0018404086191179012,-0.009392197686290491,-0.009611056782789992,0.24322031681240008,-0.018824333995824862,-0.012166716252255178,-0.007939158483896492,-0.014362030005605056,-0.01561390144065196,0.046936967214077974,0.03659252150991557,0.052164860643252584,0.05377855009289818,0.051100072364217076,0.022455485217257837,-0.012475351776490133,0.005113784058168203,0.1840922665672491,0.26948184996332564,0.1714709308387794,-0.001663797255719629,0.012064148886796298,-0.00469100428273498,0.007503789427534738,0.00292039987996694,0.01029830974125976,0.011261500852115887,-0.0014103759585646833,0.012410046205291639,0.02927129365501816,0.0011023154783330233,0.01406444683479385,0.012588200966951717,-0.00029215990463918806,0.003747556843369941,0.014924863480409509,0.007527156855420153,-0.010673872619562506,0.0078098525362060335,0.00794985154367057,-0.011012736030415993,0.039211753979487,0.03757697917215748,0.04563181798191708,0.040680986414845514,0.035480184160104705,0.03779362587317644,-0.011385450896530449,-0.014828987837447983,-0.015116107516355188,0.040287075749486256,0.11054347967677203,0.1915793119807627,0.18107472589986212,0.05916610525991191,0.1952606797950601,0.03301745000287404,0.07521000791186207,0.06684470607881642,0.04571003020814972,0.03944639554661769,0.07959820671468458,0.2570309728542996,0.17142795304978545,0.27198395641064144,-0.012736451229678718,-0.009172718337716735,-0.011946159038099601,-0.016078174382402617,-0.014516129220852346,-0.014622134314269874,-0.015240851391674661,-0.01187120456097544,-0.015725808764440685,0.0854718297442337,0.19691486070986255,0.1671881157115688,0.1932722100767974,0.04984202157579119,0.1979028734753321,0.19913262537537757,0.06957047606976104,0.07627033778309666,0.05306057587377369,0.19638019813413143,0.013202352276732688,0.013858775670090823,0.011409054435975655,0.038793598586580505,0.006153725340378598,0.013302832070371012,0.03339598056463276,-0.008455717371617603,-0.006976944792632055,-0.004008694262127334,-0.001432995037402158,0.02728734907587732,-0.022040553615789008,-0.02270468768481236,-0.019689943437950524,0.024733885982242323,0.0009093916424586993,-0.00857880150926354,0.010151204402851385,-0.0017495464870425402,0.23519594427157944,0.21631735539598784,0.011776388159320295,-0.0015576849129415962,0.4431125603930782,0.520274037995136,0.502026784885961,0.47029782023997196,0.5442412426906499,0.5030691949214082,0.4698034713991944,0.02834990178017204,-0.002802887575449995,-0.0008939550123064972,0.0016270728126631434,0.040441132766920886,-0.0007223062935407726,-0.005757703689133578,0.000911219516663088,0.003834772311481364,0.04549015809920573,-0.003433160146626385,-0.0036231809152661404,0.042201170878233406,0.04127595153939796,0.04013126329113766,0.041145205291611434,0.0062485612634498085,0.0066251515318097596,0.0012618710223731577,0.018782915053253264,0.01735655469862002,0.06385719492858827,-0.003011542556306128,0.08636907774303512,0.1553255740125323,0.15573543483117927,0.24212127346043597,0.1607458371410785,0.02418159277761151,0.01751686336486988,0.01765062696903359,-0.0037785714999535092,0.010696596959610198,0.012492715335159676,-0.003540367625479563,-0.009298993654375892,-0.021307644021509038,-0.016822433564575117)
shap_list[[8]]=c(0.16706372204250775, 0.1380995437829789,-0.015752962318714387,-0.015003273119731425,0.0816689597004165,-0.06738492071995085,-0.03984514992773005,-0.013328624501099185,-0.048874978940951,-0.17720212705024144,-0.07162630988368152,-0.011479039843366793,-0.14685195003518633,-0.08103631024194723,0.07725318388560191,0.1725981507158098,0.3662562729579417,0.24616756972475642,-0.0017718831397363544,0.23927304784704562,0.17159006633247736,0.15271103598062694,0.08361194458190051,0.039693764333271125,-0.17415361077835448,-0.04581694200925885,0.021500411485998707,0.013142378645815888,-0.0003757750132905227,-0.04702591884130047,-0.13815235805348036,-0.09828463456469709,-0.1704123378055015,-0.1687616451371193,-0.19304647256531618,-0.09753099952560075,0.2575762825002808,0.3065024627911496,0.13577049320197612,0.035533076313360765,0.004978812111001537,0.10678752993914566,0.23645560663336762,0.41634740017063787,0.19102632879258283,0.11127781896940758,0.2284273823303216,0.2335997668319562,0.0884926088252652,0.22158599223284353,0.1748632266378534,0.04010267988464018,0.20170762384679977,0.22268491223884834,0.05332012895289094,0.09025881673248326,0.5485515168534214,-0.012749961881436608,-0.015049886125586397,-0.0734362090923558,0.0021801741088399943,0.20321235158270248,-0.10151755067181938,-0.17350696423886497,-0.14187247495471164,-0.06621571543799254,-0.18510024528122443,-0.10584913924950873,-0.0976460207152671,-0.035931852381066345,-0.048983349355975966,-0.09423001596470516,-0.1990541720217422,-0.2040011016152957,-0.22216282656921965,-0.1495830843275175,-0.21379770913062737,-0.11022788318020559,-0.1738658032492373,-0.20859740140737137,-0.14870904752389769,-0.06934611523788489,-0.20620614218188196,0.15393184926924025,0.06360238615276803,0.05697180369778024,0.16609779223077145,0.19495241263963917,0.10319149567815139,0.28089817721044136,0.38389414937983424,0.38380509212595937,0.3889414305427062,0.38608954197629086,0.2836400183745931,-0.210166980508057,-0.2281173139938519,-0.22003408711975755,-0.18894654152752752,-0.18853907571401005,-0.22162791864949552,-0.21537908291109512,-0.19665736809473142,-0.22030108147748784,-0.16325189886843824,-0.22571982466063534,0.4386382048039541,-0.006675712137094615,-0.03928400309313942,0.052599913988900356,0.2668865155571511,0.43421854368532176,-0.13124834893744683,0.21310698328016275,0.20153894287252935,0.1404218464435673,0.1083412767176734,-0.037125007555655246,0.05898256495281295,0.19032435893844338,0.19021849133982452,0.25737431606904415,0.09893651236403997,0.20948665750238477,0.0680622523172633,0.11728131013880894,-0.1551313024689484,-0.012442061615879923,0.029287453565103854,-0.03485456576591584,-0.16621644661014762,-0.13055560501937416,-0.13464464056588726,-0.2029522564901058,-0.09629245945335523,-0.12916294060242398,-0.1838918038685534,-0.06878289203172244,-0.15004080371525633,-0.12846793119842242,-0.11552780851228271,-0.18071942289492432,-0.1474547107045556,-0.1260154239434436,-0.12175781497604261,-0.0523297111501406,-0.17865951060646318,-0.14215587894658704,-0.17587082059267015,-0.12826954833813017,-0.17188753284008795,-0.18607373736439795,-0.15268171774031897,-0.04133055213626909,0.23395886474345162,0.07565240550256067,-0.16140101722350245,0.09624378294121229,0.13275187558658455,0.0038621940228511344,-0.1331961759937912,-0.16518563916020051,-0.11121108032997115,-0.2197997299795917,-0.10233584448930946,-0.0505443287030733,-0.022685780516508925,-0.009689206753681838,0.004765748312685616,0.057335917353243414,0.014055191813567333,-0.023230065632013696,0.14123313810621274,0.009243251469993304,0.15302037471865276)
shap = do.call('cbind', shap_list)
baseline = 0.31640984964396823
rate=c(0.5255202449537624, 0.7750339600371463,0.5562415699754064,0.5923509037617479,0.5904739430005274,0.255210651441548,0.3485519886564387,0.38958472588150445,0.32155911726484443,1.5941793121648946,0.27611623542679886,0.40346575706464344,0.22276595932080356,0.2949821475290095,0.4784009782319633,0.4565324612967827,0.4428735658829488,0.4153428232739214,0.3422874523222439,1.0509579098904218,0.514907527544965,0.8310773256272487,0.40858843847708304,0.4324800161815165,0.842938150794994,0.17094035640709493,0.23951755729993215,0.3075166572394846,0.19235054039672844,0.15365855085609056,0.7025564464713439,0.5932035416904691,0.9083304195679581,1.0700154216180662,0.8322332105990063,0.4590918425536804,0.5792830329650882,0.6169939306755464,0.783700553204604,1.2220227351445327,0.7835112617730904,0.25645017886842275,0.7511979601026434,0.633812025954368,0.6235415028794606,0.4908263308504796,0.7453481628438171,0.7604592386691909,0.33995303398847454,0.7059004038428379,0.5613008653835108,0.3170197883772909,0.6474596427342592,0.7085044625391742,0.34881241072348396,0.4495606151972357,1.6670145483540708,0.5091134090417584,0.5909969528774475,0.444958158767496,0.5740752987705141,0.3147059973147261,0.6207159924408541,0.5371021546878912,0.6540008565917839,0.6348980824286252,0.5133626446592007,0.5896797975135587,0.3509116139628749,0.23225008819268816,0.1637337142118327,0.6340936460473814,1.2334103038929658,2.6754984104499306,2.6295123534284395,0.8704224558995738,2.7567916773545713,0.45798343764950117,0.7850638329956863,0.7900518096374227,0.7971726550871088,0.6193009952310592,0.9370611220518447,1.1483311537201917,0.6442663664157442,1.0391305091167575,0.6227839503673015,0.7183818793970198,0.41116826130262085,0.3556318538853839,0.4516048878295205,0.4505785240056164,0.4583579435669153,0.5517847326269336,0.4116411339529885,1.0095172851759857,2.668252948049623,2.3836124562987306,2.720235305719636,0.6881219891813037,2.702046199901307,2.764560329663529,0.9639240841595913,0.930588818730698,0.7368643302593091,2.654731684214889,0.816361336166342,0.339779945612772,0.27824569093528345,0.6346514178286367,0.5835019040091499,0.8113391572634586,0.6831717332016098,0.7303066701237376,0.7107496529639403,0.5904682798359486,0.5319818610189456,0.5839051445307633,0.1688207117827758,0.3142346593533631,0.43616477095097655,0.7171083789988933,0.5510581669580906,0.7729285587371008,0.4350262138090555,0.6154797234779837,0.5265817300222457,0.659791890328798,0.6941083449801685,0.7648797836469564,1.2086679739171307,1.2211743310012666,1.2812868388773335,1.1714444990144466,1.3854825314056811,1.2874091486691988,1.1716182383067693,0.5822716345171917,0.4167915520473651,0.5363901614741592,0.6669381473044721,1.2928905706500506,0.5184857204535837,0.4261661003289871,0.5837969478194195,0.4788397752510905,1.4065258564808105,0.46905870561707613,0.425836669174314,1.3248167455701119,1.2960953032252518,1.2913314663825082,1.296212345065473,0.720615067562258,0.9413261511057137,0.7249880938743347,0.7904714108151456,0.9681835587846627,1.642580904108773,0.5606615820034286,1.4508500620671196,0.5367596198268657,0.5660628463765464,0.8750704705136441,0.6725453562437277,0.4557755398896266,0.3608045311264675,0.4811844835636791,0.13944257173718763,0.4674108724002801,0.6439017279240558,0.5246968559828306,0.6212793259796465,0.3127536150875688,0.5281160327901362)
rate_lwr=c(0.05368991310101229, 0.002529860534148415,0.006399397457136025,0.015352883813736673,0.08778102499135554,0.015572905255812758,0.044197255033290195,0.06351682731118341,0.040136001105267605,0.08509882668758165,0.024826694970982055,0.0557064881307863,0.004169846917510572,0.02652769246019665,0.006569057949427831,0.005189637981972611,0.029122228148480006,0.01220357552360693,0.008192057266270397,0.11032884477961852,0.005661350563537559,0.03757652822422122,0.020335539124843025,0.02404929657572291,0.026550732526636044,0.004215263542927644,0.0053192088783023395,0.008045885640762994,0.005254956060737663,0.00168006736357873,0.11510270647019905,0.07152174855333382,0.08289229863449571,0.004352961379008334,0.04166432381005722,0.019856988158869604,0.033144167735740554,0.025132563449706408,0.016978835738357595,0.11347267793041577,0.025264778145882773,0.016234935238311654,0.15021929737039824,0.09281872904536415,0.03614304528800266,0.1316487692528083,0.1555904150120429,0.20913738821394162,0.007897209456849574,0.20253050286900626,0.06293657889371757,0.043805560712660396,0.1913824722390463,0.18936550296553017,0.07095748975767585,0.1046588607676521,0.07554443537695134,0.010900666718748286,0.00829100950352743,0.0015375948619730517,0.009163824593404674,0.003184236881782883,0.0818884407301321,0.02986601564957944,0.028159932874732146,0.04502974541716298,0.04535509936563448,0.06877562577418053,0.008647528683702693,0.008612488638193999,0.00430101345958564,0.05440945415351747,0.011690791881072887,0.427382430104735,0.29791240206120917,0.107511807248417,0.2685862451534582,0.009942096210451168,0.023964618964510853,0.08325563920667922,0.0746714979620797,0.07113070514782051,0.09377007423471281,0.056315157742723485,0.013437415953074766,0.0330944346676168,0.016895015938954358,0.024350542104742773,0.017618601386063214,0.013185894972144674,0.006860112713387455,0.0035258113586240925,0.003928519044706355,0.042222085092990275,0.005753902406725457,0.10644583660409762,0.3672629618086622,0.06889344888100754,0.4571852632271007,0.05695194400177295,0.41249343822743767,0.23487480422293694,0.10318599468204219,0.07059757760781044,0.02913218727744228,0.45673872220819556,0.0020499042948272372,0.026661858790944667,0.01653980858053518,0.04306650868514944,0.002408474132006587,0.0020619026549824615,0.0552403885856289,0.048389230080879614,0.05611935583512305,0.02634484004018592,0.01910236084787212,0.04049817427304862,0.002533551968163461,0.032417597058946285,0.012980721998171907,0.053242898372652475,0.03804790724430171,0.020727769695829346,0.0066480910988507835,0.03547976726220678,0.011389601803284327,0.06672271829215778,0.014674415221398951,0.010034174785596608,0.05663116268403903,0.015599510419853583,0.007489942822449559,0.054587061390121316,0.03243643618570191,0.03397683027645282,0.04626593322701386,0.050926939637068916,0.01332501633806138,0.08118310587313965,0.06660840941469404,0.33172650893476124,0.06214688920861508,0.02742546448579393,0.11244181189076188,0.05960435966525146,0.1986003284059188,0.06551629173124679,0.053372587715000586,0.3532226361122861,0.20417887028210693,0.19073328405989315,0.32464199100762103,0.1086049632796979,0.12851512219325012,0.14370208732749168,0.015640058397005566,0.1414952945956683,0.18684754575227164,0.0893199742688067,0.2676419025312192,0.034093507873470486,0.07497236894257955,0.04778194682658418,0.06744308943819106,0.0172038433751332,0.010655384009416013,0.022576658999705117,0.00977125571449039,0.08247844928423623,0.010969307009354529,0.010633335465940363,0.036814070201477145,0.008517999558576378,0.020195038702130207)
rate_upr=c(1.2811037843063906, 2.2569791111775137,1.4516193735813048,1.5420544862566492,1.4201151321919814,0.7213657560212049,0.7684301520364135,0.9739343637674723,0.6816783883113547,3.5989408045187252,0.560042670071651,1.0350773813730805,0.5445618448378363,0.5859598621602059,1.3345150114021613,1.4989849394783659,1.1217324330740062,0.9516285295504942,1.0180305134416896,2.349167473818445,1.4637443123068694,2.0196424938894277,0.9936460360877146,1.036648052263911,1.822359716507282,0.49677652963173025,0.6949362400001333,0.9210845033250458,0.5377454362496169,0.44011353013110704,1.609884782803019,1.3514229835910934,1.8252837305710639,2.3135783708744095,1.5962672938191438,1.130195756310958,1.3404343669329948,1.4934343337321603,1.802304564499579,2.8983513630986604,1.8656775795778584,0.6400558718312914,1.5439593149717252,1.4759288894546505,1.4127310596415632,0.947961919274048,1.520853950718315,1.532152793616448,0.836713705258006,1.3523647216047363,1.5072842800255977,0.6619600730033619,1.2562251643012585,1.3134775891576271,0.6961659567650142,0.9435827053891712,3.886000500667389,1.5077770740213985,1.5686272799608783,1.4551185938044457,1.5741328854505512,0.7422603139339785,1.4235871991642093,1.2280492188575456,1.4418314068695843,1.4637193236971475,1.2055155836227907,1.3259466793888737,1.005175937108329,0.6274396301482144,0.44232245664144293,1.4314074713983422,3.016948376771764,4.937728780073222,5.005832841017936,1.7494316391347706,4.976213813766964,1.2352959844380718,1.9802797147661597,1.7600287610321954,1.5973068307780052,1.4546210255511691,2.1369533174428605,2.493965745266031,1.4867219612014586,2.3901659148389496,1.4661164007411938,1.7758274365958537,1.1351289131835178,0.7990240878350666,1.0095699320561056,0.999248209220202,1.0351417688429816,1.5352068475724494,1.1841306974947232,2.163060462314698,4.901103164041665,4.6077169308820425,5.073112366749732,1.5572848760351028,4.9167802765167385,4.908583371909367,1.8032412138925626,1.973865057834225,1.6554398215077863,4.868949280922011,2.1701347180678163,0.8471133838087409,0.6869213706035663,1.615026712671581,1.4862232600673329,2.170281408348888,1.542072507534858,1.8642749310009357,1.945069955856552,1.5973625466617631,1.4648587192175864,1.294285028680271,0.4395274773892788,0.7577448785783638,1.276878523898879,1.9376968997515225,1.5506247458037894,1.9547318405881073,1.338150137271097,1.7257202199708246,1.1908501403202225,1.4268401253444352,1.8830959408635526,2.1373560960730624,2.9004693151961294,2.674225983226946,2.687099220368534,2.5596792862683415,3.270622157914369,2.655681783000632,2.5018734502843056,1.458017949267128,0.9640871288101455,1.160840437080169,1.5204552960604802,2.661042607621062,1.1163763600388714,0.9681349480727752,1.2610487292368258,1.1075632272352705,2.739722869510194,1.0320762643213295,0.8727244140530213,2.6435423431060254,2.5011377307304077,2.501607114214648,2.624402304331342,1.5662738080729164,2.004012471534114,1.5294436642123943,1.903411414584668,2.2993686723325872,3.1941302346888363,1.2100763485087993,3.1343621737559126,1.2293427840255235,1.266388181852478,1.9703045779901607,1.4915339255429974,1.0393474072570619,0.9062505583301234,1.2589470824130187,0.3438564856078513,0.9756781093768567,1.7517116519576683,1.3447320010021262,1.561893428144862,0.7580749526916255,1.2345345472333675)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Grassland')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(0.0, 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.88884247356902,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.78599643443742,13.509885309719447,13.644381033687072,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.883919453129167,11.610334918074667,10.928438777046042,19.116662982107215,19.495450853775065,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,13.644381033687072,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.109881006140222,14.172329741711991,13.509885309719447,11.874539661446518,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,20.39513914855202,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,9.062465735197444,10.647178292822375,22.72199624767148,10.15963284744126,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.685450981781905,16.47608727416608,22.26749625621469,12.543329772332134,10.15963284744126,12.685450981781905,19.64726903273955,19.336662977971898,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,17.990150182769337,22.62499624949477,21.1276885853318,13.580403826912434,12.518304131776894,23.096662907295563,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.060863185459783524, -0.07320681727606418,-0.07654386546924914,-0.07652082005947258,0.06015277042745709,0.060532182241244376,0.061341608771550586,0.05883647335204316,0.06049601822232392,0.06016221345052785,0.06139460454800628,0.06039206126448981,0.06138903518756381,0.06152098398073222,-0.07209824586668517,-0.0692286313488707,-0.06910948281423698,-0.0716111811132948,-0.06192029879561728,-0.06131933579919249,-0.06132797715378947,-0.061467269015912596,-0.06136291441456187,-0.06170344241304459,-0.08893380195546502,-0.07976016902898853,-0.07955792294167464,-0.07894364089016817,-0.0793768336540073,-0.07995504658237998,0.09788447786700531,0.09593808752730786,0.09868807414607648,0.09872658084077487,0.09885123463650916,0.09634769055247272,-0.06485853892007641,-0.059571627119713685,-0.08115495325971353,-0.08203987634577908,-0.08238017286631427,0.02281304271634878,0.00922919091556472,-0.04557356707020526,0.036850806214743716,0.022854666172270697,0.009642813194151126,0.006766637181752045,0.022846738225624524,0.02274458962682088,0.03967907917964768,0.04112748739955508,0.03044636485502582,0.020459765889077247,0.030591194068119623,0.03349572152430172,-0.057577416528390754,-0.07691422929805913,-0.07689361555560549,-0.07715538593628532,-0.07671325810181971,-0.06071069314928286,0.09719790264756585,0.1024903284765878,0.10184980688164574,0.09744977975872951,0.1024903284765878,0.09961632655428462,-0.07051088980067635,-0.07035778570750403,-0.07040093643125918,0.09753675648182462,0.10043582143234493,0.09924740092506265,0.10047138144545428,0.09865611952126656,0.09930482795080886,0.09877558705182875,0.10044584016482089,0.1003371480378836,0.09825129929205635,0.0973277919378257,0.10037015111630278,-0.07811555890718311,-0.07814236227038877,-0.0780944101049448,-0.06804272423989652,-0.06804891569395757,-0.06811022509021272,-0.06937270206264275,-0.06900546752659746,-0.06903601803835066,-0.06901883443329221,-0.06888269886928479,-0.06955655425542555,0.10377339315321796,0.10376335757268948,0.10357606179229592,0.10324774653863109,0.10254054575470513,0.1038262327082655,0.10381266104753684,0.10309915537312586,0.10269556488843283,0.10239488734609858,0.10336390163993132,-0.06345016863189173,0.07334882521558612,0.07360631131333437,0.039880200479503636,-0.06372005944857374,-0.06328242704877315,0.09653296763313603,-0.07171735264158438,-0.07227445748588511,-0.07229387196351592,-0.07248434364707335,0.08108191417615905,-0.07520864461440253,-0.07472620452451097,-0.07485040424751142,-0.06813985969469906,-0.07352821565751647,-0.07359220858430278,-0.07372851767374744,-0.0738351768554105,-0.087276488720033,-0.08660305925208747,-0.06941424541511598,-0.06852907326841812,-0.08969812819891594,-0.0889731887948055,-0.08876398257860355,-0.0898752883469872,-0.08654924136005515,-0.08869648644233902,-0.08979744912076075,0.08502655429178078,0.052539998161508575,0.05289708029519542,0.05283909848981707,0.05429048430326612,0.05360745180480962,0.053546907927808855,0.05291816156967441,0.05225785440957535,0.05416549783779726,0.05355615841765843,0.05363955484110082,0.05358555599967036,0.05294361831068787,0.054313435590982576,0.05406580720860015,0.0523196730287991,0.04161979671927976,0.04210841979005076,0.04283199701354932,0.0417588027735061,0.04209656800408915,0.04219929731322723,0.09518983668683834,-0.08919652356918684,-0.08900895996880458,-0.08911434585720078,-0.08906317033427286,0.07894341555887924,0.07889626640009026,0.04593599291822851,0.045599283684789355,0.0458205989369061,-0.07284491389831149,-0.07324876953223632,-0.06793447546166657,-0.06830321244694354,-0.06793199529150755)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.034620240719060696, 0.07018066553476546,0.07851358038821489,0.07845636517082558,-6.167341075193274e-05,-6.262083223544907e-05,-6.471432891868839e-05,-5.830386317980783e-05,-6.253144808346305e-05,-6.166835546199483e-05,-6.4849532271481e-05,-6.227005165508582e-05,-6.483454330533377e-05,-6.517380366706965e-05,0.06737363908527713,0.0606514279752381,0.057759536485988285,0.06502798928250261,0.036106803052464595,0.035255759952427274,0.03527133955528856,0.035462104086826894,0.035318271238312826,0.0357980902047288,-0.2056659901999113,0.08600437831751899,0.08547627868190653,0.08387471459620251,0.08500358679432672,0.08651676274447062,-0.012483851183276573,-0.011873599924562725,-0.012734963680520394,-0.012747015315138133,-0.012786004406633729,-0.012000245543109881,0.04416504926235904,0.03621550323622673,-0.16230111118674165,-0.16701843082999865,-0.16870448128367338,0.006828998350612858,0.008069949940462506,0.012746700302059922,0.005042298155076051,0.006859270217647012,0.008016582470091555,0.008247958694016962,0.006853527356061129,0.006779378811098141,0.004724679064291644,0.004577821105504386,0.005859675877131444,0.006893384568341854,0.0059276272109553595,0.005491737178147441,0.031098016462933777,0.07945235732361826,0.07939985681609889,0.08005825101738794,0.07894968380533571,0.03672586524087544,-0.01230211986736821,-0.01407244833485813,-0.013859629765493405,-0.012389505999393393,-0.014072448334858056,-0.013113098295605015,0.05453714116290661,0.054249959611672074,0.05433050723981216,-0.01237694123541558,-0.01330511197498338,-0.012918259178816326,-0.013316507243567817,-0.012731813217488374,-0.012936388306316243,-0.01276962329866271,-0.013308279722953896,-0.013273443805182878,-0.01260334904506987,-0.012312529993346056,-0.013284019241828348,-0.14524385197812298,-0.1453644722716534,-0.14514778542901705,0.049917636760106146,0.04992867037788673,0.050037732121498535,0.058238983162757725,0.05749223228536907,0.057553834099129605,0.057519188281604475,0.05726525246554128,0.05867293694307973,-0.014509533066124115,-0.014506116608304009,-0.014442700547482003,-0.014331466870631852,-0.01409126090783217,-0.014527415829414416,-0.014522814384805518,-0.01428147873762967,-0.014144531489181801,-0.01404284875711349,-0.014370566621944865,0.04521048008316533,-0.004670108797673014,-0.004709958318709218,0.004783084392809557,0.045500807993421113,0.04474376168900925,-0.012057797527212812,0.06651243888297399,0.06777849667943808,0.06782274162680664,0.0682566150319257,-0.007093538488054757,0.0739956454710229,0.07284839249303436,0.07314301533539619,0.05809863624502365,0.07097779662735107,0.0711655125850771,0.07145790907598504,0.07170837666044141,-0.1962625086988851,-0.1925993930146172,0.06094203816965531,0.050782363908818164,-0.2101194127013782,-0.20599903567380803,-0.20480311441779925,-0.21112657434301718,-0.19225770214983773,-0.20442620060289005,-0.21068444030268993,-0.008354608561954701,0.009777015930329395,0.00994198023859823,0.009915478731409558,0.010602961914556959,0.010279101144112127,0.010251075731703849,0.00995157228726274,0.009650262437008958,0.010543763884224028,0.010255364949980356,0.010294040669512125,0.010269918341355216,0.009963220718771917,0.010613808167261386,0.010496763676417055,0.009677797470914276,0.004761566773114628,0.00494688024881923,0.005188106213538598,0.004788069302060459,0.004972731204726929,0.004958530489560858,-0.011631609091310965,-0.207145140623968,-0.2060918219305312,-0.20668293569451335,-0.20639581093063813,-0.0063713920575913605,-0.006362191794353129,0.0036278901868327692,0.0035635376171133768,0.003605852761019194,0.06911638993328466,0.07005015441191663,0.049714927750539956,0.05037279053198539,0.04971053809563197)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(18.20552447573449, 14.895429116510035,9.43827190343214,9.43827190343214,12.725366600039624,6.289681196931176,9.43827190343214,9.43827190343214,9.43827190343214,3.090089021149111,6.289681196931176,9.43827190343214,1.2905371785737632,6.289681196931176,14.895429116510035,21.735626173034284,36.35859194025574,25.56573651316409,9.43827190343214,14.895429116510035,18.20552447573449,14.895429116510035,14.895429116510035,12.725366600039624,3.090089021149111,9.43827190343214,14.895429116510035,14.895429116510035,12.725366600039624,9.43827190343214,3.090089021149111,4.466628677334144,2.190063092659079,1.2905371785737632,1.2905371785737632,4.466628677334144,25.56573651316409,25.56573651316409,14.895429116510035,9.43827190343214,9.43827190343214,18.20552447573449,18.20552447573449,31.00089309243445,18.20552447573449,14.895429116510035,18.20552447573449,18.20552447573449,14.895429116510035,18.20552447573449,18.20552447573449,12.725366600039624,18.20552447573449,18.20552447573449,12.725366600039624,14.895429116510035,25.56573651316409,9.43827190343214,9.43827190343214,6.289681196931176,9.43827190343214,25.56573651316409,4.466628677334144,1.2905371785737632,3.090089021149111,6.289681196931176,0.06885198352948747,4.466628677334144,4.466628677334144,9.43827190343214,9.43827190343214,4.466628677334144,0.45351306507803296,0.45351306507803296,0.45351306507803296,3.090089021149111,0.45351306507803296,3.090089021149111,1.2905371785737632,1.2905371785737632,3.090089021149111,6.289681196931176,1.2905371785737632,14.895429116510035,12.725366600039624,9.43827190343214,18.20552447573449,18.20552447573449,18.20552447573449,31.00089309243445,36.35859194025574,36.35859194025574,36.35859194025574,36.35859194025574,31.00089309243445,1.2905371785737632,0.06885198352948747,0.45351306507803296,1.2905371785737632,0.45351306507803296,0.06885198352948747,0.45351306507803296,1.2905371785737632,0.45351306507803296,2.190063092659079,0.06885198352948747,31.00089309243445,9.43827190343214,9.43827190343214,12.725366600039624,25.56573651316409,31.00089309243445,4.466628677334144,18.20552447573449,18.20552447573449,14.895429116510035,14.895429116510035,9.43827190343214,18.20552447573449,25.56573651316409,25.56573651316409,21.735626173034284,14.895429116510035,18.20552447573449,14.895429116510035,14.895429116510035,3.090089021149111,9.43827190343214,9.43827190343214,6.289681196931176,2.190063092659079,4.466628677334144,4.466628677334144,1.2905371785737632,6.289681196931176,4.466628677334144,2.190063092659079,6.289681196931176,3.090089021149111,4.466628677334144,4.466628677334144,0.45351306507803296,3.090089021149111,4.466628677334144,4.466628677334144,6.289681196931176,1.2905371785737632,3.090089021149111,1.2905371785737632,4.466628677334144,1.2905371785737632,0.45351306507803296,2.190063092659079,9.43827190343214,18.20552447573449,14.895429116510035,1.2905371785737632,14.895429116510035,18.20552447573449,9.43827190343214,3.090089021149111,2.190063092659079,4.466628677334144,1.2905371785737632,6.289681196931176,9.43827190343214,9.43827190343214,9.43827190343214,12.725366600039624,12.725366600039624,9.43827190343214,9.43827190343214,18.20552447573449,12.725366600039624,18.20552447573449)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(4.0, 2.0,1.0,8.0,3.0,0.0,5.0,6.0,7.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.01911765183578149, 0.02793484460672078,0.020405515626828807,0.03796956645131769,0.25259168271785465,0.282063239324637,0.25861726285986153,0.0018415582022411686,0.28292309901616874,0.16837522674587702,-0.012270989208629221,0.2844126365227223,0.34756565244834614,0.12349108939172539,0.04208922675263347,0.0092250261201628,0.30692471546040156,0.10695391983419107,0.01037248537660953,0.018994198508381875,0.02553971215816907,0.023617399046840255,-0.017428367480163628,0.017882907220978298,0.1390848902102612,0.36869535331930503,0.1123758607569148,0.04640347210532251,0.0565612592491956,0.10907086825256558,-0.21841837216478066,0.01750617836629429,-0.15916577948093472,-0.11521456837694037,-0.14249503862029628,-0.11649132070218193,0.01886562170604145,0.08944381699568692,0.03688293082284789,0.03681451950415743,0.043504783816573106,-0.005478487174079077,0.013878453556148262,0.02324934627902017,0.004887249523012436,0.012875870769342644,0.00870328037998453,0.011529196210246569,0.030739504318522206,0.012583653397023381,0.029823437232844488,0.01617033480064651,0.025251804971249965,0.008821670129593766,0.012227595194954397,0.03381042963499723,0.028814541101163913,0.017071261170602706,0.011454134426792818,0.010078803096587714,0.022347927946873538,0.31318391128406137,0.012076731608053306,0.01181914727177897,-0.16628327119525832,0.012646455387320182,-0.0017986520206462518,0.0031036077654698294,0.20628471374420898,0.07804477187878714,0.01844823114980604,-0.08193909145215135,-0.03309119269912643,-0.17456272321166896,-0.04122421352964911,-0.04832536790275908,0.0692243544227626,-0.10608200277653583,-0.12583134163736334,-0.2574571648574717,-0.02572146460437623,0.014653951828414868,-0.2759318502869288,0.031048442130939876,0.02671525665687873,0.043559542870112475,0.007513440465828406,0.0008359951135763984,0.004757037102039732,0.4427220091391049,0.3143319734915528,0.4009426869077779,0.33360760312578275,0.26663650805882544,0.35963782776726827,-0.08976835310329002,0.08943476903208948,-0.07967007401257366,-0.24362895674427945,-0.14655457732309918,0.08451096826568455,-0.17972361753604596,-0.2176821528116197,-0.10091127214481618,-0.23679295995539368,0.10899544924137004,0.3851587593297436,0.03890306309580433,0.04504763715108388,0.004222816428293185,0.46546172544112097,0.385150359729727,-0.11397295254571448,0.006094062962528868,0.032435594467853504,0.03564303885735825,0.019147100277147704,0.016455013789726806,0.11923297054375413,0.1420076105185507,0.0723238966820818,0.013241995518243335,0.015022492310350934,0.013480861585716987,0.016127563335505374,0.012398256208131564,0.014505240360060703,0.017921311559215915,0.03877501373243538,0.06440685897346643,0.1717157501002745,0.18391734830701964,0.12405080703690162,0.15921352288519466,0.15432841674735054,0.12321815807396587,0.17006391035149498,0.016559253846639553,-0.07944423624228147,-0.011453211225385704,-0.004540700450567368,-0.02767629701377115,0.08751933838507582,-0.048653487693674634,0.08588858888722983,0.01652193486572903,0.04422224771024569,-0.0217173897168012,-0.08578387726828832,-0.008619801913704317,-0.004799074103857014,0.0002859479587360926,0.05497038225455733,-0.010865599174626468,0.01812141860968942,0.02612852221713296,0.10016991925348662,0.05001632113820389,0.02858097832906978,0.10757892430499129,0.01843402667448923,0.005980231226195109,0.02097520434159315,0.12983957312549738,-0.008750623420986009,-0.01777026813345224,0.0007843050037279421,0.014456292041760917,0.016690477045350507,-0.0013749751803526031,0.058965208175671587,0.02488513751064173,0.012147901556422133,-0.0012745224073199436,0.01010304498641151)
shap_list[[2]]=c(0.06680494937172032, 0.11905635761769225,0.25571879354300314,0.3437998987680277,0.39576454051586213,0.4509709261158574,0.3736836990610692,-0.012387299350374031,0.414786465681992,0.31360808680458707,-0.015890241888325413,0.4374340975584126,0.5186976158135299,0.19754945267794324,0.14454268942044585,0.1121083802641518,-0.08360354661135881,-0.07440142946902675,0.05105987711977808,0.09323530259456364,0.015385743034967397,0.062000792120857955,0.04995509589067168,0.0692988992736468,0.29791605358684964,-0.3426785754799106,-0.05526976562336287,-0.012247954328872067,-0.039989810329705444,-0.053958703109112445,-0.07227186972481522,-0.02294429289575627,0.1109596678576421,0.007819674347141698,0.11371057766803275,-0.07990826177063552,-0.05991331750483879,0.12844834111518538,0.24793344059400863,0.15232552173621333,0.21297623609618174,0.07740464695089194,0.07934318970971753,0.10315000500687573,0.07582260183132532,0.08240445714024525,0.06622623506987581,0.0743630541711423,0.07592500001180252,0.07864923836052388,0.2566995820084951,0.1396700586147123,0.15113180756976502,0.06660361372028142,0.12013344125202853,0.11119543374434072,0.05661205280080614,0.2087724556733326,0.20591759972794335,0.2863692833152192,0.15238406390396184,-0.07983939048779179,-0.02223253325316069,0.06698714215555497,-0.00022164981470334456,-0.023040968702139036,0.059195281809213234,-0.026010321562526126,-0.21856384486318423,-0.12004226166728385,-0.05123906339872553,-0.031691325093337434,0.04252565814015974,-0.13758283540955873,-0.04661404100765401,-0.05299118567245186,0.0649261070359401,-0.06622029844531739,0.09265411761571946,-0.05293165011335918,-0.03669696501453467,-0.023396953421722454,-0.10689349392287259,0.20177960935353884,0.2189503732904469,0.23884247088106061,-0.05752047333166562,-0.03663065571061792,-0.042394216257150424,0.19805263845845733,0.10914902464883784,0.16812107166590431,0.11603202827532803,-0.04062432523066975,-0.07129789352543252,0.05488997574223967,0.14026219640618504,-0.09915546047055099,-0.1665865515892606,-0.012115480244754456,0.08287538074441082,-0.03135273604720723,-0.037774996441789783,0.10443052125372099,-0.09605342219547716,0.09069766469427573,0.35503095357499836,0.17604844709499667,0.2246476872390829,0.1706350188354753,0.4240379687084666,0.35423196772604887,0.41068439758291536,0.14097933023993128,0.21196458208870184,0.22164501429110262,0.18072849390819765,-0.022056479432910336,-0.06606506587634102,-0.09731094268806491,-0.05460229592067873,0.08701693355025,0.1518401030803628,0.1442702661766542,0.21250231799461378,0.1434066143819404,0.23213416267270168,0.23522646301236644,0.3257117383782536,0.015627064545146598,0.17474949718349791,0.09610389856120731,0.07276337435866853,0.18174592196691083,0.10471695558705298,0.07689440036259448,0.20364504626695046,0.09250641291464198,-0.0774902012563297,-0.05996590273726263,-0.039647093466726,-0.05519805225663137,0.14395622630918106,-0.08357177519564533,0.14385315494748233,-0.023382405100698098,0.12449594710784284,-0.015129629108326376,-0.09385763057520352,-0.04298017803418224,-0.06800973686999537,-0.05583118284595714,0.10216936568626057,-0.060778814671897434,-0.020250588325188307,-0.008077813492539514,0.1004609509578832,0.024338537754314143,-0.03242831557154607,0.15265925460511548,0.07395669664384931,0.0642698217765743,0.0646005510135577,0.2708458770306976,-0.003594567982358194,0.23448358786275975,0.17805217805567428,0.250393766048588,0.12516150321561453,0.10647484580591458,0.331915001791559,0.23634749155789925,-0.0360375008306247,-0.045904719025901077,-0.05605953354773999)
shap_list[[3]]=c(0.0993181235016134, 0.22799254360893123,-0.10871922926912052,-0.09157828027004367,0.040474953127018716,0.058014722324855605,0.7173366208411777,-0.0170637862483159,0.7255330965170129,1.388926314653265,0.061918723509683575,0.029829648567997323,-0.04311852656525459,0.3939226579920373,-0.01652809706943297,-0.06401718541341685,0.2244054791011657,0.1258245426888237,-0.026868242054687744,-0.0023266080850501835,-0.036142455143110964,0.010917841506248928,0.08738687568336846,-0.03496847713708394,-0.04999443894205211,0.49048846951257813,0.002142419778411568,-0.0016355106017944367,-0.011724574974272725,0.0020869922359534367,0.32534408817214044,0.0801278153206682,-0.03336311907899293,0.04943143333485875,-0.03305837021364632,-0.0018869194694611853,0.10422570051284341,0.20331686832819146,-0.14290621222902702,-0.0973504522729104,-0.13335834773336278,-0.07145189057533342,0.014675000831589988,0.1434615784756146,-0.0092267931760299,-0.00810856703548404,0.0213277811112176,0.020535486285665906,-0.002648119622996561,-0.003803506249590755,-0.1752455676141283,-0.031217417919989606,-0.0302123001319483,0.008764564485033393,-0.025064225972169393,-0.026246504374345288,0.062099893280273294,-0.03829852005817277,-0.09849550759848368,0.3421375325902903,-0.02742878281100908,0.252114948491256,0.09028941176311951,0.45705915830540383,0.42631390636285094,0.09881252135043385,0.4752908321779369,0.11049563884192418,-0.03794396694628916,0.0038283802040279514,-0.014768627209496215,0.2575428547546564,-0.0980235742649852,1.5336595100250479,1.094247404194771,-0.034489107949147474,0.7464669281718679,-0.2849772948882213,-0.7719522052289,-0.09082818478061783,-0.027376800643778856,0.09302791820754534,-0.07321100854322202,-0.09128076777533059,-0.124459587504796,-0.07694618612284505,-0.009024204352056425,0.0051411336900876615,-0.08974971675317392,0.45174023320453627,0.2881221868419318,0.405461017720963,0.3453611936634369,0.18700804140486188,0.2432664322054411,-0.052496775714875446,0.7282039697120318,1.2900609108072565,1.5042718363983056,0.4447594505189396,0.7506612269217142,1.5263336565843657,-0.06341608073043566,-0.03834937047531765,0.33412759042921975,0.7417177163416502,0.509887383932788,-0.03400271925017658,-0.028924491620541167,-0.0842146363735887,0.5891173912496991,0.5095137860199728,-0.06844022263027712,-0.024730659860206967,-0.04839210567849847,-0.049773662223360056,-0.041224648368146224,0.06591131614153682,-0.009086142368970117,0.15634319064256552,-0.01594569930593175,0.17845841173923252,-0.028439711598520108,-0.028154134362030476,0.20061656668138653,-0.02614349088721178,-0.1620516434489943,-0.17871503196118507,-0.09386373638768616,0.029796484907244156,0.08907741817548001,0.12258271801886425,0.12899860952074219,0.16020061143457925,0.10278078496488109,0.13128642782435948,0.16570286265782286,0.12759742363067297,-0.10965854445794683,-0.04849451994255271,-0.01645468400737729,0.8750584031001574,-0.024276262442236594,-0.13231105610965818,-0.025541205466678808,0.07062364061026279,1.150846589408719,-0.09434155950673,-0.1161696721531874,0.6823391721304024,0.8461533625394138,0.8928932434286146,0.8779530706858647,-0.03918991830820454,0.011510255773174584,0.030314734951170014,0.11281551047020721,0.08002454956013676,0.5582562360367389,-0.050129471524821785,0.4832182303672286,-0.18388947985640172,-0.1737918466860294,-0.0526811564691161,-0.15792555937715685,0.17187599339616252,-0.06163051199376295,-0.010526673952055483,-0.04794026096673541,-0.022355306363318037,-0.08299943555715088,-0.10893493247126519,0.10657908262214545,-0.003213061080331849,-0.008949383275091932)
shap_list[[4]]=c(-0.012533037588255722, 0.00627378371471673,-0.009834017881215996,-0.013126448102420302,-0.06421909253546013,-0.07378048781874363,-0.0756608456209627,-0.004357324311775431,-0.07547815464672976,-0.05956902432837846,-0.007113920117789671,-0.06497486323344344,-0.08289444703019748,-0.03970912760673666,-0.00993933986582683,-0.012818040977567637,0.1387444389077362,0.08563665871009558,-0.00986875358328755,-0.003332471095997064,-0.015485688044801377,-0.004258234641699341,-0.011585677995754565,-0.012617724941132561,-0.03561725673541519,-0.043863319526403065,-0.014619205822309085,-0.009914856686414081,-0.011162082060094046,-0.014482795452878382,-0.021675853168433488,-0.006802372235322831,-0.05907059498004475,-0.026346609275329676,-0.0580034192107277,-0.025199310582687953,0.06088101215147298,0.11424198903632027,-0.012624624975792687,-0.0015249316869778767,-0.007012732545474046,-0.010731882837338445,-0.000941156411882975,0.08994438347061207,0.059886306534649526,-0.004340388918077539,7.668535714621999e-05,-2.051084370414144e-05,-0.003475043473899919,-0.0036602751762851225,-0.012586637368507935,-0.009361224674713637,-0.010672307349853477,-0.0016845197549739965,-0.0080440363280361,-0.009697803019831832,0.03157201737732368,-0.011474072969317536,-0.008270440281789141,-0.020918854161893752,-0.00824347391056546,0.14490275181919754,-0.007696214939430792,-0.041812850717611594,-0.03098087523808325,-0.0072919746870069736,-0.042780228544818145,-0.00910885930575416,-0.0430162129197106,-0.01732924939879628,-0.010719876446220519,-0.017802712412998006,-0.04799034828965965,-0.06587511998821503,-0.03873478504387265,-0.013124418854286739,-0.02037295860561133,-0.01801626758811145,-0.052722705758811744,-0.02833899708525025,-0.00950110027050602,-0.007175893178186497,-0.030080670383017698,-0.0034760356379766456,-0.008476728516630054,-0.0027525140247043663,-0.008877956830531214,-0.004852045513055663,-0.00571071766630429,0.2388339839007114,0.152529415549127,0.21398337257903527,0.1818249677243971,0.1250143986437499,0.155945559583958,-0.05293772504815364,-0.01241391424751479,-0.044555115842457006,-0.06290058133382109,-0.04008377195154512,-0.019801514943399396,-0.06458790038530436,-0.029346509229187488,-0.05508435682433686,-0.02093230326996299,-0.015970569738815846,0.2576656610682835,-0.01425840303264425,-0.015981096854565616,-0.007221397644526541,0.30458203382452276,0.25718092658865915,-0.04758237735277973,-0.009308846740530667,-0.013589924088385233,-0.013960018242792686,-0.011123160611429218,-0.005319960060240789,-0.014352715969951491,-0.021060295019593972,-0.01174821943856985,0.10523388572655072,-0.009361111794562083,-0.009454528110230075,-0.021876933149929043,-0.00857049724623533,-0.010633556901165839,-0.012538824107439932,-0.012517954883967458,-0.0025696109266766997,-0.026151826491325032,-0.025204484558475355,-0.021757963311560883,-0.01269309972085421,-0.021157991543850473,-0.023144524302014576,-0.011753866528161367,-0.013056593057180039,-0.0418892688113017,-0.011272268690927631,-0.013049475747341962,-0.030354655377621064,-0.048696500570333506,-0.03466994778954787,-0.04936835927268924,-0.0062090901757283065,-0.052856874197136326,-0.035463498220694126,-0.02089586356789367,-0.020783178145007266,-0.028450552366869268,-0.03242038134903301,-0.03574081689613465,-0.01101685130502332,-0.0012142554908363729,0.00046467196589404644,-0.014572707575370323,0.003496410903155326,-0.014304275658101667,-0.045515471367163586,-0.012987106283191564,-0.011538138232275834,-0.013429923012062018,-0.03830733010346384,-0.007624590577922867,-0.01803736475711669,-0.011401954553892667,-0.012839115847102322,-0.015055438476555041,-0.007892784066046698,-0.01344741609822846,-0.009358570844477785,0.06833301832211996,-0.006705136522621248,-0.00949801978668718)
shap_list[[5]]=c(-0.09585385265279028, 0.026997726267922476,0.0868550690497294,0.20998550819455974,0.527505861977889,0.6631496872940188,-0.20181939618298816,0.02387750077418228,-0.11254763806188371,0.3028899707003909,-0.05067561280908675,0.47336769525769967,0.3387170207604845,-0.07794984838541358,0.05353028502457926,-0.018482769738180704,-0.08604705886253122,-0.07307305457511169,0.08076832360186131,0.049282697571336326,0.10960017452850787,0.044121867783581264,-0.11956991759253947,0.0979031444504602,-0.009179512011336627,-0.09643602374208948,0.0993931785486119,-0.0008993671631981482,0.04024598566290786,0.09909778208056202,-0.14072995222118545,-0.0318147255735284,0.5190818417470344,-0.053289725160059434,0.4334757017837563,0.0669377265043915,-0.04774662537135202,-0.12079355825613099,0.22137133488630117,0.010897674428047892,0.12018054374781871,0.012264428475055005,0.037477705616227756,-0.11939543603535197,0.000455829428316966,0.04554241779168403,0.008988430486999282,0.024062581199171425,0.05458561335389028,0.04596303037608825,0.24785372478089834,0.08526664772730615,0.08619298549874788,0.023270481450887236,0.05968192341788789,0.09265127276427877,0.021839866110207516,0.129169572064636,0.0547721411568101,-0.060171443340898044,0.08889105823874792,-0.12953102333212882,-0.02942637901797611,-0.14737652651662483,-0.06360712359285467,-0.020597591903762556,-0.23214349394469402,-0.039580386179394224,0.5768563729382675,0.09578908549659569,0.017778755412133574,-0.08290792742944492,0.772985934003687,0.6204396227207849,0.6514189446980797,0.12767485013931867,0.40257042138870114,0.14839242249836293,0.7291620681348678,0.3742811155503453,0.0812471757267451,-0.022199328986255526,0.507628566763827,0.03414217644962574,0.1173471017998751,0.03169641028561364,0.044422146424048334,0.010646738826872707,0.0518063049530975,-0.11809861640427957,-0.15600375198417457,-0.13222705133274418,-0.1271100061234309,-0.08131630437595981,-0.07865681525123097,0.7972655374145082,0.34393495605373425,1.178210277994102,0.5854956187507965,-0.061404682233574565,0.35714677780827053,0.725293694120645,0.35684930368850853,0.6801259763431902,-0.11206995182187354,0.34726775150405637,-0.11819896538844246,0.12137260850036194,0.1395934867335654,0.05133454025918718,-0.14348110982451318,-0.11829363876698969,0.22396579492902705,0.01775632119718485,0.08816886377487743,0.10586045093463381,0.05980123018473231,-0.03316327851278378,0.08866617367455744,-0.047836156951619704,0.010202790901868989,-0.08324013958017785,0.04067538398235715,0.021541344422645964,-0.15064821759619065,0.03671099082794217,-0.009887375942511798,0.1078504740728457,0.23471945580814468,0.06866740232605409,-0.18127442244353392,0.2973158695250404,0.24681770130227404,0.39900163968870905,0.21609182953024691,0.30973565522241914,0.4346732264014415,-0.07169011365327982,0.42059728461752605,0.026324150371923656,0.025078773225409547,-0.5292162604933329,0.47637296789875366,0.2757891956602642,0.4621607233357443,-0.03796311864837724,-0.24716462979780976,0.37558708237136296,0.048278463045991024,-0.39595438278595546,-0.5323720998295532,-0.5164451547139801,-0.43798758596963144,0.07481093633309807,0.011239657927835305,0.022028626270319058,-0.0026231497912783046,0.0637552944698032,0.08213379801902525,0.2237965575691379,-0.12020266244736534,0.3483953423701723,0.3919554318654225,-0.030264423737782337,0.08577305365500075,-0.12993881499463605,-0.03443917270115841,0.09729544865771458,0.06665838992345614,0.026602760909820545,0.25880457489786085,0.10188755688766607,-0.03260865699458378,0.020545882917692538,0.055769184406187215)
shap_list[[6]]=c(-0.09140051423508966, -0.11947363522448652,-0.11948902222514919,-0.13613565926868976,1.342949701648573,1.6240816204487227,1.7192074981526377,-0.08613487365922894,1.829278292484317,-0.26115808515398586,-0.0843894075924225,1.372650841201579,1.6081885879695799,0.814011272559499,-0.10392440742151511,-0.08615389743198947,-0.09298121309537846,-0.08033796091882288,-0.10552115140153495,-0.10116506948660223,-0.09220512798169614,-0.09822599056048716,-0.08678386987663658,-0.11488209100154104,3.668162811841257,1.160352473245805,-0.08932051731587018,-0.06783296730053069,-0.07296565465220439,-0.08849678520483432,0.8004539461048308,-0.08158209619138636,3.914185359090707,1.4717956087841324,3.8945985875493205,0.7711029512876685,-0.08341282464387981,-0.10507326256884525,-0.1391423687637292,-0.117384171655364,-0.13213526975193465,-0.08409267400033707,-0.0948404444825973,-0.09489858759835626,-0.09558743877305936,-0.09938561942238291,-0.08869343004873034,-0.09231814107347411,-0.09716853221227399,-0.09633148661032086,-0.12393104063961757,-0.10978344642691164,-0.11130438942411224,-0.08903784868134336,-0.10176197021532055,-0.10544937012360235,-0.09244963388933967,-0.12315332854194415,-0.10867979521757994,-0.14144800687970677,-0.11114189985562573,-0.10338710545431273,-0.0669438537427297,3.8080180321034582,1.834699635573824,-0.08324968403665846,3.7346148213194565,-0.009880692751273968,3.7354193527978095,0.18837727246456132,-0.07521508224084161,0.43775383460988027,3.263728403249564,1.5559265387203276,0.716416881126866,0.1472067293333315,4.060131353165223,0.5841899399313528,3.5198648399920485,0.8712760317547519,0.08411563345594898,-0.09141663402544893,1.2642491466868777,-0.12271021912301797,-0.1287582654281571,-0.13072097535318594,-0.07274937432974805,-0.06738999752295152,-0.06632582537357239,-0.13777098739637605,-0.09775002517807468,-0.1262671542722625,-0.11514203358775874,-0.08731167336554661,-0.09747424204050575,3.9365269895813064,4.076117462731097,1.482974204539235,1.4697533372787401,2.5872372154136514,4.088138627028599,1.665579553092839,1.826336657953581,3.989066447676001,0.7852928146857014,4.092725803475632,-0.15120990863952988,-0.12649348779249386,-0.12305676735167646,-0.09956224325393698,-0.17187392267044135,-0.15104536214247463,1.177597530129302,-0.09072180724540345,-0.11654299027027641,-0.11902181812340419,-0.10535189406256325,-0.08651216423942963,-0.08707171223918413,-0.08729809782152749,-0.07215353836874137,-0.1093619098322696,-0.0994523983528987,-0.10058065259580383,-0.11141941384031531,-0.09763188959481822,-0.12353780183378897,-0.13294490338828177,-0.13241311078938392,-0.10696841406647938,1.1076825274610504,-0.059623813386005205,-0.15378099762378486,1.2010576930049617,-0.14491713477656268,-0.15800958340219856,1.2258520176495045,0.0027319638394488646,1.0190025399514224,0.23518456929455073,0.3350869400449965,1.239189790261796,4.321958853410964,0.9381213347362577,4.314053241513059,-0.046388990659081475,1.0698943613528034,2.1311902955938073,0.6881293159679923,0.7337525746487706,1.0888991607614755,1.342484636023238,3.9271769264421184,0.1193885661684783,-0.07273860068364484,-0.0771275619374034,0.5338759482835245,-0.08298015685456403,-0.14939397450334227,0.7498463097910182,-0.13307769962986868,-0.14704439896031513,-0.1499973228602965,3.616894191316189,-0.10767971085815264,-0.12434795163296916,-0.09614100712061731,-0.12295757203225148,-0.10506851551603023,-0.09579122423811083,-0.13802981952779572,-0.11853086285973927,-0.0855232194968513,-0.07313028584211438,-0.08314432794365527)
shap_list[[7]]=c(0.058638965987761485, 0.14947849694470575,0.11450899453295266,0.1552083866542256,0.0506591842931995,0.06668766971766148,0.04067589377836919,-0.019034396134721427,0.04169025775647841,0.03394934893791258,-0.019920068546043657,0.05544452030123908,0.06966155805673356,0.00269589298713675,0.09178366109345847,0.07370903535698484,0.06914018171833201,0.05237288342235177,0.07836639423764537,0.08156161353238553,0.056082940198349376,0.07958033117766629,0.05882100996920469,0.08638892620587307,0.14918228473049913,0.17648460385876147,0.06443666876953225,0.039166588754232755,0.04534439093893114,0.064449948988685,-0.028378439829977325,0.012585153611511104,-0.024238842282966157,-0.019989570619630928,-0.03769809945292179,-0.001731876024162143,0.047323910329719145,0.08161111835348304,0.11181411820109782,0.0759679115040329,0.1007203852842281,-0.018410722989474854,0.018844683441590945,0.028202966924329817,-0.013504131900394054,0.005564679388055527,0.010177965899658721,0.017627458601868137,0.012386931140210403,0.004473887141004695,-0.006074918630981413,-0.008991143959767068,0.0018175569918241314,0.002724592299161216,-0.004059260208475045,0.004243969357594002,0.08359913691247471,0.10608305352128902,0.10181472975738932,0.17257303639641516,0.1014818805175304,0.07510897273726827,0.014508684878503058,-0.09105828840575221,-0.0821651214795242,0.014892944149197068,-0.09512213472365749,0.013903270986114895,0.0918299897407089,0.09251662977365385,0.0410399416386904,-0.022315187842153583,-0.008044897674447318,-0.03889103795296537,0.05909374487362314,0.010662821564208539,0.014005853133968725,0.00855947962236114,-0.008580116563668276,-0.003930443214137607,0.00762688255749486,0.01413083803599046,0.009659772279527922,0.08665758932656203,0.09864629696481036,0.09912009342391784,0.04114095659140231,0.03790025782515359,0.034339248754750654,0.14195900022583327,0.09734245931436933,0.12463421621938528,0.10874223903936531,0.059289754400186835,0.07261752008111283,6.05309739396922e-05,0.005567803980256614,0.028870905349932897,-0.051694858794109184,-0.05123307189565193,-0.0029768328641494755,-0.04763432317404684,-0.028172513361314672,-0.013526009739485353,-0.0317664291869454,-0.0008869851290861974,0.17784835557940853,-0.009065567070493635,-0.005416425610422335,-0.01256552820878883,0.20743347245805574,0.17740571049618784,-0.056301996368939435,0.06258605760878555,0.08405261461303844,0.08744478891713796,0.07409682823840148,0.00044383945320586955,0.05693859470624002,0.06106351966124611,0.04224512408797889,0.10369875764042927,0.07432405213873942,0.07563149518835442,0.10654004072501488,0.07464691589642207,0.07584534188848219,0.09415983247588246,0.14944465326773032,0.12996830121849687,0.19122861277694742,0.17123800954781027,0.154341169260302,0.19012642688765358,0.1590155361540689,0.1627580345785595,0.18553622393069985,-0.00417369398968542,0.03611627229033953,-0.007593496305773011,0.013501481043582399,0.06486654234156727,0.09899776204910675,0.022580135570133646,0.10068974937277375,-0.014909855674907666,0.06475809357094238,0.014865672695208396,0.03238723444961518,0.0534951498978856,0.06369953335871101,0.06803367107477817,0.07560020717419497,0.002751260268722766,-0.015293556272205088,-0.008200289687865864,0.08042795562593864,0.012963265512632886,0.005327698635806397,0.042083068934042754,0.031017222503754167,0.11866284420079201,0.12262201691948632,0.15935916506111591,0.07936923819609094,-0.003953352781722991,-0.009332605737900082,0.01870769128553564,-0.017182163752249187,-0.020818479449121175,0.1762045973330554,0.11145529522381162,0.05216154292605522,0.03882723481975157,0.04412990816304418)
shap_list[[8]]=c(0.013145296127415971, 0.057614969212314814,0.024449842857374785,0.02075491588284255,0.1974162893185411,0.2242362135650851,0.23428317425295003,0.007422151990158596,0.2474959199892254,0.16627489981908955,0.017338342306414418,0.20458421697598128,0.25088348279488404,0.13400865902196366,0.034837865587133726,0.0219694287759317,-0.022773949368248666,-0.03354585581904714,0.0061722757518269744,0.016454970072097872,-0.0044319264765776386,0.020703952897724844,0.013308696907686221,0.0065038991106643185,0.1152373844009103,-0.07688679825398932,-0.06711087178744234,-0.037590447635301845,-0.04862470697874269,-0.06752591858877337,0.0982902567177666,0.035020588978229565,0.3012571676004804,0.1354742902417979,0.3034025962141529,0.09861981106990977,-0.004625817494050084,0.0306885804576073,0.20353360944055607,0.21270637112730978,0.21410509325130891,0.010895967406796409,0.01905454126379748,0.020143179066107717,0.017302371957198897,0.016680273530334567,0.017621792670338792,0.018902745635773186,0.019229865156456697,0.015873255460619188,0.04128141027172117,0.022305563676500842,0.02575502589915426,0.015863714128625802,0.01897034328732886,0.02247617256363362,0.02764782877657718,0.0293616810986803,0.02879610432465801,0.05049443725319586,0.039394841328131404,0.03003308076343614,0.03959004393745581,0.23037048561490261,0.16570557980402043,0.03842001980692328,0.23022129529575022,0.04379780168795126,0.03980571244168624,-0.008703694332593529,-0.021533690668041033,0.08298648813189348,0.236345754004986,0.23614584733065477,0.19195438866019174,0.05040314314167972,0.23449780735777656,0.07343008518231499,0.29307248617202475,0.12746462573595677,0.04105254756926346,0.0360618440931248,0.14794138043486754,0.24084458884203988,0.2153466275407197,0.2709448515646398,-0.015701725938014485,-0.005592600804104976,-0.007116686518991679,0.00023669738450613506,-0.008131897484928862,-0.006432854453794365,-0.012765028842246787,-0.02134279403968594,-0.024656448541863926,0.2597291400486666,0.2373862371638134,0.24523913970402983,0.2230628872253778,0.17762854184320043,0.23829971120574284,0.2535142119887094,0.14843511855647884,0.28414683057345697,0.09980217214550562,0.23718255720148523,0.0746198199949608,0.04458118858635529,0.056328188557071515,0.03436786810827533,0.08168926589134318,0.07478460701092413,0.18354599186769657,0.013285008980082053,0.020917147478531947,0.01999769709073298,0.01885270635851483,0.02937431884607679,-0.05481842860228297,-0.061488265465506134,-0.04422095230624709,0.04087664495715087,0.0229958469366459,0.02421154089936486,0.04014895776176326,0.023481566639606488,0.2025934053453184,0.16203489895930895,0.024917981252146063,0.029349159296079955,0.3668964901128313,0.582232051666566,0.4968793893644776,0.20127372989483175,0.5548209119661675,0.5191593201496421,0.18105014424324042,0.04972695700875169,0.07088128143965483,0.01829514290085685,0.036176834248443465,0.12946275076646055,0.2333212243527454,0.053093396741634394,0.23437571197969,0.019086113620657128,0.15933878748537983,0.11699709506922001,0.029500851931539403,0.10034073424488875,0.12589675481339618,0.13574026754471213,0.17800353280019882,0.012566227199668795,0.009777243979369356,0.01875630842052877,0.11424152582691359,0.03772779324878572,0.050255687073107666,0.10515482485635513,0.08353946072445419,0.23252652559576706,0.26880700587894973,0.1261254800244544,0.1617548219295813,0.04749618062224909,0.029541498519284705,0.04521068323028714,0.0243612841233848,0.015647855108576733,0.03985766279952779,0.02735938788810617,-0.00592893477283872,-0.011399183721386976,-0.018123607890706512)
shap_list[[9]]=c(0.0037711649753986937, -0.04334249659870694,0.07859929083715783,0.07495212048578714,0.2800706732567977,0.32775292926081184,0.3781335230236241,0.020053321852236867,0.38113632887936344,0.24465226707535093,0.029930499629725847,0.29819109330460664,0.3934377540790363,0.21754742204852395,-0.03351919086979808,0.004880809417133708,-0.22202306512680825,-0.11720851088189048,0.005784459923461866,-0.02658000568989813,0.02622767802095522,-0.020432742127763324,0.0335339021266346,0.051349037418581565,0.17521161444247196,0.24778877823289516,0.054107770220594556,-0.0169295672657054,-0.015532618692693902,0.047813202675399666,0.14919375323437567,0.049224294448492766,0.34175857335110904,0.1581056477844271,0.34882351278136736,0.1465730207348364,-0.050337845284741375,-0.20176905655898206,0.015852708734269864,0.00577707965802661,0.011576232077754258,0.018716897576294793,-0.045123648516505896,-0.14584168954661894,-0.01542560940152342,-0.010276957436404199,-0.03639392831991114,-0.042720068591263705,-0.03731323832832165,-0.027839680256005604,0.015551743376244815,0.0029582787051672358,0.009433959494828857,-0.0401778369368524,-0.002176795782280624,0.04148228303612893,-0.0761668897567077,0.05238886379925161,0.04724065672209195,0.08992131122207386,0.006321383223643409,-0.18311393761863107,0.05628384221383343,0.2948716555807204,0.22632566693346465,0.038962948591599336,0.3000133409336483,0.0653460536286247,0.2119319775360455,0.10020465509662284,0.03435005803888799,0.12767329814875558,0.24224046141260447,0.3247734251070083,0.22449400167490793,0.07314963883813815,0.21358906047034643,0.1131113402233183,0.3368265145827529,0.1892785060994006,0.06267322288852548,0.040316651366674505,0.20558352090848173,-0.025355400736474232,-0.026198725803549226,0.002532933046217468,0.023813341840784735,-0.028938917562241838,0.004624198148814827,-0.3512480468776436,-0.4446654076849988,-0.3879107961195406,-0.36683731192319574,-0.2253030668990899,-0.20752907202367127,0.2717779270908505,0.20704239775488775,0.2743606020596716,0.29013208853286787,0.25082116936129306,0.21343205540152071,0.325562172185447,0.19084535489086998,0.3014775410095044,0.15153290064096311,0.2095490427872361,-0.41706809698553526,0.06508742644887339,0.07253468836167992,0.009277190381998422,-0.2965096925005036,-0.4178627645789473,0.27061368058833746,-0.05710790933130555,0.015448639716036194,0.008772320226168959,-0.02352155213501762,0.04153519790773884,0.02447829652186693,0.020846357261108256,0.004472855704035424,-0.08266727092126591,-0.03393230393253168,0.001052740539397356,-0.008754523241919523,-0.035213575193395574,0.10146461363741148,0.12756893459093352,0.009488265678149447,0.02521764422723646,0.1784452698408604,0.1228913847714162,0.08620886824812429,0.21834702630815958,0.05843354628968864,0.08858150070013539,0.23484978285001182,0.07235809039888169,0.240770111884608,0.07816937849241501,0.08369935087629538,0.25442972575661005,0.27831881056164975,0.2072508614120947,0.2839486351780162,0.05360645526362472,0.2837824572623369,0.2244600355030108,0.13138245790097225,0.17701531465726822,0.2266598346656628,0.2577439890947484,0.2541820912170238,0.061431420771863976,-0.020189086190447573,0.005512264165066297,0.12982209837386055,-0.014982186629877077,-0.07920655824352348,0.219954963849911,0.08378790797484592,0.14019369732079026,0.13850200647041078,0.18768375043056973,0.07331056817628227,0.08801248634168002,0.04595693265692111,0.011916256101126784,0.05886342166410399,-0.0027346361855988214,0.02127861495429696,0.05740947244002959,-0.050955011602418915,-0.004955761162495573,0.027063384977703955)
shap = do.call('cbind', shap_list)
baseline = 0.3120152572232971
rate=c(0.33478870087528984, 0.764547847373108,0.654510494294858,0.9138452660189039,3.335229051543571,3.9351917774562017,3.756472687389034,0.22623211033770035,4.046832924839236,2.609964262477407,0.23094258250682362,3.402955143680095,3.7131539555504407,2.077582727909977,0.5148879498749749,0.35243604359650726,0.5438012393466076,0.3042364502148604,0.40228092619496997,0.4381398851445147,0.39658630751806007,0.43004047442626664,0.31965300485576836,0.478873777823744,4.762019088746738,2.1959602183902485,0.41815079474837785,0.2505346471010356,0.2541674453866185,0.41006984910086414,1.2038228143432206,0.3633358010524993,5.223419531047328,1.9198014382836948,5.134771305722335,1.170031078270974,0.29727507162451194,0.5321300941258128,0.85473019393383,0.5902447795658324,0.7425721814663905,0.24113154005577248,0.354383582231383,0.36003100326553,0.3366256432467935,0.35297142303061024,0.3200500698298764,0.34397705881872254,0.3642772375666871,0.3379233736663542,0.5853869906402654,0.41903290776624846,0.4594094007429533,0.3071636880637101,0.3819222718692148,0.47648114080649123,0.45558406993607625,0.6819362229816547,0.5465648802411304,1.041051356714581,0.5760222558049853,0.6314874654256526,0.3984649906709648,4.9008932126151326,2.6218020045770354,0.3815699271792039,4.739506319525484,0.4640813703344336,4.874619351692835,0.7247008467388723,0.25015590349949035,0.9813154886383979,4.68269145510608,4.166048484564712,3.1230675828705596,0.5721823598613286,6.097054183764269,0.7644026609828218,4.324508914531967,1.4408290963129153,0.4894343888880794,0.3660176511434337,1.960960621160837,0.6636652400532044,0.7011276062228958,0.7882918837941235,0.26503140776334505,0.22313516556601565,0.19624488361280715,1.1784421688581475,0.5669392347369394,0.972319766138022,0.7757289085749759,0.49406579581996946,0.6638681254783734,5.4370625042084875,6.127551135809872,4.588350647351941,3.859920076947914,3.461070050711759,6.104301656791691,4.4849999680526995,2.4580894397383863,5.463391564895217,1.185155668695034,6.123293687601103,1.3857492196899739,0.5741878138038801,0.6767881638285754,0.37828888575568553,1.7724723898010484,1.383080849306404,2.2921251034228622,0.37084681503436295,0.5864776793251762,0.6086230689508753,0.4834203610131349,0.31868306111621736,0.36993722761298603,0.3772821773604558,0.24258921925909352,0.5652725660214407,0.4456876099932408,0.45401419096736617,0.5952516158932263,0.43510014825567894,0.6324476430008107,0.732578412436943,0.8562775632791195,0.5655101477238652,2.384384573939381,1.8034682396767399,1.4465362153794412,3.0102887295734417,1.4961281121423409,1.54249464643076,3.101634605046303,0.5845749581621885,1.790900496638989,0.5312090993811417,0.731866682990012,2.2325772043085297,5.879487677178202,1.5096439145551555,5.862075497697926,0.342999941324778,2.9093322371266193,3.008463361903353,0.9249865369548349,1.5906206619236627,2.0296924401916816,2.404500293439153,5.308342430617745,0.46111248450537723,0.23297774655104359,0.32181472009559936,1.466633308648462,0.4863750863258879,0.7612365313405313,1.8174442182418844,0.8197013337514927,0.8795717026645957,0.9822583811543294,4.681510383901453,0.42664788696367606,0.5598357531462512,0.3534049193515738,0.603672032756901,0.41850395448363725,0.3097733135650608,0.9645642459920936,0.6345352325559693,0.34018347895272255,0.22480570519857013,0.27330590731276316)
rate_lwr=c(0.015510568207332126, 0.002620578270640661,0.005969040170738599,0.014654477002215928,0.0290864869487808,0.05005417744328766,0.2492152081920739,0.01319194681052932,0.2309653331005962,0.11946518632000308,0.002075503543725765,0.036943502997527466,0.08142609441527698,0.036316918393444086,0.005900045594120967,0.007907826669091955,0.0030231111926801307,0.002597522627234776,0.03316134768975609,0.054692943444245745,0.016220823123768824,0.00778770883143641,0.010908845627134928,0.03883631783341718,1.4910760987749334,0.013405669382622332,0.004893264073203153,0.007226613003175064,0.0011005460074592702,0.003441558733105657,0.06102876283484132,0.0303624578882577,1.5223045537212776,0.06645936910752065,1.547745234027859,0.02761708304021218,0.0005798470100090089,0.0012082067130227553,0.018120820927991443,0.010268207297944365,0.020553773676395215,0.019765165283005055,0.08681455560960039,0.0015702950966647172,0.015583139361641074,0.08806645332492655,0.06619462223978723,0.08553052584315782,0.026134043264178702,0.10072950487338045,0.013033488889992895,0.07517874128164584,0.07594765178796234,0.07197049834381614,0.08158668063955096,0.08074998689553006,0.004094384042524546,0.0251825572063204,0.005380251300889705,0.01574980797507436,0.006158476217680835,0.002910668173600653,0.012471276950874577,1.3009645243521364,0.1572197438621433,0.011707583640519562,1.1985840583293674,0.011510059429095137,1.5212175451107857,0.002781359617084346,0.0033080873738592503,0.04012207752150962,0.1267294170367821,0.6816417247462879,0.007646436258112954,0.0010541645335993763,3.2245391699190193,0.012027259342824115,0.6960180456655637,0.0802305248014007,0.0045240514629474315,0.012205368061441957,0.07294804934572285,0.022807096427991363,0.022246052817337353,0.007192018250398391,0.020822783342841857,0.009376756295615074,0.0072549770045992334,0.002259474432313169,0.0022862608255960273,0.002352994929932517,0.00922929797855418,0.0017130997812139573,0.0009451495679139235,2.3995399044778205,3.1462044395270485,1.1938548058728475,0.22697140509024782,0.2719973665563387,2.893433465147757,1.1904559977097833,0.07370855798391629,2.523492915817921,0.07983904577704459,3.150702299036923,0.003024880169822268,0.04510814079808545,0.05658202124938205,0.00703021282577615,0.003762534634123814,0.0030732374075568766,0.10681069774668189,0.00591605417746989,0.038697139595965324,0.03848133452977853,0.0057629653396766775,0.011638335641162567,0.006235770212229201,0.004637091565861895,0.006066901240204835,0.0043010527890830486,0.02325651046664154,0.024209017778366024,0.005404872451130721,0.005607552361874879,0.014360707202383041,0.015129607661584707,0.008940718687455156,0.021093472874296013,0.09438536866790839,0.00212114399701039,0.05337694365528853,0.3912607305917322,0.0014302207181908222,0.08932055087015153,0.38896509158961423,0.008695499721473265,0.16035859708933953,0.008271183076821398,0.02577567542173516,0.10415770720884854,2.9183530625124536,0.13811752245860714,2.929561802312416,0.011433515389958626,0.12510851847095764,0.160829613699344,0.036021687947707076,0.09964826005129895,0.12279374737219315,0.19735471671705906,2.0873785008631214,0.009319447237720435,0.019404762496996353,0.022041843149359447,0.050144622451815224,0.02023633751026936,0.008990858446776578,0.01177309038960711,0.030107449568382794,0.038172467733234086,0.0022797912587595795,1.3716978467545125,0.004094578361657705,0.01954117851902981,0.01227359824719132,0.07730923078746504,0.01868884531442838,0.049711578503199294,0.017551155447346006,0.008082795566581369,0.0007028901222078596,0.008723913251361237,0.0020272287164834826)
rate_upr=c(0.8260427396866911, 2.994288460525465,2.158130045122642,2.9985106620544433,7.159949262885803,7.192223405515668,6.826148620700579,0.5902364431894269,6.937627545968893,5.816066544530647,0.5333042307892311,7.207850543001446,6.564266056808584,6.165361698061191,1.8152713742689635,1.1782378777676858,2.0731798863151227,0.9078329132894438,0.9827185801372429,1.2621809615945512,1.0991647917762077,1.3447344564707364,0.8502712569887415,1.3502793602744432,8.047467314168653,4.922368442982437,1.536678992852145,0.7037817065356238,0.6496882456032478,1.499305766438006,3.8154141757587183,0.8587152208035878,8.134125911660625,5.34878720170669,8.349846872786415,4.087220880522146,0.8584449695470626,1.641612273390612,2.4177211684748685,1.910822528933632,2.0613064441426534,0.560129914846679,0.7876675172400605,0.9368203502255867,0.8092806751538607,0.6741261933778127,0.6988771844640717,0.7743596177556552,0.9745514778938904,0.72649393245807,2.054993529060572,0.9084779498791351,1.1091113105273378,0.6546945833132023,0.7355089938474451,1.1437739617882015,1.7484677212218278,2.2483397786557386,1.6624659334525909,3.550949044772715,1.7576164336406972,2.4724231843736617,1.0388191003158844,8.175619006228876,7.307771329465146,0.9573362627038162,8.076621111429816,1.4027860595738075,8.48569411010353,3.781791767822997,0.6164941678921707,3.288774324289353,8.203551585006787,7.2513381602837885,8.019601074760624,2.145700274343355,9.607533890596729,2.457087311975602,7.555175955800579,4.257324342786871,1.7496157929862994,0.8969563638186004,6.2864522234443365,1.8629958148506998,1.9328846194444522,2.455193053589795,0.595222223413969,0.5393357877848436,0.47770706724557305,3.341752464727765,1.7896453264315524,2.9593519245202904,2.5178644566420116,1.8479482410447918,2.4572226354919002,8.843619521302564,9.373693949289716,7.786935825958707,6.6184320521048985,7.405336672465407,9.310379675929351,7.709607171835529,7.2517238975266505,8.862444843646207,3.8170169872855464,9.618813843206647,3.559434947602986,1.8034166399065161,1.9587528292465715,1.0190035241355975,4.077932693142827,3.5821029362574017,5.332865420952422,0.9266419320406347,1.8820868174344807,1.9999122805571052,1.2549302974739387,0.6827785557083682,1.345574751961783,1.6386091950095143,0.7394838798346683,2.0574386833761165,1.2690197464680415,1.4263103265544945,2.150007580762329,1.2329316483867319,1.8270208133507555,2.2353672243120477,2.762530830695068,2.076437422442009,5.306057336792851,4.326148632759033,3.5875210786032397,5.808111094259658,3.989338363475338,3.7936551840314157,5.737576843588496,2.7179099028657188,4.298856696823909,1.7155785379046773,2.481511160051862,5.192911210360245,9.064923833960755,4.167860632510641,9.065179418832278,0.8240165792546669,6.267657630123637,8.142298620242492,3.5466761082795557,4.165052591010225,4.463079330787977,5.78537425795872,8.967165586074588,1.7628559398477601,0.5259000620247551,0.7363833135426212,4.3663058148010645,1.3789995681425777,2.2463556848153416,5.193518327052423,2.7306261799468663,2.3835289059909117,2.790299841502473,8.03270133739957,1.1368657465903174,1.6388632313558724,0.9889742849855025,1.818877939196125,1.2392958453587684,0.5979957553862522,3.2441737491058142,1.8491698046501006,1.0896749775380137,0.4655772056990801,0.6469854593638369)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Grassland')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 9)
feat_states = vector(mode = 'list', length = 9)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(1.0, 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,8.193996520752748,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,11.45516312611962,18.316996330471802,13.644381033687072,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.505765520098972,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.883919453129167,11.610334918074667,9.991905577866738,18.464662994362794,19.511662974682444,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,12.762457973341409,14.827255655327345,13.78444086011421,11.841227221426918,12.479304132509975,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.318996330434206,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.109881006140222,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,16.211996370039262,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,13.644381033687072,15.307996387031654,11.451546459520934,9.062465735197444,10.647178292822375,22.62499624949477,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,8.672663178421974,19.709996304287746,7.629996531354187,11.754396453828296,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,19.336662977971898,8.396996516936989,11.45516312611962,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.058496485705948,14.172329741711991,17.899611722932722,22.62499624949477,21.1276885853318,12.586611822800617,9.906796488557434,23.096662907295563,6.560946551449007,6.758613214400147,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.0, 0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,2.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(-0.060863185459783524, -0.07320681727606418,-0.07654386546924914,-0.07652082005947258,0.06015277042745709,0.060532182241244376,0.061341608771550586,0.05883647335204316,0.06049601822232392,0.06016221345052785,0.06139460454800628,0.06039206126448981,0.06138903518756381,0.06152098398073222,-0.07209824586668517,-0.0692286313488707,-0.06910948281423698,-0.0716111811132948,-0.06192029879561728,-0.06131933579919249,-0.06132797715378947,-0.061467269015912596,-0.06136291441456187,-0.06170344241304459,-0.08893380195546502,-0.07976016902898853,-0.07955792294167464,-0.07894364089016817,-0.0793768336540073,-0.07995504658237998,0.09788447786700531,0.09593808752730786,0.09868807414607648,0.09872658084077487,0.09885123463650916,0.09634769055247272,-0.06485853892007641,-0.059571627119713685,-0.08115495325971353,-0.08203987634577908,-0.08238017286631427,0.02281304271634878,0.00922919091556472,-0.04557356707020526,0.036850806214743716,0.022854666172270697,0.009642813194151126,0.006766637181752045,0.022846738225624524,0.02274458962682088,0.03967907917964768,0.04112748739955508,0.03044636485502582,0.020459765889077247,0.030591194068119623,0.03349572152430172,-0.057577416528390754,-0.07691422929805913,-0.07689361555560549,-0.07715538593628532,-0.07671325810181971,-0.06071069314928286,0.09719790264756585,0.1024903284765878,0.10184980688164574,0.09744977975872951,0.1024903284765878,0.09961632655428462,-0.07051088980067635,-0.07035778570750403,-0.07040093643125918,0.09753675648182462,0.10043582143234493,0.09924740092506265,0.10047138144545428,0.09865611952126656,0.09930482795080886,0.09877558705182875,0.10044584016482089,0.1003371480378836,0.09825129929205635,0.0973277919378257,0.10037015111630278,-0.07811555890718311,-0.07814236227038877,-0.0780944101049448,-0.06804272423989652,-0.06804891569395757,-0.06811022509021272,-0.06937270206264275,-0.06900546752659746,-0.06903601803835066,-0.06901883443329221,-0.06888269886928479,-0.06955655425542555,0.10377339315321796,0.10376335757268948,0.10357606179229592,0.10324774653863109,0.10254054575470513,0.1038262327082655,0.10381266104753684,0.10309915537312586,0.10269556488843283,0.10239488734609858,0.10336390163993132,-0.06345016863189173,0.07334882521558612,0.07360631131333437,0.039880200479503636,-0.06372005944857374,-0.06328242704877315,0.09653296763313603,-0.07171735264158438,-0.07227445748588511,-0.07229387196351592,-0.07248434364707335,0.08108191417615905,-0.07520864461440253,-0.07472620452451097,-0.07485040424751142,-0.06813985969469906,-0.07352821565751647,-0.07359220858430278,-0.07372851767374744,-0.0738351768554105,-0.087276488720033,-0.08660305925208747,-0.06941424541511598,-0.06852907326841812,-0.08969812819891594,-0.0889731887948055,-0.08876398257860355,-0.0898752883469872,-0.08654924136005515,-0.08869648644233902,-0.08979744912076075,0.08502655429178078,0.052539998161508575,0.05289708029519542,0.05283909848981707,0.05429048430326612,0.05360745180480962,0.053546907927808855,0.05291816156967441,0.05225785440957535,0.05416549783779726,0.05355615841765843,0.05363955484110082,0.05358555599967036,0.05294361831068787,0.054313435590982576,0.05406580720860015,0.0523196730287991,0.04161979671927976,0.04210841979005076,0.04283199701354932,0.0417588027735061,0.04209656800408915,0.04219929731322723,0.09518983668683834,-0.08919652356918684,-0.08900895996880458,-0.08911434585720078,-0.08906317033427286,0.07894341555887924,0.07889626640009026,0.04593599291822851,0.045599283684789355,0.0458205989369061,-0.07284491389831149,-0.07324876953223632,-0.06793447546166657,-0.06830321244694354,-0.06793199529150755)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(0.034620240719060696, 0.07018066553476546,0.07851358038821489,0.07845636517082558,-6.167341075193274e-05,-6.262083223544907e-05,-6.471432891868839e-05,-5.830386317980783e-05,-6.253144808346305e-05,-6.166835546199483e-05,-6.4849532271481e-05,-6.227005165508582e-05,-6.483454330533377e-05,-6.517380366706965e-05,0.06737363908527713,0.0606514279752381,0.057759536485988285,0.06502798928250261,0.036106803052464595,0.035255759952427274,0.03527133955528856,0.035462104086826894,0.035318271238312826,0.0357980902047288,-0.2056659901999113,0.08600437831751899,0.08547627868190653,0.08387471459620251,0.08500358679432672,0.08651676274447062,-0.012483851183276573,-0.011873599924562725,-0.012734963680520394,-0.012747015315138133,-0.012786004406633729,-0.012000245543109881,0.04416504926235904,0.03621550323622673,-0.16230111118674165,-0.16701843082999865,-0.16870448128367338,0.006828998350612858,0.008069949940462506,0.012746700302059922,0.005042298155076051,0.006859270217647012,0.008016582470091555,0.008247958694016962,0.006853527356061129,0.006779378811098141,0.004724679064291644,0.004577821105504386,0.005859675877131444,0.006893384568341854,0.0059276272109553595,0.005491737178147441,0.031098016462933777,0.07945235732361826,0.07939985681609889,0.08005825101738794,0.07894968380533571,0.03672586524087544,-0.01230211986736821,-0.01407244833485813,-0.013859629765493405,-0.012389505999393393,-0.014072448334858056,-0.013113098295605015,0.05453714116290661,0.054249959611672074,0.05433050723981216,-0.01237694123541558,-0.01330511197498338,-0.012918259178816326,-0.013316507243567817,-0.012731813217488374,-0.012936388306316243,-0.01276962329866271,-0.013308279722953896,-0.013273443805182878,-0.01260334904506987,-0.012312529993346056,-0.013284019241828348,-0.14524385197812298,-0.1453644722716534,-0.14514778542901705,0.049917636760106146,0.04992867037788673,0.050037732121498535,0.058238983162757725,0.05749223228536907,0.057553834099129605,0.057519188281604475,0.05726525246554128,0.05867293694307973,-0.014509533066124115,-0.014506116608304009,-0.014442700547482003,-0.014331466870631852,-0.01409126090783217,-0.014527415829414416,-0.014522814384805518,-0.01428147873762967,-0.014144531489181801,-0.01404284875711349,-0.014370566621944865,0.04521048008316533,-0.004670108797673014,-0.004709958318709218,0.004783084392809557,0.045500807993421113,0.04474376168900925,-0.012057797527212812,0.06651243888297399,0.06777849667943808,0.06782274162680664,0.0682566150319257,-0.007093538488054757,0.0739956454710229,0.07284839249303436,0.07314301533539619,0.05809863624502365,0.07097779662735107,0.0711655125850771,0.07145790907598504,0.07170837666044141,-0.1962625086988851,-0.1925993930146172,0.06094203816965531,0.050782363908818164,-0.2101194127013782,-0.20599903567380803,-0.20480311441779925,-0.21112657434301718,-0.19225770214983773,-0.20442620060289005,-0.21068444030268993,-0.008354608561954701,0.009777015930329395,0.00994198023859823,0.009915478731409558,0.010602961914556959,0.010279101144112127,0.010251075731703849,0.00995157228726274,0.009650262437008958,0.010543763884224028,0.010255364949980356,0.010294040669512125,0.010269918341355216,0.009963220718771917,0.010613808167261386,0.010496763676417055,0.009677797470914276,0.004761566773114628,0.00494688024881923,0.005188106213538598,0.004788069302060459,0.004972731204726929,0.004958530489560858,-0.011631609091310965,-0.207145140623968,-0.2060918219305312,-0.20668293569451335,-0.20639581093063813,-0.0063713920575913605,-0.006362191794353129,0.0036278901868327692,0.0035635376171133768,0.003605852761019194,0.06911638993328466,0.07005015441191663,0.049714927750539956,0.05037279053198539,0.04971053809563197)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
tmp=c(9.43827190343214, 14.895429116510035,4.466628677334144,6.289681196931176,2.190063092659079,1.2905371785737632,1.2905371785737632,6.289681196931176,1.2905371785737632,3.090089021149111,6.289681196931176,2.190063092659079,1.2905371785737632,2.190063092659079,14.895429116510035,9.43827190343214,31.00089309243445,25.56573651316409,9.43827190343214,14.895429116510035,9.43827190343214,14.895429116510035,9.43827190343214,4.466628677334144,0.005850168535185211,1.2905371785737632,6.289681196931176,14.895429116510035,12.725366600039624,6.289681196931176,1.2905371785737632,3.090089021149111,0.06885198352948747,0.45351306507803296,0.005850168535185211,1.2905371785737632,18.20552447573449,25.56573651316409,9.43827190343214,9.43827190343214,9.43827190343214,9.43827190343214,18.20552447573449,21.735626173034284,12.725366600039624,12.725366600039624,18.20552447573449,18.20552447573449,14.895429116510035,14.895429116510035,9.43827190343214,9.43827190343214,9.43827190343214,18.20552447573449,9.43827190343214,6.289681196931176,25.56573651316409,6.289681196931176,6.289681196931176,6.289681196931176,9.43827190343214,25.56573651316409,2.190063092659079,0.005850168535185211,0.45351306507803296,4.466628677334144,0.005850168535185211,2.190063092659079,0.005850168535185211,2.190063092659079,4.466628677334144,2.190063092659079,0.005850168535185211,0.45351306507803296,0.06885198352948747,2.190063092659079,0.06885198352948747,0.45351306507803296,0.005850168535185211,0.45351306507803296,2.190063092659079,4.466628677334144,0.45351306507803296,12.725366600039624,12.725366600039624,9.43827190343214,6.289681196931176,18.20552447573449,9.43827190343214,31.00089309243445,36.35859194025574,31.00089309243445,31.00089309243445,36.35859194025574,31.00089309243445,0.06885198352948747,0.06885198352948747,0.45351306507803296,1.2905371785737632,0.06885198352948747,0.06885198352948747,0.45351306507803296,0.45351306507803296,0.06885198352948747,0.45351306507803296,0.06885198352948747,31.00089309243445,6.289681196931176,6.289681196931176,9.43827190343214,25.56573651316409,31.00089309243445,1.2905371785737632,18.20552447573449,9.43827190343214,9.43827190343214,12.725366600039624,3.090089021149111,9.43827190343214,9.43827190343214,9.43827190343214,18.20552447573449,14.895429116510035,9.43827190343214,12.725366600039624,14.895429116510035,2.190063092659079,1.2905371785737632,9.43827190343214,6.289681196931176,1.2905371785737632,3.090089021149111,4.466628677334144,1.2905371785737632,6.289681196931176,4.466628677334144,1.2905371785737632,4.466628677334144,1.2905371785737632,2.190063092659079,2.190063092659079,0.45351306507803296,0.06885198352948747,1.2905371785737632,0.06885198352948747,3.090089021149111,1.2905371785737632,0.45351306507803296,1.2905371785737632,1.2905371785737632,1.2905371785737632,0.45351306507803296,0.06885198352948747,3.090089021149111,18.20552447573449,9.43827190343214,1.2905371785737632,14.895429116510035,14.895429116510035,2.190063092659079,3.090089021149111,0.45351306507803296,1.2905371785737632,0.005850168535185211,1.2905371785737632,4.466628677334144,6.289681196931176,9.43827190343214,6.289681196931176,9.43827190343214,9.43827190343214,6.289681196931176,18.20552447573449,12.725366600039624,6.289681196931176)
feat[[9]] = tmp[ord]
feat_states[[9]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()