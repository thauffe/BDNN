pdf(file='/home/ubuntu/BDNN/Proboscidea/PyRate_analyses/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_2_reg_G_BDS_BDNN_16_8TVc_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates, na.rm = TRUE), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 5.0,2.0,4.0,3.0,6.0,1.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.01201420592012688, 0.07307028496011793,0.11912318950913253,0.1297752174831858,0.16819065987672238,0.05472415041158208,0.0869805593493282,0.06409537156441877,0.05351460131398661,0.23273006292118753,0.031086860938249913,0.08165149497432467,0.05350827060291885,0.0729958908070692,-0.10854744089238126,-0.06995797228862105,-0.4231090331585183,-0.304335476101568,-0.057625945281098885,0.1678113020651383,-0.19023500650994823,0.0333247118484971,0.0140889490549478,-0.04529773951856214,0.19534361367795103,-0.2103242070168875,-0.253199064908623,-0.25084604900511853,-0.23460130893937994,-0.20612669885231208,0.48016195018432867,0.3451828182209582,0.5560492251492937,0.49868285392130746,0.5204531370454213,0.2647543003960608,-0.1456118160404213,-0.09084666582338852,0.10115677471368281,0.25593805747689785,0.22601395159881188,-0.041514505008391975,0.0018065475823569653,-0.08106682818630631,-0.008995382597088198,-0.050344009398410175,-0.025242150761758526,0.006617667404006502,-0.10608742103025617,-0.005951211196577197,0.014209067153829094,-0.06092436659661303,-0.04623335025489035,-0.01672236910050388,-0.07554587070528467,-0.06560095113416023,0.20863476656001703,0.09482087015749034,0.1408860881424469,0.13355426695150294,0.08499928787642586,-0.3190077477471444,0.3256182251726269,0.3192928702427605,0.43747332553656565,0.31402577499970785,0.3090255096901187,0.3154554924639101,-0.027305955139484764,-0.06793981241432857,-0.11006832581780192,0.37130974258583316,0.5241754973181156,0.8047227878515096,0.8101359822743955,0.4853663060937763,0.8529844620146065,0.31375750991746965,0.38013702805565075,0.4340445843082312,0.46116659464826154,0.3342570444686006,0.5005101338099747,0.16005708881654857,0.07105218702195491,0.11392710159065539,-0.0914452129598858,-0.02216688375025201,-0.062409403684657264,-0.37430527617148235,-0.3974683899044488,-0.39786735364566345,-0.3853570223652848,-0.40844543877697614,-0.41046910616856896,0.5724185129425792,0.8136998902276498,0.7172093024264963,0.8550897587825975,0.4793418609850628,0.8167514521852961,0.8592431979356486,0.5763293563640812,0.5380046509116063,0.5037303997650155,0.7689969916237805,-0.22934812715566327,-0.044313866241807956,-0.05123130122458476,0.07926442909835771,-0.2138434431173755,-0.22737188610508144,0.38164701652345434,0.027187493646283808,-0.0024494090017102414,0.020064828106242556,-0.023897424419138467,0.31096963377617093,-0.3100726077077413,-0.3233400280954972,-0.3785985157631646,-0.0380107618934956,-0.013054744523855863,0.053359443974642394,-0.036066440934312015,0.015926894603298474,0.010971014770752583,0.04006218953526481,0.1145934349107679,0.16557429097994336,0.1163931575785988,0.011504563273715416,0.07633994972207976,0.13796928834893743,0.03994470284769202,0.09251217019337327,0.12559491505490908,0.32674989159278,0.25456030552474834,0.2622941101265853,0.30043745605397004,0.3788719464954766,0.2867069663735126,0.2341506541822704,0.30592573623232344,0.23971536293202414,0.39763302157489533,0.2767059794815756,0.24903254711679085,0.3681324161856506,0.3592698075137083,0.3581146182654621,0.38823292782648866,0.36043019599994247,0.3398553172473427,0.17531903572651125,0.21506713523503368,0.2015919288390242,0.32674143136305767,0.24670667832859836,0.5089863889727865,0.21424782218513072,0.1775288792251955,0.23721002600828858,0.20427212719582574,0.1353335337074374,0.11059898849008659,0.0773462575859566,-0.04287881179781222,-0.03077514226863036,0.09238002946730402,0.08978892927143277,-0.06657836558547442,-0.09825215893853455,-0.1005316612509081)
shap_list[[2]]=c(-0.02590069610232163, 0.013893943845646461,-0.04339049326018526,-0.03670658196443035,0.013999870793330135,-0.015761951335803596,0.010459447245290545,-0.006883127772645366,0.002293503745838302,0.09004924063754413,-0.001483851490230444,-0.009056876955122787,-0.01228820225706509,0.0023712952308872896,0.021717844927122934,-0.0133292765949895,0.010064325867660026,0.013960241949973815,0.012933096570535024,0.07993785912313377,0.0027357356371387888,0.07251974505683642,-0.027879999853521874,0.03663016757606182,0.01963637515237683,0.031184681887333206,0.05124737433967925,0.06584462975669439,0.03185338345951291,0.029205455548007905,0.006848987382634706,-0.007113454953331545,0.03390573441165755,0.019136797522434478,0.03626352481319579,0.00891466621499208,0.013698115659926915,0.041297864321483885,0.022186139347285427,0.03929863830828506,0.014566704172754491,-0.007124550563659988,0.043025980324923954,-0.015446669270533763,0.015375207052426154,0.007024579036144027,0.02098734072737652,0.04130528451710436,0.005095529619892084,0.03559439621130284,-0.037177956099807924,0.00021089203105528615,0.016258771519481213,0.03321582018659447,-0.003519505087005306,-0.0008902202057570436,0.08363865938707492,-0.028463923141136042,-0.032735940555303975,0.023698568103292655,-0.007519600653644719,-0.010401620206087972,-0.004462158259069754,-0.003797425049682523,0.0036596426765257055,-0.0019160672230765857,-0.003790822808750901,-0.007891379323828038,0.0247846103342789,0.04405465553496721,0.03217858976142137,-0.0033622372368461023,0.10671917025692292,0.11858686045781765,0.15829160653706942,0.04727322957713064,0.14617000587651438,0.022771291727853187,0.06423788591139211,0.04147310652399581,0.03420177585446458,-0.000539563377547666,0.05478899831111633,0.0529741056776564,0.011999490591395361,0.04347945480655251,0.003846890653119524,-0.008869322761354721,0.001854044132338533,-0.004160875006740367,-0.0026581117612484687,-0.002668812842865372,-0.007490298950630935,0.05444696474873676,0.03455720288821359,0.0597804865449709,0.1404073974674418,0.14881501708045958,0.1207042980337019,0.009722422862076042,0.1386145900746814,0.1497303025595936,0.05177330746783993,0.0522932278615769,0.012724833370382386,0.13891688786023512,0.07053649270363536,0.006241302056667005,0.002741235635108332,-0.01832219479570569,0.04428899762458887,0.06346180556819768,0.02369741394682775,-0.018302527727509916,-0.025890401067175817,-0.019873694318057883,-0.035793653218589676,-0.005144578698818273,0.0012616491392090706,0.007548766708024905,0.010313983881291358,-0.009025543027722073,-0.02538764661187632,-0.01964538648592965,-0.008874879532933559,-0.023501310505310027,-0.00837127560420079,-0.012493596269056459,-0.0024033169220625678,0.06822339745439944,0.05808175704220873,0.06972721649702507,0.07479545344665899,0.06787182137731214,0.08532660584396318,0.07900562716705394,0.06398005531794464,0.06274968343206164,0.00741554532362421,0.008052034002940118,-0.00397060562778239,0.017802116347627798,0.009541070195819564,0.004503032991527446,0.011945197810328309,-0.0053420322302439455,0.03328387077554941,0.008488612092307857,0.003533604254094001,0.019515361169380258,0.021091463887855013,0.020384450933733665,0.01674022848946546,0.021718158423320963,0.03186882013925626,0.0025478041952566996,0.043458694692371076,0.034570379786280296,0.017704625856939084,0.012204515711312315,0.05164991054164255,0.014109618129359486,0.015841020699659748,0.02442907645348692,0.016774519112000737,0.04753886160106302,0.024082484463004424,0.03909478892839054,-0.0028201199967725927,0.01489741676543401,0.01239632025951588,-0.026545787794386804,0.05454612787411141,-0.007605611522040659,-0.007238263359514132)
shap_list[[3]]=c(-0.08841172913524943, -0.03360466333481215,0.17947602977889515,0.1831456016811406,0.04658475994474686,0.0025469812576407245,-0.05434561942821057,0.018844530725239485,-0.056172156680858946,1.0208909524893524,-0.05289240790685415,0.013900685542207806,0.00398595746833124,-0.05887490698508252,0.04277352137908471,-0.19945531935610486,-0.023039624210252418,-0.02742998965249717,0.014726883576285087,0.1512268571712135,0.03870748463117975,0.10714960948897077,-0.08262549924802408,0.04056111431995573,0.08775228628958331,-0.02095860556687339,0.03818390201305129,0.04546173968799961,0.02808404061804139,0.02042961722220317,-0.04652334445685547,-0.07211619155065677,0.04598486986353764,0.09374668153460021,0.04014134050707266,-0.22398232369386104,-0.04715820542176769,-0.026195936851384962,0.19953838338592714,0.1965971605980055,0.12173004468083737,-0.17972653643396957,0.09258710785844143,-0.08765667307300197,0.054260505918387845,0.03971635566575383,0.06636280036542344,0.09400618916072927,0.030799437494930526,0.08408407786861899,0.11656440039440287,0.02586691143434967,0.06211613441320338,0.0805587044244209,0.02284183529793078,0.026042795846534093,0.18731899074756606,0.030698498561526247,0.19196580202875968,0.001289257256889542,0.03372436155525869,-0.01861065087307942,-0.07129211233858682,-0.06986797663283718,-0.05607700167564855,-0.06094233028734939,-0.06851621526191846,-0.07532949709583918,0.13745749142190294,-0.10305206990879794,-0.0900418174346054,-0.06844765118716771,0.274029646360764,1.05484879629644,1.0519716828032004,0.04205152545476747,1.085083710101698,-0.26837329478836425,-0.01991794353245971,0.03140665719230026,0.03958922552899462,-0.05770335747559832,0.040268289034225774,0.3251079173431453,0.18386624963764447,0.3131158961646271,0.055072686272411964,0.07415057297199576,-0.05919024537573097,-0.021463835816245874,-0.026384797694123042,-0.026296892793312626,-0.0281161895778255,-0.011039289630914637,-0.014586123768382404,0.051765859769339506,1.1190887521317405,0.9728393983306376,1.025781772019174,-0.044407646331594636,1.1004479909679785,1.0910374785990244,0.049039687918897075,0.044977073743311745,-0.0360452635731434,1.123291099584846,0.016794764082287937,0.02958399617875233,0.018375338378453145,0.17680333767390552,0.0038498264580967205,0.014828659154515948,0.047026969315227034,0.09782987686050308,0.06802632496974599,0.08993026266507148,0.04346270635063671,-0.06119477965561219,0.025097074046862226,-0.02831266739692007,0.04514152233256591,-0.08344171368293259,0.047969795898363435,0.09749681215188663,-0.05339605810511472,0.05760669027335856,0.06445119384307299,0.06307116500448337,0.20121781757168053,0.11066634118599794,0.15120106658536236,0.14387307629269386,0.18132450409974432,0.18672588196662526,0.14372520161309416,0.1859867449838621,0.18755142334750102,-0.04090217077451415,0.0008532518429113787,0.015767433158437226,0.02645909960636367,0.6722816266048265,0.01620366585139636,-0.00018390539215267797,0.023285842478053046,-0.07113289607467556,0.8146002544137901,0.0057907837427433086,0.004974836427694382,0.6609466837246866,0.6730793637436893,0.6809255256892394,0.6623531405354608,0.027917482395592386,0.08382049577362365,0.04582366070264603,0.11188153503225523,0.1059576521812953,0.6453413044305454,0.0321485192189081,0.6582497359643612,0.024344225619650557,0.018947810175829707,0.07832779045851998,0.030989305002744112,-0.040222761744802896,-0.1937522617,0.06379194661514317,-0.15238651055682914,0.0417328529265759,0.2034723073210763,0.17639736610995913,-0.03559839584597467,0.02017667612139855,0.04328748197365575)
shap_list[[4]]=c(-0.021914038347037784, 0.0696955595379613,0.03995686852728243,0.010709147766974186,0.03024274793378606,-0.05394707490545996,0.029850012055507358,0.00733522041796104,0.025952151795621107,0.11289410862370139,0.025006424808338302,-0.008995307648572502,-0.010438349167210098,0.02376508349507051,0.04224060771616573,0.01845621315901065,0.03868733714057935,0.050606409321731494,-0.022335025540603102,0.10870753007110205,0.031746450076350546,0.08601310698038528,-0.01796947353177351,0.01675134550180451,0.12005619418591444,0.025889511310340944,0.01253097480145782,0.041541055412621895,-0.005833344192025881,-0.021792565853907972,0.003476758178869602,-0.010327390141210011,0.040825555696687645,0.07043645319041109,0.02897788519251583,0.033174196897564,0.04860032398125484,0.028374338024873633,0.023908946000074642,0.1153873217255235,-0.025207062402945447,0.024701522297445277,0.06888829813699986,-0.036468402025386995,0.03898154924937871,0.03459062467306572,0.05405566093001756,0.07662531411065734,0.005935761497060431,0.06724810906009926,-0.08802337106456701,0.005837980943845228,0.05404897347043,0.06672960101167347,0.01566719315535554,0.018652589851284682,0.1194406006892882,0.010578564240661935,0.04823528753515113,0.0414441234569346,0.014171931923612456,0.03226924802967512,-0.011465168626526405,0.010554675800428964,0.008451765215101055,0.012508426820531078,0.01314134241651656,-0.010745806789114744,-0.07359032761596863,0.023029045798543264,0.018126340539613057,-0.0007765269087392807,-0.08646887113126374,0.1905165246791307,0.12923054133342657,0.02276018719085164,0.19776742488992502,0.027555815047747567,-0.026612611164593857,-0.014740534438288709,0.03151831242059486,0.01229638985720003,-0.0009828084788187394,0.12114625592770553,-0.01782346073129095,0.13043013055930106,0.06641477055897277,0.06222149439338336,-0.012798747231170153,0.024445885594098993,0.028680007123240623,0.028511547775400284,0.02958671779066083,0.05474713381204884,0.03758234885932107,0.01791685953565167,0.19886449296431122,0.04178729169005686,0.19098524155999835,0.017019030671858976,0.20200201319437391,0.19969660420956623,0.0288494996213643,0.0116697150294066,0.017799081725252842,0.2026076893272217,0.06485778759530265,0.005831748862639891,-0.013788261386579617,0.06264626084154838,0.04858065261184414,0.058635677013944766,0.04201122085266379,0.07960220438672055,0.05908472973487931,0.07479432963223615,0.04358766664459421,-0.01196211273325292,0.007935750225218904,0.029896202301552592,0.03534979179424764,-0.0068422900292131415,0.04791261400019761,0.06125397664642302,-0.002347378299613347,0.054723242588328135,0.06347572795610522,0.04865806103302414,-0.004645128817464882,0.014145179441713947,0.1303728359874063,-0.0008807887751828338,0.003395853960975743,-0.017143282885748123,0.005802613611165167,-0.010899248488344228,-0.012131101612689757,0.041000520411799975,-0.04619030788313012,0.03361320760066044,0.024278771311563623,-0.07117970712549077,0.03073037561631783,-0.02697775695380393,0.04095027527348049,0.003429468209036095,-0.018274209571009652,-0.008617934476564703,0.0029373683465277523,-0.07427359140100424,-0.06090319613706006,-0.05839736315013855,-0.0830631227571724,0.019313771320602715,0.08020039611765294,0.0367150048858135,0.19315411261189183,0.10459555578725147,0.06749496913909683,0.04338720771419613,-0.10530724957150146,-0.043318277562244274,-0.034111202893179156,0.11193568982794318,0.022710147905804914,0.050197402631146325,0.03875827436778923,0.020782436708603413,0.01920215554059301,0.04521368889570409,-0.0012569611372190092,0.03239351733132817,0.06657869791459659,0.006390183775433463,0.038508483857514826)
shap_list[[5]]=c(-0.02989251182403795, 0.02214905878225713,0.026646248440696834,0.045160559688226645,-0.018737622785091463,-0.01561029580769293,0.03187663527015286,-0.014790745131879866,0.02005552813300825,0.05925051210300341,0.01855890491263596,-0.01676768864248192,-0.006926792932796945,0.01640030766109497,0.01628120380087995,-0.004969768661815723,0.007586679865215031,0.009802371588051665,0.009571796064000005,0.05730587162898198,0.00692011361522466,0.056976430225418165,-0.026931295837542307,0.01925828993312675,0.050017937869909726,0.004486288672511871,0.0136637674214971,0.01925453315433917,0.009367153655438295,0.005705645854007489,0.009300702805219436,0.004091238279786918,0.036579937683233525,0.019760569948930936,0.04284276118235748,0.017721629372815163,0.0162706604256523,0.026976039008585313,0.05943328193601675,0.07287456674859145,0.05119648739589218,-0.017594674292214296,-0.03480179434666882,-0.022366644344786205,-0.0451325867870149,-0.048598191484603336,-0.044177346665306726,-0.028925509540357122,-0.034707511722481925,-0.041809536738523834,-0.04174464626100241,-0.030276029518567962,-0.04523161770149161,-0.04041027779122244,-0.03769046051999498,-0.04382171895021227,0.13240728954601202,-0.0016366286324173624,0.03003239538248946,0.027439100426370728,0.007278639661438929,0.0015161096414645098,0.0013573956916666239,0.008506806828746884,0.009190606176252024,0.007997713733653723,0.009003859579007527,0.0044132881062877065,0.006464169502533444,0.01778394883866169,0.01276241599772084,0.006665826211963255,0.106826685266268,0.17558678867955152,0.20585813400589648,0.060954899129567815,0.1994583976923037,0.03599340513218184,0.0744352217244015,0.0588132187003182,0.046032293713078556,0.012293408643533586,0.06970818370724147,0.08392956990793998,0.048563062747496014,0.07277333063799152,0.03594506384738818,0.04804003963719503,0.011213855253063804,0.00850389794550115,0.011021657593038366,0.011064730038563838,0.011147301718063003,0.015550264043351606,0.007569495715379592,0.07360477599372808,0.18160413308242201,0.19023984442265537,0.180363294423476,0.011088252355455703,0.18779506831962775,0.20168603844009286,0.06118418665169647,0.06487722133394257,0.013027947944272316,0.18580959186939497,0.04742920615073251,0.02771682947980882,0.02676288763301724,-0.009199993237633498,0.02699003426706144,0.042043492700806734,0.024981050564518464,0.01772484100263058,0.004428899046990721,0.014694983479387224,-0.006180850849405807,0.009380643098690026,0.005337583044267757,0.006119534322610864,0.0139334115126385,-0.015013187920940063,-0.0015470073543553274,0.026009744487380745,-0.014698394249505876,0.001990809324799854,0.026519449733756025,0.030304208211766322,0.06407179458222148,0.09937533300046278,0.10207467622005913,0.08521232119444015,0.10319263655652988,0.10646066717317385,0.09399816461397405,0.10636980480178118,0.10512187926250123,0.04059051910789261,-0.03252070813312147,-0.023123692250378955,-0.025804493382259687,0.017008558930173185,-0.022923582659839136,-0.031713839983440656,-0.02064704883965415,-0.009470705820206487,0.025646095424806514,-0.028207544738627213,-0.028100030287545815,0.019741646467196398,0.01909651833279937,0.017702859666177243,0.01803318651025745,-0.016660916954398353,-0.024283129664400056,-0.027819817718253155,0.027122586318648965,0.014893563280007734,0.01052244192893346,-0.04002429275130408,0.028803896568997758,0.029443066554406365,0.029678719810707462,0.05046215644223727,0.0359137850098043,0.035949901955366306,0.03717773456607458,0.04172988513936966,0.013038975653192498,0.00994561887273936,0.07532662048328527,0.03085769672005023,0.031035821373382223,0.011187728873536638,0.024952441724557694)
shap_list[[6]]=c(-0.02109217726754141, -0.004884296210751022,0.009920155978318121,0.019278265278021723,-0.0013261492488683062,-0.018934046813919185,-0.0024059797360456658,-0.015544704948530415,-0.008366032581759199,0.09068751528572583,-0.009320708804581421,-0.016616920975706113,-0.019782575372981843,-0.008432679810408916,-0.022917052930125657,-0.02262979397841541,0.0016410252766263108,0.011986927337474666,-0.02372293303599608,0.00649729942847595,-0.024578450220581315,-0.008301372045008774,-0.0226769131775195,-0.02104006899634714,0.0743657694599429,0.011028000666140502,0.04265898423609373,0.04513951057687078,0.03449918997163468,0.026311108113705857,0.018245805094212635,0.005378480392948878,0.02638305324449051,0.02099479095040046,0.02418224899507103,-0.003254953849015292,0.014517889461641984,0.07322619084865065,0.04865370216654687,0.09440515611377513,0.03381175464706476,-0.018920835971470474,-0.008025148956562547,-0.030636226403292895,-0.020740495345188927,-0.02340087050579234,-0.018765657012582395,-0.01078360250348903,-0.021792625863180544,-0.009466423723659696,0.010407074619254875,-0.02185502151649751,-0.013912574855329833,-0.011661926078310637,-0.024749171102512527,-0.024421499223824857,0.047689653303298274,-0.022186854744010918,0.01262484640970069,-0.0029730062481869773,-0.022383027973737646,-0.0019130479677777596,0.004446433180792765,0.0034194185044257412,0.01498113362385406,0.010767846114055287,0.0024079482095389136,0.003178146258747028,0.009788704832318054,0.010862539195957413,0.005329351289379726,0.008464469292438406,0.07880681905588577,0.15281248534670783,0.15118717801511325,0.028166711921015736,0.16230085775991027,0.007111071269907841,0.03559243271329108,0.02312685691791552,0.020885864872416282,0.013569385691045847,0.03238550302431705,0.10622608140901676,0.03045293695397266,0.104954858625257,0.027443395262001978,0.03608778277687945,0.005284146184810953,0.01494380094706547,0.017975274328383445,0.017928973076443235,0.017617063523696422,0.011725931084102288,0.0020883589821123457,0.04039322986725546,0.16050576659105292,0.1314515046196974,0.15376436073128844,0.018875455112467805,0.16025513109864734,0.1638611271704274,0.0358494882635277,0.03389872976589492,0.0238006975911649,0.15987925714494217,0.08005623639426322,-0.012692013828036282,-0.01526386610732712,0.029933021495629174,0.05571631521542661,0.06733054036412782,0.011526976117594984,-0.010203368281276376,-0.017057433566898626,-0.012361971716181738,-0.024058456691808942,0.00948002152183827,0.011690672780516756,0.003914141114492446,0.019225359818514955,-0.02383105362096191,-0.02323734001179293,-0.01685335030265579,-0.023970736654410726,-0.02105035083163805,0.08833184725863949,0.04905083899536908,0.030711819202254798,0.0742763904149334,0.30001023290596174,0.3090476987208399,0.30656865248578724,0.291683728180396,0.31680295330356506,0.306124468697378,0.292134833449104,0.018112972282565327,-0.014819147767445825,-0.012782655791030535,-0.01601215276931683,0.038760235727020136,-0.01175324528757003,-0.016985463736578877,-0.009109123941266475,-0.00510446187127993,0.05129157466420358,-0.013957627736102172,-0.01633160271387595,0.03981638054005423,0.038398397504457886,0.03818555827450947,0.03977605321592601,-0.0017359162356696185,0.007836154560553242,-0.0183391501223842,0.0019412283208722013,-0.0021100395478116075,0.06613147441470485,-0.011805994043287459,0.05751467689317152,0.02146261186851728,0.013527096314694377,0.07253034262054348,0.0016350331608545909,0.007015662432537616,-0.004542626165849285,0.000637840975335276,-0.012874409674350837,-0.011467731106660653,0.033149165919617314,0.012790927304542295,0.030908868171723572,0.0003742151876573665,0.012710092759150218)
shap_list[[7]]=c(0.1832285105314757, 0.10506417689572362,-0.019979124549270134,-0.01876934191754089,0.10958464799548494,-0.09506781283107482,-0.01960053928533795,-0.019549794114792723,-0.07607036735772779,-0.20652146495351048,-0.08882874096639247,-0.03360264714351378,-0.17273085591597975,-0.09289193383578138,0.08531881345633638,0.15868953583391807,0.3971459556603628,0.27484523149153667,-0.03720327732108764,0.3013073218603631,0.17023122405337368,0.17643371815817027,0.08004310576150732,0.05265895395035594,-0.17580748411076605,-0.06314684144688973,0.02728590547386507,-0.010275867282476094,-0.008291469440931476,-0.059277532510335254,-0.1720929384814297,-0.10308197447649138,-0.2132987349995591,-0.19160131706045982,-0.23053909995014363,-0.10824847176583285,0.26625891335971624,0.3696602769850461,0.16649687710451358,-0.006544764557903788,-0.010487768580428788,0.1027746262686116,0.25916625193598886,0.45560474691595665,0.20967752645582635,0.09381514240330138,0.23443795425343933,0.26122876242278936,0.07291328081918297,0.24964273497246384,0.10908866781469059,0.036112222546189066,0.2113339945708548,0.24267611924525706,0.02803962443555254,0.037469857019844996,0.5947226667483212,-0.02419775822252796,-0.015743897619539773,-0.09838176688732472,-0.016982119707717683,0.20509819011359157,-0.10868132685078451,-0.2068290421424654,-0.17020313949617877,-0.07568332193198278,-0.22899073454393817,-0.11604442574582532,-0.11527753435958635,-0.04338053922571245,-0.05316110274806512,-0.13327219104102356,-0.22084146724603335,-0.23038264790026458,-0.249506516141646,-0.18050745910343668,-0.24413948057662868,-0.12132485556354596,-0.18132067168915797,-0.24254750358729282,-0.18538873953572124,-0.05967685566223323,-0.234543860851917,0.1948476483448151,0.0760242203209687,0.0984068831490144,0.18051920384817197,0.21352980095239704,0.0794685164726932,0.31396706040194117,0.42717731601271575,0.4272313833779995,0.43353777400299026,0.4222454265692109,0.2969870151065714,-0.23970295643239894,-0.2575483569770398,-0.24744519817067817,-0.21956729947948941,-0.23689811359554672,-0.25278847971906443,-0.24527630374448517,-0.24001397324604867,-0.2560909739200742,-0.19913607631898064,-0.25625690761953124,0.4562647931502734,-0.0255632884386061,-0.07680750458832589,0.03676497358592794,0.3090124276275139,0.4484822302550158,-0.17058237682422794,0.26441371108430844,0.18170166770406526,0.24285819835757047,0.12011358057979991,-0.0007816836905517814,0.06225308675560577,0.20683042115987652,0.21275683137569595,0.2530702053508243,0.12115546985888609,0.2582673880793289,0.04083333848806591,0.1370534416781835,-0.16389980544037494,-0.028756189943058532,-0.018106789444384007,-0.09023573637736643,-0.17152766791524773,-0.11521291530698505,-0.13689414037364336,-0.19779328546494673,-0.09881429490487803,-0.12772903078461553,-0.18157660053941924,-0.09725756840642438,-0.15932151168023362,-0.1666357583194405,-0.08265566582693606,-0.21320057921212895,-0.17417120159829808,-0.15432358643297373,-0.1471609498717946,-0.055477315841877047,-0.2361963065463661,-0.16483306931515093,-0.2136708218739927,-0.16381195444963847,-0.20528751942700876,-0.2227873213818503,-0.18296726455655263,-0.04795492458552195,0.32245525411270914,0.09266150937020473,-0.17050897195494272,0.11979602501253436,0.15838050705735313,0.013939649142080693,-0.15474117121433623,-0.17992025561619546,-0.12651275662834427,-0.22715656327527,-0.11769789802944347,-0.07573146488621743,-0.03020825414360291,-0.01768200290522264,0.004627024320991762,0.050741281241142376,-0.019138866071190228,-0.020113660851287855,0.1450621665647941,0.013121480694511516,0.16953674902727564)
shap = do.call('cbind', shap_list)
baseline = 0.3521696804110412
rate=c(0.36322614312724383, 0.5951740973796472,0.6640333802485227,0.6838356475620877,0.699083755264953,0.21257014843425667,0.43538182660888824,0.38665731279383364,0.314777470907759,1.7375396146776088,0.27589626423166935,0.364157945958709,0.18948540014983736,0.309157244618378,0.42558787956361643,0.22034886532492987,0.36192763302399406,0.38199926576138105,0.24848257772980079,1.211158176692341,0.3860808143786129,0.8657676222427285,0.27133293802610703,0.44839317187783356,0.7243869509136032,0.13270087361812477,0.28425340715678515,0.30790710275700733,0.20790778814685043,0.1482070442764422,0.6536409929328009,0.5171804468095802,0.878314345667533,0.8817206296181803,0.8145768283052528,0.34214759734906364,0.5193463149672455,0.7693827372925669,0.9687744774675624,1.1135348980148825,0.7630913963920716,0.21612988132487118,0.768518668853229,0.5367534010387494,0.5945661236081234,0.4041441884044548,0.6371065504099869,0.7858381950735043,0.3038096495532484,0.7264302755400938,0.43892725708436897,0.3071408072499507,0.588070119689525,0.7017815208343579,0.2775119382787183,0.29977303851871395,1.7119770799587062,0.4115972079217413,0.7268197779784009,0.47643318218124014,0.44434008995490676,0.24162673192511705,0.4908683175215048,0.4164680647486941,0.6020409318454376,0.5611066386127733,0.3874113759847672,0.46845527622885075,0.31630964314359583,0.23470156361265837,0.1688002220357746,0.5355543893501522,1.131251268571062,2.5992627948161946,2.5884903977306513,0.8569739238459968,2.729536388140513,0.37014387672696275,0.6763515551824525,0.6838744778514431,0.799860589375028,0.6084770795053827,0.8132582460838009,1.382997887029329,0.7542647820698214,1.217296797089713,0.627090300346051,0.7511095742465277,0.31673715534417907,0.31462713756347027,0.41108801399995926,0.4106559685024773,0.42371642613186195,0.49041006041701213,0.3065184240994912,0.9266091076986334,2.6862023507703783,2.2901969876002384,2.640662334213947,0.6091488668277607,2.682791233277957,2.749624303586571,0.9141781524641254,0.8409958900115987,0.6896817915103709,2.6522190929350855,0.8504669106785394,0.338265293580125,0.2432610166709979,0.708278469736181,0.6209664426451155,0.8117743757501887,0.7119949584126944,0.8042652771843242,0.6162009635063194,0.7567812853561771,0.4679436264482407,0.6050343374374582,0.15711359064828917,0.25610414604507814,0.3109249377660856,0.4309731822638476,0.5037913165191237,0.8072258991962383,0.25560311871618313,0.5719550037221643,0.43440391687595786,0.5433421946549738,0.7338638905284377,0.7876094818090105,1.035477221917074,0.8516510390098315,0.9551889159868651,0.923296657757506,0.9340525301650707,0.9778259049976491,0.9279757738922519,0.7016643553044073,0.36509169316084283,0.47095342347426006,0.5768980919829642,1.1955432704127615,0.4881839685322552,0.3634686049564784,0.5583744166389915,0.4516254549215648,1.417817405412326,0.430032650819772,0.3573353960380616,1.2261138313595097,1.1996361646429765,1.1885756115288357,1.2153719060244335,0.7150911199640957,1.189483397050794,0.6602135060785312,0.7697693148850585,0.9285001247355761,1.650998739898885,0.6483451348558976,1.39993595002425,0.4373641568072023,0.45243536285242986,0.7014705206852043,0.5518097385550882,0.5118828252948505,0.3351147518753929,0.5737280003304305,0.17966976348927702,0.47062382004569625,0.7439524231651798,0.6472293990446981,0.5769340927097947,0.298852862058291,0.5323540185138902)
rate_lwr=c(0.07303548050996694, 0.05120070386763703,0.14973104344995353,0.19436281559321858,0.20546319602024837,0.02748059808109582,0.06709170496264111,0.09574412923010905,0.07033137973482995,0.2028463407253575,0.05022682655678515,0.09491771254347803,0.018595631951136837,0.045204546058079276,0.04542008726350155,0.011099670758799307,0.08977254499442688,0.07514269088402928,0.040930546259009826,0.29194497817858817,0.016238586330911076,0.1388276636282128,0.043707535615053084,0.055556958819597546,0.1391794298472308,0.008968735479038925,0.04023729240094112,0.037838436634530404,0.03610810687644672,0.014401416475684381,0.25387925432433284,0.23960957876212655,0.25498949843176033,0.06599470514174838,0.28646770091621715,0.03196920010639809,0.09820061644059455,0.06637310569296978,0.22950260959152932,0.13672665200621847,0.10661534588046198,0.017615695200980108,0.2097680983064683,0.07244080641688971,0.09501214273060449,0.12199600949369602,0.22648836838123376,0.27111158595536494,0.03684122986983851,0.2863646103200076,0.060929742753300264,0.07542583135946973,0.16555189413120291,0.24866860227828766,0.06412332100696089,0.10118545759579545,0.3451641174787907,0.07410837978752216,0.16966818667575273,0.020203908729696796,0.06511783170006352,0.027220498268931193,0.17771141095529383,0.15054529880261272,0.21856065986189568,0.18653195333001862,0.09891269610743547,0.20306848261940663,0.009341731989884194,0.013477096255942123,0.011059130320885513,0.2459891820236155,0.08973845173225303,1.1052918249053394,0.8930872377512258,0.289102447319057,1.1214028190812781,0.013634358471040164,0.014362404552007602,0.17579222536313358,0.22975899073552397,0.20111233783552857,0.24967258863790504,0.3682437737812307,0.13239573275425648,0.2046341137379316,0.12555935141146118,0.13725291230943754,0.009944533450104986,0.04055299128137679,0.13325484852800945,0.14463885751525055,0.13776939053236847,0.07926384971678865,0.031219960779786005,0.3249967688688439,1.2160301401698341,0.6018944907539766,1.0640939059423162,0.20683447075605155,1.1765133068570492,1.2204113210870673,0.32016359654904725,0.278286176849032,0.25011772428883,0.9397652466148518,0.10765517647111625,0.05586813606572599,0.027919509282740673,0.07369794175116717,0.0768079823561329,0.08077724315804857,0.14974731043377582,0.2602408175857091,0.1756108533880757,0.20433530821340604,0.14855566151761704,0.17217270658220227,0.02529328077457399,0.04989891110636474,0.031627118220918515,0.09624916999224231,0.1758951064119137,0.2025440801813845,0.03535267485638821,0.20528608769830778,0.019205532028856886,0.07220610975663444,0.11272761497648742,0.03813901191357438,0.02112330219990205,0.17762253162488162,0.21111461479595123,0.23644522154300285,0.09504862454591129,0.1587287631530877,0.15778917564128858,0.114598392220056,0.08205850705844836,0.11426632671304177,0.1334444971883516,0.4490705779901284,0.17178493844704296,0.10088482784388572,0.15765501868122073,0.06149343141020708,0.3058749193023416,0.14464857474805423,0.09943534282299532,0.38529088664097505,0.3898828389997643,0.3630873739181076,0.440191568138545,0.1325949831231536,0.19073087438258435,0.14191290814017515,0.022966939017588117,0.13202609846838148,0.2591384672840161,0.17246218538173913,0.2607438442054716,0.05037067363044412,0.08560895283452086,0.11088575907870657,0.11078280635483212,0.05645550197798527,0.024637980626183997,0.0536617570461439,0.011562378292456654,0.0945764186353252,0.1156049366220937,0.17563143549003243,0.07481600922414361,0.08487034223656492,0.10235465283754344)
rate_upr=c(0.7355159607238518, 1.5724465188070869,1.284759716367571,1.3217459894898804,1.4292069397176879,0.42216337391005215,0.8791634752147788,0.7376296705510978,0.611307349977724,3.4455331884043945,0.526412338104319,0.7022632714882463,0.4065303313245106,0.5563358565681489,1.0299848519988115,0.5968584148995841,0.7418182722968275,0.856112621835548,0.5950727449385227,2.399130079628803,0.9431655849075868,1.7703543000905042,0.5476612806371846,0.9919983441828084,1.489725657823396,0.28711843696054484,0.7078367034190892,0.7963319791800443,0.46334942004058144,0.31126932482795655,1.1767919156939188,0.8418937402379725,1.6879931452881967,1.9396167236476423,1.4523264105878764,0.7915299137960661,1.098983253873997,1.782596734601118,1.916286190073838,2.280795084138506,1.7137621670116838,0.5057566943256009,1.45081147258129,1.1605745534540581,1.1238713711093968,0.7473237814265956,1.1687831455488535,1.4719679428404318,0.6974308977498307,1.4029213996067305,1.0139119223460213,0.5745282670984533,1.0850190733617504,1.3256741943233379,0.5063651146485454,0.5561360743456123,3.4946831226687673,0.8802543085132393,1.4673088671429482,1.321676703707049,0.9244974530137617,0.5108591673319254,0.8614408623391148,0.7226248639144317,0.976891793855963,0.9890836667386369,0.7134548857877754,0.806842833591801,0.830448309440124,0.5591079282290853,0.4111270045989783,0.8452138530321085,2.593365970465351,4.154033548631895,4.525101356547817,1.5138698873298386,4.215613953632555,0.9215114814802287,1.7403059228692543,1.3259734463251118,1.4237281522309722,1.1334479151697394,1.5517028652846179,2.8100761622894983,1.603867451680273,2.5235922773837625,1.2839061139114423,1.5671058886497078,0.8139161186987304,0.5911237112407286,0.7311292730230821,0.7415109357014976,0.7613616377681756,1.110819301591341,0.6773669483700698,1.7047505473601516,4.513174544896925,4.344605917724802,4.158609047090174,1.0954938453636074,4.269359569924967,4.401884972096947,1.6252787074987172,1.5379914266037977,1.2329286129171813,4.072890808066647,1.9966188852541644,0.7635802809912875,0.5347033967886654,1.7064045912637982,1.497532760802087,1.885252355509989,1.5202401708129571,1.4512808541031204,1.2525646017907828,1.4140812006312427,0.832063136680035,1.1056543123561093,0.33230985242756117,0.535656656512525,0.7220430561832671,0.9661701078380931,0.8340040625435277,1.5376149443623777,0.6191089888670431,0.9599196961567203,0.9591199415124645,1.0938671550779326,1.5502724035030593,2.069568366289556,2.4658904826122945,1.7260262906324928,1.9126048468918948,2.0062502532307898,2.0811012178005885,1.9502738482004638,1.9266218354162963,1.5188594070884633,0.6772788818289743,0.8871729255039161,1.0871150186421383,2.110817299697039,0.8997215797560119,0.6212502582802341,1.043862331879052,0.9501770436255697,2.550251058272337,0.7610602196651723,0.649268538161029,2.0707273591680573,2.0968433074686814,2.0859183378505697,2.0996298217099043,1.4428736984336303,2.4152554610765415,1.3037374069531746,1.8563699203497255,2.0298469235128924,3.045051632785306,1.350768246067706,2.66871743541968,0.8639050309462812,0.8785205892704995,1.4920794882998485,1.0512400059072016,1.1231288615333692,0.7786054542066524,1.4626688137046782,0.4354757045242078,0.9803030211161716,1.574037646490115,1.2090501007453747,1.3426569990593054,0.5949872013261288,1.0522713535958268)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 7)
feat_states = vector(mode = 'list', length = 7)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(20.14999629601708, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.836919378825037,11.763688761345936,18.834541775289008,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.979848282645456,13.509885309719447,13.644381033687072,20.953699984613685,11.890957989722903,17.481163012849535,19.543842461257075,12.690342590081567,15.275304079953862,11.610334918074667,10.928438777046042,19.116662982107215,19.555450852647265,11.892196451238082,22.62499624949477,10.937196469189116,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.161227290599497,11.901919527978396,13.967996412219494,13.55414456814677,12.762457973341409,12.762457973341409,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.810905393300043,18.06782966848869,18.560496325894754,17.761269068190476,17.604996343855184,19.676359941283643,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,0.7889966599437539,10.31349648091274,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,10.955496468845132,17.883359974986455,6.999079876546806,14.197688715594296,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.138842619244942,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,7.7528298623786664,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,20.39513914855202,11.566150303520583,10.647178292822375,13.556073343039289,20.792329617276543,20.39513914855202,12.543329772332134,14.172329741711991,13.876163080612338,14.172329741711991,13.644381033687072,19.836919378825037,13.538644568438118,19.47116297544374,16.6109963625393,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,16.26999636894904,14.445304095555281,9.062465735197444,10.647178292822375,22.72199624767148,10.647178292822375,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.72363266766776,8.943829839991546,12.543329772332134,17.04717817252226,22.62499624949477,12.543329772332134,10.058496485705948,12.685450981781905,19.64726903273955,18.82474632092768,10.704829806890222,11.45516312611962,23.096662907295563,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,18.04222710486738,22.72199624767148,21.1276885853318,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,13.202287335703351,19.967269026724537,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,9.062465735197444,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(-0.05651836162797346, -0.06480256787204668,-0.06809418260837145,-0.06806181503686257,0.06662662272007806,0.06706748996264623,0.06825597448802538,0.06666227846724812,0.06709458775663184,0.06713239507833531,0.06826460722074876,0.06688178793127686,0.06863777380071477,0.06839968625330488,-0.06455968653903116,-0.06021817588084175,-0.08058331448423661,-0.08076132055424771,-0.05721895768703083,-0.05682971483105193,-0.0568190706186041,-0.056950796342111386,-0.0569284258319477,-0.05713965744168112,-0.08041130094750801,-0.09049607488949253,-0.0903139438266748,-0.08982139917622144,-0.09030055659317993,-0.09083610794804303,0.0988983385268792,0.0952072777293202,0.09941741977796538,0.09973969422155841,0.09982002212841251,0.09592980524036564,-0.07390082103774019,-0.06490742151401967,-0.061142376299037515,-0.0702127722105736,-0.07047062655893609,0.01698222967843764,0.00910227979169506,-0.045138249869302594,0.026733076852176584,0.017059423995310276,0.011411190850650553,0.000748164565854522,0.017012646919015873,0.017010340460265068,0.02913649219253861,0.03463234222333615,0.024989132200333646,0.012872786084299608,0.025151143362559962,0.025249338226786905,-0.06969722985016336,-0.0686013422769117,-0.06809411692728987,-0.06879735848186957,-0.06835803165869436,-0.0719047603127395,0.09622919283729005,0.10226698481869084,0.10160692295055165,0.09654364348338464,0.10226698481869084,0.09968831280882494,-0.08180474365899758,-0.08142226957283229,-0.08143000518573135,0.09924179592616288,0.10234361726117265,0.10142429134622544,0.10237047218311697,0.10094321635565486,0.10147968237241968,0.10104522609934904,0.10235445556959867,0.1023049944715206,0.10019478018514638,0.09812368583642342,0.10235083718313466,-0.05855712798097906,-0.0587604338319199,-0.058813862101973854,-0.07861813300355343,-0.07865969274740589,-0.07878576015105078,-0.07739148820834478,-0.076831349246591,-0.0768395003244555,-0.07671330094542568,-0.07781427262004945,-0.08120654178786313,0.10488074039747473,0.10492030396181705,0.10476877487732145,0.10465136081887044,0.10287656114490452,0.10494257618152818,0.1049422597216283,0.10412742684016915,0.10393387610749354,0.10272497991075555,0.10478039473582063,-0.07092639883389602,0.0781320341637059,0.07832700974157289,0.029275121086986083,-0.06814341448267815,-0.06760994501472208,0.09758999342297486,-0.0642453420080075,-0.06473341117236422,-0.06475310809115625,-0.06485640163060172,0.0912280782274644,-0.08587207132628637,-0.08542729455061523,-0.08569848540137272,-0.059474745791523315,-0.06593415179373348,-0.0661987037720193,-0.06607813807185921,-0.06623430652846982,-0.07863381728512676,-0.07806886319853502,-0.060763758618417964,-0.07650330959233965,-0.08076591525113466,-0.08051463161259971,-0.07931716838505198,-0.08080810848957948,-0.07835119450270042,-0.07929356474964296,-0.08072495607931025,0.09208692568974744,0.04409495615167945,0.045118058295874335,0.044915752629682476,0.04644617136297667,0.04569526202328689,0.045907134152386606,0.04515145075178281,0.04459211094823683,0.04630040552947146,0.045896443637128775,0.04576885007213378,0.04602575334206345,0.04515550083723579,0.0464553519883399,0.04610030362057164,0.04379927902317676,0.035389639064430316,0.03575476535142663,0.036392168454709606,0.035344660433078705,0.03567048378861443,0.0357481553081906,0.09627693110533266,-0.08044545413495895,-0.08035133159965714,-0.08058963729742737,-0.07951361217573848,0.07983960128172365,0.07976356020000391,0.06589172985986919,0.06560461900903364,0.06561742012174449,-0.06534195927062902,-0.06565044738062739,-0.07814922888272295,-0.07870922113534479,-0.07823200925589514)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(0.008340059169112657, 0.0034883197099496535,0.00397167951047656,0.003966930731779293,0.00043759936864947135,0.00044491160787615055,0.0004655848532984965,0.00043809012971686553,0.0004453904140988316,0.00044598670670882324,0.0004657321315609854,0.00044182573223547393,0.0004721868121530568,0.0004680514164795048,0.003449282010023049,0.0028406678394692782,0.09070592034039324,0.0954081696013839,0.008604010671771748,0.008456380056160447,0.00845274093806766,0.00850185879276496,0.008493552310750805,0.008573385928908252,-0.21396927932102533,0.129959214002841,0.12930325307107002,0.12751885603396082,0.12925473806161308,0.1311944537509816,0.0030172594919760623,0.002726666441613978,0.003057466434583522,0.0030825347661421047,0.0030887721398484146,0.0027828212570103,0.06436805546099711,0.043337547906052404,-0.08658538463107102,-0.14561957981343251,-0.14696955293322092,-0.0020980582220398165,-0.0021908402989456546,-0.002913069055306161,-0.001834799738446175,-0.002122133690950296,-0.0021442545314092516,-0.0023240906690761708,-0.002107502886787055,-0.002106786150268457,-0.0018068141253373565,-0.0016529822696032693,-0.0018853266117037006,-0.0021206601726511975,-0.001916307573773066,-0.0018995315469932752,0.054205562398901154,0.0040484760055131365,0.003972658112302309,0.004077610226565219,0.004012343452167758,0.059517737284699855,0.002811455067967546,0.0033118386127495526,0.0032582140493638834,0.0028382017176417683,0.003311838612749575,0.0030990841825712812,0.08426788762251568,0.0832790956797318,0.08329822319150125,0.0030467892914208877,0.0032966092213777905,0.0032213887898897104,0.0032987805776155264,0.003183078241788871,0.003225813413394385,0.0031911800420981826,0.0032974825888799956,0.003293486388801876,0.0031230001392814873,0.0029578388737870444,0.0032971903298754006,-0.0648108163591692,-0.06538049074765084,-0.06553000536091544,0.07604397282684437,0.07614513283839958,0.07645197419937319,0.08098823503314455,0.07951151158974984,0.07953267072637851,0.07920473823081636,0.08248350191719443,0.09248558238354984,0.003535456900630439,0.0035388024235848397,0.0035259793624098793,0.00351605577574263,0.0033653403814204986,0.0035406880576945568,0.0035406603781880266,0.003471787422645344,0.0034552943006736507,0.0033529028582070654,0.0035269458461859864,0.06225421163217933,0.0013760749141570707,0.0013847163026276925,-0.0018285934737689873,0.053043784099848126,0.052001839144063006,0.0029143948435073593,0.0034071455375004954,0.003472923395489737,0.0034755839074276005,0.003489541786792354,0.0024110679439585327,0.11312751676551824,0.11165950568359569,0.11255396073668338,0.002738961042720718,0.0036537623255732837,0.003693934136001706,0.003674808232994058,0.003696716889959983,-0.2019665034465181,-0.1983222055559574,0.0029048623483089774,0.07060951571973784,-0.21641982920993974,-0.21473141934325926,-0.2065941465084821,-0.2167040927631643,-0.20017693448706478,-0.20643997527805347,-0.21614431139920962,0.0024773138451578787,-0.0034670541876899255,-0.003685678220803348,-0.0036440766349708723,-0.003971734406561932,-0.003810164528110645,-0.0038556999933591204,-0.003692526654966078,-0.0035772605459629386,-0.003940425058957709,-0.0038534468100514837,-0.0038256185693920416,-0.0038815745821877273,-0.0036932494472738395,-0.00397370689900717,-0.0038973724167359223,-0.003408723299144487,-0.001669524174928423,-0.0017271037753260892,-0.0018147630589366878,-0.0016548839503539403,-0.0017245055650481232,-0.0017135574720451125,0.0028130088962780545,-0.2141975417330544,-0.2135688377528635,-0.2151658165733002,-0.20795048657350845,0.0014961810087010066,0.001492603375792766,0.0004158404553953644,0.0004112972981189502,0.0004114995935813801,0.0035583205131917723,0.0036007423295789506,0.0748643791004821,0.07622581213361314,0.07506452076896544)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(21.735, 14.895,9.437999999999999,9.437999999999999,12.724999999999998,6.2895,9.437999999999999,9.437999999999999,6.2895,3.09,6.2895,9.437999999999999,1.2905,6.2895,14.895,21.735,36.3182805,25.565,9.437999999999999,18.205000000000002,18.205000000000002,14.895,18.205000000000002,12.724999999999998,3.09,9.437999999999999,14.895,12.724999999999998,12.724999999999998,9.437999999999999,3.09,6.2895,2.19,1.2905,2.19,4.4665,25.565,25.565,14.895,9.437999999999999,9.437999999999999,18.205000000000002,18.205000000000002,30.999999999999996,18.205000000000002,14.895,18.205000000000002,18.205000000000002,14.895,18.205000000000002,14.895,12.724999999999998,18.205000000000002,18.205000000000002,12.724999999999998,12.724999999999998,25.565,9.437999999999999,9.437999999999999,6.2895,9.437999999999999,25.565,6.2895,1.2905,3.09,6.2895,0.06885000000000001,4.4665,4.4665,9.437999999999999,9.437999999999999,4.4665,1.2905,1.2905,0.4535,3.09,0.4535,3.09,1.2905,1.2905,3.09,6.2895,1.2905,14.895,12.724999999999998,12.724999999999998,18.205000000000002,18.205000000000002,14.895,30.999999999999996,36.3182805,36.3182805,36.3182805,36.3182805,30.999999999999996,1.2905,0.06885000000000001,0.4535,1.2905,0.4535,0.06885000000000001,0.4535,1.2905,0.4535,2.19,0.06885000000000001,30.999999999999996,9.437999999999999,6.2895,12.724999999999998,25.565,30.999999999999996,3.09,18.205000000000002,18.205000000000002,18.205000000000002,14.895,9.437999999999999,18.205000000000002,25.565,25.565,21.735,14.895,18.205000000000002,14.895,14.895,3.09,9.437999999999999,9.437999999999999,6.2895,2.19,6.2895,4.4665,1.2905,6.2895,4.4665,2.19,6.2895,3.09,3.09,6.2895,1.2905,3.09,3.09,4.4665,6.2895,0.4535,3.09,1.2905,3.09,1.2905,0.4535,2.19,9.437999999999999,18.205000000000002,12.724999999999998,2.19,14.895,18.205000000000002,9.437999999999999,4.4665,2.19,4.4665,1.2905,6.2895,6.2895,9.437999999999999,9.437999999999999,12.724999999999998,12.724999999999998,9.437999999999999,9.437999999999999,18.205000000000002,12.724999999999998,18.205000000000002)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(5.0, 2.0,1.0,3.0,0.0,4.0,7.0,6.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.03440951872978697, 0.02976613652827964,-0.0074225965256659735,0.02898928432942169,0.13487932332200503,0.28458162784565405,0.2590874798107716,0.0006440319635629738,0.27733979170151496,0.16211232606816242,-0.019344020404867678,0.20439158728049608,0.35756692575545507,0.10983210415300874,0.019162523185019712,-0.004788727078506513,0.12911487797147247,0.0013405890687723761,-0.0004987777723397764,0.0191637864821212,0.026505668456617542,0.015626180939024372,-0.039858835734743914,0.01930746939871303,0.21304943670206336,0.09424887743669762,-0.0071748433288576895,-0.02882464379039808,-0.031393348515926595,-0.006908014517316515,-0.15854973701678138,0.025309865284805805,-0.2017080873214921,0.005899845481657143,-0.18966182424869704,-0.06699827916892313,-0.017675074013740483,0.11883449133954907,0.026327470259538657,0.04953046848003402,0.05928816006638674,-0.011307196073423446,0.00324033336518073,0.008451599040360767,-0.006777419591732071,0.017186615687395344,-0.004668480594841032,0.0021302928311192817,0.02550732181742069,0.015014217976440125,0.005119003932281424,0.01740863921204754,0.02532650470437821,-0.0001414034813571894,0.013527256081804877,0.02902016683547328,0.0903381277972638,-0.0018067032356985848,-0.014310929825194479,-0.023352427733091905,0.000964265704374813,0.17236534813960555,0.021978544676541884,0.001821998281445801,-0.1246944988298041,0.018636153605883044,-0.00965658245944781,0.019172610331948337,0.1883177251572593,0.059578030936584696,-0.007311916763732277,-0.010809347032368027,0.04787495853474587,-0.07434016045581684,5.4046938244926925e-05,-0.037520845520553174,0.09928397537489847,-0.05203269585295026,-0.08027760559744844,-0.19855087054429624,-0.011215753771009874,0.021610390267247884,-0.23118375809634237,0.040872671523022056,0.025518016731157264,0.050404692950388214,-0.008850019199612457,-0.002145309336487992,0.0012682008362699352,0.20559656229666845,0.14073290467745467,0.19174356471988058,0.1397836347180375,0.13031873681555461,0.1783967182957286,-0.09542146680592747,0.126259107272129,0.06547287293808564,-0.13373861346993962,-0.1540527667174646,0.11278800779490124,-0.06926436459805765,-0.20105983097122412,-0.12198733827601056,-0.18273052317062136,0.14242379372449165,0.2969170055014953,0.039300052831483176,0.02581534694642838,-0.00283357840192894,0.3599505868313533,0.31441561653913314,-0.06457247109308656,-0.01513166493876467,-0.0026941630695093122,0.00031943864157636816,-0.011104055409055184,0.024858332129554097,-0.019505492248309313,0.013325705919850345,-0.03725832145423828,0.0027879969960511934,-0.014455904240388407,-0.01645325466024023,0.007226333035160158,-0.015122260603642365,-0.000821020761500793,0.007369924021928537,0.051682316514488805,0.1764936139365663,0.19636347503442592,0.1093211332751252,0.06789343986946951,0.20459461525209968,0.07103800928307222,0.0856826242843982,0.2023923929249516,0.05672396040354145,-0.02248257140856324,0.012274797034746838,0.032628671492573785,0.011055999368748083,0.12799903123893416,-0.011041516758275348,0.1267208838831835,0.02471881250578991,0.11489693547739296,-0.04498598685442309,-0.0678670032875417,0.01445536764484076,0.024674749681760925,0.03051735414535179,0.07453093519527826,-0.0015345930398445835,0.027710826389874776,0.03509701501867709,0.12457256479460051,0.07644417642002901,0.03536735381999544,0.15295041546491625,0.062410218253917196,0.06640879832989231,0.06795553313656269,0.2187943671138402,0.013501706819983014,-0.00947484286889468,0.02016382585362954,0.018783053226172176,-0.0040782112152690534,-0.006086410317345345,0.06829611553149005,0.01493640324354824,0.00581544948459206,-0.013433203738468001,-0.00782033863999405)
shap_list[[2]]=c(0.10030356774106972, 0.15536064338953517,0.2853688376631849,0.39860816645554653,0.16658571192472924,0.3784098509111302,0.3395821270758522,-0.02811348372914325,0.37337848457721473,0.28962050910906206,-0.032283627468848004,0.2821722254202931,0.5232564361230022,0.1400482046451953,0.17164924670815762,0.11735122671570176,-0.10137784003706013,-0.09527543477686955,0.06475482162122614,0.13505624768885613,0.02348599352743655,0.07933342203145538,0.05955636019152267,0.11392667461848693,0.33133587002492265,-0.36427418431365255,-0.14175181799910755,-0.07577221355757675,-0.10911895565566684,-0.14472998702423504,-0.10809367070594282,-0.05604366501296397,0.09934370522525837,-0.03933786548067706,0.09574924917331555,-0.10846548391140895,-0.10047792370675533,0.21120052832206654,0.3056013644372987,0.21198172972257337,0.27002139245130546,0.0918235050688124,0.09153374917354087,0.09360763260500045,0.07089509601933984,0.1176867831705343,0.0760775625087414,0.09144742921398162,0.09417842279343938,0.10940087910368289,0.21355148509313915,0.16909402179216534,0.17819568976752562,0.08316627750471751,0.15193110120297684,0.13137191202637016,0.1200299241099054,0.22285985115270251,0.25455718535788524,0.3490662387606045,0.17239513635783013,-0.08966177722485101,-0.05077512542054955,0.004371720644274381,-0.04200858159861166,-0.05101492561425691,-0.0007734666406296718,-0.05455775060253192,-0.24906246646117722,-0.174886271698926,-0.09824193282695998,-0.05895842717155995,0.007585216226228624,-0.19709791684489694,-0.07777089556968501,-0.07709657403859625,0.004868567306669905,-0.0809654394166295,0.060386838222723276,-0.06998524707433383,-0.061179035322325506,-0.0528439044112022,-0.15876253951230768,0.29800377312998655,0.2924307229744896,0.3304090086010268,-0.12614421121683358,-0.09181929813892462,-0.08298361469692324,0.1775087547290675,0.09623489140813608,0.15586948227466216,0.09976799700557376,-0.06064446563776916,-0.09833190626548266,0.025588786292280532,0.1167832612913145,-0.11338797752147979,-0.21582023244135118,-0.09757270652765893,0.027802857210989313,-0.08297033139176277,-0.09683388062478011,0.10025975347175896,-0.13678658920584683,0.03843268414208483,0.40718242068379984,0.208045727890576,0.22172240587993078,0.21192010522463792,0.4343151312037534,0.3870742996216621,0.4178790314062009,0.16088953376042978,0.216977275116312,0.22616192053874412,0.18926336110957476,-0.05164696762013346,-0.12131178551473741,-0.14874293124784596,-0.10250533596678105,0.04615069318600148,0.16189336713381078,0.155925148267885,0.2556286368704179,0.1562961979820193,0.25047493853837505,0.24758512969041735,0.42121356859470455,0.07411439208480847,0.20102509052806794,0.02924015069958787,0.015493161933522284,0.18547263501166933,0.017539851486842162,0.028212599879884986,0.20364541173019834,0.10496833705902728,-0.10183125696173977,-0.07338408657119024,-0.04883278523647888,-0.10213290117307648,0.1229300896732709,-0.11687673884279111,0.12724297589299066,-0.05113539001984132,0.1434709421523519,-0.13095324462068517,-0.13062432040352348,-0.10923413950010671,-0.11986001683147426,-0.1190375503743088,0.06064634702021626,-0.08972731004363381,-0.03721525776916828,-0.03064517664274915,0.044637301097494475,0.013686410700901699,-0.07544242435912661,0.16858479579448932,0.06887216264195126,0.07784936001664729,0.07720444737429133,0.29325770815836066,-0.01173809056048682,0.26125421143451655,0.18328834094400046,0.25676563698707144,0.11432402558043912,0.12400899286784951,0.4237459405415313,0.30085515590422557,-0.08587949022824133,-0.10315458862802708,-0.12864374478244384)
shap_list[[3]]=c(0.15277481104722102, 0.40765852915726647,-0.1475245163883425,-0.10123654248682379,0.0006954958031570208,0.06578432931787027,0.8003559734547855,-0.03162764534602742,0.8357647834186392,1.3586643277925705,0.06725995145976589,0.015283485060862103,-0.042328133538024476,0.43294452982739623,-0.0540401395154114,-0.13256921090046464,0.16465658129127145,0.09007415986823789,-0.05712406569030861,-0.02102093450027075,-0.06203983706519584,-0.008526343678356654,0.10537994609926066,-0.06449836246166171,-0.01847240399258207,0.5113723112080419,-0.01763325464826061,-0.010643156274742306,-0.02480135485724271,-0.015946358602468676,0.33347750938343645,0.08639687548305638,-0.0681420406753912,0.03789650197788745,-0.07775811355588129,-0.06792055811691038,0.11098244063508776,0.3192282273100572,-0.13493370808427915,-0.10677455478595826,-0.13454994469164988,-0.10177119532586938,-0.008154665444399812,0.12217574973216963,-0.008415223258063053,-0.02931718703883816,-0.0017752903696481139,0.00033728050431815627,-0.019261303844824256,-0.021650514263559986,-0.2033473088179127,-0.03450069047292099,-0.03541427861818899,-0.008352312867308243,-0.037229548521846796,-0.02777594717715541,0.09215694160461799,-0.08219078190364368,-0.1470530109775411,0.4428888584188866,-0.0705908690328351,0.2350093051815244,0.10238555578300636,0.7087611469653559,0.5406678081970109,0.11405931073835095,0.7115637992630924,0.10825909148862596,-0.05058698055686184,-0.024519819834674886,-0.039241080711959024,0.19422319371367916,0.017758987370974873,1.4108244010673823,1.1210850257204097,-0.058309516157915575,0.8190985771995192,-0.27979532174060756,-0.8274068942099286,-0.12266616584906687,-0.05033979535204873,0.1075741282465591,-0.10935982246452382,-0.019354083206239565,-0.10175817108795777,-0.003899293635512446,-0.022821143883088178,-0.0040611351484512925,-0.13674182665223927,0.37666055507921575,0.23526674062207328,0.3405019877146623,0.2769598890404072,0.16244217671571598,0.20573133217771417,-0.06146925694561559,0.779550415412177,1.1776950324950226,1.3756109183837986,0.5304917344722112,0.8262351363574095,1.433715511119722,-0.10972251303817296,-0.05978171844833663,0.35138752616499874,0.8085193277764764,0.5615048701501543,-0.027026642538930036,-0.029326577787690017,-0.09249405901484604,0.6333645892901048,0.5684633526321619,-0.08962215766400526,-0.06448808462778943,-0.09913410792718128,-0.1007543815198354,-0.08731829827263118,0.07877284635809254,-0.0369084637715426,0.13782651288775621,-0.035230313843340466,0.1424702352526076,-0.07211840325300117,-0.07021957947090991,0.24568751366379257,-0.06837994732927902,-0.15839733942157977,-0.16056771768999,-0.07559896875643678,0.09540570190340698,0.1321884375791541,0.08294861935147464,0.07661945293503025,0.1545153685205215,0.04784037136227379,0.09326645401885604,0.15705076243141886,0.1224037377238078,-0.13484914070632328,-0.04661511581266152,-0.015803781478136502,0.686348012172317,-0.044618029021846285,-0.1724000862519765,-0.046345867452800775,0.12197994209297053,1.2138011340496826,-0.17070997238236596,-0.15892064789519272,0.6435898778062208,0.6475210718423433,0.6990965670641256,0.9554416127525824,-0.0583990227195517,0.010933676067961197,0.03697323487050957,0.1745228758571265,0.12630211357261842,0.5026627084167515,-0.0622836906638196,0.37455595739779374,-0.14548448245395906,-0.12902267951384297,-0.005077971927107233,-0.14743969975775983,0.1457107017052021,-0.09087650570229788,-0.012157557826902778,-0.0815867484969827,-0.03516951345360523,-0.06412160839920909,-0.13878848345324057,0.1322106270982661,-0.015129724284087341,-0.021435606610975093)
shap_list[[4]]=c(-0.1394868729086676, 0.0970420203805807,0.0609900041425324,0.24457555976917286,0.31505290030959865,0.6222911084135726,-0.17872544055386486,0.01094314965177038,-0.0817717730697036,0.3060538832526694,-0.06624597314231358,0.3528329608968072,0.3103034082328662,-0.0758843228226844,0.03773835357508602,-0.0357718234382531,-0.07486012868528283,-0.06415250090959561,0.08890953734019912,0.05015603193650707,0.1352238226879353,0.039602002804083075,-0.17859470810678252,0.13616857770323149,0.018181305651621987,-0.06234709146513164,0.09031683464370731,-0.004793035062575212,0.03751096848067009,0.09571979473310317,-0.15697117063657168,-0.05443746055550444,0.5949699249090469,0.0954140899667343,0.4849651819039117,0.018344439783515118,-0.05154706836091868,-0.11118784036106748,0.216267003620303,0.012329258644509154,0.13835608778921313,0.004847247944160249,0.025737106661815525,-0.12474127196623863,-0.01528633821902844,0.06250552537749823,-0.007698192637605679,0.013626186112359322,0.057687429156883616,0.06166362884456696,0.2262662763719779,0.0917501243367064,0.08885962688993068,0.012101757301700792,0.06499112715760409,0.08796657407926267,0.05454581061321211,0.1086048106963644,0.037330006549635295,-0.06850548676981154,0.06612993470523633,-0.10559895363498384,-0.05074121920500295,-0.185800638495629,-0.07308005034617439,-0.0386238733208984,-0.2757020850718318,-0.05483742853946207,0.47832878591088357,0.08346136538217029,0.011379053671582463,-0.0678426787302302,0.8308024197505972,0.6243375783206057,0.780652410117854,0.12182285852018977,0.5270769242954014,0.112196109057002,0.7205350400686412,0.37932621375398873,0.06773021765965913,-0.04123999406284106,0.4526042041730368,0.08209509571130019,0.14738442441095811,0.06881679396640433,0.04693912640778926,0.005858676801297206,0.061294383602903936,-0.10477968778765989,-0.14466550257788466,-0.11722553387456859,-0.11442039906739053,-0.0690241754529459,-0.0629849882963805,0.9715045018723821,0.4402183490181511,1.2447100493503964,0.6176387364738578,-0.09096276737231353,0.45994422479088637,0.7395856389267329,0.3002042444680336,0.8000846248505605,-0.12263382353039601,0.445005588376577,-0.08075344142924278,0.1354441915023482,0.11308883321183096,0.052694384224701296,-0.10656299743630378,-0.08471657795431073,0.15824483012059,-0.0007824511737215391,0.058751902904826535,0.07628761407628468,0.030255871346278815,-0.05802976593526295,0.07841310382229026,-0.0643248020824042,-0.002596445605369092,-0.09261560616454056,0.008258669249745571,-0.009070691400362365,-0.2131191844547225,0.008520840267415283,-0.01512470605455987,0.09371549890870277,0.3214972719525386,0.13947139155737925,-0.10758917049247231,0.23969336916874157,0.1614979588741152,0.33307648873595563,0.13140861408628776,0.23434045991411245,0.33631136262594297,-0.08553213570389318,0.4530980630588912,-0.003256219119745485,0.011900696209880757,-0.5440400726290516,0.5896816534179297,0.2647235354392712,0.5371359291999765,-0.0686497386238955,-0.244279799996808,0.27264377211345403,-0.01627676719316147,-0.5715821138548458,-0.5479621122784384,-0.5309994557811698,-0.5158564511446743,0.06314820609831806,-0.0035502465290734677,0.010541042977264988,0.14228267609119336,0.07376028157855971,0.07220110139995659,0.24136752850648516,-0.11182473382670773,0.3781935948783691,0.4460893496545311,-0.004736889916977951,0.08161333404756774,-0.12697402011994505,-0.04107156944041497,0.07224193280040568,0.03679727216496511,0.01562945956571466,0.3388756019594079,0.10867094396549842,-0.027226410281449332,0.0078056047704211495,0.06294969004730581)
shap_list[[5]]=c(-0.10581579097269155, -0.14488159612435025,-0.12542303843724867,-0.15446792796878175,0.49979508719683935,1.2570212232298805,1.6478268192521286,-0.07884543072883486,1.7477288610525454,-0.23202854888083674,-0.08010453526040594,0.8289620367219726,1.4850310487423304,0.7292025347227961,-0.10148130555585083,-0.08313999577539401,-0.07288626756350015,-0.06590807156661777,-0.10615697010230364,-0.10446082133245815,-0.10195481014287561,-0.09585568942268605,-0.08656592104923494,-0.12920920363230606,3.1553691902265957,1.1381254784529475,-0.08408076909564083,-0.06711066770895031,-0.07149733141922072,-0.08478812081061961,0.7239279832820782,-0.06953717984665332,3.1468763926362486,0.5365406366261911,3.1014977735089073,0.5674404597379624,-0.07715664004773334,-0.11699163374147213,-0.14029503114420055,-0.11281601154625634,-0.12845920719864995,-0.07858145103205325,-0.08506587721325952,-0.08324350656184258,-0.08021658130171319,-0.10353244976681474,-0.07836745223446479,-0.0842565525158305,-0.09199667632278373,-0.09700014800629314,-0.11603098158035946,-0.10904795527629711,-0.10846874536367108,-0.0820985627802323,-0.10457186874395857,-0.11143014698419387,-0.09841664981174715,-0.12414609822422258,-0.11962267061309242,-0.1635105743409195,-0.11314613738002136,-0.08407318526197785,-0.07250060843754721,3.149668095806812,1.6480881546198227,-0.07538662016055975,3.073719083887132,-0.04337309822519587,3.1029221660836597,0.1642024817628329,-0.07517879924670152,0.15069891612010256,2.131884644713562,1.298293385944983,-0.07737853962280153,0.129143487518438,3.462220130899721,0.469185259276173,2.7488961891698667,0.7582351372354383,0.06696997766834592,-0.08351539562705712,0.8231955086114591,-0.1262802530654344,-0.13211624583804668,-0.13251709368608028,-0.06756232863423754,-0.07051523919335727,-0.06898527581259198,-0.11095263412400846,-0.08183157606587306,-0.10409480085135933,-0.09349563657357857,-0.07060595292669096,-0.07833939225389593,3.2195769569739308,3.5443072483859495,1.1673862992458144,1.238979528959166,1.5517904241292364,3.5215762327415634,1.3806210856516978,1.1794093353683521,3.2599630993566393,0.7063953447735083,3.5330744631962276,-0.1397493856201685,-0.12494107557227967,-0.1160822651976808,-0.09977679299804483,-0.15177179063199236,-0.13940720417528993,1.0363438928779354,-0.08869790039645531,-0.11175624940964875,-0.1134130984700267,-0.10068318126041166,-0.0835990439193573,-0.07872835202619244,-0.07996205543247803,-0.06690229007451894,-0.09069542678647051,-0.09407129287306243,-0.09638374154202003,-0.12287003704171491,-0.0940191491652825,-0.10860044592524641,-0.11905174307215109,-0.15678902024921026,-0.139102735953031,1.0555843852252071,0.14465275954612608,-0.12185305104891524,1.146149588232278,-0.10884636749604738,-0.1292853148052006,1.1579809050039913,-0.07191869772700471,0.9596205830283526,0.06813180616339001,0.1459043313407088,1.1656905504204529,3.672736858377832,0.8494528625261549,3.6392810313300035,-0.007260936242731044,1.4915790474568973,0.9528092323503596,0.6306749694313402,0.9549946934107031,0.9487506846709098,1.0770588278288444,3.3044357088218597,0.09111214084288745,-0.06759484058503863,-0.07465989309200102,-0.07491083251037613,-0.0765361330866966,-0.13278514340630335,0.7935464687109105,-0.1171170622685417,-0.1364107028074283,-0.13954915676262328,3.1146565459107323,-0.09697687610236663,-0.11811662578138411,-0.08511999467690065,-0.11038307345574096,-0.08842131656794812,-0.08878330784860014,-0.16115455200496037,-0.13453568645600447,-0.08371610811007138,-0.07343053637711723,-0.08661201538177475)
shap_list[[6]]=c(0.08618864595754716, 0.22854138767205864,0.10997162057532832,0.19058680190005345,-0.05990112565289362,-0.04377359704028128,-0.11366200248802506,-0.06556478941642048,-0.10861604481144545,-0.06133587345690152,-0.06342148117941021,-0.04838996085156517,-0.06003602916945488,-0.09524022383749331,0.09844427277630324,0.06853202384157395,0.05167351683662746,0.045416032646858395,0.07904751287481263,0.09816389985698071,0.059928254830379474,0.09012934786130555,0.06848172379984059,0.10443322440328867,0.28471385090330364,0.22150876381143722,0.06439079953424798,0.04693881199094766,0.05286636975947978,0.0665983922281465,-0.20262182015407282,-0.051257128728832764,-0.15579497746691337,-0.102791079380671,-0.17294770232344886,-0.13603027432799553,0.05983634187755332,0.184116102601585,0.15404772736294609,0.09407363041736404,0.12211091799975299,-0.033221090883541374,-0.006202170486986459,0.033918558963325005,-0.0362429604421394,-0.0074986763885541655,-0.01738255584296573,0.002547303486519276,-4.7577057820095976e-05,-0.007801114310872433,-0.08650007058055373,-0.030833552136765155,-0.017383434005189487,-0.01494393345991715,-0.023064122598235495,-0.012661673889778522,0.16282029947439225,0.0782318932159431,0.1036978401436034,0.21952602461146414,0.08887991843351688,0.07264488308171026,-0.0466460496656928,-0.22406450427347774,-0.23149581631595545,-0.046547951917432814,-0.22911971838912357,-0.048899606057304604,0.14171978596480345,0.12127920778613524,0.057151029003750776,-0.08969907988608798,-0.06634868689103746,-0.22689445701270078,-0.08943017232376951,-0.08123192370611573,-0.07653339123593564,-0.09616495120929903,-0.12192595147120304,-0.17496301515634682,-0.07059287895881208,-0.046780861752456375,-0.16437809484202476,0.14253498608240173,0.1434411369074771,0.1530152950189799,0.06583376270068464,0.059359018476429846,0.05376104982802559,0.15230609413507049,0.101862215677875,0.13757916099532377,0.11548626497306268,0.05327533571114104,0.05899761712424115,-0.1066607876367741,-0.086171574454146,-0.08269178348275263,-0.23461394855242163,-0.20506147578568265,-0.0962804539693728,-0.2199293744975862,-0.14592405839284292,-0.13425715267958402,-0.21192644919071138,-0.09537219597145996,0.26928656571228315,-0.07688676808090406,-0.0661823124878767,-0.04188944999073125,0.29089561345033116,0.25753808563964525,-0.1881893440235909,0.054784198121360296,0.057903275684089935,0.05879625717386734,0.05436314193088786,-0.045905388541485986,0.05855278006568593,0.054012322763823596,0.04488482576647716,0.08459154005650102,0.061712758567638394,0.06119432088261684,0.13059898286811686,0.06276775241907218,0.07753734164380986,0.10040010512213851,0.2180919035638561,0.2779715419032003,0.2643154000679399,0.1613169177294305,0.1158160323457073,0.2706394413061214,0.1019685029842887,0.13584411902010582,0.2643786835588657,-0.05617374704368655,-0.060339759327733784,-0.051496692820654354,-0.03613610408062874,-0.02987166443119546,0.05841952686142804,-0.08191204122222884,0.061568743032351506,-0.04379522065448544,0.024603959890434055,-0.0790929342854512,-0.08475624097974058,-0.03460048818181014,-0.025878298297499883,-0.023834163329231346,0.02470881174893144,-0.0517428956264172,-0.03376117024120976,-0.02829165717562868,0.02531687198806684,0.008527808460465481,-0.034086955949167844,0.018682013028362095,-0.05295119352643606,0.13619386072965764,0.1486184383192759,0.29805850475026624,0.07170509788080134,-0.07148472388609928,-0.039829563447356706,-0.020225530953605485,-0.07123550843502494,-0.06663454920705913,0.25961668129789556,0.1353904579055904,0.0816971517690672,0.057390238886423424,0.06619082588596724)
shap_list[[7]]=c(0.010777906127729244, 0.061524440048413405,0.030587694180070103,0.07301841319643573,0.06703961024222531,0.15365757810578407,0.19905892271281803,-0.008101840167030248,0.21931340127944923,0.1428314440923927,0.0009663859278962357,0.09681319012470434,0.14390283925408365,0.09828175656017607,0.013958034960282811,0.0012890818119972603,-0.015259517694840144,-0.007573391099926619,0.0003140281587806024,0.01472079185009627,0.012453872568239705,0.016169464320247396,0.007342790378203616,0.013690056573287044,-0.12017047858186806,0.005597573117782849,0.01622012083051267,0.02979249666875372,0.027453800288615816,0.018985919450448224,0.04520557224899574,0.010616819144227055,0.1904842235302964,0.0414578488449465,0.1831243630209039,0.020917949896842376,0.01470830284027439,0.1300006021297581,0.08262303564376229,0.09242848804905579,0.08211663775127075,-0.0028379919871875502,-0.0009856557751417082,-0.0014238755675317156,-0.0040480630760003355,0.0018601841719270392,-0.0021569704727913233,0.0005809816981915648,0.005106628965188238,0.0009874314625387224,0.024647801384129073,0.005235544578719882,0.008313039685525353,-0.0016946118350959643,0.003047723755459056,0.00676629157845675,0.14294093707889224,0.0021974007909430155,0.026627860299676974,0.06298033937428071,-0.000945118848286619,0.04714330710330983,0.013907383453176023,0.18480857907966994,0.09822299837316334,0.011002829883431878,0.17974401112826727,0.01466497518898086,0.09674006201115869,0.05222863669760386,0.014092535758669034,0.02326242250727985,0.18023722217782354,0.15335298242218776,0.13387070680804097,0.009486304488493661,0.21426286787538956,0.02126142955356473,0.19887188764658412,0.037797449765966266,0.003965313083666809,0.010041218493470472,0.04556168029143216,0.1601142258187935,0.10741804541012948,0.18238047848185868,0.02611690323871999,0.04111008597394365,0.032839546934598424,0.06881687190279212,0.03954293935739431,0.0597040179607087,0.041202983179239934,0.00524314855729407,-0.01272917764332983,0.19702535200369356,0.21247996446523498,0.19857089185003565,0.14212765896258606,0.09612245844199588,0.21641362628169686,0.16566662564992501,0.05054434205574889,0.20424187737358412,0.04426106958806938,0.218561368761157,0.18961704409138394,0.016744384892205342,0.013647093580839332,0.024076377651953914,0.20037189405013983,0.17974090283490643,0.06196513823910949,-0.003667589216124983,-0.001554110398166269,-0.0013471513188664495,-0.005027824543636998,0.008566393528140119,0.009003153517995618,-0.05763433708455148,0.013645266353676994,0.006430035291043222,-0.003800150616224748,-0.0038046106430881547,0.022936436214613058,-0.0039099358433729685,-0.00823906241537401,-0.06384024026820873,0.0901399561135856,0.2200415668379392,0.11484264053037894,0.11247621388366957,0.1463304671340704,-0.220973403931885,0.22486325786835806,0.1592481004920404,-0.2307523234419717,0.0229649569235618,0.03957070858434866,-0.006638327947307933,0.009844851179072016,0.09725699711502285,0.22207559044879616,0.016308784410414136,0.22124265245978397,0.01633748867906008,0.16994621431793686,0.019929120148240168,-0.004767615840154127,0.08448315349767463,0.08596007983307688,0.09287483419662199,0.17866367443383918,-0.002817473913146445,-0.0037399073970751213,0.0029155589682593854,0.05525333594457774,0.03214179676089039,0.02517641988862922,0.060167261174423746,0.04405415603793052,-0.023752005146701286,0.00797860721813028,-0.10759712001884322,-0.044170418960638176,0.018638928434310715,0.004690429067358963,0.011415415857928818,0.0025348119145661165,-0.0031913455123084495,0.10652776212322455,0.05031154746682298,0.037136580900309676,0.033926816664733773,0.023839838377998093)
shap_list[[8]]=c(0.01365587481978568, -0.05129529758336932,0.06599729452543149,0.09219924734501879,0.1616539197730762,0.2601042190934125,0.34073438409111073,0.021781353086433673,0.3388377461670114,0.24897271014960126,0.03288210115942215,0.193763535592896,0.32612688591392586,0.1935252815597945,-0.05095006477695789,0.007048235586591967,-0.1629893105150332,-0.08752586728059863,0.0019109399915153594,-0.03980831613936568,0.028113260910095268,-0.03595027417067348,0.03047625656654826,0.10342658942597484,0.1826703984318893,0.2363628087714807,0.04313731051180337,-0.015499519595009061,-0.018745173053110135,0.0441317139338881,0.1487582253494841,0.061095419957557726,0.3383647626615647,0.09520421418996683,0.33772750042052796,0.10810971600260177,-0.05607624657000502,-0.22642801778364396,0.02173596789009292,0.012390547807576419,0.013009769311911173,0.017061206592789355,-0.06090002758018705,-0.1292686131258739,-0.015147009994312373,0.0038377089007643056,-0.04904264705315758,-0.05848920888116071,-0.04581057579085534,-0.03102518867651581,0.006765084149860486,0.005437644467079492,0.008254979810953321,-0.05389878320879022,0.0029752340876195663,0.03233312590001612,-0.10284154747154585,0.048548248969879554,0.053955441516056454,0.12492363262692528,-0.003351817559101436,-0.1591023630434186,0.06641679708269674,0.2595442300272632,0.22263741175674404,0.04763415224697811,0.2624438371055907,0.07224815046655844,0.21201014261110676,0.10935696629310152,0.036860844119751386,0.0980334326013823,0.2156061584939647,0.28528703085927226,0.23125454870456802,0.07223808973472384,0.22227101949332562,0.09032181690760492,0.28514553741889564,0.18130498300038156,0.060679407708452496,0.05034763235380701,0.17090076659617667,-0.048171680158608454,-0.03313441272639966,-0.0044605801286816266,0.02549576837363068,-0.0466447987124949,0.004241841658543124,-0.33125661922027444,-0.3906732251537209,-0.3517937121236472,-0.3269639220970396,-0.1748991039684189,-0.15265239921493956,0.2686887807233877,0.2176650880531801,0.23955501946802726,0.26142029143395956,0.2052812748403871,0.2233869897326819,0.2834883794320603,0.15928944951511614,0.3128436240820935,0.1587293319877109,0.22122900341625618,-0.36498346608090787,0.09801378038368412,0.06739121006696795,0.010493740242270582,-0.2767246339601031,-0.37203295098297895,0.22125106987592597,-0.06986902823547889,0.006642782196605466,-0.003958455218297663,-0.03576994551954195,0.05701490034914586,0.020161087402172716,0.009453883642816267,0.0006401504697672646,-0.09630944762791846,-0.05006847515402822,-0.014566898508208777,-0.017077129698765504,-0.04844561721969144,0.10593116241194259,0.11856388554898403,0.030780172654128985,0.061457106290684335,0.1829050882921254,0.12612480941079154,0.07728312927258098,0.2006657176807114,0.04425725849311805,0.0831350581630036,0.20317760954164849,0.07511369354425089,0.2420735802035337,0.056443821416916055,0.06887250962135831,0.22409222703830575,0.2738445534589632,0.19638861966620805,0.2850696883020304,0.07589168004144707,0.34997272386809963,0.1997846910482547,0.11209140169314848,0.20232225622332578,0.1982204878176473,0.22823009526705537,0.2474373772748704,0.06116439057694744,-0.02952892183602761,0.005080123558958648,0.07088180097516679,-0.028608721855826615,-0.09526891121424531,0.2235302217978023,0.09305161740144674,0.14731284660012597,0.14621177717568887,0.18853370639812586,0.07785166157775995,0.0921980418955369,0.04033284836082021,0.013829382837652065,0.045633493676498695,-0.0008748020913215949,0.03413941012851217,0.07000324494361282,-0.06089217276003545,-0.020012714279409746,0.03502306616138881)
shap = do.call('cbind', shap_list)
baseline = 0.32987101026940774
rate=c(0.4138596333516147, 1.1135872737378232,0.6024163100046979,1.1021440128094513,1.6156719331881457,3.307947350146431,3.6241292736249835,0.15098635558371873,3.9318462605846354,2.544761788396128,0.16957981136064684,2.2557000705158745,3.3736943915835926,1.8625808750775963,0.46435193162603755,0.2678218210326547,0.24794292187306313,0.14626652621966854,0.4010280366909897,0.48184169611187483,0.45158723604204054,0.43039912095380745,0.2960886224140221,0.6271160362984219,4.376548179635356,2.110465547289011,0.2932953907178126,0.20395908293985765,0.19214598529700658,0.30293434966035393,0.9550039020200323,0.28201455599510034,4.274264913768029,1.000155202495442,4.092567438168951,0.665268980165092,0.2124651429231704,0.8386434700862401,0.8612448402548694,0.5830145670583062,0.7517648237489486,0.21588404457309487,0.28907380296997065,0.24934728338877687,0.23463251040575886,0.3925995143833201,0.24485698357267513,0.29779472271890617,0.35523467998605673,0.3594602023993953,0.4003423002219697,0.4444147867701435,0.47755439314067133,0.2640094374431251,0.40147791269083144,0.4654613126378591,0.7914448536643983,0.5821696317316755,0.5250527327204376,1.2738876152177463,0.47020632265012136,0.4185975746103261,0.3138962885360365,4.228981638305118,2.3682084361256037,0.30963008573090406,4.042089889092455,0.3425479543210271,4.250260230990242,0.7205716075942358,0.22938074327380883,0.5687794423916059,3.6952719306462662,3.6036338545704263,2.352208141042269,0.4084028911080725,5.602419681478392,0.5138772168442661,3.3140960515175357,1.1203694954011398,0.3358884629853363,0.2950642237769357,1.1584489550263133,0.8596857461046293,0.7790545270512149,0.9740203118377917,0.26887886805646066,0.22101301099136275,0.19456531596799462,0.7637709072802801,0.32634039821486244,0.6421551770850701,0.4681918214477205,0.3059767100832888,0.36795881419306375,4.748703876746762,5.680962869713403,4.227181414612559,3.3814753500190644,2.165907185750117,5.621737631210167,3.9607841805621393,1.4657780986496383,4.691237780000109,0.9365668976861191,5.641745043691217,1.4688926232782051,0.598564661577591,0.5599447444821578,0.3920617372074204,1.7137094030666928,1.4409465344243362,1.883171000008487,0.3029080235628634,0.4550076153667361,0.47196315417285434,0.36385007965087235,0.2599023166181008,0.23954704151677078,0.19382530963637443,0.14454854591508148,0.3326810304726831,0.3272215790838978,0.3364917031950801,0.6388825617263051,0.3275788907766463,0.47263187828527436,0.554045852531229,1.2308882106570627,1.2357235888303615,2.3695063570342354,1.3356449833343549,0.8689516015849885,2.6040114610768796,0.8599405083376015,1.0203151112366093,2.624055814644453,0.4984211154490127,1.7047312167401736,0.28533099261290135,0.49824939931775736,1.8382701581509304,5.352940284724715,1.2745144292361839,5.281787046916927,0.3979576480477224,3.593862167485394,1.3492956877867919,0.6094247857945823,1.5142996173154097,1.541297656707734,1.7837775192866976,4.659879026372313,0.3410744524449669,0.19312516836965102,0.2868812587526988,0.8924276045072581,0.5555887428203492,0.6276951588658972,1.926416024082978,0.6909221323807615,0.8301822804160119,0.9553573268714219,4.325759860737805,0.2742177252142684,0.5216226810826511,0.3214488212282469,0.560140269742389,0.28383882889065204,0.2687695342727322,1.3357963614472999,0.7367145937894617,0.3290166381418453,0.20383290328387677,0.27336272532687994)
rate_lwr=c(0.07290895222065374, 0.039530570173977125,0.1671425027341081,0.19150328297538935,0.005691020036153682,0.06382663099435715,0.8813634969389716,0.015255661634780426,1.290674943008415,0.1982083659115494,0.009728926302975754,0.0444136405267479,0.48787692825580664,0.026401580800210656,0.05805311405689634,0.023228164200226498,0.048300691356300135,0.01852776207907797,0.08090256547156827,0.0836211563905786,0.019453702745981905,0.03035898860358749,0.02184647731703901,0.09902491772796135,1.3358214390522603,0.09000455398497612,0.05737633402139797,0.010760164130081573,0.04481782848681437,0.073739988468151,0.16851125917178122,0.08567757551212277,1.5106197971613888,0.09666246693934455,1.1902030563276693,0.07726969289420507,0.03917879656003609,0.04501936585330096,0.12403738987685103,0.03178924824252033,0.07153818400449957,0.00981201239869206,0.08937756361436397,0.01245214646354631,0.03465670189781539,0.12301078908791085,0.057094162684530214,0.061034699452325536,0.023582003146601804,0.11812265182575302,0.01708580365350565,0.09172643229478245,0.13246287645309945,0.05947877972233362,0.12082252409237049,0.12173414536503735,0.0044505906458516264,0.10248014105907344,0.1253098439714866,0.06089280595760871,0.13036506971240258,0.027891384782100626,0.0655663677927833,0.8999139067993467,0.3365707142860845,0.0627987934522698,0.8927292926279456,0.0808348403595664,0.9413945469920137,0.014844725664627328,0.022550334819928408,0.07655635187198478,0.09729879262850721,1.1049524670328585,0.19900384699403084,0.034022009761791316,3.0587124488940454,0.028701013220687854,0.31584088632616214,0.21157976851001115,0.008599377457909813,0.0735553799042416,0.06403823222817495,0.06747000127410974,0.12911507319551324,0.0621711296227655,0.04853842986071921,0.026488722249349173,0.003924641566057957,0.09192582290256135,0.06686301340021675,0.11408798467254888,0.08790314003661404,0.026253407180753002,0.046096595210014246,2.2447223305280577,3.075440957978733,1.4594034585012106,1.0368111191437743,0.18782997192820194,3.0769402828936347,1.373383355255811,0.0668145832660052,2.0353468153918093,0.19629022885006392,3.0422303356015465,0.13637842712751108,0.0952282774104497,0.09514049405406683,0.0066339190880307375,0.1659385323364016,0.14919986849739705,0.2291982485932254,0.10521349801752797,0.11753382766627699,0.13837016617440512,0.14068297668866753,0.08606151792203309,0.0355015956667874,0.031163239316769398,0.01865101423589105,0.021960730204052425,0.11896297983149043,0.11375916463490796,0.0521781866948296,0.11397203037782516,0.04071003413760496,0.03202554732067653,0.20051872340567478,0.06925238621653124,0.06577526096635755,0.08986069708098549,0.11248138985721227,0.4747636950866195,0.021500125203377796,0.12214036429456865,0.41029675056978726,0.023625471968250045,0.33116100823955075,0.02607681525946326,0.02435599450519177,0.3075437735532535,2.9858718295527593,0.32949028412088655,2.588672968744924,0.009546629822111408,1.1144556480428407,0.27181828694016946,0.137712737585661,0.4252826681383079,0.3502633452923442,0.29594419576510905,1.8586569214276423,0.006728006306356199,0.017795619169759497,0.04397993142940071,0.038954363365972466,0.044116812432015706,0.01047719875949571,0.004896349212039741,0.03309202398466379,0.08792982810999109,0.07602708442873654,1.3573307483094952,0.018157835844227754,0.037599776455053135,0.010122349624358318,0.03721995788299265,0.01257463185273583,0.055276887639081757,0.16478658629101278,0.1700283857430617,0.006497905729117626,0.058831106240621434,0.02343406119690422)
rate_upr=c(0.9965108169862996, 2.91067254598288,1.2404259928272663,2.341353297594641,5.773031974009831,6.419408213164098,6.470509566220841,0.2983257516076574,6.915329437984376,5.270146209988625,0.3678107518466238,6.13208197016472,5.929593298548483,5.803676039857356,1.1994342790783679,0.6971525262629601,0.5763289073755782,0.292318258450242,0.8248559747914607,1.1478247992313224,1.1719258396461636,1.1087039417868256,0.634035306405355,1.4753455872197567,7.047878443713143,4.8095950890049775,0.6725087857609228,0.5163613912406013,0.3632629615999237,0.720119639433475,2.0009060422681064,0.5376775064604755,6.9356590115104675,2.636619914242795,6.864983667632834,1.7283328816653665,0.5240347440533224,2.5291757853739085,1.9727748834664545,1.580285945119769,1.9273350629272183,0.5174896726262264,0.5582867078465835,0.5715920737105662,0.44747177222372814,0.7203306046243452,0.4751813695066216,0.6134782658074827,0.8601564464797,0.7176228459150902,0.8832805679818486,0.8374322150155293,0.961632268304558,0.48381463202195235,0.7132988738349544,1.0076903241307402,2.3007879076110735,1.2690265034365449,1.0438000184862801,3.306589744485342,0.9750526210164303,1.2554349831957725,0.6330055344007223,7.115840184807702,6.28263482521031,0.6396409339855342,7.05368478619655,0.717344372738703,7.467016645682929,3.5176404770762417,0.5251015557807943,1.9848674429790307,7.052071685581938,6.0445240003887175,5.180234585862126,1.1398038165499376,8.171951881852204,1.3626257347302397,6.162691626233032,2.50100636604623,1.0726467676709723,0.559632083920073,2.877522745022305,2.309778094968187,1.7320974808364014,2.718724186816539,0.5399688411536411,0.4863688628347288,0.44461731281547934,1.7471883444812601,0.6432226280313509,1.4325102107290606,0.9263902705261462,0.9086343358426257,1.1418374982393669,7.574541595392553,8.256090332470226,6.792256556978185,5.929936211195524,6.330686736159693,8.248223893526124,6.294771355497289,5.892300104564089,7.358297162875156,1.9880801395932335,8.311676961541473,3.4408013896590885,1.4437327880838031,1.3416742726957114,1.003736597114666,3.7304656854122724,3.2900947177121598,4.124811388130645,0.5575262155846645,0.8727557091374646,0.9150758300092925,0.6211227549092289,0.5028377553745781,0.6080384166341368,0.3983934300543499,0.28147200975708025,0.8995623066202373,0.5650257340893805,0.6172542722455994,1.5491067926878923,0.5677803379433478,1.1386827615524822,1.3737456900836327,2.751103786755226,3.5125700661648245,5.005519208791036,3.4056658973401324,1.930696186008604,4.937244191480961,2.170718718438946,2.244430332992688,4.917902953454483,1.4257343990880693,3.33056910189384,0.9146324580593533,1.888528223965685,4.525940472081689,8.434911933634712,2.491577004735538,8.207429202357874,1.0862608393616127,6.2357684677792955,3.033998861808186,1.2204593332540234,3.0637009856293016,3.0959977193919253,3.5682972360414436,7.352606831093889,1.240724644520651,0.4499326720665362,0.6209229768309166,2.5221417922502973,1.5796059537446463,1.730255559892847,4.846579101431945,1.7281492301879817,1.9409803067585358,2.5164876568901047,7.13826537867415,0.5959521609206758,1.2737262066855588,0.8297294329964137,1.5214316583885523,0.7008274052295023,0.5137778441962189,3.0189338151038756,1.4903852381507041,1.0177890206364053,0.41244312405387384,0.615696673050907)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'Temperature')
feat_names = c(feat_names, 'Humans')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2, drop = FALSE]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[3]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[4]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[5]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[6]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[3]] = tmp[, ord]
feat_states[[3]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.83163279721596,10.29810557211113,8.193996520752748,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,11.45516312611962,18.316996330471802,13.644381033687072,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.919573411394193,13.644381033687072,20.505765520098972,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.275304079953862,11.610334918074667,9.991905577866738,18.464662994362794,19.037996316919237,9.630996493741618,22.26749625621469,10.683496473957888,13.47221864376079,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,11.566150303520583,14.53068870933493,13.78444086011421,11.841227221426918,11.438227229002063,6.657265780407739,10.904765700567948,11.296188770133483,13.55414456814677,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,17.44349634689089,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.318996330434206,4.058996598477934,9.179446502229375,3.2289966140793247,8.156796521451984,8.13719652182041,9.24823400093636,5.8691632311190585,6.680496549201861,9.222796501414518,17.887359974911266,5.5135590711366635,14.197688715594296,10.74007339597134,15.251534849631417,10.647178292822375,13.509885309719447,9.014881120707269,20.39513914855202,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,19.213662980283914,4.400446592059717,9.341546499182357,1.4329216478399402,8.275121519227847,18.093996334663508,9.341546499182357,8.275121519227847,8.396996516936989,6.486996552839075,17.63799634323489,9.341546499182357,20.39513914855202,10.15963284744126,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,11.45516312611962,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,13.644381033687072,15.03049639224779,11.451546459520934,9.062465735197444,10.647178292822375,22.62499624949477,9.026196505109999,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,8.672663178421974,19.709996304287746,6.680496549201861,11.754396453828296,15.70239637961816,22.26749625621469,9.45499649704987,8.672663178421974,9.45499649704987,19.634996305697506,18.82474632092768,8.396996516936989,11.45516312611962,22.62499624949477,22.62499624949477,22.26749625621469,21.779996265378173,10.058496485705948,14.172329741711991,17.899611722932722,22.72199624767148,21.1276885853318,12.586611822800617,9.906796488557434,22.72199624767148,6.560946551449007,6.758613214400147,17.61049634375181,10.757363139236089,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp=c(0.0, 0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,2.0,0.0,2.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[5]] = tmp[ord]
feat_states[[5]] = NA
tmp=c(-0.05651836162797346, -0.06480256787204668,-0.06809418260837145,-0.06806181503686257,0.06662662272007806,0.06706748996264623,0.06825597448802538,0.06666227846724812,0.06709458775663184,0.06713239507833531,0.06826460722074876,0.06688178793127686,0.06863777380071477,0.06839968625330488,-0.06455968653903116,-0.06021817588084175,-0.08058331448423661,-0.08076132055424771,-0.05721895768703083,-0.05682971483105193,-0.0568190706186041,-0.056950796342111386,-0.0569284258319477,-0.05713965744168112,-0.08041130094750801,-0.09049607488949253,-0.0903139438266748,-0.08982139917622144,-0.09030055659317993,-0.09083610794804303,0.0988983385268792,0.0952072777293202,0.09941741977796538,0.09973969422155841,0.09982002212841251,0.09592980524036564,-0.07390082103774019,-0.06490742151401967,-0.061142376299037515,-0.0702127722105736,-0.07047062655893609,0.01698222967843764,0.00910227979169506,-0.045138249869302594,0.026733076852176584,0.017059423995310276,0.011411190850650553,0.000748164565854522,0.017012646919015873,0.017010340460265068,0.02913649219253861,0.03463234222333615,0.024989132200333646,0.012872786084299608,0.025151143362559962,0.025249338226786905,-0.06969722985016336,-0.0686013422769117,-0.06809411692728987,-0.06879735848186957,-0.06835803165869436,-0.0719047603127395,0.09622919283729005,0.10226698481869084,0.10160692295055165,0.09654364348338464,0.10226698481869084,0.09968831280882494,-0.08180474365899758,-0.08142226957283229,-0.08143000518573135,0.09924179592616288,0.10234361726117265,0.10142429134622544,0.10237047218311697,0.10094321635565486,0.10147968237241968,0.10104522609934904,0.10235445556959867,0.1023049944715206,0.10019478018514638,0.09812368583642342,0.10235083718313466,-0.05855712798097906,-0.0587604338319199,-0.058813862101973854,-0.07861813300355343,-0.07865969274740589,-0.07878576015105078,-0.07739148820834478,-0.076831349246591,-0.0768395003244555,-0.07671330094542568,-0.07781427262004945,-0.08120654178786313,0.10488074039747473,0.10492030396181705,0.10476877487732145,0.10465136081887044,0.10287656114490452,0.10494257618152818,0.1049422597216283,0.10412742684016915,0.10393387610749354,0.10272497991075555,0.10478039473582063,-0.07092639883389602,0.0781320341637059,0.07832700974157289,0.029275121086986083,-0.06814341448267815,-0.06760994501472208,0.09758999342297486,-0.0642453420080075,-0.06473341117236422,-0.06475310809115625,-0.06485640163060172,0.0912280782274644,-0.08587207132628637,-0.08542729455061523,-0.08569848540137272,-0.059474745791523315,-0.06593415179373348,-0.0661987037720193,-0.06607813807185921,-0.06623430652846982,-0.07863381728512676,-0.07806886319853502,-0.060763758618417964,-0.07650330959233965,-0.08076591525113466,-0.08051463161259971,-0.07931716838505198,-0.08080810848957948,-0.07835119450270042,-0.07929356474964296,-0.08072495607931025,0.09208692568974744,0.04409495615167945,0.045118058295874335,0.044915752629682476,0.04644617136297667,0.04569526202328689,0.045907134152386606,0.04515145075178281,0.04459211094823683,0.04630040552947146,0.045896443637128775,0.04576885007213378,0.04602575334206345,0.04515550083723579,0.0464553519883399,0.04610030362057164,0.04379927902317676,0.035389639064430316,0.03575476535142663,0.036392168454709606,0.035344660433078705,0.03567048378861443,0.0357481553081906,0.09627693110533266,-0.08044545413495895,-0.08035133159965714,-0.08058963729742737,-0.07951361217573848,0.07983960128172365,0.07976356020000391,0.06589172985986919,0.06560461900903364,0.06561742012174449,-0.06534195927062902,-0.06565044738062739,-0.07814922888272295,-0.07870922113534479,-0.07823200925589514)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.008340059169112657, 0.0034883197099496535,0.00397167951047656,0.003966930731779293,0.00043759936864947135,0.00044491160787615055,0.0004655848532984965,0.00043809012971686553,0.0004453904140988316,0.00044598670670882324,0.0004657321315609854,0.00044182573223547393,0.0004721868121530568,0.0004680514164795048,0.003449282010023049,0.0028406678394692782,0.09070592034039324,0.0954081696013839,0.008604010671771748,0.008456380056160447,0.00845274093806766,0.00850185879276496,0.008493552310750805,0.008573385928908252,-0.21396927932102533,0.129959214002841,0.12930325307107002,0.12751885603396082,0.12925473806161308,0.1311944537509816,0.0030172594919760623,0.002726666441613978,0.003057466434583522,0.0030825347661421047,0.0030887721398484146,0.0027828212570103,0.06436805546099711,0.043337547906052404,-0.08658538463107102,-0.14561957981343251,-0.14696955293322092,-0.0020980582220398165,-0.0021908402989456546,-0.002913069055306161,-0.001834799738446175,-0.002122133690950296,-0.0021442545314092516,-0.0023240906690761708,-0.002107502886787055,-0.002106786150268457,-0.0018068141253373565,-0.0016529822696032693,-0.0018853266117037006,-0.0021206601726511975,-0.001916307573773066,-0.0018995315469932752,0.054205562398901154,0.0040484760055131365,0.003972658112302309,0.004077610226565219,0.004012343452167758,0.059517737284699855,0.002811455067967546,0.0033118386127495526,0.0032582140493638834,0.0028382017176417683,0.003311838612749575,0.0030990841825712812,0.08426788762251568,0.0832790956797318,0.08329822319150125,0.0030467892914208877,0.0032966092213777905,0.0032213887898897104,0.0032987805776155264,0.003183078241788871,0.003225813413394385,0.0031911800420981826,0.0032974825888799956,0.003293486388801876,0.0031230001392814873,0.0029578388737870444,0.0032971903298754006,-0.0648108163591692,-0.06538049074765084,-0.06553000536091544,0.07604397282684437,0.07614513283839958,0.07645197419937319,0.08098823503314455,0.07951151158974984,0.07953267072637851,0.07920473823081636,0.08248350191719443,0.09248558238354984,0.003535456900630439,0.0035388024235848397,0.0035259793624098793,0.00351605577574263,0.0033653403814204986,0.0035406880576945568,0.0035406603781880266,0.003471787422645344,0.0034552943006736507,0.0033529028582070654,0.0035269458461859864,0.06225421163217933,0.0013760749141570707,0.0013847163026276925,-0.0018285934737689873,0.053043784099848126,0.052001839144063006,0.0029143948435073593,0.0034071455375004954,0.003472923395489737,0.0034755839074276005,0.003489541786792354,0.0024110679439585327,0.11312751676551824,0.11165950568359569,0.11255396073668338,0.002738961042720718,0.0036537623255732837,0.003693934136001706,0.003674808232994058,0.003696716889959983,-0.2019665034465181,-0.1983222055559574,0.0029048623483089774,0.07060951571973784,-0.21641982920993974,-0.21473141934325926,-0.2065941465084821,-0.2167040927631643,-0.20017693448706478,-0.20643997527805347,-0.21614431139920962,0.0024773138451578787,-0.0034670541876899255,-0.003685678220803348,-0.0036440766349708723,-0.003971734406561932,-0.003810164528110645,-0.0038556999933591204,-0.003692526654966078,-0.0035772605459629386,-0.003940425058957709,-0.0038534468100514837,-0.0038256185693920416,-0.0038815745821877273,-0.0036932494472738395,-0.00397370689900717,-0.0038973724167359223,-0.003408723299144487,-0.001669524174928423,-0.0017271037753260892,-0.0018147630589366878,-0.0016548839503539403,-0.0017245055650481232,-0.0017135574720451125,0.0028130088962780545,-0.2141975417330544,-0.2135688377528635,-0.2151658165733002,-0.20795048657350845,0.0014961810087010066,0.001492603375792766,0.0004158404553953644,0.0004112972981189502,0.0004114995935813801,0.0035583205131917723,0.0036007423295789506,0.0748643791004821,0.07622581213361314,0.07506452076896544)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(9.437999999999999, 14.895,6.2895,6.2895,2.19,1.2905,1.2905,6.2895,1.2905,3.09,6.2895,2.19,1.2905,2.19,14.895,9.437999999999999,30.999999999999996,25.565,9.437999999999999,14.895,9.437999999999999,14.895,9.437999999999999,4.4665,0.00585,1.2905,6.2895,12.724999999999998,12.724999999999998,6.2895,1.2905,2.19,0.06885000000000001,0.4535,0.00585,1.2905,18.205000000000002,25.565,9.437999999999999,9.437999999999999,9.437999999999999,9.437999999999999,18.205000000000002,21.735,12.724999999999998,9.437999999999999,14.895,18.205000000000002,14.895,12.724999999999998,9.437999999999999,9.437999999999999,9.437999999999999,18.205000000000002,9.437999999999999,6.2895,25.565,6.2895,6.2895,6.2895,9.437999999999999,25.565,2.19,0.00585,0.4535,4.4665,0.00585,2.19,0.00585,2.19,4.4665,2.19,0.00585,0.4535,0.06885000000000001,2.19,0.06885000000000001,0.4535,0.00585,0.4535,2.19,4.4665,0.4535,14.895,12.724999999999998,12.724999999999998,6.2895,18.205000000000002,9.437999999999999,30.999999999999996,36.3182805,30.999999999999996,30.999999999999996,36.3182805,25.565,0.06885000000000001,0.06885000000000001,0.4535,0.4535,0.4535,0.06885000000000001,0.4535,0.4535,0.06885000000000001,0.4535,0.06885000000000001,30.999999999999996,4.4665,6.2895,9.437999999999999,25.565,30.999999999999996,1.2905,18.205000000000002,9.437999999999999,9.437999999999999,12.724999999999998,3.09,9.437999999999999,9.437999999999999,9.437999999999999,18.205000000000002,14.895,9.437999999999999,12.724999999999998,14.895,1.2905,1.2905,9.437999999999999,6.2895,1.2905,2.19,4.4665,1.2905,6.2895,4.4665,1.2905,4.4665,0.4535,2.19,2.19,0.4535,0.06885000000000001,1.2905,0.06885000000000001,3.09,0.4535,0.4535,1.2905,1.2905,1.2905,0.4535,0.06885000000000001,3.09,18.205000000000002,9.437999999999999,2.19,14.895,14.895,2.19,2.19,0.4535,1.2905,0.00585,1.2905,4.4665,6.2895,9.437999999999999,6.2895,9.437999999999999,9.437999999999999,6.2895,18.205000000000002,12.724999999999998,6.2895)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()