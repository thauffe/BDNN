pdf(file='/home/torsten/Work/BDNN/Proboscideans/PyRateAnalyses40Ma/Humans_Island_SpTemp_Grass/pyrate_mcmc_logs/proboscideans_1_G_BDS_BDNN_16_8TVcb_contribution_per_species_rates.pdf', width = 7, height = 6, useDingbats = FALSE, pointsize = 7)

ord_by_importance = function(s, consrank, rate_mean) {
  imp = consrank**2
  s = scale(s)
  imp = imp / sum(imp)
  #imp = imp / max(imp)
  s = t(t(s) * imp)
  p = prcomp(cbind(s, scale(rate_mean)))
  ord <- order(p$x[, 1])
  if (cor(1:length(rate_mean), rate_mean[ord]) < 0) {
     ord = order(p$x[, 1], decreasing = TRUE)
  }
  return(ord)
}

is_discrete <- function(x) {
  any(x == 0) && all((min(x):max(x)) %in% unique(x))
}

combine_predictors <- function(shap, feat, feat_names, n_comb) {
  n_comb1 = n_comb + 1
  idx_comb = n_comb1:ncol(shap)
  shap[, n_comb1] = rowSums(shap[, idx_comb])
  shap = shap[, 1:n_comb1]
  comb_pred = t(do.call('rbind', feat[idx_comb]))
  pc1 = prcomp(comb_pred)$x[, 1]
  feat[[n_comb1]] = pc1
  feat[(n_comb + 2):(length(feat))] = NULL
  feat_names = feat_names[1:n_comb1]
  feat_names[n_comb1] = 'PC1 other predictors'
  out = vector(mode = 'list', length = 3)
  out[[1]] = shap
  out[[2]] = feat
  out[[3]] = feat_names
  return(out)
}

shap_heatmap <- function(shap, baseline, rates, species_names, feat,
                         feat_names, feat_states, rate_type = 'speciation', n_individual_pred = NULL) {
  nfeat = ncol(shap)
  if (!is.null(n_individual_pred)) {
    if ((n_individual_pred + 1) < nfeat) {
      comb_p = combine_predictors(shap, feat, feat_names, n_individual_pred)
      shap = comb_p[[1]]
      feat = comb_p[[2]]
      feat_names = comb_p[[3]]
      nfeat = ncol(shap)
    }
  }
  nspecies = nrow(shap)
  shap_pos = shap > 0
  shap_neg = shap < 0
  shap_sqrt = shap
  shap_sqrt[shap == 0] = 0
  offset_sqrt = 0.0
  shap_sqrt[shap_pos] = sqrt(shap[shap_pos] + offset_sqrt)
  shap_sqrt[shap_neg] = sqrt(-1 * shap[shap_neg] + offset_sqrt)
  max_pos = max(shap_sqrt[shap_pos])
  max_neg = max(shap_sqrt[shap_neg])
  steps_pos = round(max_pos / (max_pos + max_neg), 2) * 200
  steps_neg = round(max_neg / (max_pos + max_neg), 2) * 200
  # BrBG diverging colors
  total_steps = steps_pos + steps_neg
  max_steps = max(c(steps_pos, steps_neg))
  col_pos = colorRampPalette(c('#F5F5F5', '#543005'))(max_steps)
  col_neg = colorRampPalette(c('#F5F5F5', '#003C30'))(max_steps)
  col_pos = col_pos[1:steps_pos]
  col_neg = col_neg[1:steps_neg]
  shap_col = shap
  shap_col[shap == 0] = '#F5F5F5'
  col_idx = findInterval(shap_sqrt[shap_pos], seq(sqrt(offset_sqrt), max_pos, length.out = steps_pos), all.inside = TRUE)
  shap_col[shap_pos] = col_pos[col_idx]
  col_idx = findInterval(shap_sqrt[shap_neg], seq(sqrt(offset_sqrt), max_neg, length.out = steps_neg), all.inside = TRUE)
  shap_col[shap_neg] = col_neg[col_idx]
  species_names = gsub('_', ' ', species_names)
  # Plot
  h = 0.15
  if (nfeat < 10) {
    h = seq(0.4, 0.1, length.out = 9)
    h = h[nfeat]
  }
  heights = c(h, rep((1 - 1.25 * h)/nfeat, nfeat), h/4)
  rate_name = 'Speciation rate'
  rate_col = 'dodgerblue'
  if (rate_type == 'extinction') {
    rate_name = 'Extinction rate'
    rate_col = 'red'
  }
  layout(cbind(c(1, 2:(nfeat+2)), c(nfeat + 3, rep(nfeat + 4, nfeat), nfeat + 5)),
         heights = heights, widths = c(0.9, 0.1))
  # Rates per species
  par(las = 1, mar = c(0.1, 6, 0.5, 0.1), mgp = c(5, 1, 0))
  cex_lab = 2 / sqrt(length(feat_names))
  cex_lab = ifelse(cex_lab > 1, 1, cex_lab)
  y_tck = pretty(range(rates), n = 5)
  plot(0, 0, type = 'n', xaxs = 'i', yaxs = 'i',
       xlim = c(0, nspecies), ylim = range(y_tck),
       axes = FALSE, ylab = rate_name, cex.lab = cex_lab)
  abline(h = baseline, lty = 2, col = 'grey')
  x = c(1:nspecies) - 0.5
  polygon(c(x, rev(x)), c(rates[, 2], rev(rates[, 3])), col = adjustcolor(rate_col, alpha = 0.25), border = NA)
  lines(x, rates[, 1], col = rate_col, lwd = 1.5)
  axis(side = 2, at = y_tck, cex.axis = cex_lab)
  # Shape values
  species_x = c(1:nspecies) - 0.5
  for (i in 1:nfeat) {
    f = feat[[i]]
    if (is.null(dim(f))) {
      d = is_discrete(f)
      y_tck = pretty(range(f), n = 5)
      ylim = range(y_tck)
      if (d) {
        ylim = c(min(f) - 0.5, max(f) + 0.5)
      }
      plot(species_x, f, type = 'n', ylim = ylim,
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      if (!d) {
        lines(species_x, f, col = 'grey')
        axis(side = 2, at = y_tck, cex.axis = cex_lab)
      }
      else {
        axis(side = 2, at = min(f):max(f), cex.axis = cex_lab)
      }
      points(species_x, f, pch = 19, col = shap_col[, i])
    }
    else {
      nr = nrow(f)
      plot(0, 0, type = 'n', ylim = c(1 - 0.5, nr + 0.5),
           xlim = c(0, nspecies), xaxs = 'i', axes = FALSE,
           xlab = '', ylab = feat_names[i], cex.lab = cex_lab)
      axis(side = 2, at = 1:nr, labels = feat_states[[i]], cex.axis = cex_lab)
      for (j in 1:nr) {
        fj = f[j, ]
        idx = fj == 1
        points(species_x[idx], rep(j, sum(idx)), pch = 19, col = shap_col[idx, i])
      }
    }
  }
  # Species names
  par(mar = c(0.1, 6, 0.5, 0.1), mgp = c(3, 0.1, 0))
  plot(0, 0, type = 'n', xlim = c(0, nspecies), ylim = c(0, 3),
       xaxs = 'i', axes = FALSE, xlab = '', ylab = '')
  text(x = species_x, y = 3, labels = species_names,
       xpd = NA, srt = 35, adj = 0.965,
       cex = 4 / sqrt(length(species_names)), font = 3)
  # Empty plot
  plot(0, 0, type = 'n', axes = FALSE, xlab = '', ylab = '')
  # Legend
  col = c(rev(col_neg), col_pos)
  n_lead_digit = nchar(as.character(max(round(abs(shap)))))
  par(mar = c(4, 0.5, 0.5, 0.5), mgp = c(3, 1, 0))
  plot(0, 0, type = 'n', xlab = '', ylab = '', axes = FALSE,
       xlim = c(0, 2), ylim = c(0, 1.05 * total_steps))
  for (j in 1:total_steps) {
    rect(0, j - 1, 0.7, j, border = col[j], col = col[j])
  }
  rect(0, 0, 0.7, total_steps, border = 'black')
  lines(x = c(0.7, 1.0), y = rep(steps_neg, 2))
  text(x = 0, y = 1.05 * total_steps, labels = 'Rate change', adj = c(0, 0.5))
  a = c(1, 0.5) # right align
  text(x = 2, y = steps_neg, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), 0), adj = a)
  n_tck = 4
  s = seq(sqrt(offset_sqrt), max(c(max_pos, max_neg)), length.out = n_tck)
  pos = (s / s[n_tck]) * max_steps
  pos = pos[-1]
  s = s[-1]
  for (i in 1:length(pos)) {
    p = steps_neg + pos[i]
    if (p <= total_steps) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), s[i]**2))
    }
    p = steps_neg - pos[i]
    if (p >= 0) {
      lines(x = c(0.7, 1.0), y = rep(p, 2))
      text(x = 2, y = p, adj = a, labels = sprintf(paste0('%.', 3 - n_lead_digit, 'f'), -(s[i]**2)))
    }
  }
}

consrank=c(0.0, 4.5,2.0,3.5,1.0,2.0,2.5,0.5)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(0.05087411287958048, 0.07181408418465347,0.14080559182585314,0.13781901127738166,0.13502116373170603,0.08629846494367159,0.12595648456841113,0.06817083262832291,0.09425603940378688,0.26627921685956957,0.07762658106839745,0.09101407864886528,0.05722239395829837,0.11106489913712898,-0.09624413835508357,-0.06485530574406384,-0.4673821656299131,-0.3296384675417918,-0.0487622022506359,0.2162705231851174,-0.10622764991943093,0.0673837828440003,0.055246344012651036,-0.0236637625800891,0.2514153500640698,-0.18142553245732573,-0.2356034759417563,-0.25891632195228903,-0.23841464140808188,-0.1994148195977885,0.4053049822043689,0.3347299094758437,0.5267706172696304,0.637857158394969,0.4823351246886311,0.3240383320617536,-0.17157952640765864,-0.1003964836644552,0.15242628212229556,0.42555508083992744,0.2888393358032626,-0.024025633857599014,-0.010464659711548446,-0.09164916536760287,0.011443599690648325,-0.03252144074814264,0.025765361393020585,0.03575096055778163,-0.09774511655093523,0.03013101543497887,0.06237975331819705,-0.060015841325305,-0.034670494066486396,-0.023001400129066017,-0.06796115327162404,-0.06085275031547562,0.3186188317241981,0.14805011061962645,0.1555331185040033,0.09275829732002847,0.11385156932595923,-0.344916064850291,0.3485173534783793,0.30333501623375225,0.3665720311295851,0.3130117240532937,0.3046946532669408,0.3399040459397447,-0.057163901990111995,-0.08789697710834753,-0.1323191647061853,0.36256872616870156,0.6540332775312692,0.9782113444075794,1.0251307453105332,0.4955891851679345,1.0358828695898967,0.3908201614038195,0.5339701839666421,0.47241658264843467,0.44560302410893565,0.3219314638306477,0.5679521589301408,0.2016312893199732,0.07876886255203253,0.19885042873934716,-0.061421722677112524,0.033791811284924866,-0.07005403990707873,-0.3630546160708057,-0.38359220416002476,-0.3838384899311808,-0.3699406560964822,-0.47239364718862253,-0.4724938211365218,0.6670969777057187,0.9821305463262766,0.8569939617654404,1.0244772604056176,0.39090174118302407,0.9866985661442724,1.0489651824500845,0.5757948548504753,0.5719199751487309,0.40873318933390984,0.9336778784171038,-0.21314199871626496,-0.02514429404201076,-0.022392969788224977,0.17104600530524655,-0.18505246572955614,-0.2126299782160864,0.34054139602497246,0.1013375408621742,0.09785836747206014,0.02199545158781383,-9.933865357308059e-05,0.3040807455922873,-0.3094490932403376,-0.34802707647660724,-0.4481698382189402,-0.014946266420506431,0.019392931133771524,0.1357023722945752,0.025097729770773423,0.061525150075022225,0.03506917363730531,0.14539467109625995,0.12157973436541311,0.22642666464966404,0.2467157867344158,0.03060652226518281,0.06403623002756556,0.1058407152487854,0.12726977930725356,0.06632311476057748,0.0995720241605208,0.32651130232713227,0.24946526297430488,0.24212897277288148,0.34785195294492366,0.49668520740461963,0.2703549789669959,0.2208255260488891,0.2732262636869582,0.25081699975673116,0.40270201206026607,0.2509237063205913,0.22018195418530845,0.5483332939438795,0.49778400028832726,0.48414348105373506,0.5120399698192168,0.4004857367561382,0.2738626124323032,0.19274978980091945,0.3184113410210812,0.30293145877397987,0.3968737043159619,0.17664756784251426,0.5219627795264621,0.20677856530018907,0.17460992826153807,0.3546599678978159,0.2133371595390133,0.19970429218902133,0.16949248941198175,0.1193013818894483,-0.03278107624570658,-0.017087843064327264,0.16951319627420658,0.0824543968209509,-0.07521450166114223,-0.08885727199999877,-0.06467579420924015)
shap_list[[2]]=c(-0.06171970073297646, -0.02171773879200844,-0.007418223479065844,-0.017882108858905267,-0.02846441238878857,-0.029090180796279612,-0.02475018584550217,-0.032075042766254544,-0.02468048011561035,0.09764805589222779,-0.023401025663504067,-0.03150654080801933,-0.02947522377919589,-0.027803336507670855,-0.019096868241844797,-0.05982863403176224,0.03656958082912643,0.014968130895654732,0.003375537381695651,0.037933489148876974,-0.049150473341367414,0.04538743505023886,-0.024640643231329605,0.019667345369437948,-0.056776240279012846,0.04905744197929935,0.12391342199232083,0.14957118420199564,0.12645829213329013,0.09583944991565478,0.013302134102786736,0.004117329686124925,0.011916986759146327,0.0724058810344503,0.007090441199424527,0.00374704577599992,0.055118548375334274,-0.02571112362408156,0.0038272721386538727,0.021224501475051623,-0.0058750277647185946,0.011757456196786663,0.03616970276948476,-0.04127584045003332,0.02355773148699159,0.009322851088319744,0.11471167442768848,0.07023789123425038,-0.004907073448394269,-0.01561348634474825,-0.037115439224207125,0.0018858515651938024,0.051196522894328654,0.024979545799793872,0.00020794868951303085,-0.01054409092436012,0.023245264744678418,-0.06637208395667074,0.003364491705535132,-0.02935133230894151,-0.05002901593866231,-0.012150834062160217,0.04290565401317379,0.01432718351983231,0.0013049734393298467,0.018901674193390748,0.015984108128432945,0.02582793827512595,0.07466821615229376,0.08552504834588703,0.044056868709264715,-0.0002669996473594439,0.23004373102927045,0.16421286933960327,0.1870446412309174,0.051496142903442246,0.17535230033372134,-0.005221814554495599,0.09290174739376898,0.01772427183541691,0.006405494048521715,0.006225555984124959,0.05414195829580269,0.003433545636551338,-0.017013037708905953,-0.004332852036603718,0.05295318820461374,0.015488535326209096,0.06297387949326574,-0.02194876790034938,-0.02640448733569136,-0.026502963810630536,-0.031846286965862274,0.1190192422853998,0.08813337995210732,0.055584781103862516,0.19026601495736925,0.2164741142466266,0.16782513054070342,0.02704270748932931,0.18323649365346353,0.18858688242564547,0.04622904036837626,0.03829324409388253,0.02823000060799054,0.19022038758036924,0.047181463416476464,0.010076334788362645,0.011797665470910032,0.015468177879992061,0.009377926679943027,0.04756816852010246,-0.04596886309462263,-0.08571569079736177,-0.08036209702295824,-0.08283708165583062,-0.0883060878493464,-0.0019170872768597101,0.039763841543092926,0.020856778992553997,0.04498091073608988,-0.047512948177505496,-0.08510185266878376,-0.09102771882250435,-0.024366456503473417,-0.08511048604807706,-0.02632688141476506,0.00205222071371296,-0.0059103090342701465,0.07524305372129975,0.07513703290558836,0.06774638429378715,0.017190732708812318,-0.014118681073714228,0.16348624930644595,0.003641107675128363,-0.016412654924045453,-0.014937775857439547,-0.01992977965765321,-0.03808705663865673,-0.015602008310508347,0.08685910887146324,-0.03202443101520659,-0.031078687443314868,-0.03877701067357415,-0.027676747224123915,-0.032455139029262094,-0.023042128797198486,-0.02678330394572419,0.074058760639762,0.10448220642267306,0.1056908132129876,0.03195092768580749,-0.002009381770693591,-0.06107864896240554,-0.06000261870021865,-0.0245532827792029,-0.05863143098522583,0.04730725656042961,-0.061702386357164976,-0.02820160822549609,-0.03732169498137816,-0.03072103798249211,-0.038869802037161484,-0.04072410490709462,0.005794247590249319,0.020066304671360842,0.09128315636180606,0.006296440818075334,0.02205144844570734,0.020163770547068756,-0.013801529552249444,0.13775145064560843,0.04054822127821126,0.048695832272061486)
shap_list[[3]]=c(-0.06763049635508199, -0.02456388449465312,-0.02806790837885053,0.009533808908917472,-0.04774360493529219,-0.019465192466685655,0.05647412210270851,-0.038671865775633515,0.03792336112120576,0.14302954141778715,0.03623142404829634,-0.042770429897375846,-0.025557729129307642,0.03903304496174868,-0.007913616728303359,-0.007282323418483153,0.012518676335511347,0.005776484838816119,-0.008236665194549042,0.09209477653778593,-0.002365996839004019,0.07598528206414401,-0.03155080898658297,0.006363032112092509,0.08408702950567774,-0.0075945648437443156,0.019370181556406706,0.03968962386427054,0.030280422847179543,0.0008289181562540007,0.06272150879012853,0.07114479111510312,0.05515716322821114,0.008373852898795803,0.030554960030227514,0.041498945793544406,0.0003416252845985235,-0.0371784740688136,0.09560304024892795,0.1681828702527847,0.07014531089399985,-0.0025413804751090894,-0.08516584928507809,-0.05344233814964311,-0.06642601510422405,-0.08000156045439231,-0.0272697899272911,-0.025269516293188504,-0.06971210505344716,-0.06836086153358675,-0.048616063544134426,-0.0592457958769337,-0.06408470370775261,-0.08269217597603148,-0.061730648203241936,-0.07070780745348317,0.12475685568456854,0.005587184559875623,-0.03610928911122383,-0.029646467034427738,0.00461827773741022,-0.0023200037753945643,0.07086200311193103,0.06961734143980486,0.06129147366598402,0.09534332244897133,0.0713236239576645,0.07168393272342273,-0.035105632998726904,-0.01027172132263543,-0.003573232953852178,0.08042714589371919,0.4178243288287861,0.4930094987628123,0.5617562728815668,0.07528661014302218,0.5209638364145558,0.024827151667515535,0.22159013013067258,0.08607253992285833,0.033285937150015744,0.08718811836846309,0.12214655922759832,0.1345142154477182,0.055209312030909195,0.1583751691773493,0.014711298875119683,0.04426674393716183,-0.0018967928623325743,-0.0002601205580073082,0.003513518989309854,0.0036456911247653248,0.002548381228022743,0.03231393672528465,0.016042609375925998,0.1826164228076927,0.539604982605851,0.4760204389214689,0.5012959034076194,0.057651639487406356,0.5122631110636885,0.5454476679180397,0.08755660799468568,0.10566087916739471,0.06444150996147897,0.5082635177929138,0.03233715760941362,0.02347953538932862,0.026355295782959164,-0.03597385991283704,0.017836072449680995,0.03234862146253875,0.02286573540676586,0.025472154182262462,0.020411365328326023,-0.00916987736588152,-0.01562887069324575,0.06861237439402545,-0.0061390313628901325,0.007355429927016976,0.037689219043091436,-0.05379830034168666,-0.010587644447725739,0.04625792976549209,-0.025183794331147036,0.0001249154005259462,0.05574271250816942,0.1040658336181393,0.04060566204160569,0.16826246274493648,0.24928607323881727,0.13629514095147316,0.16436806298707743,0.15027088420450896,0.14124766096603728,0.16080715486436095,0.16295623691657718,0.09397719159477287,-0.037464391219815936,-0.08007058679027415,-0.02343028297928376,0.03164792310427901,-0.07374481513525961,-0.06921359358236148,-0.07454811531026877,-0.012548572359163198,-0.003912507318594796,-0.06850446022912302,-0.07209998737792167,0.05728822569277299,0.040751122728919266,0.037931256806287506,0.0429858225621737,-0.09287241783854731,-0.09063812347226079,-0.11118887622269949,-0.009568594496262076,-0.05721511397099799,-0.046242477900685135,-0.0915913810313622,0.08152455757271593,0.037517157875878955,0.04157658671489599,0.12433857188180966,0.03246955598014088,0.09073222777282862,0.0634599685229621,0.010841683399573743,0.01602172312018384,-0.00340368190512369,0.05216243645561046,-0.0038014733720975274,-0.022622706118027462,-0.023583895063923006,-0.014942455873840885)
shap_list[[4]]=c(-0.05138644823290313, -0.01534811297523384,-0.02374522751033069,-0.023747913685294414,-0.015525153392454277,-0.00773447243492322,-0.014116607090757665,-0.012526608774380759,-0.019400624900825718,0.0679450622873475,-0.020200975516861668,-0.010160495091362843,-0.019923327897275855,-0.020246590625404053,-0.048406011673710926,-0.042511238655997416,-0.04976223442678999,-0.04317455729372719,-0.036941786531323254,0.016975726327928705,-0.03478101027815521,-0.007918190663809855,-0.027834824192828227,-0.030504237237101793,0.24212397191931156,-0.0068952348016454975,0.042501151994589696,0.06336464209887717,0.056777391622887016,0.00793388519711897,0.0006203331503217613,0.0012129569469555858,0.058690292036687484,0.02650229669218977,0.04584524859184144,0.004473966860368004,-0.043784817093949505,-0.04180954153035058,0.22400088007210162,0.38821775687464477,0.19417092270519357,-0.01609704472583031,-0.022221757316262202,-0.047397918122498384,-0.029409633902319356,-0.03837031391349265,-0.0297919986352495,0.009954168861701302,-0.024419218508079925,0.0026652261578643563,0.02637996150602865,-0.019049695845880774,-0.018500740409066928,-0.026984299503585597,-0.03292017258414041,-0.03291441226004395,-0.047901710854689916,-0.03967421151239657,-0.02701260915327529,-0.034204915532276836,-0.05339687674892772,-0.023613856267353038,0.00036746250001081784,-0.008143124576417077,-0.005282279748273113,-0.002668548933962095,-0.006802344859083979,0.0024078855289201375,-0.040408011264469815,-0.03055746965855976,-0.03817696647174967,0.0003273217847253783,0.16044937891744668,0.2353496640201514,0.2672576278554809,0.07756871585945549,0.2446281216735847,0.006111950837187767,0.10815672210264815,0.0438000838603394,0.05060184816263323,0.0015667529579119362,0.06702506155019795,0.2773733866486797,0.15406227999789857,0.3136598511794705,-0.008863420100045854,0.008197567389505382,-0.04267163594982152,-0.04625990720323004,-0.043608307564939316,-0.04376385528176442,-0.04413051268179848,-0.025322977875433732,-0.051612510502630604,0.08161384461106647,0.2763396316995984,0.23613639408009618,0.24090681600541203,-0.008882051642229593,0.25550726360889053,0.2592883395219806,0.07314782241154634,0.06323697187534069,-0.0075861377934215695,0.25284750947580525,-0.02706314544389985,0.0033125517904503817,0.009000036115450912,0.04516054869923273,-0.031046098514360805,-0.0308115129403889,0.04403687271367236,-0.006064255698364369,-0.010617449356801926,-0.038448581546733696,-0.04190939837119363,-0.00027027561116997335,0.015007242585149804,-0.05382116414496803,0.012412816103616529,-0.05352721933079811,-0.036495965092584993,-0.01073432638866225,-0.0219987964372114,-0.02846755244266642,0.21817634139703693,0.2771022236706727,-0.008961875613032794,0.007276574724791056,0.4670650126097621,0.4940772262332495,0.4461126098117171,0.42625957332972353,0.5871682226003345,0.4499196089927578,0.429843117418035,-0.0013281919351067213,-0.025589133284987263,-0.03776622086057422,-0.04082378465885253,-0.003544809711566145,-0.03364644162009149,-0.03448987787409293,-0.03692914432601874,-0.01440467895083875,-0.023134586824671472,-0.03127995614063634,-0.03476608479242911,0.008146816955342421,0.0012017024675177845,1.4102725709055908e-05,0.0034331889650869264,-0.026381159748216122,-0.05899668875153672,-0.040841974323986716,-0.006698032626312281,-0.03039116129379954,-0.011864754094702118,-0.041568715271922616,0.036019275657027915,0.119474619708126,0.1335873905861597,0.302310409424203,0.1608729870760142,-0.00980291967879059,9.368911325862914e-05,0.03802148246241552,-0.00838149505179909,-0.004341450486983112,0.0009149177182455115,-0.023539301435420303,-0.02528919602980383,-0.040177207906452954,-0.016242047457136335)
shap_list[[5]]=c(-0.15583415146431343, -0.09172735471788682,0.09383862133118163,0.11569331824213488,0.03592536284879462,0.021595706728608353,-0.036157068620335756,0.029753376397469368,-0.03639030042107654,0.8214160957827881,-0.030006989910882485,0.02914960990298836,0.014334008162802035,-0.04378145258591716,0.06382478179716422,-0.11722026508832065,-0.09671279875067022,-0.1054797609324613,0.06113525318965368,0.22056729549397147,0.1334224039625718,0.18070881088519225,-0.07733175090747232,0.08651115361110433,0.029444280912990246,-0.06208621230887752,0.06905704122590077,0.10936336269967777,0.0997525571999434,0.058767744090789276,-0.14697134318804214,-0.14695376737864976,0.136165637024521,0.18002579672823438,0.09710184115632223,-0.14411974952622036,-0.16914808552730495,-0.17033076139677691,0.0945513392130711,0.2942165647118335,0.0021686640240007214,-0.09796236969628487,0.06270522336791111,-0.2135689812813158,0.005551346251437108,0.03363276808497519,0.0599641234622156,0.08391427462877155,0.045626445013706274,0.07600726454496284,0.11594795853465927,0.04428007607835848,0.05002163057106288,0.050889547543234194,0.03518200665454653,0.039291910932228016,0.3165474595397972,0.0932809153026227,0.11222188085727011,-0.08184466416645195,0.0803583964316624,-0.07658542691585553,-0.14770460528093604,-0.11170501688522379,-0.1366517044149969,-0.1109218432575512,-0.10975001178759217,-0.14402017141914605,0.12026394764764173,-0.0739122791101692,-0.03808899729883723,-0.14450772323385325,0.2724008017064899,1.0707515893363841,1.01806433642362,0.07783821903811122,1.1253963962863973,-0.10416859097967482,0.07618233829138742,0.06362327196923082,0.07411207202227597,-0.12524124568162975,0.08747032513367874,0.16336265765278038,-0.008909984660004195,0.23168607655612955,0.10697912379223642,0.16960537140796847,0.07377482104839456,-0.09985508134359505,-0.10988624364129847,-0.10996398712536545,-0.11130005940646666,-0.09173119343447837,-0.06904127646322457,0.11406198736882038,1.2992389294750601,0.8074886592929555,1.0711686797913111,-0.1297791394079223,1.1649954531094793,1.1910202625315454,0.12069119808552875,0.09820158990962162,-0.13465742022192126,1.157120765913573,-0.08684272926496725,0.04946272347793969,0.05665137795604339,0.07309276932222758,-0.053606287125183685,-0.08494118224488181,0.05966276562214416,0.1774599625911925,0.17728518844554603,0.08661643548719887,0.07059160995060389,-0.12998050196573233,0.08939485526655228,-0.09279633907530356,0.10381445143561778,-0.17536437756103634,0.08291870468569987,0.18636471408438637,-0.09340037164026058,0.10368643007293514,-0.054940447535036116,-0.008428011141822605,0.16215471084168384,0.2545872339447224,0.3257374436817062,0.2841200840969285,0.349846948306315,0.3516135416180356,0.21503987823061724,0.34606926292122464,0.36657242293350123,-0.10118200699603215,0.028803970793544586,0.04820874939855516,0.1958147437105075,0.4169722348906421,0.0695729170100394,0.027823264804529374,0.06177218501616657,-0.11742767985020204,0.45083629969169686,0.03806137039975822,0.03068901686302363,0.4615011589099807,0.44004507447039043,0.44003018180648457,0.39988218248500956,0.07051320989001729,0.055121801547028934,0.05810227592633029,0.16910334760073864,0.08410003036560859,0.49252637293367696,0.04994388283018296,0.5038713410588966,-0.01136539419079855,0.0017001942573004968,0.10598206949751263,-0.003747337789731833,-0.1121753157172235,-0.14080466030929345,0.08975146142896688,-0.07715392622034146,0.026866361664276705,0.21800123839260138,0.09792886167407203,-0.15829704677344986,0.036872164925483966,0.08651958641445891)
shap_list[[6]]=c(0.018695192918774504, 0.03002300407725248,0.019845905853167475,-0.01022039530685136,0.00940870255304766,-0.02890987525822321,0.06965544290858983,0.0017947262418840215,0.05761860165146408,0.1651584242583852,0.05402488629326259,-0.002783926281880402,-0.009513647227027463,0.053255419819665493,0.00955257173140629,0.03119977349243346,0.04892192845870406,0.06395052388082641,-0.020708004673627635,0.12414966573325774,0.04934297459388328,0.08003289336365596,0.05025236706504097,0.016370152508028514,0.1623867500820065,0.040368973526467525,-0.010112531895115424,0.04691966218691593,0.011622604182521637,-0.03639026844952766,0.006291893373078575,0.020416095026776448,-0.053208798670370795,0.18373592511647896,-0.06104359968791802,0.034204286074573015,0.047298432707197254,0.04706914247351342,0.0458422658564501,0.25122579467682515,-0.053548095198465484,0.020837686633070642,0.03277008519146424,0.039963018751317456,0.028539170179180878,0.018582718853869327,0.06647588002118136,0.07800430871531848,0.0043262400789372095,0.05275799643397723,-0.09385358211384627,-0.00029095564627610075,0.0358103803011479,0.024445687321733998,0.010764025808758345,0.004852087400051117,0.15348210296030323,0.029998201699707246,0.02568174989801252,0.026795535185509988,0.019591948263385218,0.040648614952002005,0.03864150654853751,0.013949491189741458,-0.0024313529369251316,0.02729824717245368,0.020955202155310566,0.035028975775076195,-0.09503051778959187,0.02193533726692788,0.00652654182190081,0.006999286019453018,-0.05581895517109137,0.30915304973545743,0.3246273928136679,-0.023639907221266,0.3427051440198544,-0.022321623701481212,-0.02358755508155368,-0.01579746109952095,-0.03960128871003461,0.02031154608366495,-0.02297085757924896,0.16809693456957703,-0.04729859881134787,0.22015784187755627,0.06490844035574238,0.06396253485912384,-0.018644352778870627,0.050216392098281715,0.04637833397175854,0.04591567064867967,0.045679510005227644,0.06615584947756423,0.04573566917777732,0.033134318979445486,0.38715734752541076,0.17194043271581558,0.3090190325032523,0.004527512374403339,0.33900419153243133,0.3653067366658914,-0.04377868192935282,-0.009381942645339137,0.0008440266243883957,0.33033232695658943,0.09264206279262081,0.03089124943751076,0.03171540765684629,0.12106827722991102,0.0889298422992109,0.1027585436174308,0.045377379612767485,0.10448288523480583,0.10028318480815443,0.04424635569354203,0.028888402760970506,0.033526531743296936,-0.003887309992506136,0.04280351611474017,0.009156826052191105,0.024482369769926505,0.037621092753121484,0.10825498669476068,0.06969354977770423,0.052983024998826934,0.07598596976196023,0.12848942295590735,-0.03222139798667698,0.050917537480496655,0.28444481746042694,0.04029513420100504,-0.001631765594384381,-0.046914032471623845,0.10727455830422994,-0.023224925641104222,-0.04358238338462887,0.05576427132864133,-0.06343030768624278,-0.01821451658543956,0.1018647595686131,0.052024565692192326,-0.011361403676937509,-0.06319373866620785,-0.02273962152887549,0.044717588819053924,-0.02155403463233652,-0.05448989300072512,-0.03960462596659003,0.08795347750854285,0.08687820656839583,0.07600193421633727,0.04621366567141329,-0.027945285020366938,0.0009148586685947598,0.06519413760084847,0.3157319720159079,0.1826091805945989,0.031265761146854795,-0.021900897415029135,-0.1376531757238496,-0.1046426282594396,-0.09516543398778916,0.22911104400012228,-0.00739161825841963,0.10113387916775676,0.038214738614588434,0.06466646432637355,0.01234159102747354,0.037272781397753654,-0.01390731290154111,-2.7450991591423253e-05,0.08655652834570382,0.0028501484340015476,0.035177069146560075)
shap_list[[7]]=c(0.18258817487642548, -0.024666031035982715,-0.018408316487101277,-0.01774579051255023,-0.026954823752884632,-0.02119330439486193,-0.030049319124335994,-0.022411449444331457,-0.02696209047962787,-0.05012492595065852,-0.0264426353391722,-0.022680090065037416,-0.018256664081816067,-0.02663224483280152,-0.03693704384415141,0.07124577415730941,0.1698934259290447,0.15325141385624574,-0.026159232663089893,-0.06546580207010924,0.22216472655848593,-0.06299846979877638,-0.01504143009180787,-0.04042628724007154,-0.01659041149557313,-0.01883533358495771,-0.033949886974366086,-0.03782781556677669,-0.0407052441783992,-0.024614258695879056,-0.029072138017661574,-0.03043010420583996,-0.0324576293133269,-0.036065703889266575,-0.028339489583507738,-0.0289909291083841,0.2096087043511988,0.14994366762620254,-0.040263546975985234,-0.06442495994958408,-0.030282121447870042,-0.028608652963927655,-0.03517173687170748,0.131763844806434,-0.012819364173323227,-0.03231451101632363,0.25333868714466135,-0.051015915448371016,-0.028040836054053657,0.01958871436421107,-0.03384143781793274,-0.026775504051824984,-0.0400902283136738,-0.03452562224505729,-0.02881307251409365,-0.025431346590045596,0.2371884871603426,-0.022589023777071303,-0.016598814092923835,-0.017318073601092228,-0.02439207200608303,0.16907043415217712,-0.031600405173057095,-0.028244861568002027,-0.028409822217827573,-0.03295036656850904,-0.028252937515016303,-0.03090826467540595,-0.017254782123732004,-0.01671640035450182,-0.014444205153491282,-0.0318562856549547,-0.021982052083477192,-0.07938703180057609,-0.0673982499549641,-0.031518192978021345,-0.07624334932120984,-0.021316186268807446,-0.03788591722568283,-0.03135103235470139,-0.030839215187713553,-0.03190781500531651,-0.03230556789005027,-0.054343309651121954,-0.0219127494229031,-0.05209453625890925,-0.05328345113122872,-0.058866322495152265,-0.031050096076270666,0.1429182258323773,0.14773970708922918,0.14783556796204395,0.14909504423486164,0.17624011898765166,0.1735856563447508,-0.04274732707785238,-0.07974148495397576,-0.05551959486725373,-0.07702107540327216,-0.027752985148139037,-0.08203726088045439,-0.07597783342318473,-0.0319928475991272,-0.03449701739201223,-0.02880422717964868,-0.08422927017234123,0.1768947853630518,-0.026448148973407682,-0.02719428600692947,-0.029172532606901593,0.16443551536937004,0.1773262931862506,-0.03465243192169629,-0.055410007414361986,-0.05624269615120363,-0.03959449132709972,-0.033337697840536716,-0.03146481425394266,0.007291098343108553,0.15839910963983847,0.1934660565171616,0.14992719120161738,-0.03507694842129349,-0.049604563650798475,0.0072480176810954785,-0.037221446147576165,-0.016535215676482515,-0.04624260511822838,-0.021849028039293675,-0.05902458164303381,-0.04111337227460922,-0.002032045605598638,-0.023937914398154486,-0.014014294382344772,-0.027045852275684745,-0.011571487750951067,-0.01666644686150486,-0.03110780591812374,-0.021409359092637727,-0.023685146559964836,-0.037840975208912525,-0.047214027917770005,-0.026551600107000212,-0.019544200739711796,-0.024930346997327848,-0.02469020881859651,-0.04133493384603902,-0.02127251551515321,-0.01997678864498668,-0.056420295502951565,-0.050981934501866735,-0.049785130043882,-0.047880812948184207,-0.03203856506039041,-0.04139623252832156,-0.03532041156977965,-0.03514399109738127,-0.040833966904638475,-0.06210737107580773,-0.025526607186403805,-0.04235929638492948,-0.010399394250354674,-0.013857493549651444,-0.020296011658310863,-0.015225857235737167,-0.024563036234253793,-0.028700835787441353,-0.03727548872017944,-0.02081644031667178,-0.03227616731836888,-0.029443949289847716,-0.02119296171166373,0.22233140629108025,-0.029735753051466383,-0.04767235483960513)
shap_list[[8]]=c(0.17054005389648036, 0.07845959696785833,0.014419027425353411,0.002437767098298673,0.0709410769591844,-0.05798869706844173,-0.059436498286167025,-0.01703981387648843,-0.08017684520969284,-0.18703211253109947,-0.08024478664249275,-0.014385365135081856,-0.15192514276456753,-0.08676130429285749,0.05512909074307402,0.16124392472571497,0.40205394371467634,0.29131769435205335,-0.031325607912149035,0.2658281975671519,0.2458216210971793,0.1810526206914716,0.0731750095234866,0.055147638391035536,-0.2436984352699329,-0.05212423447925776,0.02869848216097695,0.013796400613940597,0.05539226303857299,-0.04873776899386318,-0.1533838108854145,-0.11080380799442975,-0.2048639701550715,-0.13962786721657233,-0.23523536307819998,-0.11371903471073035,0.3223592558622018,0.34953404600098625,0.29791711950411337,0.08667734656309269,0.050953421359330175,0.14250815587607263,0.21363391269319393,0.4882190196180973,0.20168670363316799,0.11378181575633253,0.3489872190921893,0.25878249574756346,0.06742056508500466,0.26427941715986414,0.24633467922156466,0.03886372647412012,0.20919755219837058,0.1937730299224157,0.06483158604483329,0.028517533660244454,0.680338842996767,0.02148809819006924,0.008339187453499278,-0.08520343329566257,-0.003039400190196679,0.21039542040044115,-0.12276289710841108,-0.19930673056172743,-0.15412505864266438,-0.08688475495299708,-0.20819248146208086,-0.10812650150764527,-0.10405825373089388,-0.035917758986334127,-0.05569834003535666,-0.0821781995416532,-0.20411401941446772,-0.2543072129098496,-0.25341007200796767,-0.17896665566783934,-0.2693950192414341,-0.12380635559315671,-0.19970226929404392,-0.22414340955383505,-0.13663771598509195,-0.06854993076278258,-0.22564904189827173,0.23069435070688965,0.11702558786507253,0.22229604206871983,0.17945230687753438,0.23321803247130787,0.08469017258279007,0.3374407211079348,0.44028791292184943,0.4401390168711704,0.44479132794467596,0.45820937347756574,0.3180770795923814,-0.2503338370311552,-0.2947978646778515,-0.24859300236392165,-0.23357496690333496,-0.20461812097131715,-0.2803584582765396,-0.2789485406092381,-0.24420047409407278,-0.269628499407128,-0.17629122851988285,-0.27987275921538396,0.5600060834998011,-0.009271567405432104,-0.014628270451968706,0.1630067469063236,0.32584948969595295,0.5610316775181499,-0.14091876981014428,0.29926545676832206,0.28765175874095616,0.14040458541796594,0.10160469847387854,-0.0751289813770479,0.1131492644509778,0.2261319155219037,0.20375335896981478,0.28851446656176183,0.1163248915128479,0.3077970798271369,0.0842989288577361,0.14437116710512346,-0.21713198974362918,0.03641580546935375,-0.0052169657840306465,0.046685465208812046,-0.20817700806751746,-0.16402450222510434,-0.12203451412272667,-0.16592877389116054,-0.0850979978854717,-0.11964431472725753,-0.14756643654040913,-0.0684684991709418,-0.14912734344581846,-0.11310673870355285,-0.15151866664854768,-0.2125844517418797,-0.11195672378287709,-0.11307266406529308,-0.1155150883812482,-0.05349475078144865,-0.21601691810362125,-0.1378734750648597,-0.17046405668071363,-0.13591385099309303,-0.20617217147888725,-0.22202107424784345,-0.18243307129099948,0.03415509667230087,0.23132691711639858,0.05352756905551239,-0.1823549476180895,0.14749798310053117,0.1895676965470243,0.001511974238967373,-0.16047272099735244,-0.17539156127125127,-0.12675891939601405,-0.3069514623737647,-0.12946725867874126,-0.04434932441433347,-0.020245651100188278,0.005233359558876799,0.02952417312679373,0.060779065769949216,0.11877118100272384,-0.05651298273720255,0.19115066744107087,0.011780467479540218,0.1668022955412241)
shap = do.call('cbind', shap_list)
baseline = 0.3369165929318429
rate=c(0.42920108968842363, 0.3410755754814626,0.5279668308194404,0.5319005189576506,0.47298792477360685,0.28474349386398584,0.42381792732678275,0.31824849297617785,0.3400698946303288,1.631737896693145,0.3256671544408168,0.337317779564855,0.15849436813211915,0.33684253539615877,0.2569943290462906,0.3125136928185503,0.3917864632389712,0.38738462298208287,0.23042776123838996,1.2207281515794546,0.7806500807845816,0.8772093288389277,0.3395740074044418,0.4225078308586564,0.7938919361309048,0.10227152591380065,0.3394154260423553,0.4567152836740728,0.4316290517772579,0.19414791978928808,0.5035126303733823,0.48695945037755184,0.8381797316214747,1.2717852051512435,0.6827404504663257,0.4612240882022025,0.5876488777998713,0.5107614977903893,1.197702722660807,1.8751575403023721,0.8551267837589009,0.34267841104534424,0.5269387692573202,0.5602749196714196,0.49908537957559906,0.3306966688917065,1.135395425694326,0.7859192034977702,0.23230963536309462,0.6925912448326759,0.5802850071516893,0.2594373613178294,0.5240549205436841,0.46305991891762427,0.2595419019144293,0.2124314401302747,2.1192012610714026,0.5060699083084497,0.5609667387396263,0.18373480468861397,0.4250815234334727,0.29435094202025336,0.5414028122970374,0.39833429346107047,0.4477132872955303,0.5622688896011442,0.40401245432763266,0.5341313519589743,0.18797507187244492,0.1924140419623573,0.10963321155231631,0.5350496135554782,1.7653806062278548,3.218375503532685,3.361647780302789,0.883080685576519,3.3968460561871323,0.4873210688719931,1.1052405633294116,0.75633421350135,0.745686282301069,0.553664601759539,0.9590951632377329,1.437496251727614,0.6481054533058673,1.596578135920506,0.6245086970610085,0.835662961400342,0.396447813846909,0.33488955252472596,0.41028126415920046,0.40935558481531514,0.4208280015919369,0.5927972932994535,0.3824516770882246,1.1787016021828287,3.583352289839437,2.7762442554757865,3.3065966570627707,0.4548696025533113,3.374555729944582,3.536650967732549,0.9243329614013126,0.90563212179094,0.5006343824476883,3.303338012417437,0.9057864252610909,0.3927312478827923,0.40759870317117625,0.8533825063583699,0.6615954902019366,0.916328163820024,0.6264558304728064,0.8869137278095625,0.8628584989577828,0.4606876685612427,0.3605312264908944,0.509030209751683,0.2801917354096688,0.2982459986564123,0.4904677569432804,0.46191095916939445,0.42603796426320695,0.9575302542508153,0.35910671134746763,0.5463193266261714,0.4119917084531973,0.9661625455823908,0.5835723946082537,1.0854653843177506,1.7182039395983075,1.213393558342607,1.2192239482688365,1.1203875490133677,1.5520085279791846,1.1992174480267337,1.1605083337047593,0.5963118664569343,0.3042313046463415,0.3223635242688202,0.7082559226078176,1.163041210463756,0.3928959014995389,0.26192149505712986,0.3639301690651167,0.3880003253260041,0.8615968318958362,0.295535571525533,0.23016149618971035,1.3831731876158901,1.2530070334733998,1.2111676738870054,1.1506843255731531,0.6657257759325559,0.6512648481564922,0.4662518778705384,0.8792482891265051,0.8691766470344531,1.3743142163273363,0.3287129032569267,1.1219181488591154,0.3729411246088895,0.4320032344789674,1.0868934103738528,0.5573892949656973,0.5458047630929073,0.4411944875596884,0.7118273799048589,0.2642477741891046,0.4264331900757098,0.8622512994121037,0.39896773438412636,0.6911332909032346,0.24872830942651486,0.5270944991538865)
rate_lwr=c(0.11911945297180881, 0.10912662859843708,0.17284456095573014,0.19007557190273427,0.20276735232578547,0.02554482012526671,0.20458570058867637,0.1396694302849913,0.1317650890406878,0.4065726331156067,0.12038327744689295,0.15022153650978348,0.058769035146339244,0.11806282633411364,0.0881925875903588,0.041197086155865814,0.18942205419104358,0.07955742856783451,0.0326670294960093,0.511112775475866,0.1529103095717817,0.22830572049439501,0.02211847214324153,0.1579181312994457,0.3115179240840855,0.009616817332662675,0.1616798476672237,0.15446293954856244,0.1831882058979087,0.04021504998422548,0.25033524159667997,0.31295411419576935,0.30115131675178913,0.4584079975769902,0.3376656528624949,0.15372286412304148,0.03438824682691777,0.1682028653351456,0.3038732659346817,0.2776722684262954,0.31887450434240977,0.054613049806073954,0.15181000165258052,0.1870043753553229,0.19725226372811783,0.11830296973057963,0.419375509020376,0.2757185342930446,0.04858265714030824,0.15279937136050833,0.16857935091071355,0.10681334108883506,0.1581016750492355,0.15206279696688269,0.11300857565532323,0.09460511214278289,0.5925360410833622,0.2389368593455508,0.14400122526243597,0.04616214850671507,0.10937000893672155,0.08885027362262504,0.36118964516937785,0.1433963994444062,0.26560105285668073,0.2596832692328452,0.13497779180359626,0.33380385603987983,0.06415088875145586,0.017352105570031084,0.012612306693818048,0.39046619745412325,0.6255355291317672,1.3346759844006284,1.2764225858884897,0.448446327672731,1.2907110348738968,0.06817524904105343,0.3497183553502644,0.25548058661267353,0.36146469968863515,0.2734476053591743,0.5673743278561937,0.31400048089801724,0.208305140846474,0.3090712620958623,0.2790803598717828,0.26392581972821827,0.04573535131547124,0.14636278116958396,0.16781068561819917,0.16821656431254345,0.17770049050376313,0.28573134628993674,0.07720456744698312,0.5410795264759857,1.0184040742048937,1.2282221809967908,1.1922975817337986,0.21414409261062042,1.226017528141055,1.2396871561394525,0.5333399202120188,0.49420512651891935,0.2160678909534401,1.2733182810174883,0.19580552030642462,0.33619548079770467,0.27657577933118627,0.4036362545649258,0.16287428640331203,0.2845047253372816,0.13653104964800616,0.4842369358825604,0.4612876283146928,0.2030081511278597,0.20302959206099278,0.2692618283152213,0.03873830153748903,0.09937755507310819,0.23630530676796613,0.09538122894341344,0.22955791993499336,0.26159557665065025,0.02718724623274199,0.29679006176578326,0.09991823164100894,0.2966535271963029,0.1628474342345159,0.17074606074780924,0.7949454760138508,0.38615668341036324,0.3519349335585979,0.3534809867586268,0.6807362674312234,0.3342471582821688,0.35173326828192514,0.2582678799432209,0.09144139538608831,0.2154790743105655,0.21227316274538127,0.554211299251349,0.19403802572111722,0.11288055010359681,0.19153409855491738,0.03577451356355987,0.41829134298189713,0.1447066367400201,0.0669278851345586,0.8039743226467426,0.6582517163669328,0.532681681097598,0.6699884358537991,0.36730238631200446,0.18911867954317896,0.22849881248451465,0.2686294645207553,0.20740537607178866,0.7074652778462273,0.17470382503079546,0.5581133608653404,0.11132198391461345,0.127615270176884,0.2921324470671792,0.20528399020936347,0.15454275997108138,0.16754542589086616,0.19904050160547038,0.09578976246621698,0.2648957897150366,0.2998121417199075,0.18522750178651504,0.37016780393478455,0.07912679469850631,0.23281777301104836)
rate_upr=c(0.7331830455561772, 0.7731845315836232,0.9864461056188837,0.9210574430828709,1.367176468085423,1.037559613878286,0.8470808564015614,0.5388346817411799,0.6245972254043329,5.558773066379902,0.5942717235273063,0.6132309649131616,0.2542619969565809,0.5954828382751763,0.9383885153311387,1.0439932242247199,0.6075282584208532,0.6348361900852086,0.6536114000032258,2.0861585779366227,2.877365223580845,1.528081146513,1.040452468462568,1.196441002638053,2.7275996095597206,0.2801646429394739,0.6592069121099262,1.0289408193691485,1.2499385088021877,0.42056406762640025,0.7159063240938952,0.7277039057759844,2.280132693446941,2.930139773224596,1.2895096850082763,0.9169224830125415,1.7656365702104928,0.8692713038674433,2.229933149832904,4.401514397415226,1.8534464931354808,0.9753197779135307,1.0200083574081755,0.9280037850875918,1.0958291151257842,0.6331104063041877,3.038177365450945,1.4010876353981776,0.428497684585436,2.3124722917156584,2.36283004189492,0.393685015923891,1.2464554471473357,1.0079229491246877,0.4019068416240385,0.35713174284659754,4.219031482952137,1.2018886465293757,1.293381636614023,0.44771180990193804,0.8300526180468004,0.6412450951558986,1.253417765815661,0.6618764767496738,0.6629729011209069,0.9070638960947475,0.6638999308940027,1.2103266824572785,0.7072668327795462,0.3811091641477196,0.33478877718112293,0.7019626515844448,4.734863402913282,5.219102679417905,6.310934429414418,1.5819675873355887,5.92740969648624,0.959480141305209,2.2956177377373748,1.4850396273919202,1.163476220697579,0.8623475705898933,1.4647582672581558,3.083610046438289,1.3584089003851312,3.967836666791543,1.453018080390875,1.878907354114462,1.1273845082411222,0.6043088091382698,0.7666520468627318,0.7630449497741945,0.8053744498354709,1.4491515236181653,0.7082822723157167,1.8793041789433775,7.047329614933296,5.595246128730205,5.563005820395034,0.7892230621166321,5.939227312040394,6.651802571360514,1.4898933183577467,1.5022581715810226,0.8403461787331834,5.6722836592169745,2.691142534840494,0.497029627909521,0.6458796052675162,1.200126093344287,2.2980033480483466,2.6368841131072696,2.4503092395044215,1.3387906784667962,1.463895123848475,1.1302574609614053,0.7871334125448068,1.0236778716453352,1.6017158575305757,0.5640379547802841,1.3955477737060156,0.6523145068693725,0.7341319424685613,2.4949244981795116,0.8166715992725848,0.8606738381361551,1.024604241966122,2.2204659269436258,0.9574230021663721,3.858716581218574,4.360068981438499,2.915706085643895,2.195253836943295,2.397972281941533,4.340235305099019,2.0138555896808747,2.3893541399868905,1.8975034881529944,0.7260687188093509,0.43395058498238664,3.2034304939529155,1.9875233738320637,0.6653848943125815,0.48811337390769566,0.651417021103802,1.2320427216971124,1.8703721139102818,0.5730374926250286,0.47639756991888066,1.9358651300673262,2.2547324503877095,2.4061808475220547,1.913437479392457,1.931161676842716,1.6558727089022134,0.8570107840131187,1.871617484542913,2.2885572947313726,2.2729942337017612,0.5289993952103031,2.3303365542194485,1.0622501936090885,1.272596941657154,2.3118210670419717,1.922042478407799,0.9370982470041459,0.7940924059120849,2.0200572527782987,0.4901180843935749,0.7465233249940049,1.3046658258583315,0.6221837750455526,1.0024493418676839,0.5137653489033185,1.51854176107188)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'temp')
feat_names = c(feat_names, 'grassland')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 8)
feat_states = vector(mode = 'list', length = 8)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp=c(-0.058414521820778435, -0.07164671728446251,-0.07587955641462105,-0.07592397681508509,0.06442980838777326,0.06490437016894386,0.06590897787909443,0.06431617570322645,0.06481154220532942,0.06484928067956051,0.06585925934152699,0.06473329810598621,0.06613921304770044,0.06609461796525146,-0.07094003301084287,-0.06904681409764324,-0.07445558363554657,-0.08453356093017415,-0.059247787833885325,-0.059057869529616634,-0.05878367549467526,-0.05902614326599661,-0.05887312006618727,-0.05916943096624768,-0.0939427678987424,-0.0934518857459363,-0.09393425921352966,-0.09374600153857954,-0.09385235739162465,-0.09445570344739337,0.09618559949626625,0.09438542366035656,0.09651634146421605,0.09684472116810389,0.09698486820418072,0.09539882928796065,-0.0651978042313004,-0.0589648571535116,-0.08428366442935248,-0.08572968480621122,-0.08592644706195396,0.024616223124533935,0.015683127461569378,-0.046052085699498625,0.031467721463810105,0.024666240766274168,0.01862707426588952,-0.005349081164331647,0.024585140590386394,0.024562959597428023,0.032734066880927996,0.032931600693062626,0.02465115496692623,0.023650394496710473,0.024758688754084903,0.02694558279953612,-0.06310000696392157,-0.07600813576164203,-0.07579183476577538,-0.0762328138610209,-0.07589878553887243,-0.06514250154159966,0.09522756690017951,0.09985835014724148,0.09929508277144913,0.09525848829910316,0.09985835014724148,0.09643428117280815,-0.07318186696218164,-0.07246685435438704,-0.07288628198634443,0.0960880215156384,0.097782884201871,0.09779348372217933,0.09779299994561766,0.09692490139127626,0.09785663155673786,0.09710186409957576,0.09807318308716768,0.09780343332747295,0.0966887527336106,0.0953334846624295,0.09800120150785513,-0.08289839583141893,-0.0830337584508204,-0.08321461108214506,-0.07090220995564953,-0.07088549300719894,-0.07099054117939556,-0.07474271068281117,-0.07406564324936793,-0.0741283313971423,-0.07398552357668303,-0.0742524603294404,-0.07522102045549028,0.10218560769625591,0.10221241938794932,0.10193411896733814,0.10179712565670455,0.10125194606349096,0.10223292580329378,0.10222386398831851,0.10156883977691315,0.10125102621726598,0.10111439565418553,0.1019489044201218,-0.06642764116640026,0.07677663912824607,0.07703999863644129,0.03291906394475632,-0.06624150622327575,-0.0658000859640134,0.09548242162873982,-0.07059382753326422,-0.07129351179124352,-0.07143449035090073,-0.07144691753022014,0.08619720463387645,-0.08900953397286654,-0.08836704008260386,-0.08876555681922822,-0.06589131701883813,-0.07227825834087352,-0.07275004196774995,-0.07257485206118992,-0.07264785444785284,-0.09182753033091402,-0.09118532436455833,-0.06856933277732158,-0.07004777931120586,-0.09396230613169208,-0.09354960628049984,-0.09298822235522171,-0.0942441569003846,-0.09259860135816678,-0.09294300533704139,-0.09415576437399571,0.08864389056936739,0.04482015807626981,0.04652866828534303,0.046543533724077955,0.04772943291575601,0.04743528308146563,0.04736934004517126,0.04650616882253169,0.04545414891015366,0.04758174462097674,0.04737897294055926,0.04744073959845496,0.047564160384661,0.04665822320279706,0.047742122377705136,0.0475717889869051,0.044621271039851765,0.036335716645303044,0.03673385136527376,0.03732839139921377,0.036184819519851426,0.03663193032743641,0.03693200184217506,0.09358580019913897,-0.09391525814698706,-0.09349307467039521,-0.09415005902316854,-0.09270373444441703,0.08164235026247536,0.08152243629501296,0.0621809246096028,0.06204207584338987,0.06203878377537002,-0.07194691736554613,-0.07224447079653487,-0.07025315172717497,-0.07075509229836187,-0.07032949994111379)
feat[[3]] = tmp[ord]
feat_states[[3]] = NA
tmp=c(0.01953949855438053, 0.03884914396172339,0.04495420642366205,0.045018512254017776,-0.0016716154191672315,-0.001701917063170843,-0.001768543880392044,-0.001663889791991163,-0.0016959204646181795,-0.0016981948432027059,-0.0017652813279619047,-0.0016908940449004406,-0.0017837430863127228,-0.0017807095916983742,0.03781496844930065,0.03527302744784383,0.08358735477225274,0.12579751881416293,0.020231602199437926,0.020072232554906227,0.019845292331429117,0.020045946913419446,0.019918153474218197,0.020165513759836606,-0.1968847216770256,0.16365506255931547,0.1657611909433433,0.16494619027737858,0.16540472065743234,0.16801933738813532,-0.009892260449595293,-0.009436287805448758,-0.009975798919422067,-0.010059129052455018,-0.010094642983979803,-0.009692577839528543,0.0394121879505805,0.02966016698894538,-0.14813906349856124,-0.15500790759303412,-0.15587769481867833,0.005672243555228218,0.006278330346861525,0.010296943435667309,0.004937210360074944,0.005700361845988034,0.006007104069868673,0.007748697154871818,0.005654678916983353,0.005642262490568442,0.004897823460500547,0.004886695550826243,0.005609239591228211,0.005634670972608609,0.005669231546322758,0.005475003314309325,0.0359196685723949,0.045141836769255775,0.044827213122335285,0.04546827257836678,0.04498379870104556,0.03932840226991852,-0.009668337104269835,-0.010921989888297278,-0.010772147083652508,-0.009679388440339862,-0.010921989888297352,-0.009997776440797404,0.05317439278234565,0.051905100638224844,0.052650623321613195,-0.009869291218585124,-0.010305051467682116,-0.010307082521173266,-0.010307655410633393,-0.010084021106339085,-0.010323281896486756,-0.010129600084588485,-0.010380259125666882,-0.010310569804405785,-0.010023228910870579,-0.009678186185091801,-0.010361723707135628,-0.14107427315422225,-0.1416361084544233,-0.14239241379850343,0.04914625449892921,0.04911806931323453,0.04929554423271644,0.08437062774833973,0.08250928978820203,0.0826793109634408,0.0822895602583389,0.08302328117982344,0.0857103386254381,-0.01157085522906214,-0.011578243256120651,-0.01150146132679579,-0.011463743375617163,-0.01131295737515966,-0.011583902156703001,-0.011581395576019416,-0.011400984044436442,-0.011313056191140543,-0.011275581223629918,-0.011505425303646538,0.055394313634535536,-0.004900319860083416,-0.004941454635545249,0.004965743974227885,0.053888118157259364,0.05301405683366961,-0.00971379642655436,0.03736573473354222,0.0382823707739733,0.03846727992729482,0.038483568426807176,-0.007309228216773757,0.14423883227146847,0.14170457694363603,0.1432741129790116,0.030975153238448676,0.03974179480669786,0.04043687992946697,0.0401569998616709,0.04025537871847558,-0.18600122464072524,-0.18283717604266103,0.034520693176759515,0.04762811220635949,-0.1970482871402489,-0.19493843659706273,-0.19204157656876764,-0.19849579701288392,-0.19008092591965742,-0.1918144463173173,-0.19804246963084918,-0.00794116869589442,0.009135515422832252,0.010069355961217065,0.010077328389136624,0.01073234831769021,0.010570898469901753,0.010535190640666143,0.010057504478193417,0.0094951847693506,0.010651247831528753,0.010540401809603929,0.01057385953188753,0.010641963306153891,0.010138052385228767,0.010739311854643514,0.01064582773147443,0.00903675505534908,0.004655064648095826,0.004820601055229108,0.005031858883196039,0.004561004978710308,0.004803568660079683,0.004875742141614021,-0.009224338713644524,-0.19674374933690414,-0.19458980533622836,-0.19794490676806697,-0.19052914002828744,-0.0061154753875975925,-0.006093604261031933,-0.0012242182908813897,-0.0012175479623885452,-0.0012173907684889253,0.03916606687319242,0.039563031434867876,0.04800475575836776,0.048847164085182485,0.04813202374118991)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[5]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[6]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[7]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[8]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[5]] = tmp[, ord]
feat_states[[5]] = tmp_states
tmp=c(20.042959260992028, 16.77145789798466,13.633034880054188,11.08258108184095,11.671573378462035,9.197260138258148,19.709087213395712,11.763688761345936,18.834541775289008,12.543329772332134,18.452723600647822,11.389842614526929,11.45516312611962,18.75717814037957,13.644381033687072,17.34412134875883,21.211041052192133,20.792329617276543,10.092919561981976,12.78599643443742,14.52187140180836,13.644381033687072,20.783073207194157,11.890957989722903,17.481163012849535,19.543842461257075,11.732111838862561,15.275304079953862,12.763996434850949,10.928438777046042,19.116662982107215,19.555450852647265,11.892196451238082,22.62499624949477,10.612329808628933,14.86899639528348,19.35866297755837,20.328662959325403,11.825381067878618,15.109881006140222,10.62649647502931,15.791354402637378,12.910033469142949,21.12371056342856,16.117700075515444,13.644381033687072,14.827255655327345,13.78444086011421,11.841227221426918,13.26458901803396,8.992181690934547,11.901919527978396,13.967996412219494,13.55414456814677,13.644381033687072,12.762457973341409,15.824796377317421,11.576207995639223,13.958227181633893,18.452723600647822,11.566150303520583,21.08232961182545,19.736359940155797,17.601246343925673,18.560496325894754,17.761269068190476,17.604996343855184,19.709087213395712,4.945632945448285,13.708701545298563,14.065624615512588,18.834541775289008,-2.0950032858460315,9.179446502229375,4.52362158974441,9.560413161735033,8.275121519227847,12.376454775468863,3.208585503351909,7.629996531354187,11.108996465959809,17.883359974986455,6.999079876546806,14.141457947420491,10.74007339597134,15.251534849631417,14.172329741711991,13.509885309719447,11.138842619244942,20.39513914855202,21.255817170753463,21.211041052192133,21.211041052192133,21.211041052192133,20.400853434158897,5.761071566484169,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,9.351663165658888,7.690746530212313,18.210596332471788,9.341546499182357,21.04119030911618,11.566150303520583,11.566150303520583,13.556073343039289,20.792329617276543,21.04119030911618,12.685450981781905,14.172329741711991,13.876163080612338,13.644381033687072,13.644381033687072,19.709087213395712,13.538644568438118,19.47116297544374,16.129371371592356,19.522496307812126,13.644381033687072,16.117700075515444,20.783073207194157,13.644381033687072,15.307996387031654,14.445304095555281,9.062465735197444,11.566150303520583,22.72199624767148,10.058496485705948,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,9.026196505109999,19.80076553335076,7.943796525455751,12.685450981781905,16.338496367661453,22.62499624949477,12.685450981781905,10.15963284744126,12.685450981781905,19.776150149198095,19.336662977971898,10.704829806890222,11.45516312611962,23.05817805953415,22.62499624949477,22.26749625621469,22.72199624767148,11.566150303520583,14.172329741711991,17.990150182769337,22.62499624949477,20.759218506787857,13.580403826912434,12.518304131776894,23.05817805953415,9.206496501720881,10.029705577156214,17.296329682990496,12.89213279607875,20.212303987153593,17.215336735794963,11.566150303520583,13.9717707711229,13.712919493937221,10.74007339597134,12.997284892004314,18.8692555793503,12.762457973341409,13.30586679503584)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.0, 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(18.205, 14.895000000000001,9.438,9.438,12.725000000000001,6.289499999999999,6.289499999999999,9.438,6.289499999999999,3.0900000000000003,6.289499999999999,9.438,1.2905,6.289499999999999,14.895000000000001,21.735000000000003,36.435540499999995,25.565,9.438,14.895000000000001,21.735000000000003,14.895000000000001,14.895000000000001,12.725000000000001,3.0900000000000003,9.438,12.725000000000001,12.725000000000001,14.895000000000001,9.438,3.0900000000000003,6.289499999999999,2.19,1.2905,1.2905,4.466500000000001,25.565,25.565,14.895000000000001,9.438,9.438,18.205,18.205,31.0,18.205,14.895000000000001,18.205,18.205,14.895000000000001,18.205,18.205,12.725000000000001,18.205,18.205,14.895000000000001,12.725000000000001,25.565,9.438,9.438,6.289499999999999,9.438,25.565,4.466500000000001,0.45349999999999996,3.0900000000000003,6.289499999999999,0.06885,6.289499999999999,4.466500000000001,9.438,9.438,6.289499999999999,0.45349999999999996,0.45349999999999996,0.45349999999999996,3.0900000000000003,0.45349999999999996,3.0900000000000003,1.2905,1.2905,4.466500000000001,6.289499999999999,1.2905,12.725000000000001,12.725000000000001,12.725000000000001,18.205,18.205,14.895000000000001,31.0,36.435540499999995,36.435540499999995,36.435540499999995,36.435540499999995,31.0,0.45349999999999996,0.06885,0.45349999999999996,1.2905,0.45349999999999996,0.06885,0.45349999999999996,1.2905,0.45349999999999996,2.19,0.06885,36.435540499999995,9.438,9.438,12.725000000000001,25.565,36.435540499999995,4.466500000000001,18.205,18.205,14.895000000000001,14.895000000000001,6.289499999999999,18.205,25.565,21.735000000000003,21.735000000000003,14.895000000000001,18.205,14.895000000000001,14.895000000000001,2.19,9.438,9.438,9.438,2.19,3.0900000000000003,4.466500000000001,1.2905,6.289499999999999,4.466500000000001,2.19,9.438,2.19,4.466500000000001,3.0900000000000003,1.2905,4.466500000000001,4.466500000000001,4.466500000000001,9.438,1.2905,3.0900000000000003,1.2905,4.466500000000001,1.2905,0.45349999999999996,2.19,9.438,18.205,14.895000000000001,1.2905,18.205,18.205,9.438,4.466500000000001,2.19,4.466500000000001,1.2905,4.466500000000001,9.438,9.438,9.438,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205,12.725000000000001,18.205)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'speciation', n_individual_pred = 3)

consrank=c(1.0, 2.0,4.0,4.0,0.0,2.0,0.0,5.0,3.0)
consrank2 = order(consrank, decreasing = FALSE)
consrank = order(consrank, decreasing = TRUE)
shap_list = list()
shap_list[[1]]=c(-0.03357598904763938, 0.003910835019135262,-0.021245183960674985,0.03240323631477756,0.5521966513255261,0.5907256502758851,0.4995976360140598,-0.012896159926843226,0.6009858594028046,0.18614944553499407,-0.02304497125291405,0.37713862509815377,0.6515046519629237,0.2311481972482976,0.07176776926743772,0.011142929131819681,0.7404303046225138,0.15269187466701092,0.009604896452682152,0.012742480390817504,0.14993060509557468,0.04991101068648769,-0.03493582869045263,0.03145168925119893,0.0926473603198326,0.5069923438289232,0.04527144706486136,0.06432880599758746,0.04947188743394792,0.05026616303203642,-0.35230111194280456,-0.04165523535245795,-0.5666918979135315,-0.40551402244895024,-0.5254101084294834,-0.23837003144656482,0.03204468047068623,0.14895766134786687,0.1003560416237271,0.07870602045240724,0.048553190094228676,0.0008815142986760685,0.0056875642750448445,0.08491864411063597,0.007685264568732399,0.019102800860565195,0.013239916184548738,0.005596506775781892,0.04873229523019787,0.0126904466709862,-0.014626449532394243,0.020968264785587862,0.03516459089989077,0.009667241137261542,0.021173213827434027,0.032673736431429685,0.049643359247179344,-0.0068436456155989926,-0.04967369213028822,-0.05087116158344819,-0.004924095197688131,0.9187449319935416,-0.047789403251526315,-0.17227273097020024,-0.2500010634403557,-0.05634842386524099,-0.1924971256356103,-0.07233972628699896,0.2873595613354421,0.12417506351384369,0.06030216689443355,-0.23027025576088583,-0.2776072742556495,-0.5398467636901642,-0.09278086518814145,-0.06702604632944417,-0.12196000186525655,-0.2562916784016759,-0.4358565561059802,-0.3745104523058798,-0.12075899055808828,-0.028879243452338065,-0.48391336247438294,0.10915417253279891,0.07284833179280091,0.14499652744754352,-0.019856568152591465,-0.00805337950500583,-0.005675775648425389,0.980880389710225,0.5624792818971488,0.8698262580031126,0.6546877429033231,0.4922370085199493,0.9235983743035094,-0.5636076525124397,-0.07619153876818777,-0.4094792714383619,-0.6588994733542187,-0.44590907486618825,-0.08811830761120042,-0.6148211636949342,-0.361731086842905,-0.5205959537534983,-0.3906384543355113,-0.04691657589141842,0.7058627443874658,0.034190948781727994,0.05019636950028165,-0.010388430449904423,0.9146351073897001,0.7172850355754303,-0.2794618102738641,-0.015087761950121436,0.034272326070814374,0.03678626934051462,0.009996263615497334,-0.05158578440697442,0.13374294161033973,0.16353610547944236,0.08946980301734075,-0.007162808299510823,-0.003747495207400129,0.010931687484729977,0.023601210893688832,-0.006269925406039342,0.017226579537016274,0.013663242865186147,0.052586199525783396,0.05622030025383368,0.34334454902830125,0.2665645066274815,0.1802552680522491,0.13394042244691362,0.26671043027042163,0.16470313250513618,0.18654287097944733,-0.009349343530563325,-0.250151233383487,-0.03562393317225656,-0.08072742029300656,-0.16266024407038066,-0.14787809584730316,-0.18603902390897573,-0.1459542270601526,-0.024344624996973964,-0.09855018748232205,-0.13458885111711213,-0.20838550167400866,-0.1636494680596754,-0.14433451779452205,-0.12146897462388129,-0.17089408996535535,-0.09388317265857662,-0.02034677455631278,0.03913663315245997,0.026749941171486158,0.0402713848146659,-0.0038282048580339533,0.10162007858292876,-0.1492022135315045,-0.008364673498595472,-0.006922299295749372,0.05552976740609352,-0.040434201509623534,-0.026893139364298036,-0.03494930199570426,-0.0127914808000724,0.025178016851330448,0.010374500076363858,0.06834280435945239,0.0008203074147491273,-0.014801894939600805,-0.020911935506879465,-0.008991173033578645)
shap_list[[2]]=c(0.04392530657881192, 0.13206128455218197,0.28444288820953884,0.43407672847323087,0.4078063850851292,0.568561566418588,0.2637007190365569,-0.03918450649320855,0.30638919005190557,0.420095260919627,-0.04395561725229409,0.2794232670430611,0.43720882620884804,0.22326949543207647,0.19156059640527492,0.11693060236558428,-0.20036257358514925,-0.1066638998479617,0.020887972436520887,0.08715319731701686,0.05152239852159041,0.07495324124147681,0.01647485900016944,0.07081543847216186,0.3633634279191962,-0.4341757971743009,-0.11622700072909901,-0.0836172710088278,-0.08508663921801311,-0.11701427807336393,-0.06314954859848373,-0.03081535700912904,0.32739833776798244,0.06966603641261385,0.32192372842935046,-0.07279492119258824,-0.09533289744399939,0.16826021419409418,0.3613206663370808,0.3151545381230264,0.32648327249157244,0.05239940360315304,0.02583967610141174,0.17031161229009745,0.02282813871819502,0.05716940857669123,0.0209502277150485,0.031704068976285235,0.03355554293299913,0.031288456240108425,0.19718051886001248,0.09527678031112174,0.09930232692249565,0.0222338743518894,0.0793355700329785,0.059054977741250306,0.11472557771259866,0.17600666004444837,0.20737310986670182,0.41665164468620475,0.13666077897873574,-0.1957236351360967,-0.019203355481273172,0.21930627568316186,0.27131711433725725,-0.04763616633643008,0.19403957897844973,-0.031645018789490824,-0.008352987059175,-0.2441280677059406,-0.06935240679399979,-0.018937618627579676,0.17945118134652036,-0.13313615888697378,0.1528454642365296,-0.025916702109940577,0.16690860711156935,-0.0756650572741057,0.13077232095221009,-0.062142563069585655,-0.027302487004756813,-0.03850937180393325,-0.009350076925555683,0.3485869788623205,0.3383523404507414,0.3933453016848247,-0.06347136086055097,-0.056112044605284815,-0.05289924527981175,0.44532882405426955,0.18790345540798498,0.42814438351563655,0.25500803841917263,-0.10383330121478951,-0.1522868871140289,0.20027612640119957,0.2000423250325774,-0.1499896178798856,-0.12389709938017905,0.07180429530454083,0.192725752910427,-0.09086112565521294,0.015485594435130062,0.3563140356285584,-0.06957748409359932,0.20369506732907147,0.6392845906657029,0.10795829995335673,0.1471260992649221,0.16921914580214642,0.8332377888909924,0.646055146893582,0.22462579385992437,0.10830254258474034,0.1969548874060089,0.1975802781623542,0.15545821496251344,-0.025460417529487828,-0.06924081136972628,-0.1286284772799873,-0.061450806983230744,0.04357021801765143,0.11902352575590976,0.13626690833292593,0.2615359956632833,0.12100449664578714,0.32602311229805575,0.2948255618385446,0.45313850254233345,-0.0018497910609792778,0.1589126207384706,0.08756680453748883,0.03482981773493833,0.062979428484185,0.1176677185159766,0.02380880768295867,0.090498490896638,0.04774501398628641,-0.11818544498139436,-0.021660501099415808,0.0007965651254134495,0.14419222119800884,0.26075231784178743,-0.12946736676054535,0.259272484807979,-0.031890879558360306,0.07300471369918078,0.2367103775101002,-0.09881953761327504,0.006929777739334675,0.01085638565270402,0.062280313574178736,0.20669913092076672,-0.0847281454330411,-0.024998432741863214,-0.01569446797877875,0.13313377227333367,0.05885673591342323,-0.018024529336017735,0.22043900752921516,0.027740121905166053,0.01085909698479316,-0.0017370617450223904,0.3393692305003812,-0.014942307167115665,0.19927171899139232,0.15832081666214481,0.13363217953442064,0.08154217698023189,0.06803272595846765,0.43542979321986797,0.28603456784456516,-0.07349036853276428,-0.06386821401857172,-0.06385436838382944)
shap_list[[3]]=c(0.032731939042212096, 0.17836932380706944,0.10988943588058091,0.22788561802306484,-0.047109291684022184,-0.12628924531823968,-0.02823545978981539,-0.04365776363062795,-0.0636890956798761,-0.052952807886666745,-0.024381210765736537,-0.11624911609913398,-0.08968890041621407,-0.006906794302159469,0.10268375413398556,0.06688866512129955,0.12556193540301538,0.0121388331578957,0.053692343385140937,0.06360618358118846,0.039090484565032745,0.07310159747911031,0.032566594755549697,0.08050289404668112,0.18892757626971832,0.17801666463272509,0.01658977285300494,-0.003410804921019647,0.005462137817388672,0.015581343336581819,-0.09879973360620378,0.007964905083764606,-0.02519143816700085,0.00342638996620868,-0.07246851578939185,-0.10900610220018114,0.01623066487120662,0.10076866821028947,0.14796848585390138,0.09467391252383658,0.1117141122040776,-0.03857905868652043,-0.03086848810760201,0.04443120436931527,-0.05102164660364576,-0.046137933096992385,-0.043298776964110254,-0.020563754732725634,-0.018040570482749395,-0.03862047987612673,-0.05708568553333539,-0.06395025716043665,-0.05390209518277643,-0.03529377103524865,-0.05326577776967104,-0.05729351708694317,0.11886416724156397,0.08818740712434216,0.07531485081816183,0.20485983374663883,0.09220682794449,0.12161160429147862,0.019713750392325396,0.006844186968342797,0.02186901124429403,-0.030874388597887343,-0.0034654135062720135,-0.016213404240947134,0.1751915646796059,0.01759557867249874,0.0010631078228439707,-0.07085440401481868,-0.06565954115723985,-0.23987855875346145,-0.06876526285616635,-0.0129447458256299,-0.05052257870159617,-0.03366676363073777,-0.057992236205657945,-0.06087991722382915,-0.02916497887376539,0.00456402193036765,-0.09187714928495617,0.11626551362729069,0.14246916600748732,0.12847465718319812,0.005528793846632025,0.004171244216058008,0.02540660361080795,0.11338432339240456,0.06459691577616175,0.07984488805857258,0.07145375709554078,0.04956132019705683,0.16282126141639763,-0.028811409327668652,-0.028776969867508995,-0.08467657578000393,-0.2182005859223961,-0.03647739681691305,-0.04675102304283531,-0.20574750430291414,-0.01477845703437985,0.06769579444780312,-0.09005840542968854,-0.038016835911412146,0.16732759651039428,-0.04644408518481592,-0.04532814133213022,-0.036468562598574006,0.21731760122260665,0.17011628703129783,-0.14464699886316795,0.04257398770438874,0.06884108989031365,0.05646620937350486,0.054211988398262745,-0.005817958294643509,-0.013819015656148653,0.010459398592504398,-0.003996080159808249,0.061165213690737144,0.04751379286001412,0.06325879371364347,0.14263093822747192,0.04758134433570603,0.08830525884988746,0.09560980722852637,0.2637208633199082,0.1000429552307994,0.013366182548407565,0.17267511355402604,0.12738081403844387,0.10996432601034276,0.1697216863840915,0.14956274563221625,0.10617128146590571,-0.04527313209823174,-0.035707716354219945,-0.03179125787909875,0.024505246648018085,0.039869021123528234,-0.00687907500396992,-0.0679395886398815,-0.0064524183233138745,-0.029331521737597583,0.0073052074879561835,0.011460372485335374,-0.06500786895846519,0.05190085529779944,0.06506023846638528,0.053160387019895214,0.03967757238277346,-0.041579405451603414,-0.0400723955781348,-0.030952703800181745,0.08465369211929283,0.04493635725733607,-0.02499279400201963,0.05197552458746071,-0.03749370313538601,0.026356118322042953,0.03469518215404515,0.21728942891201236,0.041177393420559615,-0.035492803100065966,-0.0224981798396792,-0.04719836192022852,-0.07290718497086071,-0.03897162075439903,0.261196469987983,0.12077880210083491,0.017434283592116993,0.005123871051044062,0.019802378576804176)
shap_list[[4]]=c(0.016675963733395922, 0.10876568620264364,0.008286544885705838,0.027828631735704924,0.1741948000753106,0.23032571519330083,0.20991767814875412,0.006181568744298274,0.27048369863564375,0.14533186536357265,-5.054657872661343e-05,0.11819220404859657,0.22343409600961667,0.09293484688257474,0.07536710088721454,0.007149118745116786,0.02712443521983312,-0.1372391355332462,0.019267973985849778,0.033128953134236874,0.0021387262581211127,0.05798385968889132,0.022373271043564902,0.020543466471839224,-0.08198097155405948,-0.25025199048873187,-0.09626341870902153,0.008838163922315585,-0.0070528411576841945,-0.08954341647038497,0.025429160164554647,0.012384874791987889,0.2898793385985905,0.0243000742069062,0.3056652955768476,0.0572710271124748,0.0035453703728126917,0.004447336340457785,0.23842112891312053,0.28277343242532005,0.24999983699343206,-0.003492614688365838,0.007750535365792602,0.03388794772533812,0.008677847089774617,-0.0024999851440166854,0.0072417111136176575,0.011242133579268157,0.016316590381590758,0.003182318826732445,-0.0037132845111283773,0.0043154759932032315,0.0021418887226610584,0.00697507043233773,0.0005634087624184825,0.0013666634543875716,0.04491563674474112,0.010230566185952968,0.0125849486575909,0.13227682805859095,0.02795868281652646,0.3187927584120809,0.013174066526588155,0.26218755169531877,0.3364604591174124,0.013238902387757424,0.2573560460237688,0.014092538149979073,0.13728565778487692,-0.05498020668713829,-0.049942838698561795,0.052822161838874636,0.35568338550489564,0.2876407961771714,0.3372011647531573,-0.0023304250123989934,0.3111912312092056,0.051534783315762354,0.25388080897143717,0.05050186443923569,0.012517234642373583,0.009778980582258727,0.15367800300419354,0.30822246283430327,0.22596676201590538,0.35003862839849836,-0.0030205992167804414,0.022620639652554488,0.004023786020607629,0.09156367905997234,0.017989218135278814,0.09240000751898417,0.010117457134642214,-0.057688387341397654,0.09455949822557398,0.2944859031724557,0.293246549147853,0.2638165163128708,0.264319920479105,0.16309758652724232,0.3121247515155976,0.2799704185517615,0.09242136424883082,0.3060498892764,0.028564493347611318,0.30130044630730046,0.13980495419374228,-0.01001785584148401,-0.008416883226178788,0.011918064864304492,0.21302809857777918,0.14961504932459052,0.06350243112191123,0.021352832511133284,0.013571293997431974,0.017938061570658425,0.01362377812042824,0.014455671867695835,-0.12782287534424125,-0.17848584016436359,-0.10643279518378768,-0.009729818053037206,0.03222641747171441,0.03306197836335569,0.04129027905578729,0.031907866323934206,0.15949819634078138,0.06393887449895744,0.037509868327541995,0.0699471794735655,0.5647392204541439,0.6046657090348166,0.4818952550792087,-0.1033907766046962,0.5912764318376542,0.4795198618466373,-0.15084562648029043,0.03928743532994207,0.03879552638502707,0.01582326559330879,0.037372507189356,0.04877022511135448,0.2351067309051881,0.016332830550426523,0.23771201772899855,0.013505370860562407,0.04650470621194788,0.23948449226351198,0.003807474228751413,0.04976032622254729,0.057822833123770054,0.022233361243445392,0.09446142067496584,0.01380688832204444,0.011807367808563741,0.01214120428391862,0.05263384288609404,0.02807397012954299,0.018973875635343286,0.06120925341496354,0.03560474766440905,0.24293078005882282,0.23529147298832392,-0.02611843772581804,0.1418108174526732,0.02642484607694796,-0.005660045279306332,0.002803292732836642,-0.014735327336040941,-0.005189883414513674,0.03634946463763754,0.026046625189143302,0.002596759416929678,0.01353955539633699,0.0010423384007036455)
shap_list[[5]]=c(0.07807807164729703, 0.22532134235687717,-0.11530654982450547,-0.060370432815857834,0.035223757398246895,0.09934239737371778,0.6158980172599637,-0.015379447715678493,0.7481202404584495,1.3554969094161777,0.01835027670850261,-0.14565013888688835,-0.18952346898581432,0.48172110432417375,-0.07155571609185046,-0.11347109612306765,0.44572081954060633,0.0922152736302778,-0.03499870274051077,-0.02325921193145807,-0.06928836623691446,0.012722270510212482,0.07795506818149914,-0.049489679149295154,0.033012330542553606,0.5874485397363657,-0.011361733663448243,-0.007723839034958502,-0.019347201699745187,-0.013119246032407347,0.18357757995948842,0.029874731355532425,-0.1209177293633326,0.2623815169783811,-0.133086790760925,-0.05421177541154924,0.08832900735669205,0.1828767299494719,-0.07520594096114966,0.0010968291165230064,-0.1170561241425467,-0.0627168595749502,-0.006770494964184204,0.11547579027037921,-0.0030552939210061122,-0.02923502738050964,0.00019280140738172946,0.009073900530530888,0.004795154907013895,-0.010046471404365894,-0.2060033840263904,-0.03902840492044722,-0.043650511644939924,-0.004345973264122932,-0.036496019353553844,-0.03222254603619762,0.08245371869534314,-0.09165287475125658,-0.1265850968161218,0.5087814703396774,-0.06743059573581453,0.6235035826514718,0.030305917724859542,0.6332802622776145,0.45246822740020676,0.11020632911317738,0.6383904195496537,0.07652481800250957,-0.19971715390203132,0.027172288771091003,-0.0009933695061733194,0.25168898839975784,-0.2825952838156107,1.7465632464677476,0.610438378479191,-0.01731386157202326,0.5123665715168976,-0.2421496704696334,-0.7404238690631351,-0.11917573486191417,-0.03265496491684783,0.047819844111874385,-0.14693924177594347,-0.04297541033116725,-0.07111031109483618,-0.039349661663514245,-0.010761404462365202,0.01990021477666435,-0.13866405001643753,0.8124599053651724,0.30943405588440687,0.6527308248885736,0.46969986618131987,0.2605480141662537,0.5553299604106335,-0.17295047991634782,0.4859434891881528,1.545917788305816,1.6575927239614843,0.36163150557525886,0.526895880317613,1.7052058547085422,-0.10186593955316436,-0.10861039894614613,0.22066584782547852,0.5183235263274915,0.6768539977403999,-0.0246907029730994,-0.0401037872772908,-0.045948390012743846,0.85616761824487,0.683106340571956,-0.11520007173085878,-0.05913726859501921,-0.08428912108603415,-0.0973448712100347,-0.07771033388594899,0.05481069634416726,-0.0503777358979872,0.11125211436662777,-0.02804800706215369,0.06138608157274861,-0.06861311957974772,-0.08511609183776545,0.1989123007276636,-0.06827584992642927,-0.10853392322859565,-0.10753002687882784,-0.056380685741013,0.06053677445648602,0.1724651300240182,0.20837896429580566,0.182716945774074,0.3112690781701809,0.20396827906774845,0.19170988741777845,0.3052788747120102,0.10205940203539159,-0.16810187347663103,-0.008895690721738663,0.167384686405401,0.883860790897905,-0.0998579697349802,-0.16476359862791617,-0.10053897154300336,0.04148743905526438,1.182133489670674,-0.08393052188886138,-0.12022334819663069,0.736579327110616,0.7475658620242812,0.7857807437832982,0.564705097949582,-0.0768124357069426,0.0030429295455773704,0.11048382765059835,0.2700020799225439,0.1417161060710588,0.3874854531226397,-0.18206652158308329,0.28521852467901965,-0.20982535657921825,-0.18654254106996143,-0.042735937847326634,-0.14089105808957947,0.11790433382707918,-0.06355922802588712,-0.04624940727365201,-0.05875639394595793,-0.02559791576977642,-0.08749164882910651,-0.11190834342427589,0.0798784810486444,0.0055098548732342755,-0.00479212578465822)
shap_list[[6]]=c(-0.1072280783647207, 0.07974036453491315,0.08888671476038258,0.2875764273456295,0.3477027042781456,0.7457626016103316,-0.22150036433740813,0.021726924800413355,-0.1037688132115997,0.39590825782739775,-0.03217566639956758,0.34351103831024193,0.2960629420227609,-0.06574605965308644,0.08924149228042462,-0.06467390688032956,-0.17140980179864576,-0.1105687856793175,0.10835431638949729,0.059191474386222534,0.26870744554834053,0.08294369224520692,-0.13568066710094456,0.1420766356174112,0.13431274481948083,-0.09167881931470127,0.14228720523152041,0.00253793518234492,0.04602455027890119,0.14067152566420235,-0.09558323210768407,-0.005172847982863525,0.5565434306117594,0.21017498564243273,0.46329789177432207,0.016425269380129927,-0.08913942864003899,-0.14833752232328806,0.20005611637256301,0.02935618288878402,0.0763783281209678,-0.0041717396886538655,0.017930903567469476,-0.13845878820445529,-0.01504471751651735,0.06872981816181847,-0.0030951891179722938,0.006542371881909431,0.043848153491907405,0.026862577344902615,0.16838758958141323,0.06620524555129081,0.05825466329744762,0.009300820972374214,0.03940457409937437,0.06436841688423482,0.05673748848583525,0.12366613148246863,0.04154474773832439,-0.016550431318995428,0.08435893065807386,-0.18082398300691938,0.001083615823909223,-0.07439985046206775,0.1277833539551303,-0.0270879460994805,-0.18170330755907682,-0.02137219266817528,0.5642852870777627,0.12048021617680511,0.04196764787451581,-0.10482373441434997,0.7185360943905512,0.6729588857466063,0.5761065527503358,0.04701608534999828,0.5519043148420135,0.07262790532037393,0.6336382039863142,0.1731875115313853,0.02282184065051517,-0.013097507170744965,0.5463553773010746,0.04215526741882421,0.11484103376104646,0.06471804095485838,0.057126908463141744,0.0033017232565267715,0.07888271533027832,-0.15419287448145935,-0.22976105403756503,-0.19248580489271344,-0.17970557472663806,-0.17728101117504935,-0.16633264097191577,0.6792038526374192,0.49513710205063327,1.1599225367780723,0.6136040326024621,-0.0008564748800054062,0.5350083941136495,0.8271618417248042,0.3027302826012699,0.7321787400231148,-0.05865006718555669,0.5197294458332685,-0.08829963096403338,0.07469173867927494,0.10176102017420245,0.0702114672169856,-0.11231326578093681,-0.08234163667148972,0.21315667902900834,-0.010874713856928193,0.08493690303296646,0.09901415265684335,0.04658224481190122,-0.014732097184321507,0.13693310740747794,-0.07214451083969393,0.01360388941044248,-0.084098228894577,0.02099165430698324,0.02047945953795725,-0.2125732629472536,0.02864753923703329,0.025343018469852947,0.08695270416373482,0.3536779442053374,0.08148657727449064,0.2305937207135726,0.30513743754597356,0.2501627334078492,0.18751705733896085,0.22608539068976627,0.3090675116959017,0.27519560064333987,-0.03843168052392167,0.22936569399754592,0.016338626005473134,0.15259793526380416,-0.5190270654099061,0.455647581040307,0.13142312861940936,0.4537739814800322,-0.03294569609136148,-0.22190218810744752,0.5239339481370356,-0.01810682154226144,-0.5802160014055412,-0.5793544156526194,-0.5638287313631593,-0.5422745135833517,0.0769833145615993,-0.00042655335367949957,0.03887985557854384,0.13993506435020345,0.13271341564111377,0.10004099198694996,0.24858128652301592,0.027935473957607315,0.3032666929610733,0.2787527540013902,0.10717558842537325,0.054468755106957846,-0.10159037273593974,-0.03221463994615957,0.05065861230385384,0.038991354289746635,0.01409652656590905,0.3459483995695858,0.12218126801455989,-0.0645411131071569,0.015940883376885616,0.11393589774700656)
shap_list[[7]]=c(-0.0981203867806244, -0.1488488475888583,-0.1468072718880827,-0.18649535840852852,1.11289501092551,2.027400915330257,1.847047543447039,-0.08647466740510033,2.051700516390458,-0.2775822329458183,-0.0829593942030603,0.994965220656835,1.7457564226305249,1.1611362763354163,-0.13128782355527427,-0.09253218092832996,-0.14961746843964832,-0.07779973558251738,-0.12115025877145986,-0.11108884885522667,-0.14229193551079208,-0.1178322005376854,-0.10098604883637723,-0.14408011197860657,4.770636386886131,1.4671976299566785,-0.0921611197606273,-0.07667298403327241,-0.08221707627123406,-0.09189601157600365,0.6494803028700341,-0.088413990241303,4.873756343209495,1.1355705574506856,4.8501062844199705,1.2690766235653763,-0.08766774204264279,-0.10925453561443513,-0.18693088084945841,-0.16629984930247013,-0.17064403440035328,-0.08472008712978496,-0.08619422876004992,-0.12134708996890746,-0.08442272704539626,-0.1085107475115376,-0.08525913543140777,-0.08590800132022862,-0.10187484456185628,-0.09374665738844623,-0.12032298238063346,-0.10985199969652,-0.11139616319756433,-0.08519272008922499,-0.10458506882861915,-0.11333428156414811,-0.12348053348348591,-0.1355424189568623,-0.12346210455838635,-0.18323496450255192,-0.1238352914188057,-0.1720285196970925,-0.0881826494963758,4.975522415401366,5.041380248732098,-0.0025972046811951143,4.865418961400906,-0.016165400245593774,4.997597016952961,0.083423770973372,-0.09284026934200831,0.6009296459481421,4.802301511663026,1.737584844405258,4.959030351044439,-0.08334855037390985,5.253133686393751,0.5020415607084685,4.564535718528246,0.6374350597473162,0.058039806813661235,-0.09013687630141744,1.4190873052473663,-0.1769435947637853,-0.1775617930877325,-0.1822604094822004,-0.08820688845815165,-0.07337860015285007,-0.07668639984459774,-0.20925234565986406,-0.1003075662162054,-0.19576525892934676,-0.15692081286174495,-0.08812520025052033,-0.16653890066830493,4.761824998883409,5.2837319507599405,1.6597438486672835,1.6250684305828358,2.2655075495086967,5.322450210167725,1.7416052617452482,2.194344992121752,4.969625223767949,0.6601634688800952,5.333876354743185,-0.2321006645209387,-0.12413311365195856,-0.13255737170812879,-0.11615327027338611,-0.2728386847978439,-0.2344505471609044,2.3897903855868843,-0.09318631415855352,-0.13021961767485973,-0.13367115679695063,-0.114853118700709,0.00977440217427047,-0.09692524886152114,-0.08627786374698102,-0.0794147279198717,-0.0995520002511707,-0.1069155698128871,-0.12336168500691129,-0.14087164985892106,-0.10880353117018209,-0.16523081594630312,-0.16775926295346605,-0.18249584849249195,-0.12259441764251396,1.6241516472427666,-0.18620744651655247,-0.17531029926273126,1.3729431301769348,-0.19284540122487434,-0.1808063186119682,1.3895188884472827,-0.012096586208566483,0.7731207080088229,-0.08195145595572918,0.3392640883894042,2.8550271796448508,5.33561953772555,0.7261989955575675,5.338623288120507,-0.08504796204807985,1.6466847267264704,5.329868381042243,0.6011940913528936,1.187696856950391,1.2273182838338312,2.1261296358937445,4.791685710641644,0.15698233207374473,-0.07069031480700225,0.15404356125962376,0.9266708278052066,-0.10327157676715046,-0.15408100338352462,1.0277267952195337,-0.1261073060284349,-0.15773937846018252,-0.15730476984741132,4.717195202403618,-0.12044216147999434,-0.12681875692413297,-0.09782296177729742,-0.10901044391152478,-0.10030313968557872,-0.09761157922951717,-0.18040471243772085,-0.15177894651718246,-0.08614151926122772,-0.0787533567817848,-0.1041370509869343)
shap_list[[8]]=c(-0.02760506355751944, -0.034041621791759215,-0.030276082798439446,-0.04628660176537282,-0.09407340918921517,-0.11718679348265384,-0.12978865010559965,-0.010448009608144699,-0.14621693425141552,-0.11175209575519958,-0.013874955255178997,-0.06962683786607776,-0.11269009354969006,-0.07079520307415672,-0.029832759819418353,-0.02238384219558899,0.3979811159307599,0.09322073061366884,-0.020791015791696482,-0.01737838440143803,-0.03725355775484059,-0.01649616584433316,-0.02577226649598278,-0.029531341535006316,-0.037519451297688175,-0.10339742942548565,-0.015959002915942162,-0.01877232002608617,-0.01981677203822067,-0.016384335350516917,-0.03347588695979274,-0.011185317029906171,-0.10472807403185307,-0.026761481568304085,-0.10296954065119365,-0.01987913489060633,0.07238780947938844,0.13672436269202007,-0.01918122451641787,0.02978287791250428,0.0026300303837816182,-0.016436024813154464,-0.010681462229007187,0.1986061474355016,-0.01300758477515406,-0.014148978515039313,-0.011805851079756735,-0.013778888241762094,-0.017017564077541812,-0.011497117146254014,-0.0213293887898997,-0.015473876142830745,-0.015582300819744316,-0.01098883119494715,-0.01483567573005572,-0.014390281474390327,0.10430624448781796,-0.020687698012690138,-0.02072866484603521,-0.0602952754453663,-0.018504315650455433,0.4466878643579693,-0.013160383136576945,-0.09080417756752213,-0.10306835675436594,-0.011346533273051422,-0.09207997891546522,-0.012041644679785898,-0.0217676814002939,0.0032186949877407688,-0.013242875908460166,-0.04115640134566759,-0.0943689690429781,-0.10102799958933469,-0.06748952146395118,-0.009720780677687633,-0.06345189163837807,-0.02444858750548637,-0.07961473364200043,-0.02295491884882225,-0.009943219778176537,-0.0105935154973601,-0.048705467248170695,0.015501356257012688,-0.010952643271137315,0.02654416015799238,-0.011328325010397265,-0.00560886868556444,-0.009941886329089121,0.377944919096202,0.17405165653950821,0.3184649667356484,0.24895230473121077,0.20952285258029746,0.505954184927909,-0.08915579553723205,-0.054084097077131854,-0.07239455094540703,-0.091453247838939,-0.0670884245466503,-0.06003433894690331,-0.09776046496195132,-0.03695459331407455,-0.10720592843876653,-0.035416527838063976,-0.05426876909847054,0.46777499281357626,-0.018963724980013544,-0.019268020002911307,-0.013477469442629522,0.5598187932377853,0.47118349163921713,-0.027543112151250555,-0.01955067741170517,-0.02933958472656578,-0.027678025354711956,-0.024404400571469226,-0.018373907052831658,-0.022946878601553162,-0.03149272272749688,-0.023829978742989373,0.09960277937893076,-0.020566981755263114,-0.021250397746032774,-0.05247207297155844,-0.019040832720295348,-0.0035197860286715317,-0.019876544775389297,-0.040742272998857874,-0.015103658097764755,-0.039053169619747904,-0.040625278258037974,-0.03501610438009296,0.008830598394649957,-0.04500474431126299,-0.03591032308550927,0.01179652391092512,-0.010554638134585657,-0.0290183483019844,-0.009466560899294369,-0.018176236648984306,-0.06966808494601964,-0.07364474494333527,-0.02697464037165483,-0.0732681261651721,-0.012010914739095963,-0.07499351524922829,-0.05985389536823228,-0.021203377726037486,-0.043871935276918114,-0.049471377574436114,-0.05916312661060974,-0.05628374669390547,-0.014593771222600716,-0.007780372669455348,-0.01385356509430993,-0.04572496483583756,-0.00457765964996355,-0.02741044832915062,-0.06826372762831646,-0.018681460511925072,-0.004742101571510273,-0.011453371544708059,-0.03734084968857669,-0.006651806883622047,-0.022731462687496262,-0.01418881763434344,-0.016246155271591862,-0.016607248387272417,-0.01599609145193094,-0.03660623145256524,-0.0347314433734051,0.06090272837746198,-0.008747743016335865,-0.011870870314363803)
shap_list[[9]]=c(0.00834551831344622, -0.0063666772590021264,0.08948414945970012,0.09504498662625924,0.3941434854259874,0.5026202608105643,0.47451668719310425,0.01916742276569859,0.5080068934394831,0.28234410617910716,0.0252992541360416,0.35395403051140956,0.6158789946562435,0.2914985505093003,-0.042358820113017656,0.005771468139411111,-0.5509890566818909,-0.12030005971197913,0.0006476703366222077,-0.02979369755828835,0.10321494376355016,-0.034866121588336574,0.05664137529772312,0.0798780713972018,0.16920315488929166,0.49198335782305946,0.061161222748122857,0.0029127578090538133,0.0024776852762572617,0.05623511171390981,0.09766569168155262,0.034521651344239186,0.48933210335057165,0.1825602520249986,0.4522920385294068,0.10723156303727865,-0.07980252755074088,-0.37465220262172777,0.005201974301570815,0.022083388125665016,0.020802073764476674,0.0013873612081816097,-0.04320553011658029,-0.2409385818469211,-0.005169221522290569,0.0131563504671211,-0.025831892985280613,-0.04664325273810342,-0.03215574756166668,-0.020760738957059512,0.013752857436956529,0.002973602724386657,0.0050180190307782925,-0.0391287570708793,0.0004751137035147318,0.03242231679616041,-0.1264361571598645,0.039304107047600206,0.045399340830558715,0.11975315692408517,0.003446050654801071,-0.27552374316825634,0.039060396388563956,0.30046356833784854,0.31044822479032647,0.04596317480012125,0.31729392106690857,0.052913188201544184,0.2045697998704637,0.16177025684564514,0.0708605694277423,0.11093646362272298,0.4301837490885402,0.39475134088469976,0.15923110195270876,0.026658872088758,0.19130912362280555,0.09364168523733937,0.5369998499848517,0.10182452054921334,0.03741756110307529,0.027784470535356154,0.18192098697777767,-0.008759534347669998,-0.02915622521293935,-0.010214253916619048,0.024737411295084794,-0.028117138388289768,0.008330931318633493,-0.5810906341307993,-0.885462659024278,-0.6723243772585598,-0.6548370615040577,-0.6292555045365402,-0.5389352708299622,0.46291912083106485,0.1655707714352625,0.28539876764417527,0.36621659197681894,0.22868386474203364,0.16005698025538384,0.38781305795090715,0.2330453917023013,0.5135173076906117,0.1080768933069384,0.15070457434269566,-0.7056281431539901,0.039808359100132716,0.05036149942461451,0.006803442986621139,-0.44692069802360557,-0.7056443675305839,0.13743995139456092,-0.050686315746814745,0.023904382427219168,0.007965991233818078,-0.01618553562386219,0.06193157069914364,0.04077031086619001,0.030999051836538383,0.02181833312468976,-0.11465181899518548,-0.026959735123304896,0.03784355521676583,0.011348261329662618,-0.02364066669635839,0.11767475750876306,0.14220924019434752,0.028627864754250297,-0.000633209812523347,0.20382125016025526,0.05887911505662531,0.05186542176870719,0.18221474611494728,0.0488560659945267,0.05546316808630003,0.22746515359515454,0.05430173902664158,0.13387564931463128,0.027972737579928863,0.058990897294977605,0.19954593547430313,0.40259575485998067,0.13024349521026185,0.4025481519656558,0.03786434960441983,0.3272857094382682,0.34261258488152363,0.09482552259916789,0.21337079767542627,0.242111720462362,0.22394201553944346,0.17734072597641187,0.056264268293464294,-0.018278500191026663,0.09024629044852694,0.25185401876374003,-0.03508183565969614,-0.030836932628764586,0.26176860260917767,0.07818531670350151,0.10510400372400899,0.09650179033854848,0.19546315975141837,0.053178553665999405,0.05242726231476121,0.03676550406601292,0.0008674207292470697,0.03468604241303311,-0.0045212743279943995,0.02405444723224518,0.07231231658000051,-0.059172932035282996,0.0015619872936689348,0.03928840788081306)
shap = do.call('cbind', shap_list)
baseline = 0.32060952752799127
rate=c(0.2338368090926505, 0.8595212173611924,0.587964172252197,1.1322727630568992,3.2035896211686095,4.841872595739742,3.851763334394646,0.15964488905879826,4.492621082763844,2.663648236181183,0.1438166966650573,2.4562678203441886,3.89855299806719,2.6588699412304275,0.5761951209227678,0.23543128490390658,0.9850492377393856,0.1183046232418226,0.3561247232106374,0.3949116735910624,0.6863802717776537,0.5030307114090218,0.22924588468274032,0.5227765901215774,5.953212086322448,2.6727440271025236,0.25394689964736256,0.20902997141512847,0.21052525794958904,0.25540638377204483,0.6334527489886522,0.22811294248785569,6.039989941590672,1.7764138361929636,5.879959810626893,1.2763520454817612,0.18120446440135524,0.4304002397027406,1.092615894602929,1.0079368597935878,0.8694702130376284,0.16516142205657222,0.20009800266028632,0.46749641370897504,0.18807958652068318,0.2782352339460917,0.19294333837006022,0.21787461223894708,0.29876853778788615,0.21996186183846858,0.27684931863259193,0.2820443589733469,0.2959599455562396,0.19383648176743112,0.25237886627181155,0.29325501267377485,0.6423390294997203,0.5032777620763956,0.3823769670884972,1.3919806284328264,0.45054650057785456,1.9258503882261686,0.2556114830184853,6.380737028891852,6.529266746909994,0.3141272709757618,6.123362628931253,0.29436268497103224,6.4570605928676015,0.5593371230759088,0.26843125929832345,0.870944373174187,6.086534381250045,4.146219160289541,6.886426891236094,0.17568337306571316,7.071488590019003,0.4082337048282961,5.126549034934277,0.6438948974851109,0.23158132960598166,0.22934033046205435,1.8408659023493943,1.0318167396179188,0.9263061888893274,1.1969025182925728,0.2113574949720128,0.19933331809279994,0.15338620668995712,2.1976357139341145,0.4215328318904323,1.701445415167899,1.03906524490076,0.2762953184732516,1.538779107227803,5.8647941921598505,7.085229109429582,4.5188689691925505,3.7549608206349645,2.861002958076006,7.174967827207449,4.253175703594242,2.6433070758927517,6.529578237224017,0.6937392920056948,7.209036761509703,2.0914899652003105,0.3530093914111122,0.4243803123453721,0.356325525620811,3.0827418864893383,2.135534327201087,2.7822727755011387,0.24431583860911127,0.4992420868652861,0.4776664365039875,0.3673286286546048,0.3456117041450095,0.2509233216808212,0.13982678304458143,0.14232915702862284,0.2711391456945779,0.31356201644400983,0.39272373558665985,0.5940115276478158,0.32371996815114745,0.7773959253287779,0.7226431237096052,1.230251962970783,0.5486622376033852,3.5929506788181795,1.7976444534056184,1.4193893797406374,2.5868775380604103,1.707045384752039,1.4777280006974425,2.7622315856984043,0.4482977374103839,0.8946024887363017,0.19135475697916873,1.0026177969023748,3.740519506551636,6.682071564371216,0.749623759156683,6.686325708539522,0.1978950878767687,3.2080821899234913,6.726306415473535,0.48869015999812565,1.7791100637819715,1.8981845400697472,2.8496751519843473,5.425726835831524,0.31304940030607953,0.15286648098465783,0.7050401630283921,2.1605178019840543,0.6242464252783219,0.5679359357354131,2.043599826782887,0.44380902923044446,0.6284547094692259,0.6018906835074466,5.846436679665167,0.2878835120442463,0.403111153926239,0.24480267375777168,0.27707518365127987,0.2376978237366226,0.2252249151806002,1.1874283138153707,0.6503646813569807,0.18327395208711159,0.19000443019558927,0.3010329616299543)
rate_lwr=c(0.08577021867126552, 0.1455014620513796,0.1591111547119028,0.1708857607439219,0.07271058875705372,2.613651902636698,2.5838874047212053,0.0258872658121016,2.8716921307955605,0.11713137483457728,0.034154865238564425,0.10863316477249096,1.26410043127369,0.05250437425720611,0.08447688968348008,0.03639820404476157,0.17539497521993072,0.04877858813584368,0.15675127155472873,0.2353578183406306,0.20094614045271153,0.1263528930384262,0.06551613880698592,0.24213794236162364,2.438047397963761,0.24096628214292357,0.1618791765066775,0.057760090326672286,0.08232779425411635,0.16197338022354446,0.2967765723271036,0.05792616393410824,2.235679725264414,0.3403293751081288,2.1479175984238568,0.2387177421917824,0.0621391181796746,0.08126723882558068,0.36551491761298366,0.22268851143502152,0.5000520206323321,0.0679426572417629,0.1452815918814884,0.23381373625028345,0.09009574047416313,0.11155858148091216,0.11845469778720069,0.11165363041277798,0.1023805372299513,0.10046168467198924,0.0976126142204578,0.1366009834569566,0.14087396286186346,0.1234765213716153,0.1337841351872354,0.15669492063119586,0.1479421621297314,0.158909639817024,0.15944714297826368,0.20564791054655143,0.15068203240492611,0.18578371063502366,0.060334715321781085,3.294904248703665,3.765496205484451,0.08819677833315975,3.2068381026447166,0.06434411753671712,4.172140611785506,0.13663749456178312,0.0623920483172577,0.2805361051781878,4.266613556240138,2.1193420036538377,2.180997577872057,0.10525949283482078,4.6842291504060665,0.10925772543181328,2.0196117754727587,0.16704447981998138,0.0733518138253395,0.08926555908636638,0.1974635674347706,0.36613835149222096,0.4505315580347875,0.25567563787834263,0.08962317300257813,0.06190324595255431,0.09735907020491802,1.0519517839600305,0.12113594014443607,0.6062467921416542,0.3708795501411739,0.07209950039079321,0.18451554389206132,3.053268414709771,4.522247475675582,0.7767387605708375,0.9938764538758618,0.454410258674678,4.64266576319833,2.0625753140869465,0.21278503910420882,2.801037322236635,0.29253801541432517,4.598339195721823,0.6373526268297388,0.10053813940600742,0.09538648440980732,0.05337447799347722,1.259648986701698,0.6463759955149894,0.3643686780065511,0.08610408264105185,0.2190083772342348,0.27147728754865136,0.16892642436813657,0.0963181347093868,0.06923601655999953,0.04478136635652946,0.07074197737942006,0.08885906510002856,0.15237417522941354,0.1568921132408787,0.19479244114268138,0.17259690823602106,0.2554863733970597,0.2020098918264735,0.17468034323984513,0.13073448739051471,0.28265395847047353,0.6962032411250071,0.34610830417283434,0.7835404532284811,0.6011427783427457,0.3806021051097567,1.0058491924993516,0.1011542794459559,0.35023704920023324,0.12169955870809351,0.07261730168426161,0.7271211441108169,3.441202437372144,0.4168527271124183,3.480341581052659,0.018525688296392284,0.7102170851860241,3.872301580215801,0.3196806583149332,0.7322173779033025,0.7251077141676932,0.7239063281827232,1.6522236004554385,0.11935577118904125,0.040430755359687764,0.09013688910763895,0.19035325907365608,0.12046563790649098,0.15791750251355352,0.15437324541209096,0.06922072392313228,0.25087461364593255,0.3746669210540882,2.9532766292692894,0.1273356339659409,0.10381462045040046,0.04580545309933298,0.12703029273905553,0.06486267423224865,0.11511601587953663,0.213330489162401,0.15874236850110168,0.0625336887908175,0.09374688792746316,0.10457400159483149)
rate_upr=c(0.3978925902758874, 1.6553393932021037,1.3690035718250906,2.2302300024185953,6.881988907849456,6.913490046901042,6.287160665272875,0.30047933480274175,6.82310686164947,6.160305893794302,0.34686881412711135,7.1433482965590995,6.40554136242765,6.764758930951793,2.967200157776999,0.7702475907350959,2.4761390956740477,0.2176165033940614,0.5918482788008578,0.6345836070641035,2.2391095085583204,2.1596779398578505,0.5039839636847466,1.331208348600612,10.343368953556487,6.547114214400775,0.4273171238979145,0.34267981711943646,0.41609522746763894,0.4589988423896223,1.9273971316821867,0.4603795605827078,8.436178163994889,4.255176118982017,8.501729200824833,7.414703769790738,0.32611092663551217,1.2429829416082563,3.073320302190224,2.719741631160343,1.5020335803592277,0.41909795033506325,0.272654648171203,0.9826280564106846,0.27249514586708706,0.7676571592659429,0.2606825701733888,0.30062381462283083,1.1735262481216793,0.42575583343575263,0.5696728166364204,0.49529687772117514,0.4730113902092228,0.25466597696782045,0.3670561470523317,0.5218610563609775,1.785806935739868,0.9635356998458167,0.6820555126098552,3.2411558974304424,0.7756875859547886,4.561840342189384,0.6771104769479989,10.312447815334755,9.022923335660025,0.9407790081011633,10.505176251804162,0.6463451352429613,10.488806493601537,2.4272483238678446,1.0704468975132881,3.010849711765755,7.823703291566619,5.560982948692822,8.91505397402792,0.29044884910657326,9.00140757604908,1.1634550516638182,7.959842875659809,2.2725249543615056,0.5068296684537326,0.5202254235910898,6.008759816609327,2.449770378664738,2.068823760999368,2.983186083665594,0.5020514952479935,0.49602661127382736,0.2292462608982006,5.585889479425847,1.0499529927360443,2.443965642911995,1.825928960590276,0.5019383704668173,3.696461542066536,8.873459564378653,8.998887934630556,6.390102069272621,5.465574239413964,8.047942510133666,8.827119551936272,6.344682096881971,9.331621940194962,10.294960593961584,2.2808408988087097,8.780327552196967,3.484578472698163,0.6914057257171026,0.8406502536907597,0.7040935606682661,4.432747025933109,3.6298788741666916,7.560122413248101,0.4240611006452294,1.7775476021004353,0.9876437957280675,0.9875565006603064,1.2111209251335442,0.9790959887558474,0.24113654526953657,0.2963768559438952,0.45351719743448304,0.4811709078183871,0.6462241430406435,1.3804312965522227,0.4728741659757214,2.340678106240687,1.40790961011463,2.7249875637351955,1.7431412520143708,7.104866581686642,3.4415782913647903,3.0070236832313024,4.722775457249213,3.640457437767025,3.0954038455367154,4.917420020609219,0.9176448575711948,2.202856305942097,0.34436881022394017,3.6564015294503993,9.280342528428417,8.907545185737385,1.309145463529095,8.931489740111898,0.3709619201009163,5.298994804660438,9.631463060282366,0.7249051277874655,2.947218961695188,3.2411179679970576,4.652315615102417,8.983021526241869,0.8732420196004396,0.24142481775330726,4.368962212369484,4.934182631652673,1.4787201036799529,2.821798100993029,4.090235527552501,1.0646545638763782,1.168336219018412,0.9521208205731804,10.415461091372695,0.7264223858128277,1.147728485882244,0.6794072482995261,0.5517268007991906,0.942570108672944,0.3265699941175241,2.750188163703032,1.4985120152768596,0.4279585852017024,0.3343473448106661,0.7181021371727705)
rates = cbind(rate, rate_lwr, rate_upr)
species_names = c()
species_names = c(species_names, 'Afrochoerodon_kisumuensis')
species_names = c(species_names, 'Afromastodon_coppensi')
species_names = c(species_names, 'Amebelodon_floridanus')
species_names = c(species_names, 'Amebelodon_fricki')
species_names = c(species_names, 'Anancus_arvernensis')
species_names = c(species_names, 'Anancus_kazachstanensis')
species_names = c(species_names, 'Anancus_kenyensis')
species_names = c(species_names, 'Anancus_lehmanni')
species_names = c(species_names, 'Anancus_osiris')
species_names = c(species_names, 'Anancus_perimensis')
species_names = c(species_names, 'Anancus_petrocchii')
species_names = c(species_names, 'Anancus_sinensis')
species_names = c(species_names, 'Anancus_sivalensis')
species_names = c(species_names, 'Anancus_ultimus')
species_names = c(species_names, 'Aphanobelodon_zhaoi')
species_names = c(species_names, 'Archaeobelodon_filholi')
species_names = c(species_names, 'Barytherium_grave')
species_names = c(species_names, 'Chilgatherium_harrisi')
species_names = c(species_names, 'Choerolophodon_anatolicus')
species_names = c(species_names, 'Choerolophodon_chioticus')
species_names = c(species_names, 'Choerolophodon_corrugatus')
species_names = c(species_names, 'Choerolophodon_guangheensis')
species_names = c(species_names, 'Choerolophodon_ngorora')
species_names = c(species_names, 'Choerolophodon_pentelici')
species_names = c(species_names, 'Cuvieronius_hyodon')
species_names = c(species_names, 'Deinotherium_bozasi')
species_names = c(species_names, 'Deinotherium_giganteum')
species_names = c(species_names, 'Deinotherium_indicum')
species_names = c(species_names, 'Deinotherium_levius')
species_names = c(species_names, 'Deinotherium_proavum')
species_names = c(species_names, 'Elephas_atavus')
species_names = c(species_names, 'Elephas_ekorensis')
species_names = c(species_names, 'Elephas_hysudricus')
species_names = c(species_names, 'Elephas_hysudrindicus')
species_names = c(species_names, 'Elephas_maximus')
species_names = c(species_names, 'Elephas_planifrons')
species_names = c(species_names, 'Eozygodon_morotoensis')
species_names = c(species_names, 'Eritreum_melakeghebrekristosi')
species_names = c(species_names, 'Eubelodon_morrilli')
species_names = c(species_names, 'Gnathabelodon_buckneri')
species_names = c(species_names, 'Gnathabelodon_thorpei')
species_names = c(species_names, 'Gomphotherium_angustidens')
species_names = c(species_names, 'Gomphotherium_annectens')
species_names = c(species_names, 'Gomphotherium_basal')
species_names = c(species_names, 'Gomphotherium_browni')
species_names = c(species_names, 'Gomphotherium_connexum')
species_names = c(species_names, 'Gomphotherium_cooperi')
species_names = c(species_names, 'Gomphotherium_hannibali')
species_names = c(species_names, 'Gomphotherium_inopinatum')
species_names = c(species_names, 'Gomphotherium_mongoliense')
species_names = c(species_names, 'Gomphotherium_productum')
species_names = c(species_names, 'Gomphotherium_steinheimense')
species_names = c(species_names, 'Gomphotherium_subtapiroideum')
species_names = c(species_names, 'Gomphotherium_sylvaticum')
species_names = c(species_names, 'Gomphotherium_tassyi')
species_names = c(species_names, 'Gomphotherium_wimani')
species_names = c(species_names, 'Hemimastodon_crepusculi')
species_names = c(species_names, 'Konobelodon_atticus')
species_names = c(species_names, 'Konobelodon_britti')
species_names = c(species_names, 'Konobelodon_cyrenaicus')
species_names = c(species_names, 'Konobelodon_robustus')
species_names = c(species_names, 'Losodokodon_losodokius')
species_names = c(species_names, 'Loxodonta_adaurora')
species_names = c(species_names, 'Loxodonta_africana')
species_names = c(species_names, 'Loxodonta_atlantica')
species_names = c(species_names, 'Loxodonta_cookei')
species_names = c(species_names, 'Loxodonta_cyclotis')
species_names = c(species_names, 'Loxodonta_exoptata')
species_names = c(species_names, 'Mammut_americanum')
species_names = c(species_names, 'Mammut_borsoni')
species_names = c(species_names, 'Mammut_obliquelophus')
species_names = c(species_names, 'Mammuthus_africanavus')
species_names = c(species_names, 'Mammuthus_columbi')
species_names = c(species_names, 'Mammuthus_creticus')
species_names = c(species_names, 'Mammuthus_exilis')
species_names = c(species_names, 'Mammuthus_gromovi')
species_names = c(species_names, 'Mammuthus_lamarmorai')
species_names = c(species_names, 'Mammuthus_meridionalis')
species_names = c(species_names, 'Mammuthus_primigenius')
species_names = c(species_names, 'Mammuthus_protomammonteus')
species_names = c(species_names, 'Mammuthus_rumanus')
species_names = c(species_names, 'Mammuthus_subplanifrons')
species_names = c(species_names, 'Mammuthus_trogontherii')
species_names = c(species_names, 'Megabelodon_joraki')
species_names = c(species_names, 'Megabelodon_lulli')
species_names = c(species_names, 'Megabelodon_minor')
species_names = c(species_names, 'Miomastodon_gobiensis')
species_names = c(species_names, 'Miomastodon_metachinjiensis')
species_names = c(species_names, 'Miomastodon_proavus')
species_names = c(species_names, 'Moeritherium_andrewsi')
species_names = c(species_names, 'Moeritherium_chehbeurameuri')
species_names = c(species_names, 'Moeritherium_lyonsi')
species_names = c(species_names, 'Moeritherium_trigodon')
species_names = c(species_names, 'Numidotherium_savagei')
species_names = c(species_names, 'Omanitherium_dhofarensis')
species_names = c(species_names, 'Palaeoloxodon_antiquus')
species_names = c(species_names, 'Palaeoloxodon_creutzburgi')
species_names = c(species_names, 'Palaeoloxodon_cypriotes')
species_names = c(species_names, 'Palaeoloxodon_falconeri')
species_names = c(species_names, 'Palaeoloxodon_jolensis')
species_names = c(species_names, 'Palaeoloxodon_lomolinoi')
species_names = c(species_names, 'Palaeoloxodon_mnaidriensis')
species_names = c(species_names, 'Palaeoloxodon_namadicus')
species_names = c(species_names, 'Palaeoloxodon_naumanni')
species_names = c(species_names, 'Palaeoloxodon_recki')
species_names = c(species_names, 'Palaeoloxodon_tiliensis')
species_names = c(species_names, 'Palaeomastodon_beadnelli')
species_names = c(species_names, 'Paratetralophodon_exoletus')
species_names = c(species_names, 'Paratetralophodon_hasnotensis')
species_names = c(species_names, 'Pediolophodon_campester')
species_names = c(species_names, 'Phiomia_major')
species_names = c(species_names, 'Phiomia_serridens')
species_names = c(species_names, 'Platelephas_platycephalus')
species_names = c(species_names, 'Platybelodon_dangheensis')
species_names = c(species_names, 'Platybelodon_danovi')
species_names = c(species_names, 'Platybelodon_grangeri')
species_names = c(species_names, 'Platybelodon_tongxinensis')
species_names = c(species_names, 'Primelephas_korotorensis')
species_names = c(species_names, 'Prodeinotherium_bavaricum')
species_names = c(species_names, 'Prodeinotherium_hobleyi')
species_names = c(species_names, 'Prodeinotherium_pentapotamiae')
species_names = c(species_names, 'Progomphotherium_maraisi')
species_names = c(species_names, 'Protanancus_brevirostris')
species_names = c(species_names, 'Protanancus_chinjiensis')
species_names = c(species_names, 'Protanancus_macinnesi')
species_names = c(species_names, 'Protanancus_tobieni')
species_names = c(species_names, 'Rhynchotherium_falconeri')
species_names = c(species_names, 'Rhynchotherium_tlascalae')
species_names = c(species_names, 'Serbelodon_barbourensis')
species_names = c(species_names, 'Sinomammut_tobieni')
species_names = c(species_names, 'Sinomastodon_bumiajuensis')
species_names = c(species_names, 'Sinomastodon_huananensis')
species_names = c(species_names, 'Sinomastodon_intermedius')
species_names = c(species_names, 'Sinomastodon_jiangnanensis')
species_names = c(species_names, 'Sinomastodon_praeintermedius')
species_names = c(species_names, 'Sinomastodon_sendaicus')
species_names = c(species_names, 'Sinomastodon_yangziensis')
species_names = c(species_names, 'Stegodibelodon_schneideri')
species_names = c(species_names, 'Stegodon_aurorae')
species_names = c(species_names, 'Stegodon_bombifrons')
species_names = c(species_names, 'Stegodon_elephantoides')
species_names = c(species_names, 'Stegodon_florensis')
species_names = c(species_names, 'Stegodon_ganesa')
species_names = c(species_names, 'Stegodon_huananensis')
species_names = c(species_names, 'Stegodon_insignis')
species_names = c(species_names, 'Stegodon_kaisensis')
species_names = c(species_names, 'Stegodon_luzonensis')
species_names = c(species_names, 'Stegodon_orientalis')
species_names = c(species_names, 'Stegodon_pinjorensis')
species_names = c(species_names, 'Stegodon_sompoensis')
species_names = c(species_names, 'Stegodon_sondaari')
species_names = c(species_names, 'Stegodon_timorensis')
species_names = c(species_names, 'Stegodon_trigonocephalus')
species_names = c(species_names, 'Stegodon_zdanskyi')
species_names = c(species_names, 'Stegolophodon_hueiheensis')
species_names = c(species_names, 'Stegolophodon_latidens')
species_names = c(species_names, 'Stegolophodon_lydekkeri')
species_names = c(species_names, 'Stegolophodon_nasaiensis')
species_names = c(species_names, 'Stegolophodon_pseudolatidens')
species_names = c(species_names, 'Stegolophodon_stegodontoides')
species_names = c(species_names, 'Stegoloxodon_celebensis')
species_names = c(species_names, 'Stegomastodon_aftoniae')
species_names = c(species_names, 'Stegomastodon_mirificus')
species_names = c(species_names, 'Stegomastodon_platensis')
species_names = c(species_names, 'Stegomastodon_primitivus')
species_names = c(species_names, 'Stegotetrabelodon_orbus')
species_names = c(species_names, 'Stegotetrabelodon_syrticus')
species_names = c(species_names, 'Tetralophodon_euryrostris')
species_names = c(species_names, 'Tetralophodon_longirostris')
species_names = c(species_names, 'Tetralophodon_xiaolongtanensis')
species_names = c(species_names, 'Torynobelodon_barnumbrowni')
species_names = c(species_names, 'Torynobelodon_loomisi')
species_names = c(species_names, 'Zygolophodon_aegyptensis')
species_names = c(species_names, 'Zygolophodon_chinjiensis')
species_names = c(species_names, 'Zygolophodon_turicensis')
feat_names = c()
feat_names = c(feat_names, 'NMDS1')
feat_names = c(feat_names, 'NMDS2')
feat_names = c(feat_names, 'PVR1')
feat_names = c(feat_names, 'PVR2')
feat_names = c(feat_names, 'Geography')
feat_names = c(feat_names, 'temp')
feat_names = c(feat_names, 'humans')
feat_names = c(feat_names, 'grassland')
feat_names = c(feat_names, 'time')
ord = ord_by_importance(shap, consrank, rate)
shap_ord = shap[ord, consrank2]
rates_ord = rates[ord, ]
species_names_ord = species_names[ord]
feat_names_ord = feat_names[consrank2]
feat = vector(mode = 'list', length = 9)
feat_states = vector(mode = 'list', length = 9)
tmp=c(-0.0810981217987767, -0.0184602625500703,0.142035802312936,0.194266825002114,0.263965938334339,0.263965938334339,0.242329146842273,0.134814355994058,0.19495139849217,0.100421214012633,0.13077149655276,0.217094065020907,0.29186712293248,0.28098057105069,-0.666339184502935,-0.530823275802624,-2.45263487793742,-1.73451104900531,-0.346161952688902,-0.0984097137815234,-0.974507467842991,-0.369716114281058,-0.0282152712225646,-0.414583843029675,0.43787219068675,-1.71873449869772,-1.6866405917305,-1.68664059173146,-1.67311018539467,-1.68664059173608,1.37285055676594,1.06234113213693,1.37285055676594,1.37285055676594,1.30741179705183,1.06000256094101,-0.815959002114192,-0.70665578525507,-0.0396905546967406,0.356160389552288,0.423212791123226,-0.343765582145374,-0.370101165135938,-0.447344999291067,-0.307519002546884,-0.370101165135938,-0.399408460837228,-0.370101165135938,-0.57789663886497,-0.370101165135938,-0.100356671834941,-0.350217659449109,-0.444332803618098,-0.399408460837228,-0.404282214879937,-0.370101165135938,-0.223422809527815,0.151002162174363,0.170683466246357,0.300060328236166,0.0980591364424912,-2.20167075377711,1.04878505394002,1.08299254011512,1.27222745085973,0.925248582959033,1.08299254011512,1.02839671264375,-0.239250630511692,-0.539360890058233,-0.96188790502483,1.12192988625783,1.30539697666393,1.13783525334634,1.21401142690682,1.17218857430516,1.20089888930885,1.28699654356522,1.20912952757134,1.18450236810203,1.12951613361097,0.945999231421686,1.30539697666393,-0.0396905546967406,-0.0396905546967406,-0.100356671834941,-0.64275858523332,-0.452822722860624,-0.452822722860624,-2.11487309386108,-2.11487309386108,-2.11487309386108,-2.03095105017118,-2.39453275452371,-2.58450581371261,1.42643254115916,1.10694786145604,1.17778725653356,1.25096881371257,1.4264325411591,1.12938793782752,1.20535391880801,1.42643254115915,1.37285055676594,1.42643254121173,1.02656866378845,-1.43887051413826,-0.271570012928229,-0.261534417821888,0.00782404247883269,-1.43887051413826,-1.43887051413827,0.944778975027732,-0.330346187668827,-0.330346187668827,-0.330346187668827,-0.330346187668827,0.892148798427036,-1.94339585412745,-1.9433958541274,-1.94339585412738,-0.298141242446881,-0.307814608648706,-0.242622660617342,-0.242622660617342,-0.242622660617342,-0.0256151895693261,0.00782404247883269,0.142035802312936,0.121922736553118,0.0666798982682849,-0.259337277918984,-0.0613708780116003,0.203607469733747,-0.189096596868158,-0.0122892941850751,0.150667251530403,0.870417481611804,0.838990872842343,0.769062963503208,0.823608451001982,0.816099824028656,0.823608451001982,0.769062963503208,0.823608451001982,0.769062963503208,0.69553586390048,0.838990872842343,0.823608451001982,0.777729611500442,0.768163030932342,0.768163030932342,0.823608451001982,0.862166391042953,0.489231876240483,0.368035773353325,0.526963023945113,0.333689150397327,0.365048636447312,0.526963023945113,1.06481987047411,0.658146436555354,0.511160653197914,0.582383854885132,0.511160653197914,0.387174778229715,0.408443014810719,0.0699339813603915,-0.297765362128601,-0.297765362128601,0.065648961773159,0.065648961773159,-0.572839407131733,-0.535417186758729,-0.622430561423238)
feat[[1]] = tmp[ord]
feat_states[[1]] = NA
tmp=c(-0.799016239637565, -0.567317586836067,-1.56118648538441,-1.63273240063768,-0.170495841571779,-0.170495841571779,-0.175542130996932,-0.243390226809055,-0.223090670725096,-0.386225089427438,-0.207110947575169,-0.238321888268395,-0.180649591666838,-0.175243889773299,-0.978623531843796,-1.09025744803064,1.08959153900003,1.13340697049122,-0.497534449635795,-0.870448273676343,-0.283534196697913,-0.53141789121383,-0.68239770389694,-0.53445284639467,-0.560068068712387,1.66982240067779,1.90822505694254,1.90822505694352,1.73061536594545,1.90822505694826,0.648309788828526,0.616778334033209,0.648309788828526,0.648309788828527,0.635066864936334,0.733434697159816,1.10228837072399,-0.734049517803922,-1.27754260390367,-1.10612747792026,-1.18916153862621,-1.0365355480159,-0.851733865646352,-0.877743982550461,-0.826177802592687,-0.851733865646352,-0.839437818975207,-0.851733865646352,-0.763704961138203,-0.851733865646352,-1.33411877387726,-1.10061656866568,-1.11884892485171,-0.839437818975207,-1.05941177694698,-0.851733865646352,-0.396749683668074,-1.42219607157858,-1.44908740346427,-1.36857456152947,-1.19886651941199,0.483958968833103,0.863758290508446,0.669883789413162,0.587721096377361,0.636195851535037,0.669883789413162,0.73507046434162,1.69602367332516,1.80141832356426,1.54173471109299,0.556943356837852,0.821895143121385,0.966247957669062,0.947028098839172,0.721349911109801,0.872512673167317,0.794307984511626,0.674248570396191,0.587199497869649,0.607002383911984,0.532412806128064,0.821895143121385,-1.27754260390367,-1.27754260390367,-1.33411877387726,1.43198601115371,1.41345946393699,1.41345946393699,-0.391416894911771,-0.391416894911771,-0.391416894911771,-0.318131194873546,1.54527619317039,1.43379047467902,0.755016500591651,0.531745382584057,1.07580209066219,1.00106896117298,0.755016500591618,0.803549572015277,0.779527740164358,0.755016500591647,0.648309788828526,0.755016500620209,0.773109487997718,-0.825341287886961,-1.12023492382837,-1.26369296261025,-1.35262480520825,-0.825341287886961,-0.825341287886963,-0.299854252259367,-1.46225544260505,-1.46225544260505,-1.46225544260505,-1.46225544260505,0.574403550907141,1.14912017838805,1.14912017838802,1.14912017838801,-0.544071998628314,-1.37287531267069,-1.35519082716484,-1.35519082716484,-1.35519082716484,-1.46318553656085,-1.35262480520825,-1.56118648538441,0.309083250195692,-0.184415859422627,0.359433558906997,0.0761512925137987,-0.110935432744233,0.862855576252312,0.0846158961735526,-0.188139912946148,-0.689078861984018,0.657016624459716,0.623536793280301,0.602238937244872,0.754935378509766,0.602238937244872,0.623536793280301,0.602238937244872,0.623536793280301,0.285167399264128,0.657016624459716,0.602238937244872,0.74725744919401,0.831787909509574,0.831787909509574,0.602238937244872,0.803240839487321,0.183362677952304,0.388000629381569,0.181350033322817,0.385567434621975,0.509473327014756,0.181350033322817,-0.172540284383353,-0.316560663252631,-0.222480943931952,-0.338649280135691,-0.222480943931952,-1.50356351576037,-1.60753724935785,-1.5075079588657,-1.11495738502388,-1.11495738502388,-1.43585469142198,-1.43585469142198,1.41246009356279,1.40960430721439,1.57221155396066)
feat[[2]] = tmp[ord]
feat_states[[2]] = NA
tmp=c(-0.058414521820778435, -0.07164671728446251,-0.07587955641462105,-0.07592397681508509,0.06442980838777326,0.06490437016894386,0.06590897787909443,0.06431617570322645,0.06481154220532942,0.06484928067956051,0.06585925934152699,0.06473329810598621,0.06613921304770044,0.06609461796525146,-0.07094003301084287,-0.06904681409764324,-0.07445558363554657,-0.08453356093017415,-0.059247787833885325,-0.059057869529616634,-0.05878367549467526,-0.05902614326599661,-0.05887312006618727,-0.05916943096624768,-0.0939427678987424,-0.0934518857459363,-0.09393425921352966,-0.09374600153857954,-0.09385235739162465,-0.09445570344739337,0.09618559949626625,0.09438542366035656,0.09651634146421605,0.09684472116810389,0.09698486820418072,0.09539882928796065,-0.0651978042313004,-0.0589648571535116,-0.08428366442935248,-0.08572968480621122,-0.08592644706195396,0.024616223124533935,0.015683127461569378,-0.046052085699498625,0.031467721463810105,0.024666240766274168,0.01862707426588952,-0.005349081164331647,0.024585140590386394,0.024562959597428023,0.032734066880927996,0.032931600693062626,0.02465115496692623,0.023650394496710473,0.024758688754084903,0.02694558279953612,-0.06310000696392157,-0.07600813576164203,-0.07579183476577538,-0.0762328138610209,-0.07589878553887243,-0.06514250154159966,0.09522756690017951,0.09985835014724148,0.09929508277144913,0.09525848829910316,0.09985835014724148,0.09643428117280815,-0.07318186696218164,-0.07246685435438704,-0.07288628198634443,0.0960880215156384,0.097782884201871,0.09779348372217933,0.09779299994561766,0.09692490139127626,0.09785663155673786,0.09710186409957576,0.09807318308716768,0.09780343332747295,0.0966887527336106,0.0953334846624295,0.09800120150785513,-0.08289839583141893,-0.0830337584508204,-0.08321461108214506,-0.07090220995564953,-0.07088549300719894,-0.07099054117939556,-0.07474271068281117,-0.07406564324936793,-0.0741283313971423,-0.07398552357668303,-0.0742524603294404,-0.07522102045549028,0.10218560769625591,0.10221241938794932,0.10193411896733814,0.10179712565670455,0.10125194606349096,0.10223292580329378,0.10222386398831851,0.10156883977691315,0.10125102621726598,0.10111439565418553,0.1019489044201218,-0.06642764116640026,0.07677663912824607,0.07703999863644129,0.03291906394475632,-0.06624150622327575,-0.0658000859640134,0.09548242162873982,-0.07059382753326422,-0.07129351179124352,-0.07143449035090073,-0.07144691753022014,0.08619720463387645,-0.08900953397286654,-0.08836704008260386,-0.08876555681922822,-0.06589131701883813,-0.07227825834087352,-0.07275004196774995,-0.07257485206118992,-0.07264785444785284,-0.09182753033091402,-0.09118532436455833,-0.06856933277732158,-0.07004777931120586,-0.09396230613169208,-0.09354960628049984,-0.09298822235522171,-0.0942441569003846,-0.09259860135816678,-0.09294300533704139,-0.09415576437399571,0.08864389056936739,0.04482015807626981,0.04652866828534303,0.046543533724077955,0.04772943291575601,0.04743528308146563,0.04736934004517126,0.04650616882253169,0.04545414891015366,0.04758174462097674,0.04737897294055926,0.04744073959845496,0.047564160384661,0.04665822320279706,0.047742122377705136,0.0475717889869051,0.044621271039851765,0.036335716645303044,0.03673385136527376,0.03732839139921377,0.036184819519851426,0.03663193032743641,0.03693200184217506,0.09358580019913897,-0.09391525814698706,-0.09349307467039521,-0.09415005902316854,-0.09270373444441703,0.08164235026247536,0.08152243629501296,0.0621809246096028,0.06204207584338987,0.06203878377537002,-0.07194691736554613,-0.07224447079653487,-0.07025315172717497,-0.07075509229836187,-0.07032949994111379)
feat[[3]] = tmp[ord]
feat_states[[3]] = NA
tmp=c(0.01953949855438053, 0.03884914396172339,0.04495420642366205,0.045018512254017776,-0.0016716154191672315,-0.001701917063170843,-0.001768543880392044,-0.001663889791991163,-0.0016959204646181795,-0.0016981948432027059,-0.0017652813279619047,-0.0016908940449004406,-0.0017837430863127228,-0.0017807095916983742,0.03781496844930065,0.03527302744784383,0.08358735477225274,0.12579751881416293,0.020231602199437926,0.020072232554906227,0.019845292331429117,0.020045946913419446,0.019918153474218197,0.020165513759836606,-0.1968847216770256,0.16365506255931547,0.1657611909433433,0.16494619027737858,0.16540472065743234,0.16801933738813532,-0.009892260449595293,-0.009436287805448758,-0.009975798919422067,-0.010059129052455018,-0.010094642983979803,-0.009692577839528543,0.0394121879505805,0.02966016698894538,-0.14813906349856124,-0.15500790759303412,-0.15587769481867833,0.005672243555228218,0.006278330346861525,0.010296943435667309,0.004937210360074944,0.005700361845988034,0.006007104069868673,0.007748697154871818,0.005654678916983353,0.005642262490568442,0.004897823460500547,0.004886695550826243,0.005609239591228211,0.005634670972608609,0.005669231546322758,0.005475003314309325,0.0359196685723949,0.045141836769255775,0.044827213122335285,0.04546827257836678,0.04498379870104556,0.03932840226991852,-0.009668337104269835,-0.010921989888297278,-0.010772147083652508,-0.009679388440339862,-0.010921989888297352,-0.009997776440797404,0.05317439278234565,0.051905100638224844,0.052650623321613195,-0.009869291218585124,-0.010305051467682116,-0.010307082521173266,-0.010307655410633393,-0.010084021106339085,-0.010323281896486756,-0.010129600084588485,-0.010380259125666882,-0.010310569804405785,-0.010023228910870579,-0.009678186185091801,-0.010361723707135628,-0.14107427315422225,-0.1416361084544233,-0.14239241379850343,0.04914625449892921,0.04911806931323453,0.04929554423271644,0.08437062774833973,0.08250928978820203,0.0826793109634408,0.0822895602583389,0.08302328117982344,0.0857103386254381,-0.01157085522906214,-0.011578243256120651,-0.01150146132679579,-0.011463743375617163,-0.01131295737515966,-0.011583902156703001,-0.011581395576019416,-0.011400984044436442,-0.011313056191140543,-0.011275581223629918,-0.011505425303646538,0.055394313634535536,-0.004900319860083416,-0.004941454635545249,0.004965743974227885,0.053888118157259364,0.05301405683366961,-0.00971379642655436,0.03736573473354222,0.0382823707739733,0.03846727992729482,0.038483568426807176,-0.007309228216773757,0.14423883227146847,0.14170457694363603,0.1432741129790116,0.030975153238448676,0.03974179480669786,0.04043687992946697,0.0401569998616709,0.04025537871847558,-0.18600122464072524,-0.18283717604266103,0.034520693176759515,0.04762811220635949,-0.1970482871402489,-0.19493843659706273,-0.19204157656876764,-0.19849579701288392,-0.19008092591965742,-0.1918144463173173,-0.19804246963084918,-0.00794116869589442,0.009135515422832252,0.010069355961217065,0.010077328389136624,0.01073234831769021,0.010570898469901753,0.010535190640666143,0.010057504478193417,0.0094951847693506,0.010651247831528753,0.010540401809603929,0.01057385953188753,0.010641963306153891,0.010138052385228767,0.010739311854643514,0.01064582773147443,0.00903675505534908,0.004655064648095826,0.004820601055229108,0.005031858883196039,0.004561004978710308,0.004803568660079683,0.004875742141614021,-0.009224338713644524,-0.19674374933690414,-0.19458980533622836,-0.19794490676806697,-0.19052914002828744,-0.0061154753875975925,-0.006093604261031933,-0.0012242182908813897,-0.0012175479623885452,-0.0012173907684889253,0.03916606687319242,0.039563031434867876,0.04800475575836776,0.048847164085182485,0.04813202374118991)
feat[[4]] = tmp[ord]
feat_states[[4]] = NA
tmp = vector(mode = 'list', length = 4)
tmp_states = c()
tmp[[5]]=c(1.0, 1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0)
tmp_states = c(tmp_states, 'Africa')
tmp[[6]]=c(0.0, 0.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'America')
tmp[[7]]=c(0.0, 0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,1.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,1.0,1.0)
tmp_states = c(tmp_states, 'Eurasia')
tmp[[8]]=c(0.0, 0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,0.0,1.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
tmp_states = c(tmp_states, 'Island')
tmp = do.call('rbind', tmp)
feat[[5]] = tmp[, ord]
feat_states[[5]] = tmp_states
tmp=c(19.58768861427903, 16.77145789798466,12.54225098447362,10.29810557211113,8.193996520752748,6.837329879587193,19.07999631612977,11.367632824734612,18.161829666721786,12.543329772332134,18.452723600647822,8.895596507564846,10.70649647352556,18.316996330471802,12.762457973341409,16.379284828433217,20.305139150243747,20.792329617276543,10.092919561981976,12.78599643443742,9.043360141150975,13.644381033687072,20.230905385405343,9.941360124271384,17.06367135403042,18.771662988592148,10.119360120925535,15.275304079953862,12.763996434850949,9.991905577866738,18.464662994362794,19.037996316919237,9.630996493741618,22.26749625621469,10.683496473957888,12.585271438210423,19.382218532671153,20.328662959325403,9.062465735197444,15.109881006140222,10.62649647502931,14.155919485610195,12.910033469142949,19.98812129905982,15.133227159547541,11.566150303520583,14.53068870933493,13.78444086011421,11.841227221426918,11.438227229002063,6.657265780407739,10.904765700567948,11.296188770133483,13.283150271246315,11.566150303520583,10.647178292822375,15.824796377317421,10.929769196601454,13.212232790061865,18.452723600647822,11.566150303520583,21.08232961182545,19.269996312558362,18.121496334146592,15.70349637959748,17.767541795345295,19.184996314156102,19.219996313498203,3.945996600601969,11.83759645226441,13.34629945420851,18.161829666721786,4.058996598477934,9.179446502229375,9.691796492598769,9.560413161735033,8.13719652182041,9.24823400093636,5.8691632311190585,7.629996531354187,9.222796501414518,17.887359974911266,5.5135590711366635,14.141457947420491,10.74007339597134,15.251534849631417,11.566150303520583,13.509885309719447,9.014881120707269,19.256329646148583,21.255817170753463,20.305139150243747,20.305139150243747,21.211041052192133,20.400853434158897,4.400446592059717,9.341546499182357,1.4329216478399402,9.641329826880717,18.093996334663508,9.341546499182357,8.275121519227847,8.396996516936989,9.07549650418327,17.63799634323489,9.341546499182357,20.39513914855202,10.647178292822375,10.647178292822375,12.8613425868673,20.792329617276543,20.39513914855202,10.70649647352556,14.172329741711991,12.223996445001273,11.566150303520583,12.762457973341409,19.693329637934326,10.928438777046042,18.567611710376397,13.839996414625494,19.296292608360368,13.644381033687072,14.062688718131877,20.653073209637714,12.762457973341409,15.03049639224779,11.451546459520934,9.062465735197444,11.566150303520583,22.62499624949477,9.026196505109999,10.15963284744126,8.672663178421974,10.647178292822375,8.97681468785638,7.690746530212313,19.709996304287746,7.629996531354187,12.543329772332134,15.70239637961816,22.26749625621469,9.45499649704987,7.690746530212313,9.45499649704987,19.634996305697506,19.336662977971898,7.305996537444376,10.70649647352556,22.62499624949477,22.26749625621469,22.26749625621469,21.779996265378173,9.026196505109999,14.172329741711991,17.899611722932722,22.62499624949477,21.1276885853318,12.586611822800617,9.562663161692738,22.72199624767148,6.560946551449007,6.758613214400147,17.61049634375181,11.251996463271851,19.87726902841626,17.020450900297373,11.566150303520583,12.795723706981848,12.518304131776894,9.062465735197444,12.130541901303385,18.8692555793503,12.762457973341409,10.130496484352568)
feat[[6]] = tmp[ord]
feat_states[[6]] = NA
tmp=c(0.0, 0.0,0.0,0.0,0.0,1.0,1.0,0.0,1.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,0.0,2.0,0.0,2.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,2.0,1.0,2.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2.0,2.0,1.0,1.0,1.0,2.0,1.0,1.0,2.0,1.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,1.0,0.0,0.0,1.0,2.0,1.0,2.0,0.0,1.0,2.0,1.0,1.0,1.0,1.0,2.0,0.0,0.0,0.0,1.0,0.0,0.0,1.0,0.0,0.0,0.0,2.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0)
feat[[7]] = tmp[ord]
feat_states[[7]] = NA
tmp=c(1.0, 1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,0.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0,1.0,1.0)
feat[[8]] = tmp[ord]
feat_states[[8]] = NA
tmp=c(9.438, 14.895000000000001,4.466500000000001,6.289499999999999,2.19,1.2905,1.2905,6.289499999999999,1.2905,3.0900000000000003,6.289499999999999,2.19,0.45349999999999996,2.19,12.725000000000001,9.438,31.0,25.565,9.438,14.895000000000001,6.289499999999999,14.895000000000001,6.289499999999999,4.466500000000001,0.00585,1.2905,6.289499999999999,12.725000000000001,14.895000000000001,6.289499999999999,1.2905,2.19,0.06885,0.45349999999999996,0.00585,0.45349999999999996,18.205,25.565,9.438,9.438,9.438,9.438,18.205,21.735000000000003,12.725000000000001,9.438,14.895000000000001,18.205,14.895000000000001,12.725000000000001,9.438,9.438,9.438,14.895000000000001,9.438,6.289499999999999,25.565,6.289499999999999,6.289499999999999,6.289499999999999,9.438,25.565,2.19,0.00585,0.06885,4.466500000000001,0.00585,2.19,0.00585,2.19,4.466500000000001,1.2905,0.00585,0.45349999999999996,0.00585,3.0900000000000003,0.06885,0.45349999999999996,0.00585,1.2905,2.19,4.466500000000001,0.45349999999999996,12.725000000000001,12.725000000000001,12.725000000000001,9.438,18.205,9.438,25.565,36.435540499999995,31.0,31.0,36.435540499999995,31.0,0.06885,0.06885,0.45349999999999996,1.2905,0.45349999999999996,0.06885,0.45349999999999996,0.45349999999999996,0.00585,0.45349999999999996,0.06885,31.0,6.289499999999999,6.289499999999999,9.438,25.565,31.0,0.45349999999999996,18.205,9.438,9.438,12.725000000000001,3.0900000000000003,9.438,9.438,9.438,18.205,14.895000000000001,9.438,12.725000000000001,12.725000000000001,1.2905,1.2905,9.438,9.438,1.2905,2.19,4.466500000000001,1.2905,6.289499999999999,4.466500000000001,0.45349999999999996,4.466500000000001,1.2905,3.0900000000000003,2.19,0.45349999999999996,0.06885,0.45349999999999996,0.06885,3.0900000000000003,1.2905,0.06885,0.45349999999999996,1.2905,0.45349999999999996,0.45349999999999996,0.06885,2.19,18.205,9.438,1.2905,14.895000000000001,14.895000000000001,1.2905,2.19,0.45349999999999996,1.2905,0.00585,2.19,4.466500000000001,6.289499999999999,9.438,6.289499999999999,9.438,9.438,6.289499999999999,18.205,12.725000000000001,6.289499999999999)
feat[[9]] = tmp[ord]
feat_states[[9]] = NA
feat_ord = feat[consrank2]
feat_states_ord = feat_states[consrank2]
shap_heatmap(shap_ord, baseline, rates_ord, species_names_ord, feat_ord,
             feat_names_ord, feat_states_ord, rate_type = 'extinction', n_individual_pred = 3)

dev.off()